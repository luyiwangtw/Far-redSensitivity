<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content=" Lu-Yi Wang1, Devi Stuart-Fox1, Geoff Walker1, Nicholas W. Roberts2 and Amanda M. Franklin1   1School of Biosciences, The University of Melbourne, Australia   2School of Biological Sciences, University of Bristol, UK" />


<title>Main models: Visual sensitivity in the far-red enhances contrast against vegetation</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Overview</a>
</li>
<li>
  <a href="main_models.html">Main models</a>
</li>
<li>
  <a href="even_spacing.html">Even spacing</a>
</li>
<li>
  <a href="opsin_shifed_models.html">Opsin-shifted visual systems</a>
</li>
<li>
  <a href="sensitivity_analysis.html">Sensitivity analysis</a>
</li>
<li>
  <a href="behavioural_assay.html">Behavioural assay</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Main models: Visual sensitivity in the far-red enhances contrast against vegetation</h1>
<h3 class="subtitle">Supplementary Information</h3>
<h4 class="author"><br>Lu-Yi Wang<sup>1</sup>, Devi Stuart-Fox<sup>1</sup>, Geoff Walker<sup>1</sup>, Nicholas W. Roberts<sup>2</sup> and Amanda M. Franklin<sup>1</sup> <br></br> <sup>1</sup>School of Biosciences, The University of Melbourne, Australia <br></br> <sup>2</sup>School of Biological Sciences, University of Bristol, UK <br></br></h4>

</div>


<div id="the-aims" class="section level1">
<h1>The aims</h1>
<ul>
<li><p>We used visual modelling to investigate the potential benefit of long wavelength sensitivity for insects.</p></li>
<li><p>Specifically, we varied the presence of a long wavelength sensitive photoreceptor and its peak sensitivity.</p></li>
<li><p>Our study focused on jewel beetles and their host plants because jewel beetles have sensitivity in the far red.</p></li>
<li><p>Additionally, we tested the effect of red-shifted light environment on contrast by running the same models under twilight illumination.</p></li>
</ul>
<p></br> </br></p>
</div>
<div id="load-r-libraries" class="section level1">
<h1>Load R libraries</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(pavo)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(stringr)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">library</span>(tidyr) <span class="co">#for gather() function</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">library</span>(lme4)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw">library</span>(car)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">library</span>(multcomp)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="kw">library</span>(boot) <span class="co">#for mean() function</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="kw">library</span>(pander) <span class="co">#for creating tidy tables</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="kw">library</span>(ggpubr) <span class="co">#for ggarrange() function</span></span></code></pre></div>
<p></br> </br></p>
</div>
<div id="data-description" class="section level1">
<h1>Data description</h1>
<p></br></p>
<div id="import-and-process-the-data" class="section level2">
<h2>Import and process the data</h2>
<ul>
<li>The wavelength range for all data used in the models was 300-800 nm.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">#import sensitivity curves</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>specsensbuprest.aim1 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/peak sensitivity_filter shift_aim1.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="st">  </span><span class="kw">as.rspec</span>()</span>
<span id="cb2-4"><a href="#cb2-4"></a>specsensbuprest.aim2 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/peak sensitivity_filter shift_aim2.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="st">  </span><span class="kw">as.rspec</span>()</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#import irradiance</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>irradiance.d65 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/d65.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="st">  </span><span class="kw">as.rspec</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">300</span>,<span class="dv">800</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#set import range</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="st">  </span><span class="kw">procspec</span>(<span class="dt">opt =</span> <span class="kw">c</span>(<span class="st">&quot;min&quot;</span>, <span class="st">&quot;max&quot;</span>)) <span class="co">#standardize the illumination spectrum (0,1)</span></span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a>irradiance.twilight &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/civil twilight.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="st">  </span><span class="kw">as.rspec</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">300</span>,<span class="dv">800</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="st">  </span><span class="kw">rename</span>( <span class="dt">twilight =</span> Irradiance) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="st">  </span><span class="kw">irrad2flux</span>() <span class="co">#convert the irradiance (μ Watt.cm^{-2}) to photon flux (μ mol.s^{-1}.m^{-2}) to derive correct quantum catch.</span></span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co">#import background - average leaf</span></span>
<span id="cb2-20"><a href="#cb2-20"></a>aveleaf &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/aveleaf.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.rspec</span>()</span>
<span id="cb2-21"><a href="#cb2-21"></a></span>
<span id="cb2-22"><a href="#cb2-22"></a></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="co">#import and combine beetle, flower, leaf together</span></span>
<span id="cb2-24"><a href="#cb2-24"></a>raw.dataset&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;data/refelectance spectra.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.rspec</span>()</span>
<span id="cb2-25"><a href="#cb2-25"></a>dataset&lt;-<span class="st"> </span><span class="kw">aggspec</span>(raw.dataset, <span class="dt">by =</span> <span class="dv">3</span>, <span class="dt">FUN =</span> mean) <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#average three measurements to a representative one</span></span>
<span id="cb2-26"><a href="#cb2-26"></a><span class="st">  </span><span class="kw">procspec</span>(<span class="dt">opt =</span> <span class="st">&quot;smooth&quot;</span>, <span class="dt">span =</span> <span class="fl">0.1</span>, <span class="dt">fixneg =</span> <span class="st">&quot;zero&quot;</span>) <span class="co">#smooth the spectra and lift &lt;0 to 0</span></span></code></pre></div>
<p></br></p>
</div>
<div id="spectral-reflectance-of-the-targets" class="section level2">
<h2>Spectral reflectance of the targets</h2>
<ul>
<li>Jewel beetles and their host plants (leaves and flowers)
<ul>
<li>Leaves:
<ul>
<li>sample source: mainly from Melton Gardens and Maranoa Gardens (4 from Meblourne roadsides).</li>
<li>colour (to human vision): green</li>
<li>total number: 46 (all are from the host plant genus of Australian jewel beetles)</li>
</ul></li>
<li>Flowers:
<ul>
<li>sample source: mainly from Melton Gardens and Maranoa Gardens (4 from Meblourne roadsides).</li>
<li>colour (to human vision): white (10), pink (11), red (10), yellow (9), orange (3), and purple (4)</li>
<li>total number: 47 (from 46 species, the same species for leaf reflectance)</li>
</ul></li>
<li>Beetles:
<ul>
<li>sample source: Australian jewel beetles from, ANIC (29) and our own collection</li>
<li>colour (to human vision): red, pink, yellow/orange, green, blue, velvet, black</li>
<li>total number: 37</li>
</ul></li>
</ul></li>
<li>We averaged of 3 measurements to generate a representative spectrum for each colour</li>
<li>The spectral data were smoothed with the span = 0.1, and those &lt; 0 were lifted to 0</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">#assign categories to each spectrum</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>category.list &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;flower&quot;</span>,<span class="st">&quot;leaf&quot;</span>,<span class="st">&quot;beetle&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>category &lt;-<span class="st"> </span><span class="kw">rep</span>(category.list , <span class="kw">c</span>(<span class="dv">47</span><span class="op">*</span><span class="dv">501</span>,<span class="dv">46</span><span class="op">*</span><span class="dv">501</span>,<span class="dv">37</span><span class="op">*</span><span class="dv">501</span>))</span>
<span id="cb3-4"><a href="#cb3-4"></a>wavelength&lt;-<span class="kw">rep</span>(dataset[,<span class="dv">1</span>])</span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">#transform the data for ploting purpose</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>dataset.transpose&lt;-<span class="kw">gather</span>(dataset[,<span class="dv">2</span><span class="op">:</span><span class="dv">131</span>], <span class="dt">key =</span> <span class="st">&quot;species&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;reflectance&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">FALSE</span>,</span>
<span id="cb3-8"><a href="#cb3-8"></a>                          <span class="dt">convert =</span> <span class="ot">FALSE</span>, <span class="dt">factor_key =</span> <span class="ot">FALSE</span>)</span>
<span id="cb3-9"><a href="#cb3-9"></a>dataset.plot.indivisually&lt;-<span class="kw">cbind</span>(dataset.transpose, wavelength,category)</span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">#split data by categories for future use</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>flower.spec&lt;-dataset.plot.indivisually[<span class="dv">1</span><span class="op">:</span><span class="dv">23547</span>,]</span>
<span id="cb3-13"><a href="#cb3-13"></a>leaf.spec&lt;-dataset.plot.indivisually[<span class="dv">23548</span><span class="op">:</span><span class="dv">46593</span>,]</span>
<span id="cb3-14"><a href="#cb3-14"></a>beetle.spec&lt;-dataset.plot.indivisually[<span class="dv">46594</span><span class="op">:</span><span class="dv">65130</span>,]</span>
<span id="cb3-15"><a href="#cb3-15"></a></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co">#merge the spectra before plot here</span></span>
<span id="cb3-17"><a href="#cb3-17"></a>dataset.plot.indivisually<span class="op">$</span>category2&lt;-<span class="kw">factor</span>(dataset.plot.indivisually<span class="op">$</span>category, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;leaf&quot;</span>,<span class="st">&quot;flower&quot;</span>,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-18"><a href="#cb3-18"></a></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co">#plot the spectra of the targets used in this model</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="kw">ggplot</span>(dataset.plot.indivisually,<span class="kw">aes</span>(<span class="dt">x=</span>wavelength,<span class="dt">y=</span>reflectance, <span class="dt">colour=</span>category2, <span class="dt">group=</span>species))<span class="op">+</span></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span>.<span class="dv">05</span>)<span class="op">+</span></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span>.<span class="dv">05</span>)<span class="op">+</span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span></span>
<span id="cb3-24"><a href="#cb3-24"></a><span class="st">  </span><span class="kw">scale_color_manual</span>( <span class="dt">values =</span> <span class="kw">c</span>( <span class="st">&quot;forestgreen&quot;</span>, <span class="st">&quot;palevioletred1&quot;</span>,<span class="st">&quot;cornflowerblue&quot;</span>))<span class="op">+</span></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="st">  </span><span class="kw">facet_grid</span>(category2 <span class="op">~</span><span class="st"> </span>.)<span class="op">+</span></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Wavelength (nm)&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Reflectance (%)&quot;</span>)<span class="op">+</span></span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="st">  </span><span class="kw">theme_classic</span>()<span class="op">+</span></span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour=</span><span class="ot">FALSE</span>) <span class="co"># remove the legend</span></span></code></pre></div>
<div class="figure">
<img src="main_models_old-code_files/figure-html/unnamed-chunk-2-1.png" alt="Figure caption: Reflectance spectra of the targets" width="672" />
<p class="caption">
Figure caption: Reflectance spectra of the targets
</p>
</div>
<p></br> </br></p>
</div>
<div id="visual-sensitivities-and-visual-systems" class="section level2">
<h2>Visual sensitivities and visual systems</h2>
<ul>
<li><p>We created nine sensitivity curves peaking at 355, 445, 530, 580, 600, 620, 640, 660 nm and classified them into 4 photoreceptor types based on their peaks:</p>
<ul>
<li>Ultraviolet sensitive (UVS): 355 nm</li>
<li>Short-wavelength sensitive (SWS): 445 nm</li>
<li>Medium-wavelength sensitive (MWS): 530 nm</li>
<li>Long-wavelength sensitive (LWS): 580, 600, 620, 640, 660 nm</li>
</ul></li>
<li><p>For the LWS, we applied a cut-off filter on the A1opsin sensitivity template peaking at 570 nm to shift the peak sensitivty to longer wavelengths.</p></li>
<li><p>Based on these sensitivities, we created several different visual systems to test two different questions:</p>
<ul>
<li>What is the benefit of possessing a long wavelength photoreceptor?</li>
<li>Is there an benefit to shifting the peak sensitivity of the long wavelength photoreceptor?</li>
</ul></li>
</ul>
<hr />
<ul>
<li>For the first question we compared the contrast between 3 trichromatic visual system with varied photoreceptor combination. We also tested whether an extra receptor enhanced chromatic contrast by comparing the trichromatic visual systems with a tetrachromatic visual system.
<ul>
<li>Visual systems used:
<ol style="list-style-type: decimal">
<li>Visual system USM (USM): 355 nm, 445 nm, 530 nm (UVS,SWS,MWS)</li>
<li>Visual system UML (UML): 355 nm, 530 nm, 600 nm (UVS,MWS,LWS)</li>
<li>Visual system USL (USL): 355 nm, 445 nm, 600 nm (UVS,SWS,LWS)</li>
<li>Visual system USML (USML): 355 nm, 445 nm, 530 nm, 600 nm (UVS,SWS,MWS,LWS)</li>
</ol></li>
</ul></li>
</ul>
<hr />
<ul>
<li>For the second question, we tested how the contrast changed as peak sensitivity increased by systematically increasing the peak sensitivity of the LWS photoreceptor from 580-660 nm.
<ul>
<li>Visual systems used:
<ol style="list-style-type: decimal">
<li>Visual system 580 (VS 580): 355 nm, 445 nm, 530 nm, 580 nm</li>
<li>Visual system 600 (VS 600): 355 nm, 445 nm, 530 nm, 600 nm</li>
<li>Visual system 620 (VS 620): 355 nm, 445 nm, 530 nm, 620 nm</li>
<li>Visual system 640 (VS 640): 355 nm, 445 nm, 530 nm, 640 nm</li>
<li>Visual system 660 (VS 660): 355 nm, 445 nm, 530 nm, 660 nm</li>
</ol></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>wl&lt;-specsensbuprest.aim2[,<span class="dv">1</span>]</span>
<span id="cb4-2"><a href="#cb4-2"></a>peaks&lt;-<span class="kw">gather</span>(specsensbuprest.aim2[,<span class="dv">2</span><span class="op">:</span><span class="dv">9</span>], peak, value) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(wl)</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a>peak.order &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;UVS.355.A1.&quot;</span>, <span class="st">&quot;SWS.445.A1.&quot;</span>, <span class="st">&quot;MWS.530.A1.&quot;</span>, <span class="st">&quot;LWS.570.A1..filter580.&quot;</span>, <span class="st">&quot;LWS.570.A1..filter600.&quot;</span>, <span class="st">&quot;LWS.570.A1..filter620.&quot;</span>, <span class="st">&quot;LWS.570.A1..filter640.&quot;</span>, <span class="st">&quot;LWS.570.A1..filter660.&quot;</span>) <span class="co">#to order the peaks in the legend</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="kw">ggplot</span>(peaks,<span class="kw">aes</span>(<span class="dt">x=</span>wl, <span class="dt">y=</span>value, <span class="dt">col=</span>peak))<span class="op">+</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">color=</span><span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="st">&quot;peak sensitivity&quot;</span>))<span class="op">+</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(</span>
<span id="cb4-9"><a href="#cb4-9"></a>    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkorchid4&quot;</span>, <span class="st">&quot;dodgerblue3&quot;</span>, <span class="st">&quot;olivedrab4&quot;</span>, <span class="st">&quot;orange1&quot;</span>, <span class="st">&quot;orange3&quot;</span>,<span class="st">&quot;darkorange3&quot;</span>, <span class="st">&quot;orangered1&quot;</span>, <span class="st">&quot;red2&quot;</span>),</span>
<span id="cb4-10"><a href="#cb4-10"></a>    <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;355 nm&quot;</span>, <span class="st">&quot;445 nm&quot;</span>,<span class="st">&quot;530 nm&quot;</span>, <span class="st">&quot;580 nm&quot;</span>, <span class="st">&quot;600 nm&quot;</span>, <span class="st">&quot;620 nm&quot;</span>, <span class="st">&quot;640 nm&quot;</span>, <span class="st">&quot;660 nm&quot;</span> ),</span>
<span id="cb4-11"><a href="#cb4-11"></a>    <span class="dt">breaks=</span>peak.order)<span class="op">+</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Wavelength (nm)&quot;</span>)<span class="op">+</span><span class="st"> </span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Relative spectral sensitivity&quot;</span>)<span class="op">+</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<div class="figure">
<img src="main_models_old-code_files/figure-html/unnamed-chunk-3-1.png" alt="Figure caption: Sensitivity curves of the photoreceptors with different peak wavelengths." width="672" />
<p class="caption">
Figure caption: Sensitivity curves of the photoreceptors with different peak wavelengths.
</p>
</div>
<p></br> </br></p>
</div>
<div id="illuminations" class="section level2">
<h2>Illuminations</h2>
<ul>
<li><p>Two light environments: daylight and twilight (to represent red-shifted illumination).</p>
<ul>
<li>Daylight: <strong>D65</strong> (standard daylight) from Commission internationale de l’eclairage CIE</li>
<li>Twilight: measured at the Pinnacles Lookout in Alpine National Park, VIC, Australia at 18:15 on September 14th 2019.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">ggplot</span>(irradiance.d65, <span class="kw">aes</span>(<span class="dt">x =</span> wl, <span class="dt">y =</span> D65))<span class="op">+</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Wavelength (nm)&quot;</span>)<span class="op">+</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;Relative irradiance (%)&quot;</span>)<span class="op">+</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<div class="figure">
<img src="main_models_old-code_files/figure-html/unnamed-chunk-4-1.png" alt="Figure caption: Relative irrdiance of D65 (standard daylight) used for the daylight models" width="672" />
<p class="caption">
Figure caption: Relative irrdiance of D65 (standard daylight) used for the daylight models
</p>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">ggplot</span>(irradiance.twilight, <span class="kw">aes</span>(<span class="dt">x =</span> wl, <span class="dt">y =</span> twilight))<span class="op">+</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Wavelength (nm)&quot;</span>)<span class="op">+</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;Photon flux (umol.s-1.m-2.nm-1)&quot;</span>)<span class="op">+</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<div class="figure">
<img src="main_models_old-code_files/figure-html/unnamed-chunk-5-1.png" alt="Figure caption: Absolute irradiance of the twilight used in the twilight models" width="672" />
<p class="caption">
Figure caption: Absolute irradiance of the twilight used in the twilight models
</p>
</div>
<p></br> </br></p>
</div>
</div>
<div id="run-the-visual-models" class="section level1">
<h1>Run the visual models</h1>
<p></br> </br></p>
<div id="first-quantum-catch-calculation" class="section level2">
<h2>First: Quantum catch calculation</h2>
<ul>
<li>We used the <code>vismodel</code> function in the package pavo to calculate quantum catch.</li>
<li>For each visual system, quantum catch was calculated based on Fechner’s law (the signal of the receptor channel is proportional to the logarithm of the quantum catch).</li>
<li>The average of all leaf spectra was used as the background adapting light.</li>
<li>The von Kries chromatic adaptation was applied.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co">#Quantum catch - D65 - aim 1</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>vsUSM=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim1[, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a>vsUML=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim1[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a>vsUSL=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim1[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a>vsUSML=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim1[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">#Quantum catch - D65 - Aim 2</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>buprest580=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb7-9"><a href="#cb7-9"></a>buprest600=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb7-10"><a href="#cb7-10"></a>buprest620=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">7</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb7-11"><a href="#cb7-11"></a>buprest640=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">8</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb7-12"><a href="#cb7-12"></a>buprest660=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">9</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb7-13"><a href="#cb7-13"></a></span>
<span id="cb7-14"><a href="#cb7-14"></a></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">#Quantum catch - twilight - aim 1</span></span>
<span id="cb7-16"><a href="#cb7-16"></a>vsUSM_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim1[, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb7-17"><a href="#cb7-17"></a>vsUML_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim1[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb7-18"><a href="#cb7-18"></a>vsUSL_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim1[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb7-19"><a href="#cb7-19"></a>vsUSML_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim1[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb7-20"><a href="#cb7-20"></a></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="co">#Quantum catch - twilight - Aim 2</span></span>
<span id="cb7-22"><a href="#cb7-22"></a>buprest580_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb7-23"><a href="#cb7-23"></a>buprest600_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb7-24"><a href="#cb7-24"></a>buprest620_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">7</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb7-25"><a href="#cb7-25"></a>buprest640_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">8</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb7-26"><a href="#cb7-26"></a>buprest660_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">9</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p></br> </br></p>
</div>
<div id="second-contrast-calculation" class="section level2 tabset tabset-fade tabset-pills">
<h2>Second: Contrast calculation</h2>
<ul>
<li><p>To calculate chromatic contrast we used the <code>coldist</code> function in pavo.</p></li>
<li><p>We used a neural noise-limited model where the noise is proportional to the Weber fraction and is independent of the intensity of the signal received.</p></li>
<li><p>Photoreceptor density of the tetrachromat was based on the opsin gene expression of Emerald ash borer, <em>Agrilus planipennis</em>: 1.14, 1, 1.26, 1.38. For the trichromates, we redistributed the lost cone number proportionally to the remaining three cones. (USM: 1.6027, 1.4059, 1.771; UML: 1.4416, 1.5933, 1.7451; USL:1.5481, 1.3580, 1.8740)</p></li>
<li><p>The Weber fraction for the longest cone in the tetrachromat was 0.1, which was used to calculated the unknown signa;-to-noise ratio. To keep the signa;-to-noise ratio the same bwtween the tetrachromat and the trichromates, we adjusted the weber fractions for the longest cone in trichromats to be 0.0883, 0.0889, 0.0858 for USM, UML, USL.</p></li>
<li><p>In the models using twilight illuminance, we took the photo shot noise into account.</p></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co">#Contrast calculation- D65 - aim 1</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>CvsUSM =<span class="st"> </span><span class="kw">coldist</span>(vsUSM, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.6027</span>, <span class="fl">1.4059</span>, <span class="fl">1.7714</span>), <span class="dt">weber =</span> <span class="fl">0.1059</span>, <span class="dt">weber.ref =</span> <span class="dv">3</span>) </span>
<span id="cb8-3"><a href="#cb8-3"></a>CvsUML =<span class="st"> </span><span class="kw">coldist</span>(vsUML, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.4416</span>, <span class="fl">1.5933</span>, <span class="fl">1.7451</span>), <span class="dt">weber =</span> <span class="fl">0.1067</span>, <span class="dt">weber.ref =</span> <span class="dv">3</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a>CvsUSL =<span class="st"> </span><span class="kw">coldist</span>(vsUSL, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.5481</span>, <span class="fl">1.3580</span>, <span class="fl">1.8740</span>), <span class="dt">weber =</span> <span class="fl">0.1030</span>, <span class="dt">weber.ref =</span> <span class="dv">3</span>)</span>
<span id="cb8-5"><a href="#cb8-5"></a>CvsUSML =<span class="st"> </span><span class="kw">coldist</span>(vsUSML, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.12</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#Contrast calculation- D65 - Aim 2</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>Cbuprest580 =<span class="st"> </span><span class="kw">coldist</span>(buprest580, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.12</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb8-9"><a href="#cb8-9"></a>Cbuprest600 =<span class="st"> </span><span class="kw">coldist</span>(buprest600, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.12</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb8-10"><a href="#cb8-10"></a>Cbuprest620 =<span class="st"> </span><span class="kw">coldist</span>(buprest620, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.12</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb8-11"><a href="#cb8-11"></a>Cbuprest640 =<span class="st"> </span><span class="kw">coldist</span>(buprest640, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.12</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb8-12"><a href="#cb8-12"></a>Cbuprest660 =<span class="st"> </span><span class="kw">coldist</span>(buprest660, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.12</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb8-13"><a href="#cb8-13"></a></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co">#Contrast calculation- twilight - aim 1</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>CvsUSM_twilight =<span class="st"> </span><span class="kw">coldist</span>(vsUSM_twilight, <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.6027</span>, <span class="fl">1.4059</span>, <span class="fl">1.7714</span>), <span class="dt">weber =</span> <span class="fl">0.1059</span>, <span class="dt">weber.ref =</span> <span class="dv">3</span>)  </span>
<span id="cb8-16"><a href="#cb8-16"></a>CvsUML_twilight =<span class="st"> </span><span class="kw">coldist</span>(vsUML_twilight, <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.4416</span>, <span class="fl">1.5933</span>, <span class="fl">1.7451</span>), <span class="dt">weber =</span> <span class="fl">0.1067</span>, <span class="dt">weber.ref =</span> <span class="dv">3</span>)</span>
<span id="cb8-17"><a href="#cb8-17"></a>CvsUSL_twilight =<span class="st"> </span><span class="kw">coldist</span>(vsUSL_twilight, <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.5481</span>, <span class="fl">1.3580</span>, <span class="fl">1.8740</span>), <span class="dt">weber =</span> <span class="fl">0.1030</span>, <span class="dt">weber.ref =</span> <span class="dv">3</span>)</span>
<span id="cb8-18"><a href="#cb8-18"></a>CvsUSML_twilight =<span class="st"> </span><span class="kw">coldist</span>(vsUSML_twilight, <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.12</span>,  <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb8-19"><a href="#cb8-19"></a></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="co">#Contrast calculation- twilight - Aim 2</span></span>
<span id="cb8-21"><a href="#cb8-21"></a>Cbuprest580_twilight =<span class="st"> </span><span class="kw">coldist</span>(buprest580_twilight, <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.12</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb8-22"><a href="#cb8-22"></a>Cbuprest600_twilight =<span class="st"> </span><span class="kw">coldist</span>(buprest600_twilight, <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.12</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb8-23"><a href="#cb8-23"></a>Cbuprest620_twilight =<span class="st"> </span><span class="kw">coldist</span>(buprest620_twilight, <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.12</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb8-24"><a href="#cb8-24"></a>Cbuprest640_twilight =<span class="st"> </span><span class="kw">coldist</span>(buprest640_twilight, <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.12</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb8-25"><a href="#cb8-25"></a>Cbuprest660_twilight =<span class="st"> </span><span class="kw">coldist</span>(buprest660_twilight, <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.12</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">#combine all contrast value in each comparison group</span></span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#Daylight - aim 1</span></span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">##flower vs leaf</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>VS1.fl_d65.aim1&lt;-<span class="st"> </span>CvsUSM<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-8"><a href="#cb9-8"></a>VS1.fl_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-9"><a href="#cb9-9"></a>VS2.fl_d65.aim1&lt;-CvsUML<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-11"><a href="#cb9-11"></a>VS2.fl_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-12"><a href="#cb9-12"></a>VS3.fl_d65.aim1&lt;-CvsUSL<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-14"><a href="#cb9-14"></a>VS3.fl_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-15"><a href="#cb9-15"></a>VS4.fl_d65.aim1&lt;-CvsUSML<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-17"><a href="#cb9-17"></a>VS4.fl_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-18"><a href="#cb9-18"></a>allvis.fl_d65.aim1&lt;-VS1.fl_d65.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.fl_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.fl_d65.aim1) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS4.fl_d65.aim1)</span>
<span id="cb9-19"><a href="#cb9-19"></a></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co">##beetle vs leaf</span></span>
<span id="cb9-21"><a href="#cb9-21"></a>VS1.bl_d65.aim1&lt;-<span class="st"> </span>CvsUSM<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-23"><a href="#cb9-23"></a>VS1.bl_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-24"><a href="#cb9-24"></a>VS2.bl_d65.aim1&lt;-CvsUML<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-26"><a href="#cb9-26"></a>VS2.bl_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-27"><a href="#cb9-27"></a>VS3.bl_d65.aim1&lt;-CvsUSL<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-28"><a href="#cb9-28"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-29"><a href="#cb9-29"></a>VS3.bl_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-30"><a href="#cb9-30"></a>VS4.bl_d65.aim1&lt;-CvsUSML<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-31"><a href="#cb9-31"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-32"><a href="#cb9-32"></a>VS4.bl_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-33"><a href="#cb9-33"></a>allvis.bl_d65.aim1&lt;-VS1.bl_d65.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bl_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bl_d65.aim1) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS4.bl_d65.aim1)</span>
<span id="cb9-34"><a href="#cb9-34"></a></span>
<span id="cb9-35"><a href="#cb9-35"></a><span class="co">##beetle vs flower</span></span>
<span id="cb9-36"><a href="#cb9-36"></a>VS1.bf_d65.aim1&lt;-<span class="st"> </span>CvsUSM<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-37"><a href="#cb9-37"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb9-38"><a href="#cb9-38"></a>VS1.bf_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-39"><a href="#cb9-39"></a>VS2.bf_d65.aim1&lt;-CvsUML<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-40"><a href="#cb9-40"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb9-41"><a href="#cb9-41"></a>VS2.bf_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-42"><a href="#cb9-42"></a>VS3.bf_d65.aim1&lt;-CvsUSL<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-43"><a href="#cb9-43"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb9-44"><a href="#cb9-44"></a>VS3.bf_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-45"><a href="#cb9-45"></a>VS4.bf_d65.aim1&lt;-CvsUSML<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-46"><a href="#cb9-46"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb9-47"><a href="#cb9-47"></a>VS4.bf_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-48"><a href="#cb9-48"></a>allvis.bf_d65.aim1&lt;-VS1.bf_d65.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bf_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bf_d65.aim1)<span class="op">%&gt;%</span></span>
<span id="cb9-49"><a href="#cb9-49"></a><span class="st">  </span><span class="kw">rbind</span>(VS4.bf_d65.aim1)</span>
<span id="cb9-50"><a href="#cb9-50"></a></span>
<span id="cb9-51"><a href="#cb9-51"></a><span class="co">#Twiligth - aim 1</span></span>
<span id="cb9-52"><a href="#cb9-52"></a><span class="co">##flower vs leaf</span></span>
<span id="cb9-53"><a href="#cb9-53"></a>VS1.fl_twilight.aim1&lt;-<span class="st"> </span>CvsUSM_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-54"><a href="#cb9-54"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-55"><a href="#cb9-55"></a>VS1.fl_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-56"><a href="#cb9-56"></a>VS2.fl_twilight.aim1&lt;-CvsUML_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-57"><a href="#cb9-57"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-58"><a href="#cb9-58"></a>VS2.fl_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-59"><a href="#cb9-59"></a>VS3.fl_twilight.aim1&lt;-CvsUSL_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-60"><a href="#cb9-60"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-61"><a href="#cb9-61"></a>VS3.fl_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-62"><a href="#cb9-62"></a>VS4.fl_twilight.aim1&lt;-CvsUSML_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-63"><a href="#cb9-63"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-64"><a href="#cb9-64"></a>VS4.fl_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-65"><a href="#cb9-65"></a>allvis.fl_twilight.aim1&lt;-VS1.fl_twilight.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.fl_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.fl_twilight.aim1) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS4.fl_twilight.aim1)</span>
<span id="cb9-66"><a href="#cb9-66"></a></span>
<span id="cb9-67"><a href="#cb9-67"></a><span class="co">##beetle vs leaf</span></span>
<span id="cb9-68"><a href="#cb9-68"></a>VS1.bl_twilight.aim1&lt;-<span class="st"> </span>CvsUSM_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-69"><a href="#cb9-69"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-70"><a href="#cb9-70"></a>VS1.bl_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-71"><a href="#cb9-71"></a>VS2.bl_twilight.aim1&lt;-CvsUML_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-72"><a href="#cb9-72"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-73"><a href="#cb9-73"></a>VS2.bl_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-74"><a href="#cb9-74"></a>VS3.bl_twilight.aim1&lt;-CvsUSL_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-75"><a href="#cb9-75"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-76"><a href="#cb9-76"></a>VS3.bl_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-77"><a href="#cb9-77"></a>VS4.bl_twilight.aim1&lt;-CvsUSML_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-78"><a href="#cb9-78"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-79"><a href="#cb9-79"></a>VS4.bl_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-80"><a href="#cb9-80"></a>allvis.bl_twilight.aim1&lt;-VS1.bl_twilight.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bl_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bl_twilight.aim1) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS4.bl_twilight.aim1)</span>
<span id="cb9-81"><a href="#cb9-81"></a></span>
<span id="cb9-82"><a href="#cb9-82"></a></span>
<span id="cb9-83"><a href="#cb9-83"></a><span class="co">##beetle vs flower</span></span>
<span id="cb9-84"><a href="#cb9-84"></a>VS1.bf_twilight.aim1&lt;-<span class="st"> </span>CvsUSM_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-85"><a href="#cb9-85"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb9-86"><a href="#cb9-86"></a>VS1.bf_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-87"><a href="#cb9-87"></a>VS2.bf_twilight.aim1&lt;-CvsUML_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-88"><a href="#cb9-88"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb9-89"><a href="#cb9-89"></a>VS2.bf_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-90"><a href="#cb9-90"></a>VS3.bf_twilight.aim1&lt;-CvsUSL_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-91"><a href="#cb9-91"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb9-92"><a href="#cb9-92"></a>VS3.bf_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-93"><a href="#cb9-93"></a>VS4.bf_twilight.aim1&lt;-CvsUSML_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-94"><a href="#cb9-94"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb9-95"><a href="#cb9-95"></a>VS4.bf_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-96"><a href="#cb9-96"></a>allvis.bf_twilight.aim1&lt;-VS1.bf_twilight.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bf_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bf_twilight.aim1) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS4.bf_twilight.aim1)</span>
<span id="cb9-97"><a href="#cb9-97"></a></span>
<span id="cb9-98"><a href="#cb9-98"></a></span>
<span id="cb9-99"><a href="#cb9-99"></a></span>
<span id="cb9-100"><a href="#cb9-100"></a><span class="co">#Daylight - aim 2</span></span>
<span id="cb9-101"><a href="#cb9-101"></a><span class="co">##flower vs leaf</span></span>
<span id="cb9-102"><a href="#cb9-102"></a>VS1.fl_d65.aim2&lt;-<span class="st"> </span>Cbuprest580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-103"><a href="#cb9-103"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-104"><a href="#cb9-104"></a>VS1.fl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-105"><a href="#cb9-105"></a>VS2.fl_d65.aim2&lt;-Cbuprest600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-106"><a href="#cb9-106"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-107"><a href="#cb9-107"></a>VS2.fl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-108"><a href="#cb9-108"></a>VS3.fl_d65.aim2&lt;-Cbuprest620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-109"><a href="#cb9-109"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-110"><a href="#cb9-110"></a>VS3.fl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-111"><a href="#cb9-111"></a>VS4.fl_d65.aim2&lt;-Cbuprest640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-112"><a href="#cb9-112"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-113"><a href="#cb9-113"></a>VS4.fl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-114"><a href="#cb9-114"></a>VS5.fl_d65.aim2&lt;-Cbuprest660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-115"><a href="#cb9-115"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-116"><a href="#cb9-116"></a>VS5.fl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-117"><a href="#cb9-117"></a></span>
<span id="cb9-118"><a href="#cb9-118"></a>allvis.fl_d65.aim2&lt;-VS1.fl_d65.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.fl_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.fl_d65.aim2) <span class="op">%&gt;%</span></span>
<span id="cb9-119"><a href="#cb9-119"></a><span class="st">  </span><span class="kw">rbind</span>(VS4.fl_d65.aim2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS5.fl_d65.aim2)</span>
<span id="cb9-120"><a href="#cb9-120"></a></span>
<span id="cb9-121"><a href="#cb9-121"></a><span class="co">##beetle vs leaf</span></span>
<span id="cb9-122"><a href="#cb9-122"></a>VS1.bl_d65.aim2&lt;-<span class="st"> </span>Cbuprest580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-123"><a href="#cb9-123"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-124"><a href="#cb9-124"></a>VS1.bl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-125"><a href="#cb9-125"></a>VS2.bl_d65.aim2&lt;-Cbuprest600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-126"><a href="#cb9-126"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-127"><a href="#cb9-127"></a>VS2.bl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-128"><a href="#cb9-128"></a>VS3.bl_d65.aim2&lt;-Cbuprest620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-129"><a href="#cb9-129"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-130"><a href="#cb9-130"></a>VS3.bl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-131"><a href="#cb9-131"></a>VS4.bl_d65.aim2&lt;-Cbuprest640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-132"><a href="#cb9-132"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-133"><a href="#cb9-133"></a>VS4.bl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-134"><a href="#cb9-134"></a>VS5.bl_d65.aim2&lt;-Cbuprest660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-135"><a href="#cb9-135"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-136"><a href="#cb9-136"></a>VS5.bl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-137"><a href="#cb9-137"></a></span>
<span id="cb9-138"><a href="#cb9-138"></a>allvis.bl_d65.aim2&lt;-VS1.bl_d65.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bl_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bl_d65.aim2) <span class="op">%&gt;%</span></span>
<span id="cb9-139"><a href="#cb9-139"></a><span class="st">  </span><span class="kw">rbind</span>(VS4.bl_d65.aim2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS5.bl_d65.aim2) </span>
<span id="cb9-140"><a href="#cb9-140"></a></span>
<span id="cb9-141"><a href="#cb9-141"></a></span>
<span id="cb9-142"><a href="#cb9-142"></a><span class="co">##beetle vs flower</span></span>
<span id="cb9-143"><a href="#cb9-143"></a>VS1.bf_d65.aim2&lt;-<span class="st"> </span>Cbuprest580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-144"><a href="#cb9-144"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb9-145"><a href="#cb9-145"></a>VS1.bf_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-146"><a href="#cb9-146"></a>VS2.bf_d65.aim2&lt;-Cbuprest600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-147"><a href="#cb9-147"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb9-148"><a href="#cb9-148"></a>VS2.bf_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-149"><a href="#cb9-149"></a>VS3.bf_d65.aim2&lt;-Cbuprest620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-150"><a href="#cb9-150"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb9-151"><a href="#cb9-151"></a>VS3.bf_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-152"><a href="#cb9-152"></a>VS4.bf_d65.aim2&lt;-Cbuprest640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-153"><a href="#cb9-153"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb9-154"><a href="#cb9-154"></a>VS4.bf_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-155"><a href="#cb9-155"></a>VS5.bf_d65.aim2&lt;-Cbuprest660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-156"><a href="#cb9-156"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb9-157"><a href="#cb9-157"></a>VS5.bf_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-158"><a href="#cb9-158"></a></span>
<span id="cb9-159"><a href="#cb9-159"></a>allvis.bf_d65.aim2&lt;-VS1.bf_d65.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bf_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bf_d65.aim2) <span class="op">%&gt;%</span></span>
<span id="cb9-160"><a href="#cb9-160"></a><span class="st">  </span><span class="kw">rbind</span>(VS4.bf_d65.aim2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS5.bf_d65.aim2) </span>
<span id="cb9-161"><a href="#cb9-161"></a></span>
<span id="cb9-162"><a href="#cb9-162"></a><span class="co">##Twilight - aim 2</span></span>
<span id="cb9-163"><a href="#cb9-163"></a><span class="co">##flower vs leaf</span></span>
<span id="cb9-164"><a href="#cb9-164"></a>VS1.fl_twilight.aim2&lt;-<span class="st"> </span>Cbuprest580_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-165"><a href="#cb9-165"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-166"><a href="#cb9-166"></a>VS1.fl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-167"><a href="#cb9-167"></a>VS2.fl_twilight.aim2&lt;-Cbuprest600_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-168"><a href="#cb9-168"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-169"><a href="#cb9-169"></a>VS2.fl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-170"><a href="#cb9-170"></a>VS3.fl_twilight.aim2&lt;-Cbuprest620_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-171"><a href="#cb9-171"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-172"><a href="#cb9-172"></a>VS3.fl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-173"><a href="#cb9-173"></a>VS4.fl_twilight.aim2&lt;-Cbuprest640_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-174"><a href="#cb9-174"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-175"><a href="#cb9-175"></a>VS4.fl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-176"><a href="#cb9-176"></a>VS5.fl_twilight.aim2&lt;-Cbuprest660_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-177"><a href="#cb9-177"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-178"><a href="#cb9-178"></a>VS5.fl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-179"><a href="#cb9-179"></a></span>
<span id="cb9-180"><a href="#cb9-180"></a>allvis.fl_twilight.aim2&lt;-VS1.fl_twilight.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.fl_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.fl_twilight.aim2) <span class="op">%&gt;%</span></span>
<span id="cb9-181"><a href="#cb9-181"></a><span class="st">  </span><span class="kw">rbind</span>(VS4.fl_twilight.aim2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS5.fl_twilight.aim2)</span>
<span id="cb9-182"><a href="#cb9-182"></a></span>
<span id="cb9-183"><a href="#cb9-183"></a><span class="co">##beetle vs leaf</span></span>
<span id="cb9-184"><a href="#cb9-184"></a>VS1.bl_twilight.aim2&lt;-<span class="st"> </span>Cbuprest580_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-185"><a href="#cb9-185"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-186"><a href="#cb9-186"></a>VS1.bl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-187"><a href="#cb9-187"></a>VS2.bl_twilight.aim2&lt;-Cbuprest600_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-188"><a href="#cb9-188"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-189"><a href="#cb9-189"></a>VS2.bl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-190"><a href="#cb9-190"></a>VS3.bl_twilight.aim2&lt;-Cbuprest620_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-191"><a href="#cb9-191"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-192"><a href="#cb9-192"></a>VS3.bl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-193"><a href="#cb9-193"></a>VS4.bl_twilight.aim2&lt;-Cbuprest640_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-194"><a href="#cb9-194"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-195"><a href="#cb9-195"></a>VS4.bl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-196"><a href="#cb9-196"></a>VS5.bl_twilight.aim2&lt;-Cbuprest660_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-197"><a href="#cb9-197"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb9-198"><a href="#cb9-198"></a>VS5.bl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-199"><a href="#cb9-199"></a></span>
<span id="cb9-200"><a href="#cb9-200"></a>allvis.bl_twilight.aim2&lt;-VS1.bl_twilight.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bl_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bl_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS4.bl_twilight.aim2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS5.bl_twilight.aim2)</span>
<span id="cb9-201"><a href="#cb9-201"></a></span>
<span id="cb9-202"><a href="#cb9-202"></a><span class="co">##beetle vs flower</span></span>
<span id="cb9-203"><a href="#cb9-203"></a>VS1.bf_twilight.aim2&lt;-<span class="st"> </span>Cbuprest580_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-204"><a href="#cb9-204"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb9-205"><a href="#cb9-205"></a>VS1.bf_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-206"><a href="#cb9-206"></a>VS2.bf_twilight.aim2&lt;-Cbuprest600_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-207"><a href="#cb9-207"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb9-208"><a href="#cb9-208"></a>VS2.bf_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-209"><a href="#cb9-209"></a>VS3.bf_twilight.aim2&lt;-Cbuprest620_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-210"><a href="#cb9-210"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb9-211"><a href="#cb9-211"></a>VS3.bf_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-212"><a href="#cb9-212"></a>VS4.bf_twilight.aim2&lt;-Cbuprest640_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-213"><a href="#cb9-213"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb9-214"><a href="#cb9-214"></a>VS4.bf_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-215"><a href="#cb9-215"></a>VS5.bf_twilight.aim2&lt;-Cbuprest660_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-216"><a href="#cb9-216"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb9-217"><a href="#cb9-217"></a>VS5.bf_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb9-218"><a href="#cb9-218"></a></span>
<span id="cb9-219"><a href="#cb9-219"></a>allvis.bf_twilight.aim2&lt;-VS1.bf_twilight.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bf_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bf_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS4.bf_twilight.aim2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS5.bf_twilight.aim2)</span></code></pre></div>
<div id="aim-1" class="section level3 tabset tabset-fade tabset-pills">
<h3>Aim 1</h3>
<p>The table shows the mean contrast in each comparison group</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">#Aim 1</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>system.list.aim1&lt;-<span class="st"> </span><span class="kw">rbind.data.frame</span>(<span class="st">&quot;USM&quot;</span>, <span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>,  <span class="st">&quot;USML&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">system =</span> <span class="dv">1</span>) <span class="co"># make a list of system names</span></span></code></pre></div>
<div id="daylight" class="section level4">
<h4>Daylight</h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">#Daylight</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">##list contrast from each comparison group</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>fl.contrast_d65.aim1 &lt;-<span class="st"> </span><span class="kw">rbind.data.frame</span>(<span class="kw">mean</span>(VS1.fl_d65.aim1<span class="op">$</span>dS),<span class="kw">mean</span>(VS2.fl_d65.aim1<span class="op">$</span>dS),<span class="kw">mean</span>(VS3.fl_d65.aim1<span class="op">$</span>dS),<span class="kw">mean</span>(VS4.fl_d65.aim1<span class="op">$</span>dS))</span>
<span id="cb11-4"><a href="#cb11-4"></a>bl.contrast_d65.aim1 &lt;-<span class="kw">rbind.data.frame</span>(<span class="kw">mean</span>(VS1.bl_d65.aim1<span class="op">$</span>dS),<span class="kw">mean</span>(VS2.bl_d65.aim1<span class="op">$</span>dS),<span class="kw">mean</span>(VS3.bl_d65.aim1<span class="op">$</span>dS),<span class="kw">mean</span>(VS4.bl_d65.aim1<span class="op">$</span>dS))</span>
<span id="cb11-5"><a href="#cb11-5"></a>bf.contrast_d65.aim1 &lt;-<span class="kw">rbind.data.frame</span>(<span class="kw">mean</span>(VS1.bf_d65.aim1<span class="op">$</span>dS), <span class="kw">mean</span>(VS2.bf_d65.aim1<span class="op">$</span>dS),<span class="kw">mean</span>(VS3.bf_d65.aim1<span class="op">$</span>dS),<span class="kw">mean</span>(VS4.bf_d65.aim1<span class="op">$</span>dS))</span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">#combind comparison groups together in a table</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>contrast.list_d65.aim1&lt;-<span class="st"> </span>system.list.aim1 <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">cbind</span>(fl.contrast_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(bl.contrast_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(bf.contrast_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>() </span>
<span id="cb11-8"><a href="#cb11-8"></a>contrast.list_d65.aim1</span></code></pre></div>
<table style="width:86%;">
<colgroup>
<col width="12%" />
<col width="23%" />
<col width="23%" />
<col width="26%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">system</th>
<th align="center">flower.vs.leaf</th>
<th align="center">beetle.vs.leaf</th>
<th align="center">beetle.vs.flower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">USM</td>
<td align="center">5.866</td>
<td align="center">3.87</td>
<td align="center">6.203</td>
</tr>
<tr class="even">
<td align="center">UML</td>
<td align="center">6.009</td>
<td align="center">5</td>
<td align="center">6.194</td>
</tr>
<tr class="odd">
<td align="center">USL</td>
<td align="center">6.348</td>
<td align="center">5.012</td>
<td align="center">6.832</td>
</tr>
<tr class="even">
<td align="center">USML</td>
<td align="center">6.212</td>
<td align="center">4.985</td>
<td align="center">6.682</td>
</tr>
</tbody>
</table>
</div>
<div id="twilight" class="section level4">
<h4>Twilight</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">#Twilight</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co">##list contrast from each comparison group</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>fl.contrast_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">rbind.data.frame</span>(<span class="kw">mean</span>(VS1.fl_twilight.aim1<span class="op">$</span>dS), <span class="kw">mean</span>(VS2.fl_twilight.aim1<span class="op">$</span>dS),<span class="kw">mean</span>(VS3.fl_twilight.aim1<span class="op">$</span>dS),<span class="kw">mean</span>(VS4.fl_twilight.aim1<span class="op">$</span>dS))</span>
<span id="cb12-4"><a href="#cb12-4"></a>bl.contrast_twilight.aim1 &lt;-<span class="kw">rbind.data.frame</span>(<span class="kw">mean</span>(VS1.bl_twilight.aim1<span class="op">$</span>dS),<span class="kw">mean</span>(VS2.bl_twilight.aim1<span class="op">$</span>dS),<span class="kw">mean</span>(VS3.bl_twilight.aim1<span class="op">$</span>dS),<span class="kw">mean</span>(VS4.bl_twilight.aim1<span class="op">$</span>dS))</span>
<span id="cb12-5"><a href="#cb12-5"></a>bf.contrast_twilight.aim1 &lt;-<span class="kw">rbind.data.frame</span>(<span class="kw">mean</span>(VS1.bf_twilight.aim1<span class="op">$</span>dS), <span class="kw">mean</span>(VS2.bf_twilight.aim1<span class="op">$</span>dS),<span class="kw">mean</span>(VS3.bf_twilight.aim1<span class="op">$</span>dS),<span class="kw">mean</span>(VS4.bf_twilight.aim1<span class="op">$</span>dS))</span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">#combind comparison groups together in a table</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>contrast.list_twilight.aim1&lt;-<span class="st"> </span>system.list.aim1 <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">cbind</span>(fl.contrast_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(bl.contrast_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(bf.contrast_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span>
<span id="cb12-8"><a href="#cb12-8"></a>contrast.list_twilight.aim1</span></code></pre></div>
<table style="width:86%;">
<colgroup>
<col width="12%" />
<col width="23%" />
<col width="23%" />
<col width="26%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">system</th>
<th align="center">flower.vs.leaf</th>
<th align="center">beetle.vs.leaf</th>
<th align="center">beetle.vs.flower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">USM</td>
<td align="center">0.7393</td>
<td align="center">0.3659</td>
<td align="center">0.7503</td>
</tr>
<tr class="even">
<td align="center">UML</td>
<td align="center">0.8335</td>
<td align="center">0.5485</td>
<td align="center">0.826</td>
</tr>
<tr class="odd">
<td align="center">USL</td>
<td align="center">0.8677</td>
<td align="center">0.541</td>
<td align="center">0.9076</td>
</tr>
<tr class="even">
<td align="center">USML</td>
<td align="center">0.9649</td>
<td align="center">0.6184</td>
<td align="center">1.017</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="aim-2" class="section level3 tabset tabset-fade tabset-pills">
<h3>Aim 2</h3>
<p>The table shows the mean contrast in each comparison group</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>system.list.aim2&lt;-<span class="st"> </span><span class="kw">rbind.data.frame</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>, <span class="st">&quot;VS 640&quot;</span>, <span class="st">&quot;VS 660&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">system =</span> <span class="dv">1</span>) <span class="co"># make a list of system names</span></span></code></pre></div>
<div id="daylight-1" class="section level4">
<h4>Daylight</h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co">#Daylight</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co">##list contrast from each comparison group</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>fl.contrast_d65.aim2 &lt;-<span class="st"> </span><span class="kw">rbind.data.frame</span>(<span class="kw">mean</span>(VS1.fl_d65.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS2.fl_d65.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS3.fl_d65.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS4.fl_d65.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS5.fl_d65.aim2<span class="op">$</span>dS))</span>
<span id="cb14-4"><a href="#cb14-4"></a>bl.contrast_d65.aim2 &lt;-<span class="kw">rbind.data.frame</span>(<span class="kw">mean</span>(VS1.bl_d65.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS2.bl_d65.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS3.bl_d65.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS4.bl_d65.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS5.bl_d65.aim2<span class="op">$</span>dS))</span>
<span id="cb14-5"><a href="#cb14-5"></a>bf.contrast_d65.aim2 &lt;-<span class="kw">rbind.data.frame</span>(<span class="kw">mean</span>(VS1.bf_d65.aim2<span class="op">$</span>dS), <span class="kw">mean</span>(VS2.bf_d65.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS3.bf_d65.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS4.bf_d65.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS5.bf_d65.aim2<span class="op">$</span>dS))</span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">#combind comparison groups together in a table</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>contrast.list_d65.aim2&lt;-<span class="st"> </span>system.list.aim2 <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">cbind</span>(fl.contrast_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(bl.contrast_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(bf.contrast_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>() </span>
<span id="cb14-8"><a href="#cb14-8"></a>contrast.list_d65.aim2</span></code></pre></div>
<table style="width:86%;">
<colgroup>
<col width="12%" />
<col width="23%" />
<col width="23%" />
<col width="26%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">system</th>
<th align="center">flower.vs.leaf</th>
<th align="center">beetle.vs.leaf</th>
<th align="center">beetle.vs.flower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">VS 580</td>
<td align="center">5.791</td>
<td align="center">4.412</td>
<td align="center">6.302</td>
</tr>
<tr class="even">
<td align="center">VS 600</td>
<td align="center">6.212</td>
<td align="center">4.985</td>
<td align="center">6.682</td>
</tr>
<tr class="odd">
<td align="center">VS 620</td>
<td align="center">6.966</td>
<td align="center">5.636</td>
<td align="center">7.147</td>
</tr>
<tr class="even">
<td align="center">VS 640</td>
<td align="center">7.595</td>
<td align="center">6.137</td>
<td align="center">7.529</td>
</tr>
<tr class="odd">
<td align="center">VS 660</td>
<td align="center">7.553</td>
<td align="center">6.346</td>
<td align="center">7.815</td>
</tr>
</tbody>
</table>
</div>
<div id="twilight-1" class="section level4">
<h4>Twilight</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co">#Twilight</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co">##list contrast from each comparison group</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>fl.contrast_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">rbind.data.frame</span>(<span class="kw">mean</span>(VS1.fl_twilight.aim2<span class="op">$</span>dS), <span class="kw">mean</span>(VS2.fl_twilight.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS3.fl_twilight.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS4.fl_twilight.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS5.fl_twilight.aim2<span class="op">$</span>dS))</span>
<span id="cb15-4"><a href="#cb15-4"></a>bl.contrast_twilight.aim2 &lt;-<span class="kw">rbind.data.frame</span>(<span class="kw">mean</span>(VS1.bl_twilight.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS2.bl_twilight.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS3.bl_twilight.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS4.bl_twilight.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS5.bl_twilight.aim2<span class="op">$</span>dS))</span>
<span id="cb15-5"><a href="#cb15-5"></a>bf.contrast_twilight.aim2 &lt;-<span class="kw">rbind.data.frame</span>(<span class="kw">mean</span>(VS1.bf_twilight.aim2<span class="op">$</span>dS), <span class="kw">mean</span>(VS2.bf_twilight.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS3.bf_twilight.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS4.bf_twilight.aim2<span class="op">$</span>dS),<span class="kw">mean</span>(VS5.bf_twilight.aim2<span class="op">$</span>dS))</span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">#combind comparison groups together in a table</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>contrast.list_twilight.aim2&lt;-<span class="st"> </span>system.list.aim2 <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">cbind</span>(fl.contrast_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(bl.contrast_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(bf.contrast_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>() </span>
<span id="cb15-8"><a href="#cb15-8"></a>contrast.list_twilight.aim2</span></code></pre></div>
<table style="width:86%;">
<colgroup>
<col width="12%" />
<col width="23%" />
<col width="23%" />
<col width="26%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">system</th>
<th align="center">flower.vs.leaf</th>
<th align="center">beetle.vs.leaf</th>
<th align="center">beetle.vs.flower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">VS 580</td>
<td align="center">0.8695</td>
<td align="center">0.5215</td>
<td align="center">0.9219</td>
</tr>
<tr class="even">
<td align="center">VS 600</td>
<td align="center">0.9649</td>
<td align="center">0.6184</td>
<td align="center">1.017</td>
</tr>
<tr class="odd">
<td align="center">VS 620</td>
<td align="center">1.107</td>
<td align="center">0.7161</td>
<td align="center">1.12</td>
</tr>
<tr class="even">
<td align="center">VS 640</td>
<td align="center">1.192</td>
<td align="center">0.776</td>
<td align="center">1.19</td>
</tr>
<tr class="odd">
<td align="center">VS 660</td>
<td align="center">1.129</td>
<td align="center">0.7739</td>
<td align="center">1.218</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
</div>
</div>
</div>
</div>
<div id="compare-contrasts" class="section level1">
<h1>Compare contrasts</h1>
<ul>
<li><p>To compare contrasts between visual systems, We conducted Wald chi-square tests on generalised linear mixed models (GLMM) followed by posthoc tests.</p></li>
<li><p>In the models, we assigned</p>
<ul>
<li>Independent variable: <strong>contrast</strong></li>
<li>Dependent variable:
<ul>
<li>Fixed factor: <strong>visual system</strong></li>
<li>Random factor: <strong>sample ID</strong> of both targets in the comparison</li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co">#create different comparison groups for furthur GLMM analysis</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="co">#Organize data before GLMM</span></span>
<span id="cb16-3"><a href="#cb16-3"></a></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">#D65 - aim 1</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">##flower vs leaf</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>CvsUSM.flower.vs.leaf=</span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="st">  </span>CvsUSM <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb16-8"><a href="#cb16-8"></a>CvsUML.flower.vs.leaf=</span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="st">  </span>CvsUML <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb16-10"><a href="#cb16-10"></a>CvsUSL.flower.vs.leaf=</span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="st">  </span>CvsUSL <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb16-12"><a href="#cb16-12"></a>CvsUSML.flower.vs.leaf=</span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="st">  </span>CvsUSML <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb16-14"><a href="#cb16-14"></a></span>
<span id="cb16-15"><a href="#cb16-15"></a>C.flower.vs.leaf.aim1=</span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="st">  </span>CvsUSM.flower.vs.leaf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvsUML.flower.vs.leaf) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-17"><a href="#cb16-17"></a><span class="st">  </span><span class="kw">rbind</span>(CvsUSL.flower.vs.leaf)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvsUSML.flower.vs.leaf)</span>
<span id="cb16-18"><a href="#cb16-18"></a></span>
<span id="cb16-19"><a href="#cb16-19"></a>contrast.UVSWMW...flower.vs.leaf&lt;-CvsUSM.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb16-20"><a href="#cb16-20"></a>contrast.UV..MWLW.flower.vs.leaf&lt;-CvsUML.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb16-21"><a href="#cb16-21"></a>contrast.UVSW..LW.flower.vs.leaf&lt;-CvsUSL.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb16-22"><a href="#cb16-22"></a>contrast.UVSWMWLW.flower.vs.leaf&lt;-CvsUSML.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb16-23"><a href="#cb16-23"></a></span>
<span id="cb16-24"><a href="#cb16-24"></a>com.contrast.flower.vs.leaf.aim1&lt;-<span class="kw">cbind</span>(CvsUSM.flower.vs.leaf[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],contrast.UVSWMW...flower.vs.leaf,contrast.UV..MWLW.flower.vs.leaf,contrast.UVSW..LW.flower.vs.leaf,contrast.UVSWMWLW.flower.vs.leaf)</span>
<span id="cb16-25"><a href="#cb16-25"></a>compare.flower.vs.leaf.aim1 &lt;-<span class="st"> </span>com.contrast.flower.vs.leaf.aim1 <span class="op">%&gt;%</span></span>
<span id="cb16-26"><a href="#cb16-26"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.flower.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb16-27"><a href="#cb16-27"></a></span>
<span id="cb16-28"><a href="#cb16-28"></a><span class="co">##beetle vs leaf</span></span>
<span id="cb16-29"><a href="#cb16-29"></a>CvsUSM.beetle.vs.leaf=</span>
<span id="cb16-30"><a href="#cb16-30"></a><span class="st">  </span>CvsUSM <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-31"><a href="#cb16-31"></a>CvsUML.beetle.vs.leaf=</span>
<span id="cb16-32"><a href="#cb16-32"></a><span class="st">  </span>CvsUML <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-33"><a href="#cb16-33"></a>CvsUSL.beetle.vs.leaf=</span>
<span id="cb16-34"><a href="#cb16-34"></a><span class="st">  </span>CvsUSL <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-35"><a href="#cb16-35"></a>CvsUSML.beetle.vs.leaf=</span>
<span id="cb16-36"><a href="#cb16-36"></a><span class="st">  </span>CvsUSML <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-37"><a href="#cb16-37"></a></span>
<span id="cb16-38"><a href="#cb16-38"></a>C.beetle.vs.leaf.aim1=</span>
<span id="cb16-39"><a href="#cb16-39"></a><span class="st">  </span>CvsUSM.beetle.vs.leaf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvsUML.beetle.vs.leaf) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-40"><a href="#cb16-40"></a><span class="st">  </span><span class="kw">rbind</span>(CvsUSL.beetle.vs.leaf)<span class="op">%&gt;%</span><span class="st">  </span><span class="kw">rbind</span>(CvsUSML.beetle.vs.leaf)</span>
<span id="cb16-41"><a href="#cb16-41"></a></span>
<span id="cb16-42"><a href="#cb16-42"></a>contrast.UVSWMW...beetle.vs.leaf&lt;-CvsUSM.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb16-43"><a href="#cb16-43"></a>contrast.UV..MWLW.beetle.vs.leaf&lt;-CvsUML.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb16-44"><a href="#cb16-44"></a>contrast.UVSW..LW.beetle.vs.leaf&lt;-CvsUSL.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb16-45"><a href="#cb16-45"></a>contrast.UVSWMWLW.beetle.vs.leaf&lt;-CvsUSML.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb16-46"><a href="#cb16-46"></a></span>
<span id="cb16-47"><a href="#cb16-47"></a>com.contrast.beetle.vs.leaf.aim1&lt;-<span class="kw">cbind</span>(CvsUSM.beetle.vs.leaf[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],contrast.UVSWMW...beetle.vs.leaf,contrast.UV..MWLW.beetle.vs.leaf,contrast.UVSW..LW.beetle.vs.leaf,contrast.UVSWMWLW.beetle.vs.leaf)</span>
<span id="cb16-48"><a href="#cb16-48"></a>compare.beetle.vs.leaf.aim1 &lt;-<span class="st"> </span>com.contrast.beetle.vs.leaf.aim1 <span class="op">%&gt;%</span></span>
<span id="cb16-49"><a href="#cb16-49"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb16-50"><a href="#cb16-50"></a></span>
<span id="cb16-51"><a href="#cb16-51"></a><span class="co">##beetle vs flower</span></span>
<span id="cb16-52"><a href="#cb16-52"></a>CvsUSM.beetle.vs.flower=</span>
<span id="cb16-53"><a href="#cb16-53"></a><span class="st">  </span>CvsUSM <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-54"><a href="#cb16-54"></a>CvsUML.beetle.vs.flower=</span>
<span id="cb16-55"><a href="#cb16-55"></a><span class="st">  </span>CvsUML <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-56"><a href="#cb16-56"></a>CvsUSL.beetle.vs.flower=</span>
<span id="cb16-57"><a href="#cb16-57"></a><span class="st">  </span>CvsUSL <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-58"><a href="#cb16-58"></a>CvsUSML.beetle.vs.flower=</span>
<span id="cb16-59"><a href="#cb16-59"></a><span class="st">  </span>CvsUSML <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-60"><a href="#cb16-60"></a></span>
<span id="cb16-61"><a href="#cb16-61"></a>C.beetle.vs.flower.aim1=</span>
<span id="cb16-62"><a href="#cb16-62"></a><span class="st">  </span>CvsUSM.beetle.vs.flower <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvsUML.beetle.vs.flower) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-63"><a href="#cb16-63"></a><span class="st">  </span><span class="kw">rbind</span>(CvsUSL.beetle.vs.flower) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">rbind</span>(CvsUSML.beetle.vs.flower)</span>
<span id="cb16-64"><a href="#cb16-64"></a></span>
<span id="cb16-65"><a href="#cb16-65"></a>contrast.UVSWMW...beetle.vs.flower&lt;-CvsUSM.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb16-66"><a href="#cb16-66"></a>contrast.UV..MWLW.beetle.vs.flower&lt;-CvsUML.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb16-67"><a href="#cb16-67"></a>contrast.UVSW..LW.beetle.vs.flower&lt;-CvsUSL.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb16-68"><a href="#cb16-68"></a>contrast.UVSWMWLW.beetle.vs.flower&lt;-CvsUSML.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb16-69"><a href="#cb16-69"></a></span>
<span id="cb16-70"><a href="#cb16-70"></a>com.contrast.beetle.vs.flower.aim1&lt;-<span class="kw">cbind</span>(CvsUSM.beetle.vs.flower[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],contrast.UVSWMW...beetle.vs.flower,contrast.UV..MWLW.beetle.vs.flower,contrast.UVSW..LW.beetle.vs.flower,contrast.UVSWMWLW.beetle.vs.flower)</span>
<span id="cb16-71"><a href="#cb16-71"></a>compare.beetle.vs.flower.aim1 &lt;-<span class="st"> </span>com.contrast.beetle.vs.flower.aim1 <span class="op">%&gt;%</span></span>
<span id="cb16-72"><a href="#cb16-72"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.flower&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb16-73"><a href="#cb16-73"></a></span>
<span id="cb16-74"><a href="#cb16-74"></a></span>
<span id="cb16-75"><a href="#cb16-75"></a></span>
<span id="cb16-76"><a href="#cb16-76"></a><span class="co">#D65 - Aim 2</span></span>
<span id="cb16-77"><a href="#cb16-77"></a><span class="co">##flower vs leaf</span></span>
<span id="cb16-78"><a href="#cb16-78"></a>Cbuprest580.flower.vs.leaf=</span>
<span id="cb16-79"><a href="#cb16-79"></a><span class="st">  </span>Cbuprest580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb16-80"><a href="#cb16-80"></a>Cbuprest600.flower.vs.leaf=</span>
<span id="cb16-81"><a href="#cb16-81"></a><span class="st">  </span>Cbuprest600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb16-82"><a href="#cb16-82"></a>Cbuprest620.flower.vs.leaf=</span>
<span id="cb16-83"><a href="#cb16-83"></a><span class="st">  </span>Cbuprest620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb16-84"><a href="#cb16-84"></a>Cbuprest640.flower.vs.leaf=</span>
<span id="cb16-85"><a href="#cb16-85"></a><span class="st">  </span>Cbuprest640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb16-86"><a href="#cb16-86"></a>Cbuprest660.flower.vs.leaf=</span>
<span id="cb16-87"><a href="#cb16-87"></a><span class="st">  </span>Cbuprest660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb16-88"><a href="#cb16-88"></a></span>
<span id="cb16-89"><a href="#cb16-89"></a>Cbuprest.flower.vs.leaf.aim2=</span>
<span id="cb16-90"><a href="#cb16-90"></a><span class="st">  </span>Cbuprest580.flower.vs.leaf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.flower.vs.leaf) <span class="op">%&gt;%</span></span>
<span id="cb16-91"><a href="#cb16-91"></a><span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.flower.vs.leaf)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.flower.vs.leaf) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest660.flower.vs.leaf) </span>
<span id="cb16-92"><a href="#cb16-92"></a></span>
<span id="cb16-93"><a href="#cb16-93"></a>bup580.flower.vs.leaf&lt;-Cbuprest580.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb16-94"><a href="#cb16-94"></a>bup600.flower.vs.leaf&lt;-Cbuprest600.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb16-95"><a href="#cb16-95"></a>bup620.flower.vs.leaf&lt;-Cbuprest620.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb16-96"><a href="#cb16-96"></a>bup640.flower.vs.leaf&lt;-Cbuprest640.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb16-97"><a href="#cb16-97"></a>bup660.flower.vs.leaf&lt;-Cbuprest660.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb16-98"><a href="#cb16-98"></a></span>
<span id="cb16-99"><a href="#cb16-99"></a>com.bupcontrast.flower.vs.leaf.aim2&lt;-<span class="kw">cbind</span>(Cbuprest.flower.vs.leaf.aim2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.flower.vs.leaf,bup600.flower.vs.leaf,bup620.flower.vs.leaf,bup640.flower.vs.leaf,bup660.flower.vs.leaf)</span>
<span id="cb16-100"><a href="#cb16-100"></a>compare.flower.vs.leaf.aim2 &lt;-<span class="st"> </span>com.bupcontrast.flower.vs.leaf.aim2 <span class="op">%&gt;%</span></span>
<span id="cb16-101"><a href="#cb16-101"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.flower.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)</span>
<span id="cb16-102"><a href="#cb16-102"></a></span>
<span id="cb16-103"><a href="#cb16-103"></a><span class="co">##beetle vs leaf</span></span>
<span id="cb16-104"><a href="#cb16-104"></a>Cbuprest580.beetle.vs.leaf=</span>
<span id="cb16-105"><a href="#cb16-105"></a><span class="st">  </span>Cbuprest580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-106"><a href="#cb16-106"></a>Cbuprest600.beetle.vs.leaf=</span>
<span id="cb16-107"><a href="#cb16-107"></a><span class="st">  </span>Cbuprest600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-108"><a href="#cb16-108"></a>Cbuprest620.beetle.vs.leaf=</span>
<span id="cb16-109"><a href="#cb16-109"></a><span class="st">  </span>Cbuprest620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-110"><a href="#cb16-110"></a>Cbuprest640.beetle.vs.leaf=</span>
<span id="cb16-111"><a href="#cb16-111"></a><span class="st">  </span>Cbuprest640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-112"><a href="#cb16-112"></a>Cbuprest660.beetle.vs.leaf=</span>
<span id="cb16-113"><a href="#cb16-113"></a><span class="st">  </span>Cbuprest660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-114"><a href="#cb16-114"></a></span>
<span id="cb16-115"><a href="#cb16-115"></a>Cbuprest.beetle.vs.leaf.aim2=</span>
<span id="cb16-116"><a href="#cb16-116"></a><span class="st">  </span>Cbuprest580.beetle.vs.leaf  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.beetle.vs.leaf)<span class="op">%&gt;%</span></span>
<span id="cb16-117"><a href="#cb16-117"></a><span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.beetle.vs.leaf)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.beetle.vs.leaf) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest660.beetle.vs.leaf)</span>
<span id="cb16-118"><a href="#cb16-118"></a></span>
<span id="cb16-119"><a href="#cb16-119"></a>bup580.beetle.vs.leaf&lt;-Cbuprest580.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb16-120"><a href="#cb16-120"></a>bup600.beetle.vs.leaf&lt;-Cbuprest600.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb16-121"><a href="#cb16-121"></a>bup620.beetle.vs.leaf&lt;-Cbuprest620.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb16-122"><a href="#cb16-122"></a>bup640.beetle.vs.leaf&lt;-Cbuprest640.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb16-123"><a href="#cb16-123"></a>bup660.beetle.vs.leaf&lt;-Cbuprest660.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb16-124"><a href="#cb16-124"></a></span>
<span id="cb16-125"><a href="#cb16-125"></a>com.bupcontrast.beetle.vs.leaf.aim2&lt;-<span class="kw">cbind</span>(Cbuprest.beetle.vs.leaf.aim2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.beetle.vs.leaf,bup600.beetle.vs.leaf,bup620.beetle.vs.leaf,bup640.beetle.vs.leaf,bup660.beetle.vs.leaf)</span>
<span id="cb16-126"><a href="#cb16-126"></a>compare.beetle.vs.leaf.aim2 &lt;-<span class="st"> </span>com.bupcontrast.beetle.vs.leaf.aim2 <span class="op">%&gt;%</span></span>
<span id="cb16-127"><a href="#cb16-127"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)</span>
<span id="cb16-128"><a href="#cb16-128"></a></span>
<span id="cb16-129"><a href="#cb16-129"></a><span class="co">##beetle vs flower</span></span>
<span id="cb16-130"><a href="#cb16-130"></a>Cbuprest580.beetle.vs.flower=</span>
<span id="cb16-131"><a href="#cb16-131"></a><span class="st">  </span>Cbuprest580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-132"><a href="#cb16-132"></a>Cbuprest600.beetle.vs.flower=</span>
<span id="cb16-133"><a href="#cb16-133"></a><span class="st">  </span>Cbuprest600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-134"><a href="#cb16-134"></a>Cbuprest620.beetle.vs.flower=</span>
<span id="cb16-135"><a href="#cb16-135"></a><span class="st">  </span>Cbuprest620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-136"><a href="#cb16-136"></a>Cbuprest640.beetle.vs.flower=</span>
<span id="cb16-137"><a href="#cb16-137"></a><span class="st">  </span>Cbuprest640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-138"><a href="#cb16-138"></a>Cbuprest660.beetle.vs.flower=</span>
<span id="cb16-139"><a href="#cb16-139"></a><span class="st">  </span>Cbuprest660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-140"><a href="#cb16-140"></a></span>
<span id="cb16-141"><a href="#cb16-141"></a>Cbuprest.beetle.vs.flower.aim2=</span>
<span id="cb16-142"><a href="#cb16-142"></a><span class="st">  </span>Cbuprest580.beetle.vs.flower <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.beetle.vs.flower) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-143"><a href="#cb16-143"></a><span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.beetle.vs.flower)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.beetle.vs.flower) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-144"><a href="#cb16-144"></a><span class="st">  </span><span class="kw">rbind</span>(Cbuprest660.beetle.vs.flower)</span>
<span id="cb16-145"><a href="#cb16-145"></a></span>
<span id="cb16-146"><a href="#cb16-146"></a>bup580.beetle.vs.flower&lt;-Cbuprest580.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb16-147"><a href="#cb16-147"></a>bup600.beetle.vs.flower&lt;-Cbuprest600.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb16-148"><a href="#cb16-148"></a>bup620.beetle.vs.flower&lt;-Cbuprest620.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb16-149"><a href="#cb16-149"></a>bup640.beetle.vs.flower&lt;-Cbuprest640.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb16-150"><a href="#cb16-150"></a>bup660.beetle.vs.flower&lt;-Cbuprest660.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb16-151"><a href="#cb16-151"></a></span>
<span id="cb16-152"><a href="#cb16-152"></a>com.bupcontrast.beetle.vs.flower.aim2&lt;-<span class="kw">cbind</span>(Cbuprest.beetle.vs.flower.aim2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.beetle.vs.flower,bup600.beetle.vs.flower,bup620.beetle.vs.flower,bup640.beetle.vs.flower,bup660.beetle.vs.flower)</span>
<span id="cb16-153"><a href="#cb16-153"></a>compare.beetle.vs.flower.aim2 &lt;-<span class="st"> </span>com.bupcontrast.beetle.vs.flower.aim2 <span class="op">%&gt;%</span></span>
<span id="cb16-154"><a href="#cb16-154"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.flower&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)</span>
<span id="cb16-155"><a href="#cb16-155"></a></span>
<span id="cb16-156"><a href="#cb16-156"></a></span>
<span id="cb16-157"><a href="#cb16-157"></a><span class="co">#Twilight - aim 1</span></span>
<span id="cb16-158"><a href="#cb16-158"></a><span class="co">##flower vs leaf</span></span>
<span id="cb16-159"><a href="#cb16-159"></a>CvsUSM.flower.vs.leaf_twilight=</span>
<span id="cb16-160"><a href="#cb16-160"></a><span class="st">  </span>CvsUSM_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb16-161"><a href="#cb16-161"></a>CvsUML.flower.vs.leaf_twilight=</span>
<span id="cb16-162"><a href="#cb16-162"></a><span class="st">  </span>CvsUML_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb16-163"><a href="#cb16-163"></a>CvsUSL.flower.vs.leaf_twilight=</span>
<span id="cb16-164"><a href="#cb16-164"></a><span class="st">  </span>CvsUSL_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb16-165"><a href="#cb16-165"></a>CvsUSML.flower.vs.leaf_twilight=</span>
<span id="cb16-166"><a href="#cb16-166"></a><span class="st">  </span>CvsUSML_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb16-167"><a href="#cb16-167"></a></span>
<span id="cb16-168"><a href="#cb16-168"></a>C.flower.vs.leaf_twilight.aim1=</span>
<span id="cb16-169"><a href="#cb16-169"></a><span class="st">  </span>CvsUSM.flower.vs.leaf_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvsUML.flower.vs.leaf_twilight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-170"><a href="#cb16-170"></a><span class="st">  </span><span class="kw">rbind</span>(CvsUSL.flower.vs.leaf_twilight)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvsUSML.flower.vs.leaf_twilight)</span>
<span id="cb16-171"><a href="#cb16-171"></a></span>
<span id="cb16-172"><a href="#cb16-172"></a>contrast.UVSWMW...flower.vs.leaf_twilight&lt;-CvsUSM.flower.vs.leaf_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-173"><a href="#cb16-173"></a>contrast.UV..MWLW.flower.vs.leaf_twilight&lt;-CvsUML.flower.vs.leaf_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-174"><a href="#cb16-174"></a>contrast.UVSW..LW.flower.vs.leaf_twilight&lt;-CvsUSL.flower.vs.leaf_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-175"><a href="#cb16-175"></a>contrast.UVSWMWLW.flower.vs.leaf_twilight&lt;-CvsUSML.flower.vs.leaf_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-176"><a href="#cb16-176"></a></span>
<span id="cb16-177"><a href="#cb16-177"></a>com.contrast.flower.vs.leaf_twilight.aim1&lt;-<span class="kw">cbind</span>(CvsUSM.flower.vs.leaf_twilight[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],contrast.UVSWMW...flower.vs.leaf_twilight,contrast.UV..MWLW.flower.vs.leaf_twilight,contrast.UVSW..LW.flower.vs.leaf_twilight,contrast.UVSWMWLW.flower.vs.leaf_twilight)</span>
<span id="cb16-178"><a href="#cb16-178"></a>compare.flower.vs.leaf_twilight.aim1 &lt;-<span class="st"> </span>com.contrast.flower.vs.leaf_twilight.aim1 <span class="op">%&gt;%</span></span>
<span id="cb16-179"><a href="#cb16-179"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.flower.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb16-180"><a href="#cb16-180"></a></span>
<span id="cb16-181"><a href="#cb16-181"></a><span class="co">##beetle vs leaf</span></span>
<span id="cb16-182"><a href="#cb16-182"></a>CvsUSM.beetle.vs.leaf_twilight=</span>
<span id="cb16-183"><a href="#cb16-183"></a><span class="st">  </span>CvsUSM_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-184"><a href="#cb16-184"></a>CvsUML.beetle.vs.leaf_twilight=</span>
<span id="cb16-185"><a href="#cb16-185"></a><span class="st">  </span>CvsUML_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-186"><a href="#cb16-186"></a>CvsUSL.beetle.vs.leaf_twilight=</span>
<span id="cb16-187"><a href="#cb16-187"></a><span class="st">  </span>CvsUSL_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-188"><a href="#cb16-188"></a>CvsUSML.beetle.vs.leaf_twilight=</span>
<span id="cb16-189"><a href="#cb16-189"></a><span class="st">  </span>CvsUSML_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-190"><a href="#cb16-190"></a></span>
<span id="cb16-191"><a href="#cb16-191"></a>C.beetle.vs.leaf_twilight.aim1=</span>
<span id="cb16-192"><a href="#cb16-192"></a><span class="st">  </span>CvsUSM.beetle.vs.leaf_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvsUML.beetle.vs.leaf_twilight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-193"><a href="#cb16-193"></a><span class="st">  </span><span class="kw">rbind</span>(CvsUSL.beetle.vs.leaf_twilight)<span class="op">%&gt;%</span><span class="st">  </span><span class="kw">rbind</span>(CvsUSML.beetle.vs.leaf_twilight)</span>
<span id="cb16-194"><a href="#cb16-194"></a></span>
<span id="cb16-195"><a href="#cb16-195"></a>contrast.UVSWMW...beetle.vs.leaf_twilight&lt;-CvsUSM.beetle.vs.leaf_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-196"><a href="#cb16-196"></a>contrast.UV..MWLW.beetle.vs.leaf_twilight&lt;-CvsUML.beetle.vs.leaf_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-197"><a href="#cb16-197"></a>contrast.UVSW..LW.beetle.vs.leaf_twilight&lt;-CvsUSL.beetle.vs.leaf_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-198"><a href="#cb16-198"></a>contrast.UVSWMWLW.beetle.vs.leaf_twilight&lt;-CvsUSML.beetle.vs.leaf_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-199"><a href="#cb16-199"></a></span>
<span id="cb16-200"><a href="#cb16-200"></a>com.contrast.beetle.vs.leaf_twilight.aim1&lt;-<span class="kw">cbind</span>(CvsUSM.beetle.vs.leaf_twilight[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],contrast.UVSWMW...beetle.vs.leaf_twilight,contrast.UV..MWLW.beetle.vs.leaf_twilight,contrast.UVSW..LW.beetle.vs.leaf_twilight,contrast.UVSWMWLW.beetle.vs.leaf_twilight)</span>
<span id="cb16-201"><a href="#cb16-201"></a>compare.beetle.vs.leaf_twilight.aim1 &lt;-<span class="st"> </span>com.contrast.beetle.vs.leaf_twilight.aim1 <span class="op">%&gt;%</span></span>
<span id="cb16-202"><a href="#cb16-202"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb16-203"><a href="#cb16-203"></a></span>
<span id="cb16-204"><a href="#cb16-204"></a><span class="co">##beetle vs flower</span></span>
<span id="cb16-205"><a href="#cb16-205"></a>CvsUSM.beetle.vs.flower_twilight=</span>
<span id="cb16-206"><a href="#cb16-206"></a><span class="st">  </span>CvsUSM_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-207"><a href="#cb16-207"></a>CvsUML.beetle.vs.flower_twilight=</span>
<span id="cb16-208"><a href="#cb16-208"></a><span class="st">  </span>CvsUML_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-209"><a href="#cb16-209"></a>CvsUSL.beetle.vs.flower_twilight=</span>
<span id="cb16-210"><a href="#cb16-210"></a><span class="st">  </span>CvsUSL_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-211"><a href="#cb16-211"></a>CvsUSML.beetle.vs.flower_twilight=</span>
<span id="cb16-212"><a href="#cb16-212"></a><span class="st">  </span>CvsUSML_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-213"><a href="#cb16-213"></a></span>
<span id="cb16-214"><a href="#cb16-214"></a>C.beetle.vs.flower_twilight.aim1=</span>
<span id="cb16-215"><a href="#cb16-215"></a><span class="st">  </span>CvsUSM.beetle.vs.flower_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvsUML.beetle.vs.flower_twilight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-216"><a href="#cb16-216"></a><span class="st">  </span><span class="kw">rbind</span>(CvsUSL.beetle.vs.flower_twilight) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">rbind</span>(CvsUSML.beetle.vs.flower_twilight)</span>
<span id="cb16-217"><a href="#cb16-217"></a></span>
<span id="cb16-218"><a href="#cb16-218"></a>contrast.UVSWMW...beetle.vs.flower_twilight&lt;-CvsUSM.beetle.vs.flower_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-219"><a href="#cb16-219"></a>contrast.UV..MWLW.beetle.vs.flower_twilight&lt;-CvsUML.beetle.vs.flower_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-220"><a href="#cb16-220"></a>contrast.UVSW..LW.beetle.vs.flower_twilight&lt;-CvsUSL.beetle.vs.flower_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-221"><a href="#cb16-221"></a>contrast.UVSWMWLW.beetle.vs.flower_twilight&lt;-CvsUSML.beetle.vs.flower_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-222"><a href="#cb16-222"></a></span>
<span id="cb16-223"><a href="#cb16-223"></a>com.contrast.beetle.vs.flower_twilight.aim1&lt;-<span class="kw">cbind</span>(CvsUSM.beetle.vs.flower_twilight[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],contrast.UVSWMW...beetle.vs.flower_twilight,contrast.UV..MWLW.beetle.vs.flower_twilight,contrast.UVSW..LW.beetle.vs.flower_twilight,contrast.UVSWMWLW.beetle.vs.flower_twilight)</span>
<span id="cb16-224"><a href="#cb16-224"></a>compare.beetle.vs.flower_twilight.aim1 &lt;-<span class="st"> </span>com.contrast.beetle.vs.flower_twilight.aim1 <span class="op">%&gt;%</span></span>
<span id="cb16-225"><a href="#cb16-225"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.flower&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb16-226"><a href="#cb16-226"></a></span>
<span id="cb16-227"><a href="#cb16-227"></a></span>
<span id="cb16-228"><a href="#cb16-228"></a></span>
<span id="cb16-229"><a href="#cb16-229"></a><span class="co">#Twilight - Aim 2</span></span>
<span id="cb16-230"><a href="#cb16-230"></a><span class="co">##flower vs leaf</span></span>
<span id="cb16-231"><a href="#cb16-231"></a>Cbuprest580.flower.vs.leaf_twilight=</span>
<span id="cb16-232"><a href="#cb16-232"></a><span class="st">  </span>Cbuprest580_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb16-233"><a href="#cb16-233"></a>Cbuprest600.flower.vs.leaf_twilight=</span>
<span id="cb16-234"><a href="#cb16-234"></a><span class="st">  </span>Cbuprest600_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb16-235"><a href="#cb16-235"></a>Cbuprest620.flower.vs.leaf_twilight=</span>
<span id="cb16-236"><a href="#cb16-236"></a><span class="st">  </span>Cbuprest620_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb16-237"><a href="#cb16-237"></a>Cbuprest640.flower.vs.leaf_twilight=</span>
<span id="cb16-238"><a href="#cb16-238"></a><span class="st">  </span>Cbuprest640_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb16-239"><a href="#cb16-239"></a>Cbuprest660.flower.vs.leaf_twilight=</span>
<span id="cb16-240"><a href="#cb16-240"></a><span class="st">  </span>Cbuprest660_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb16-241"><a href="#cb16-241"></a></span>
<span id="cb16-242"><a href="#cb16-242"></a>Cbuprest.flower.vs.leaf_twilight.aim2=</span>
<span id="cb16-243"><a href="#cb16-243"></a><span class="st">  </span>Cbuprest580.flower.vs.leaf_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.flower.vs.leaf_twilight) <span class="op">%&gt;%</span></span>
<span id="cb16-244"><a href="#cb16-244"></a><span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.flower.vs.leaf_twilight)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.flower.vs.leaf_twilight) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest660.flower.vs.leaf_twilight)</span>
<span id="cb16-245"><a href="#cb16-245"></a></span>
<span id="cb16-246"><a href="#cb16-246"></a>bup580.flower.vs.leaf_twilight&lt;-Cbuprest580.flower.vs.leaf_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-247"><a href="#cb16-247"></a>bup600.flower.vs.leaf_twilight&lt;-Cbuprest600.flower.vs.leaf_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-248"><a href="#cb16-248"></a>bup620.flower.vs.leaf_twilight&lt;-Cbuprest620.flower.vs.leaf_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-249"><a href="#cb16-249"></a>bup640.flower.vs.leaf_twilight&lt;-Cbuprest640.flower.vs.leaf_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-250"><a href="#cb16-250"></a>bup660.flower.vs.leaf_twilight&lt;-Cbuprest660.flower.vs.leaf_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-251"><a href="#cb16-251"></a></span>
<span id="cb16-252"><a href="#cb16-252"></a>com.bupcontrast.flower.vs.leaf_twilight.aim2&lt;-<span class="kw">cbind</span>(Cbuprest.flower.vs.leaf_twilight.aim2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.flower.vs.leaf_twilight,bup600.flower.vs.leaf_twilight,bup620.flower.vs.leaf_twilight,bup640.flower.vs.leaf_twilight,bup660.flower.vs.leaf_twilight)</span>
<span id="cb16-253"><a href="#cb16-253"></a>compare.flower.vs.leaf_twilight.aim2 &lt;-<span class="st"> </span>com.bupcontrast.flower.vs.leaf_twilight.aim2 <span class="op">%&gt;%</span></span>
<span id="cb16-254"><a href="#cb16-254"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.flower.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)</span>
<span id="cb16-255"><a href="#cb16-255"></a></span>
<span id="cb16-256"><a href="#cb16-256"></a><span class="co">##beetle vs leaf</span></span>
<span id="cb16-257"><a href="#cb16-257"></a>Cbuprest580.beetle.vs.leaf_twilight=</span>
<span id="cb16-258"><a href="#cb16-258"></a><span class="st">  </span>Cbuprest580_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-259"><a href="#cb16-259"></a>Cbuprest600.beetle.vs.leaf_twilight=</span>
<span id="cb16-260"><a href="#cb16-260"></a><span class="st">  </span>Cbuprest600_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-261"><a href="#cb16-261"></a>Cbuprest620.beetle.vs.leaf_twilight=</span>
<span id="cb16-262"><a href="#cb16-262"></a><span class="st">  </span>Cbuprest620_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-263"><a href="#cb16-263"></a>Cbuprest640.beetle.vs.leaf_twilight=</span>
<span id="cb16-264"><a href="#cb16-264"></a><span class="st">  </span>Cbuprest640_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-265"><a href="#cb16-265"></a>Cbuprest660.beetle.vs.leaf_twilight=</span>
<span id="cb16-266"><a href="#cb16-266"></a><span class="st">  </span>Cbuprest660_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-267"><a href="#cb16-267"></a></span>
<span id="cb16-268"><a href="#cb16-268"></a>Cbuprest.beetle.vs.leaf_twilight.aim2=</span>
<span id="cb16-269"><a href="#cb16-269"></a><span class="st">  </span>Cbuprest580.beetle.vs.leaf_twilight  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.beetle.vs.leaf_twilight)<span class="op">%&gt;%</span></span>
<span id="cb16-270"><a href="#cb16-270"></a><span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.beetle.vs.leaf_twilight)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.beetle.vs.leaf_twilight) <span class="op">%&gt;%</span></span>
<span id="cb16-271"><a href="#cb16-271"></a><span class="st">  </span><span class="kw">rbind</span>(Cbuprest660.beetle.vs.leaf_twilight)</span>
<span id="cb16-272"><a href="#cb16-272"></a></span>
<span id="cb16-273"><a href="#cb16-273"></a>bup580.beetle.vs.leaf_twilight&lt;-Cbuprest580.beetle.vs.leaf_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-274"><a href="#cb16-274"></a>bup600.beetle.vs.leaf_twilight&lt;-Cbuprest600.beetle.vs.leaf_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-275"><a href="#cb16-275"></a>bup620.beetle.vs.leaf_twilight&lt;-Cbuprest620.beetle.vs.leaf_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-276"><a href="#cb16-276"></a>bup640.beetle.vs.leaf_twilight&lt;-Cbuprest640.beetle.vs.leaf_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-277"><a href="#cb16-277"></a>bup660.beetle.vs.leaf_twilight&lt;-Cbuprest660.beetle.vs.leaf_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-278"><a href="#cb16-278"></a></span>
<span id="cb16-279"><a href="#cb16-279"></a>com.bupcontrast.beetle.vs.leaf_twilight.aim2&lt;-<span class="kw">cbind</span>(Cbuprest.beetle.vs.leaf_twilight.aim2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.beetle.vs.leaf_twilight,bup600.beetle.vs.leaf_twilight,bup620.beetle.vs.leaf_twilight,bup640.beetle.vs.leaf_twilight,bup660.beetle.vs.leaf_twilight)</span>
<span id="cb16-280"><a href="#cb16-280"></a>compare.beetle.vs.leaf_twilight.aim2 &lt;-<span class="st"> </span>com.bupcontrast.beetle.vs.leaf_twilight.aim2 <span class="op">%&gt;%</span></span>
<span id="cb16-281"><a href="#cb16-281"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)</span>
<span id="cb16-282"><a href="#cb16-282"></a></span>
<span id="cb16-283"><a href="#cb16-283"></a><span class="co">##beetle vs flower</span></span>
<span id="cb16-284"><a href="#cb16-284"></a>Cbuprest580.beetle.vs.flower_twilight=</span>
<span id="cb16-285"><a href="#cb16-285"></a><span class="st">  </span>Cbuprest580_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-286"><a href="#cb16-286"></a>Cbuprest600.beetle.vs.flower_twilight=</span>
<span id="cb16-287"><a href="#cb16-287"></a><span class="st">  </span>Cbuprest600_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-288"><a href="#cb16-288"></a>Cbuprest620.beetle.vs.flower_twilight=</span>
<span id="cb16-289"><a href="#cb16-289"></a><span class="st">  </span>Cbuprest620_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-290"><a href="#cb16-290"></a>Cbuprest640.beetle.vs.flower_twilight=</span>
<span id="cb16-291"><a href="#cb16-291"></a><span class="st">  </span>Cbuprest640_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-292"><a href="#cb16-292"></a>Cbuprest660.beetle.vs.flower_twilight=</span>
<span id="cb16-293"><a href="#cb16-293"></a><span class="st">  </span>Cbuprest660_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb16-294"><a href="#cb16-294"></a></span>
<span id="cb16-295"><a href="#cb16-295"></a>Cbuprest.beetle.vs.flower_twilight.aim2=</span>
<span id="cb16-296"><a href="#cb16-296"></a><span class="st">  </span>Cbuprest580.beetle.vs.flower_twilight <span class="op">%&gt;%</span><span class="kw">rbind</span>(Cbuprest600.beetle.vs.flower_twilight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-297"><a href="#cb16-297"></a><span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.beetle.vs.flower_twilight) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.beetle.vs.flower_twilight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-298"><a href="#cb16-298"></a><span class="st">  </span><span class="kw">rbind</span>(Cbuprest660.beetle.vs.flower_twilight)</span>
<span id="cb16-299"><a href="#cb16-299"></a></span>
<span id="cb16-300"><a href="#cb16-300"></a>bup580.beetle.vs.flower_twilight&lt;-Cbuprest580.beetle.vs.flower_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-301"><a href="#cb16-301"></a>bup600.beetle.vs.flower_twilight&lt;-Cbuprest600.beetle.vs.flower_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-302"><a href="#cb16-302"></a>bup620.beetle.vs.flower_twilight&lt;-Cbuprest620.beetle.vs.flower_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-303"><a href="#cb16-303"></a>bup640.beetle.vs.flower_twilight&lt;-Cbuprest640.beetle.vs.flower_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-304"><a href="#cb16-304"></a>bup660.beetle.vs.flower_twilight&lt;-Cbuprest660.beetle.vs.flower_twilight[,<span class="dv">3</span>]</span>
<span id="cb16-305"><a href="#cb16-305"></a></span>
<span id="cb16-306"><a href="#cb16-306"></a>com.bupcontrast.beetle.vs.flower_twilight.aim2&lt;-<span class="kw">cbind</span>(Cbuprest.beetle.vs.flower_twilight.aim2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.beetle.vs.flower_twilight,bup600.beetle.vs.flower_twilight,bup620.beetle.vs.flower_twilight,bup640.beetle.vs.flower_twilight,bup660.beetle.vs.flower_twilight)</span>
<span id="cb16-307"><a href="#cb16-307"></a>compare.beetle.vs.flower_twilight.aim2 &lt;-<span class="st"> </span>com.bupcontrast.beetle.vs.flower_twilight.aim2 <span class="op">%&gt;%</span></span>
<span id="cb16-308"><a href="#cb16-308"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.flower&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)</span></code></pre></div>
<div id="check-assumptions" class="section level2 tabset tabset-fade tabset-pills">
<h2>Check assumptions</h2>
<ul>
<li>Before running the GLMMs, we first check if the data follows the assumption of normality and homogeneity of variance</li>
</ul>
<p></br></p>
<p>Click the tabs to choose the assumptions ( <strong>Normality</strong> / <strong>Homogeneity</strong> ) of the visual models ( <strong>Aim 1</strong> / <strong>Aim 2</strong> ) under different light conditions ( <strong>Daylight</strong> / <strong>Twilight</strong>)</p>
<p></br></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co">#checking assumptions</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co">##D65 - aim 1</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>res.flower.vs.leaf_d65.aim1&lt;-<span class="kw">lm</span>(compare.flower.vs.leaf.aim1<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.flower.vs.leaf.aim1<span class="op">$</span>peak_wl.flower.vs.leaf)</span>
<span id="cb17-4"><a href="#cb17-4"></a>res.beetle.vs.leaf_d65.aim1&lt;-<span class="kw">lm</span>(compare.beetle.vs.leaf.aim1<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.beetle.vs.leaf.aim1<span class="op">$</span>peak_wl.beetle.vs.leaf)</span>
<span id="cb17-5"><a href="#cb17-5"></a>res.beetle.vs.flower_d65.aim1&lt;-<span class="kw">lm</span>(compare.beetle.vs.flower.aim1<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.beetle.vs.flower.aim1<span class="op">$</span>peak_wl.beetle.vs.flower)</span>
<span id="cb17-6"><a href="#cb17-6"></a></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="co">##D65 - Aim 2</span></span>
<span id="cb17-8"><a href="#cb17-8"></a>res.flower.vs.leaf_d65.aim2&lt;-<span class="kw">lm</span>(compare.flower.vs.leaf.aim2<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.flower.vs.leaf.aim2<span class="op">$</span>peak_wl.flower.vs.leaf)</span>
<span id="cb17-9"><a href="#cb17-9"></a>res.beetle.vs.leaf_d65.aim2&lt;-<span class="kw">lm</span>(compare.beetle.vs.leaf.aim2<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.beetle.vs.leaf.aim2<span class="op">$</span>peak_wl.beetle.vs.leaf)</span>
<span id="cb17-10"><a href="#cb17-10"></a>res.beetle.vs.flower_d65.aim2&lt;-<span class="kw">lm</span>(compare.beetle.vs.flower.aim2<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.beetle.vs.flower.aim2<span class="op">$</span>peak_wl.beetle.vs.flower)</span>
<span id="cb17-11"><a href="#cb17-11"></a></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="co">##Twilight - aim 1</span></span>
<span id="cb17-13"><a href="#cb17-13"></a>res.flower.vs.leaf_twilight.aim1&lt;-<span class="kw">lm</span>(compare.flower.vs.leaf_twilight.aim1<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.flower.vs.leaf_twilight.aim1<span class="op">$</span>peak_wl.flower.vs.leaf)</span>
<span id="cb17-14"><a href="#cb17-14"></a>res.beetle.vs.leaf_twilight.aim1&lt;-<span class="kw">lm</span>(compare.beetle.vs.leaf_twilight.aim1<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.beetle.vs.leaf_twilight.aim1<span class="op">$</span>peak_wl.beetle.vs.leaf)</span>
<span id="cb17-15"><a href="#cb17-15"></a>res.beetle.vs.flower_twilight.aim1&lt;-<span class="kw">lm</span>(compare.beetle.vs.flower_twilight.aim1<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.beetle.vs.flower_twilight.aim1<span class="op">$</span>peak_wl.beetle.vs.flower)</span>
<span id="cb17-16"><a href="#cb17-16"></a></span>
<span id="cb17-17"><a href="#cb17-17"></a><span class="co">##Twilight - Aim 2</span></span>
<span id="cb17-18"><a href="#cb17-18"></a>res.flower.vs.leaf_twilight.aim2&lt;-<span class="kw">lm</span>(compare.flower.vs.leaf_twilight.aim2<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.flower.vs.leaf_twilight.aim2<span class="op">$</span>peak_wl.flower.vs.leaf)</span>
<span id="cb17-19"><a href="#cb17-19"></a>res.beetle.vs.leaf_twilight.aim2&lt;-<span class="kw">lm</span>(compare.beetle.vs.leaf_twilight.aim2<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.beetle.vs.leaf_twilight.aim2<span class="op">$</span>peak_wl.beetle.vs.leaf)</span>
<span id="cb17-20"><a href="#cb17-20"></a>res.beetle.vs.flower_twilight.aim2&lt;-<span class="kw">lm</span>(compare.beetle.vs.flower_twilight.aim2<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.beetle.vs.flower_twilight.aim2<span class="op">$</span>peak_wl.beetle.vs.flower)</span></code></pre></div>
<div id="normality" class="section level3 tabset tabset-fade tabset-pills">
<h3>Normality</h3>
<div id="aim-1-1" class="section level4 tabset tabset-fade tabset-pills">
<h4>Aim 1</h4>
<div id="d65" class="section level5">
<h5>D65</h5>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">pin=</span><span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>))</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw">qqnorm</span>(res.flower.vs.leaf_d65.aim1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Flower vs Leaf&quot;</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="kw">qqnorm</span>(res.beetle.vs.leaf_d65.aim1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs Leaf&quot;</span>)</span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="kw">qqnorm</span>(res.beetle.vs.flower_d65.aim1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs Flower&quot;</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="twilight-2" class="section level5">
<h5>Twilight</h5>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">pin=</span><span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>))</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw">qqnorm</span>(res.flower.vs.leaf_twilight.aim1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Flower vs Leaf&quot;</span>)</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="kw">qqnorm</span>(res.beetle.vs.leaf_twilight.aim1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs Leaf&quot;</span>)</span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="kw">qqnorm</span>(res.beetle.vs.flower_twilight.aim1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs Flower&quot;</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
</div>
<div id="aim-2-1" class="section level4 tabset tabset-fade tabset-pills">
<h4>Aim 2</h4>
<div id="d65-1" class="section level5">
<h5>D65</h5>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">pin=</span><span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>))</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw">qqnorm</span>(res.flower.vs.leaf_d65.aim2<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Flower vs Leaf&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="kw">qqnorm</span>(res.beetle.vs.leaf_d65.aim2<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs Leaf&quot;</span>)</span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="kw">qqnorm</span>(res.beetle.vs.flower_d65.aim2<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs Flower&quot;</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="twilight-3" class="section level5">
<h5>Twilight</h5>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">pin=</span><span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>))</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="kw">qqnorm</span>(res.flower.vs.leaf_twilight.aim2<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Flower vs Leaf&quot;</span>)</span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="kw">qqnorm</span>(res.beetle.vs.leaf_twilight.aim2<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs Leaf&quot;</span>)</span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="kw">qqnorm</span>(res.beetle.vs.flower_twilight.aim2<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs Flower&quot;</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="homoscedasticity" class="section level3 tabset tabset-fade tabset-pills">
<h3>Homoscedasticity</h3>
<div id="aim-1-2" class="section level4 tabset tabset-fade tabset-pills">
<h4>Aim 1</h4>
<div id="d65-2" class="section level5">
<h5>D65</h5>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>)) <span class="co">#oma=c() to create space for common labels</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="kw">boxplot</span>(compare.flower.vs.leaf.aim1<span class="op">$</span>dS<span class="op">~</span>compare.flower.vs.leaf.aim1<span class="op">$</span>peak_wl.flower.vs.leaf, <span class="dt">las=</span><span class="dv">2</span>,</span>
<span id="cb22-3"><a href="#cb22-3"></a>        <span class="dt">main =</span> <span class="st">&quot;Flower vs Leaf&quot;</span>,</span>
<span id="cb22-4"><a href="#cb22-4"></a>        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USM&quot;</span>, <span class="st">&quot;USML&quot;</span>))</span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="kw">boxplot</span>(compare.beetle.vs.leaf.aim1<span class="op">$</span>dS<span class="op">~</span>compare.beetle.vs.leaf.aim1<span class="op">$</span>peak_wl.beetle.vs.leaf, <span class="dt">las=</span><span class="dv">2</span>,</span>
<span id="cb22-6"><a href="#cb22-6"></a>        <span class="dt">main =</span> <span class="st">&quot;Beetle vs Leaf&quot;</span>,</span>
<span id="cb22-7"><a href="#cb22-7"></a>        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USM&quot;</span>, <span class="st">&quot;USML&quot;</span>))</span>
<span id="cb22-8"><a href="#cb22-8"></a><span class="kw">boxplot</span>(compare.beetle.vs.flower.aim1<span class="op">$</span>dS<span class="op">~</span>compare.beetle.vs.flower.aim1<span class="op">$</span>peak_wl.beetle.vs.flower, <span class="dt">las=</span><span class="dv">2</span>,</span>
<span id="cb22-9"><a href="#cb22-9"></a>        <span class="dt">main =</span> <span class="st">&quot;Beetle vs Flower&quot;</span>,</span>
<span id="cb22-10"><a href="#cb22-10"></a>        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USM&quot;</span>, <span class="st">&quot;USML&quot;</span>))</span>
<span id="cb22-11"><a href="#cb22-11"></a><span class="kw">mtext</span>(<span class="st">&quot;Visual system&quot;</span>,<span class="dt">side=</span><span class="dv">1</span>,<span class="dt">line=</span><span class="dv">0</span>,<span class="dt">outer=</span><span class="ot">TRUE</span>,<span class="dt">cex=</span><span class="fl">1.3</span>) <span class="co">#side assigns the position of the text e.g. bottom</span></span>
<span id="cb22-12"><a href="#cb22-12"></a><span class="kw">mtext</span>(<span class="st">&quot;Contrast (JND)&quot;</span>,<span class="dt">side=</span><span class="dv">2</span>,<span class="dt">line=</span><span class="dv">0</span>,<span class="dt">outer=</span><span class="ot">TRUE</span>,<span class="dt">cex=</span><span class="fl">1.3</span>,<span class="dt">las=</span><span class="dv">0</span>) <span class="co">#las assigns the orientation of the text</span></span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="twilight-4" class="section level5">
<h5>Twilight</h5>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="kw">boxplot</span>(compare.flower.vs.leaf_twilight.aim1<span class="op">$</span>dS<span class="op">~</span>compare.flower.vs.leaf_twilight.aim1<span class="op">$</span>peak_wl.flower.vs.leaf, <span class="dt">las=</span><span class="dv">2</span>,</span>
<span id="cb23-3"><a href="#cb23-3"></a>        <span class="dt">main =</span> <span class="st">&quot;Flower vs Leaf&quot;</span>,</span>
<span id="cb23-4"><a href="#cb23-4"></a>        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USM&quot;</span>, <span class="st">&quot;USML&quot;</span>))</span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="kw">boxplot</span>(compare.beetle.vs.leaf_twilight.aim1<span class="op">$</span>dS<span class="op">~</span>compare.beetle.vs.leaf_twilight.aim1<span class="op">$</span>peak_wl.beetle.vs.leaf, <span class="dt">las=</span><span class="dv">2</span>,</span>
<span id="cb23-6"><a href="#cb23-6"></a>        <span class="dt">main =</span> <span class="st">&quot;Beetle vs Leaf&quot;</span>,</span>
<span id="cb23-7"><a href="#cb23-7"></a>        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USM&quot;</span>, <span class="st">&quot;USML&quot;</span>))</span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="kw">boxplot</span>(compare.beetle.vs.flower_twilight.aim1<span class="op">$</span>dS<span class="op">~</span>compare.beetle.vs.flower_twilight.aim1<span class="op">$</span>peak_wl.beetle.vs.flower, <span class="dt">las=</span><span class="dv">2</span>,</span>
<span id="cb23-9"><a href="#cb23-9"></a>        <span class="dt">main =</span> <span class="st">&quot;Beetle vs Flower&quot;</span>,</span>
<span id="cb23-10"><a href="#cb23-10"></a>        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USM&quot;</span>, <span class="st">&quot;USML&quot;</span>))</span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="kw">mtext</span>(<span class="st">&quot;Visual system&quot;</span>,<span class="dt">side=</span><span class="dv">1</span>,<span class="dt">line=</span><span class="dv">0</span>,<span class="dt">outer=</span><span class="ot">TRUE</span>,<span class="dt">cex=</span><span class="fl">1.3</span>)</span>
<span id="cb23-12"><a href="#cb23-12"></a><span class="kw">mtext</span>(<span class="st">&quot;Contrast (JND)&quot;</span>,<span class="dt">side=</span><span class="dv">2</span>,<span class="dt">line=</span><span class="dv">0</span>,<span class="dt">outer=</span><span class="ot">TRUE</span>,<span class="dt">cex=</span><span class="fl">1.3</span>,<span class="dt">las=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
</div>
<div id="aim-2-2" class="section level4 tabset tabset-fade tabset-pills">
<h4>Aim 2</h4>
<div id="d65-3" class="section level5">
<h5>D65</h5>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="kw">boxplot</span>(compare.flower.vs.leaf.aim2<span class="op">$</span>dS<span class="op">~</span>compare.flower.vs.leaf.aim2<span class="op">$</span>peak_wl.flower.vs.leaf, <span class="dt">las=</span><span class="dv">2</span>,</span>
<span id="cb24-3"><a href="#cb24-3"></a>        <span class="dt">main =</span> <span class="st">&quot;Flower vs Leaf&quot;</span>,</span>
<span id="cb24-4"><a href="#cb24-4"></a>        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>, <span class="st">&quot;VS 640&quot;</span>, <span class="st">&quot;VS 660&quot;</span>))</span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="kw">boxplot</span>(compare.beetle.vs.leaf.aim2<span class="op">$</span>dS<span class="op">~</span>compare.beetle.vs.leaf.aim2<span class="op">$</span>peak_wl.beetle.vs.leaf, <span class="dt">las=</span><span class="dv">2</span>,</span>
<span id="cb24-6"><a href="#cb24-6"></a>        <span class="dt">main =</span> <span class="st">&quot;Beetle vs Leaf&quot;</span>,</span>
<span id="cb24-7"><a href="#cb24-7"></a>        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>, <span class="st">&quot;VS 640&quot;</span>, <span class="st">&quot;VS 660&quot;</span>))</span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="kw">boxplot</span>(compare.beetle.vs.flower.aim2<span class="op">$</span>dS<span class="op">~</span>compare.beetle.vs.flower.aim2<span class="op">$</span>peak_wl.beetle.vs.flower, <span class="dt">las=</span><span class="dv">2</span>,</span>
<span id="cb24-9"><a href="#cb24-9"></a>        <span class="dt">main =</span> <span class="st">&quot;Beetle vs Flower&quot;</span>,</span>
<span id="cb24-10"><a href="#cb24-10"></a>        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>, <span class="st">&quot;VS 640&quot;</span>, <span class="st">&quot;VS 660&quot;</span>))</span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="kw">mtext</span>(<span class="st">&quot;Visual system&quot;</span>,<span class="dt">side=</span><span class="dv">1</span>,<span class="dt">line=</span><span class="dv">0</span>,<span class="dt">outer=</span><span class="ot">TRUE</span>,<span class="dt">cex=</span><span class="fl">1.3</span>)</span>
<span id="cb24-12"><a href="#cb24-12"></a><span class="kw">mtext</span>(<span class="st">&quot;Contrast (JND)&quot;</span>,<span class="dt">side=</span><span class="dv">2</span>,<span class="dt">line=</span><span class="dv">0</span>,<span class="dt">outer=</span><span class="ot">TRUE</span>,<span class="dt">cex=</span><span class="fl">1.3</span>,<span class="dt">las=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="twilight-5" class="section level5">
<h5>Twilight</h5>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="kw">boxplot</span>(compare.flower.vs.leaf_twilight.aim2<span class="op">$</span>dS<span class="op">~</span>compare.flower.vs.leaf_twilight.aim2<span class="op">$</span>peak_wl.flower.vs.leaf, <span class="dt">las=</span><span class="dv">2</span>,</span>
<span id="cb25-3"><a href="#cb25-3"></a>        <span class="dt">main =</span> <span class="st">&quot;Flower vs Leaf&quot;</span>,</span>
<span id="cb25-4"><a href="#cb25-4"></a>        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>, <span class="st">&quot;VS 640&quot;</span>, <span class="st">&quot;VS 660&quot;</span>))</span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="kw">boxplot</span>(compare.beetle.vs.leaf_twilight.aim2<span class="op">$</span>dS<span class="op">~</span>compare.beetle.vs.leaf_twilight.aim2<span class="op">$</span>peak_wl.beetle.vs.leaf, <span class="dt">las=</span><span class="dv">2</span>,</span>
<span id="cb25-6"><a href="#cb25-6"></a>        <span class="dt">main =</span> <span class="st">&quot;Beetle vs Leaf&quot;</span>,</span>
<span id="cb25-7"><a href="#cb25-7"></a>        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>, <span class="st">&quot;VS 640&quot;</span>, <span class="st">&quot;VS 660&quot;</span>))</span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="kw">boxplot</span>(compare.beetle.vs.flower_twilight.aim2<span class="op">$</span>dS<span class="op">~</span>compare.beetle.vs.flower_twilight.aim2<span class="op">$</span>peak_wl.beetle.vs.flower, <span class="dt">las=</span><span class="dv">2</span>,</span>
<span id="cb25-9"><a href="#cb25-9"></a>        <span class="dt">main =</span> <span class="st">&quot;Beetle vs Flower&quot;</span>,</span>
<span id="cb25-10"><a href="#cb25-10"></a>        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>, <span class="st">&quot;VS 640&quot;</span>, <span class="st">&quot;VS 660&quot;</span>))</span>
<span id="cb25-11"><a href="#cb25-11"></a><span class="kw">mtext</span>(<span class="st">&quot;Visual system&quot;</span>,<span class="dt">side=</span><span class="dv">1</span>,<span class="dt">line=</span><span class="dv">0</span>,<span class="dt">outer=</span><span class="ot">TRUE</span>,<span class="dt">cex=</span><span class="fl">1.3</span>)</span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="kw">mtext</span>(<span class="st">&quot;Contrast (JND)&quot;</span>,<span class="dt">side=</span><span class="dv">2</span>,<span class="dt">line=</span><span class="dv">0</span>,<span class="dt">outer=</span><span class="ot">TRUE</span>,<span class="dt">cex=</span><span class="fl">1.3</span>,<span class="dt">las=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p></br> </br></p>
</div>
</div>
</div>
</div>
<div id="glmm-results" class="section level2">
<h2>GLMM results</h2>
<p></br></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co">#GLMM - D65 - aim 1</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="co">##Flower vs Leaf</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>m.flower.vs.leaf_d65.aim1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.flower.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.flower.vs.leaf.aim1,<span class="dt">REML=</span>F)</span>
<span id="cb26-4"><a href="#cb26-4"></a>sum.flower.vs.leaf_d65.aim1&lt;-<span class="kw">summary</span>(<span class="kw">glht</span>(m.flower.vs.leaf_d65.aim1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.flower.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co">#REML=F, in order to fit the model using the likelihood ratio test. Otherwise, the lmer default will fit the model using the REML (REstricted Maximum Likelihood) criterion.</span></span>
<span id="cb26-6"><a href="#cb26-6"></a></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="co">##Beetle vs Leaf</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>m.beetle.vs.leaf_d65.aim1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.leaf.aim1,<span class="dt">REML=</span>F)</span>
<span id="cb26-9"><a href="#cb26-9"></a>sum.beetle.vs.leaf_d65.aim1 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.leaf_d65.aim1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb26-10"><a href="#cb26-10"></a></span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="co">##Beetle vs Flower</span></span>
<span id="cb26-12"><a href="#cb26-12"></a>m.beetle.vs.flower_d65.aim1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.flower <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.flower.aim1,<span class="dt">REML=</span>F)</span>
<span id="cb26-13"><a href="#cb26-13"></a>sum.beetle.vs.flower_d65.aim1 &lt;-<span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.flower_d65.aim1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.flower =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb26-14"><a href="#cb26-14"></a></span>
<span id="cb26-15"><a href="#cb26-15"></a><span class="co">###reshape data for heatmap</span></span>
<span id="cb26-16"><a href="#cb26-16"></a>p1_d65.aim1&lt;-sum.flower.vs.leaf_d65.aim1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb26-17"><a href="#cb26-17"></a>p2_d65.aim1&lt;-sum.beetle.vs.leaf_d65.aim1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb26-18"><a href="#cb26-18"></a>p3_d65.aim1&lt;-sum.beetle.vs.flower_d65.aim1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb26-19"><a href="#cb26-19"></a></span>
<span id="cb26-20"><a href="#cb26-20"></a>VislistA_d65.aim1&lt;-<span class="kw">c</span>(<span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USM&quot;</span>,<span class="st">&quot;USML&quot;</span>,<span class="st">&quot;USM&quot;</span>,<span class="st">&quot;USML&quot;</span>,<span class="st">&quot;USML&quot;</span>)</span>
<span id="cb26-21"><a href="#cb26-21"></a>VislistB_d65.aim1&lt;-<span class="kw">c</span>(<span class="st">&quot;UML&quot;</span>, <span class="st">&quot;UML&quot;</span>,<span class="st">&quot;UML&quot;</span>,<span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USM&quot;</span>)</span>
<span id="cb26-22"><a href="#cb26-22"></a></span>
<span id="cb26-23"><a href="#cb26-23"></a>heat_d65.aim1&lt;-<span class="kw">data.frame</span>(<span class="kw">names</span>(p1_d65.aim1),<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p1_d65.aim1,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-24"><a href="#cb26-24"></a><span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p2_d65.aim1,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-25"><a href="#cb26-25"></a><span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p3_d65.aim1,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb26-26"><a href="#cb26-26"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">orignial.list =</span> <span class="dv">1</span>, <span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-27"><a href="#cb26-27"></a><span class="st">  </span><span class="kw">cbind</span>(VislistA_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-28"><a href="#cb26-28"></a><span class="st">  </span><span class="kw">cbind</span>(VislistB_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-29"><a href="#cb26-29"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>orignial.list)</span>
<span id="cb26-30"><a href="#cb26-30"></a></span>
<span id="cb26-31"><a href="#cb26-31"></a><span class="co">##add asterisks for significant pairs</span></span>
<span id="cb26-32"><a href="#cb26-32"></a>heat_d65.aim1<span class="op">$</span>sig.flower.vs.leaf[heat_d65.aim1<span class="op">$</span>flower.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb26-33"><a href="#cb26-33"></a>heat_d65.aim1<span class="op">$</span>sig.flower.vs.leaf[heat_d65.aim1<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb26-34"><a href="#cb26-34"></a>heat_d65.aim1<span class="op">$</span>sig.flower.vs.leaf[heat_d65.aim1<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb26-35"><a href="#cb26-35"></a>heat_d65.aim1<span class="op">$</span>sig.flower.vs.leaf[heat_d65.aim1<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb26-36"><a href="#cb26-36"></a>heat_d65.aim1<span class="op">$</span>sig.beetle.vs.leaf[heat_d65.aim1<span class="op">$</span>beetle.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb26-37"><a href="#cb26-37"></a>heat_d65.aim1<span class="op">$</span>sig.beetle.vs.leaf[heat_d65.aim1<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb26-38"><a href="#cb26-38"></a>heat_d65.aim1<span class="op">$</span>sig.beetle.vs.leaf[heat_d65.aim1<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb26-39"><a href="#cb26-39"></a>heat_d65.aim1<span class="op">$</span>sig.beetle.vs.leaf[heat_d65.aim1<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb26-40"><a href="#cb26-40"></a>heat_d65.aim1<span class="op">$</span>sig.beetle.vs.flower[heat_d65.aim1<span class="op">$</span>beetle.vs.flower <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb26-41"><a href="#cb26-41"></a>heat_d65.aim1<span class="op">$</span>sig.beetle.vs.flower[heat_d65.aim1<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb26-42"><a href="#cb26-42"></a>heat_d65.aim1<span class="op">$</span>sig.beetle.vs.flower[heat_d65.aim1<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb26-43"><a href="#cb26-43"></a>heat_d65.aim1<span class="op">$</span>sig.beetle.vs.flower[heat_d65.aim1<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb26-44"><a href="#cb26-44"></a></span>
<span id="cb26-45"><a href="#cb26-45"></a></span>
<span id="cb26-46"><a href="#cb26-46"></a><span class="co">#GLMM - D65 - Aim 2</span></span>
<span id="cb26-47"><a href="#cb26-47"></a><span class="co">##Flower vs Leaf</span></span>
<span id="cb26-48"><a href="#cb26-48"></a>m.flower.vs.leaf_d65.aim2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.flower.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.flower.vs.leaf.aim2,<span class="dt">REML=</span>F)</span>
<span id="cb26-49"><a href="#cb26-49"></a>sum.flower.vs.leaf_d65.aim2 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.flower.vs.leaf_d65.aim2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.flower.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb26-50"><a href="#cb26-50"></a><span class="co">##Beetle vs Leaf</span></span>
<span id="cb26-51"><a href="#cb26-51"></a>m.beetle.vs.leaf_d65.aim2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.leaf.aim2,<span class="dt">REML=</span>F)</span>
<span id="cb26-52"><a href="#cb26-52"></a>sum.beetle.vs.leaf_d65.aim2 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.leaf_d65.aim2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb26-53"><a href="#cb26-53"></a><span class="co">##Beetle vs Flower</span></span>
<span id="cb26-54"><a href="#cb26-54"></a>m.beetle.vs.flower_d65.aim2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.flower <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.flower.aim2,<span class="dt">REML=</span>F)</span>
<span id="cb26-55"><a href="#cb26-55"></a>sum.beetle.vs.flower_d65.aim2 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.flower_d65.aim2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.flower =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb26-56"><a href="#cb26-56"></a></span>
<span id="cb26-57"><a href="#cb26-57"></a><span class="co">###reshape data for heatmap</span></span>
<span id="cb26-58"><a href="#cb26-58"></a>p1_d65.aim2&lt;-sum.flower.vs.leaf_d65.aim2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb26-59"><a href="#cb26-59"></a>p2_d65.aim2&lt;-sum.beetle.vs.leaf_d65.aim2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb26-60"><a href="#cb26-60"></a>p3_d65.aim2&lt;-sum.beetle.vs.flower_d65.aim2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb26-61"><a href="#cb26-61"></a></span>
<span id="cb26-62"><a href="#cb26-62"></a>VislistA_d65.aim2&lt;-<span class="kw">c</span>(<span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 660&quot;</span>)</span>
<span id="cb26-63"><a href="#cb26-63"></a>VislistB_d65.aim2&lt;-<span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>)</span>
<span id="cb26-64"><a href="#cb26-64"></a></span>
<span id="cb26-65"><a href="#cb26-65"></a>heat_d65.aim2&lt;-<span class="kw">data.frame</span>(<span class="kw">names</span>(p1_d65.aim2),<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p1_d65.aim2,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-66"><a href="#cb26-66"></a><span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p2_d65.aim2,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-67"><a href="#cb26-67"></a><span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p3_d65.aim2,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb26-68"><a href="#cb26-68"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">orignial.list =</span> <span class="dv">1</span>, <span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-69"><a href="#cb26-69"></a><span class="st">  </span><span class="kw">cbind</span>(VislistA_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-70"><a href="#cb26-70"></a><span class="st">  </span><span class="kw">cbind</span>(VislistB_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-71"><a href="#cb26-71"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>orignial.list)</span>
<span id="cb26-72"><a href="#cb26-72"></a></span>
<span id="cb26-73"><a href="#cb26-73"></a><span class="co">##add asterisks for significant pairs</span></span>
<span id="cb26-74"><a href="#cb26-74"></a>heat_d65.aim2<span class="op">$</span>sig.flower.vs.leaf[heat_d65.aim2<span class="op">$</span>flower.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb26-75"><a href="#cb26-75"></a>heat_d65.aim2<span class="op">$</span>sig.flower.vs.leaf[heat_d65.aim2<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb26-76"><a href="#cb26-76"></a>heat_d65.aim2<span class="op">$</span>sig.flower.vs.leaf[heat_d65.aim2<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb26-77"><a href="#cb26-77"></a>heat_d65.aim2<span class="op">$</span>sig.flower.vs.leaf[heat_d65.aim2<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb26-78"><a href="#cb26-78"></a>heat_d65.aim2<span class="op">$</span>sig.beetle.vs.leaf[heat_d65.aim2<span class="op">$</span>beetle.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb26-79"><a href="#cb26-79"></a>heat_d65.aim2<span class="op">$</span>sig.beetle.vs.leaf[heat_d65.aim2<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb26-80"><a href="#cb26-80"></a>heat_d65.aim2<span class="op">$</span>sig.beetle.vs.leaf[heat_d65.aim2<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb26-81"><a href="#cb26-81"></a>heat_d65.aim2<span class="op">$</span>sig.beetle.vs.leaf[heat_d65.aim2<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb26-82"><a href="#cb26-82"></a>heat_d65.aim2<span class="op">$</span>sig.beetle.vs.flower[heat_d65.aim2<span class="op">$</span>beetle.vs.flower <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb26-83"><a href="#cb26-83"></a>heat_d65.aim2<span class="op">$</span>sig.beetle.vs.flower[heat_d65.aim2<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb26-84"><a href="#cb26-84"></a>heat_d65.aim2<span class="op">$</span>sig.beetle.vs.flower[heat_d65.aim2<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb26-85"><a href="#cb26-85"></a>heat_d65.aim2<span class="op">$</span>sig.beetle.vs.flower[heat_d65.aim2<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb26-86"><a href="#cb26-86"></a></span>
<span id="cb26-87"><a href="#cb26-87"></a></span>
<span id="cb26-88"><a href="#cb26-88"></a></span>
<span id="cb26-89"><a href="#cb26-89"></a></span>
<span id="cb26-90"><a href="#cb26-90"></a><span class="co">#GLMM - Twilight - aim 1</span></span>
<span id="cb26-91"><a href="#cb26-91"></a><span class="co">##Flower vs Leaf</span></span>
<span id="cb26-92"><a href="#cb26-92"></a>m.flower.vs.leaf_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.flower.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.flower.vs.leaf_twilight.aim1,<span class="dt">REML=</span>F)</span>
<span id="cb26-93"><a href="#cb26-93"></a>sum.flower.vs.leaf_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.flower.vs.leaf_twilight.aim1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.flower.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb26-94"><a href="#cb26-94"></a><span class="co">##Beetle vs Leaf</span></span>
<span id="cb26-95"><a href="#cb26-95"></a>m.beetle.vs.leaf_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.leaf_twilight.aim1,<span class="dt">REML=</span>F)</span>
<span id="cb26-96"><a href="#cb26-96"></a>sum.beetle.vs.leaf_twilight.aim1&lt;-<span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.leaf_twilight.aim1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb26-97"><a href="#cb26-97"></a><span class="co">##Beetle vs Flower</span></span>
<span id="cb26-98"><a href="#cb26-98"></a>m.beetle.vs.flower_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.flower <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.flower_twilight.aim1,<span class="dt">REML=</span>F)</span>
<span id="cb26-99"><a href="#cb26-99"></a>sum.beetle.vs.flower_twilight.aim1&lt;-<span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.flower_twilight.aim1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.flower =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb26-100"><a href="#cb26-100"></a><span class="co">###reshape data for heatmap</span></span>
<span id="cb26-101"><a href="#cb26-101"></a>p1_twilight.aim1&lt;-sum.flower.vs.leaf_twilight.aim1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb26-102"><a href="#cb26-102"></a>p2_twilight.aim1&lt;-sum.beetle.vs.leaf_twilight.aim1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb26-103"><a href="#cb26-103"></a>p3_twilight.aim1&lt;-sum.beetle.vs.flower_twilight.aim1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb26-104"><a href="#cb26-104"></a></span>
<span id="cb26-105"><a href="#cb26-105"></a>VislistA_twilight.aim1&lt;-<span class="kw">c</span>(<span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USM&quot;</span>,<span class="st">&quot;USML&quot;</span>,<span class="st">&quot;USM&quot;</span>,<span class="st">&quot;USML&quot;</span>,<span class="st">&quot;USML&quot;</span>)</span>
<span id="cb26-106"><a href="#cb26-106"></a>VislistB_twilight.aim1&lt;-<span class="kw">c</span>(<span class="st">&quot;UML&quot;</span>, <span class="st">&quot;UML&quot;</span>,<span class="st">&quot;UML&quot;</span>,<span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USM&quot;</span>)</span>
<span id="cb26-107"><a href="#cb26-107"></a></span>
<span id="cb26-108"><a href="#cb26-108"></a>heat_twilight.aim1&lt;-<span class="kw">data.frame</span>(<span class="kw">names</span>(p1_twilight.aim1),<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p1_twilight.aim1,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-109"><a href="#cb26-109"></a><span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p2_twilight.aim1,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-110"><a href="#cb26-110"></a><span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p3_twilight.aim1,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb26-111"><a href="#cb26-111"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">orignial.list =</span> <span class="dv">1</span>, <span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-112"><a href="#cb26-112"></a><span class="st">  </span><span class="kw">cbind</span>(VislistA_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-113"><a href="#cb26-113"></a><span class="st">  </span><span class="kw">cbind</span>(VislistB_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-114"><a href="#cb26-114"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>orignial.list)</span>
<span id="cb26-115"><a href="#cb26-115"></a></span>
<span id="cb26-116"><a href="#cb26-116"></a><span class="co">##add asterisks for significant pairs</span></span>
<span id="cb26-117"><a href="#cb26-117"></a>heat_twilight.aim1<span class="op">$</span>sig.flower.vs.leaf[heat_twilight.aim1<span class="op">$</span>flower.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb26-118"><a href="#cb26-118"></a>heat_twilight.aim1<span class="op">$</span>sig.flower.vs.leaf[heat_twilight.aim1<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb26-119"><a href="#cb26-119"></a>heat_twilight.aim1<span class="op">$</span>sig.flower.vs.leaf[heat_twilight.aim1<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb26-120"><a href="#cb26-120"></a>heat_twilight.aim1<span class="op">$</span>sig.flower.vs.leaf[heat_twilight.aim1<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb26-121"><a href="#cb26-121"></a>heat_twilight.aim1<span class="op">$</span>sig.beetle.vs.leaf[heat_twilight.aim1<span class="op">$</span>beetle.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb26-122"><a href="#cb26-122"></a>heat_twilight.aim1<span class="op">$</span>sig.beetle.vs.leaf[heat_twilight.aim1<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb26-123"><a href="#cb26-123"></a>heat_twilight.aim1<span class="op">$</span>sig.beetle.vs.leaf[heat_twilight.aim1<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb26-124"><a href="#cb26-124"></a>heat_twilight.aim1<span class="op">$</span>sig.beetle.vs.leaf[heat_twilight.aim1<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb26-125"><a href="#cb26-125"></a>heat_twilight.aim1<span class="op">$</span>sig.beetle.vs.flower[heat_twilight.aim1<span class="op">$</span>beetle.vs.flower <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb26-126"><a href="#cb26-126"></a>heat_twilight.aim1<span class="op">$</span>sig.beetle.vs.flower[heat_twilight.aim1<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb26-127"><a href="#cb26-127"></a>heat_twilight.aim1<span class="op">$</span>sig.beetle.vs.flower[heat_twilight.aim1<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb26-128"><a href="#cb26-128"></a>heat_twilight.aim1<span class="op">$</span>sig.beetle.vs.flower[heat_twilight.aim1<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb26-129"><a href="#cb26-129"></a></span>
<span id="cb26-130"><a href="#cb26-130"></a></span>
<span id="cb26-131"><a href="#cb26-131"></a></span>
<span id="cb26-132"><a href="#cb26-132"></a></span>
<span id="cb26-133"><a href="#cb26-133"></a><span class="co">#GLMM - Twilight - Aim 2</span></span>
<span id="cb26-134"><a href="#cb26-134"></a><span class="co">##Flower vs Leaf</span></span>
<span id="cb26-135"><a href="#cb26-135"></a>m.flower.vs.leaf_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.flower.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.flower.vs.leaf_twilight.aim2,<span class="dt">REML=</span>F)</span>
<span id="cb26-136"><a href="#cb26-136"></a>sum.flower.vs.leaf_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.flower.vs.leaf_twilight.aim2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.flower.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb26-137"><a href="#cb26-137"></a><span class="co">##Beetle vs Leaf</span></span>
<span id="cb26-138"><a href="#cb26-138"></a>m.beetle.vs.leaf_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.leaf_twilight.aim2,<span class="dt">REML=</span>F)</span>
<span id="cb26-139"><a href="#cb26-139"></a>sum.beetle.vs.leaf_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.leaf_twilight.aim2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb26-140"><a href="#cb26-140"></a><span class="co">##Beetle vs Flower</span></span>
<span id="cb26-141"><a href="#cb26-141"></a>m.beetle.vs.flower_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.flower <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.flower_twilight.aim2,<span class="dt">REML=</span>F)</span>
<span id="cb26-142"><a href="#cb26-142"></a>sum.beetle.vs.flower_twilight.aim2 &lt;-<span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.flower_twilight.aim2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.flower =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb26-143"><a href="#cb26-143"></a><span class="co">###reshape data for heatmap</span></span>
<span id="cb26-144"><a href="#cb26-144"></a>p1_twilight.aim2&lt;-sum.flower.vs.leaf_twilight.aim2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb26-145"><a href="#cb26-145"></a>p2_twilight.aim2&lt;-sum.beetle.vs.leaf_twilight.aim2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb26-146"><a href="#cb26-146"></a>p3_twilight.aim2&lt;-sum.beetle.vs.flower_twilight.aim2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb26-147"><a href="#cb26-147"></a></span>
<span id="cb26-148"><a href="#cb26-148"></a>VislistA_twilight.aim2&lt;-<span class="kw">c</span>(<span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 660&quot;</span>)</span>
<span id="cb26-149"><a href="#cb26-149"></a>VislistB_twilight.aim2&lt;-<span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>)</span>
<span id="cb26-150"><a href="#cb26-150"></a></span>
<span id="cb26-151"><a href="#cb26-151"></a>heat_twilight.aim2&lt;-<span class="kw">data.frame</span>(<span class="kw">names</span>(p1_twilight.aim2),<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p1_twilight.aim2,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-152"><a href="#cb26-152"></a><span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p2_twilight.aim2,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-153"><a href="#cb26-153"></a><span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p3_twilight.aim2,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb26-154"><a href="#cb26-154"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">orignial.list =</span> <span class="dv">1</span>, <span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-155"><a href="#cb26-155"></a><span class="st">  </span><span class="kw">cbind</span>(VislistA_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-156"><a href="#cb26-156"></a><span class="st">  </span><span class="kw">cbind</span>(VislistB_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-157"><a href="#cb26-157"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>orignial.list)</span>
<span id="cb26-158"><a href="#cb26-158"></a></span>
<span id="cb26-159"><a href="#cb26-159"></a><span class="co">##add asterisks for significant pairs</span></span>
<span id="cb26-160"><a href="#cb26-160"></a>heat_twilight.aim2<span class="op">$</span>sig.flower.vs.leaf[heat_twilight.aim2<span class="op">$</span>flower.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb26-161"><a href="#cb26-161"></a>heat_twilight.aim2<span class="op">$</span>sig.flower.vs.leaf[heat_twilight.aim2<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb26-162"><a href="#cb26-162"></a>heat_twilight.aim2<span class="op">$</span>sig.flower.vs.leaf[heat_twilight.aim2<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb26-163"><a href="#cb26-163"></a>heat_twilight.aim2<span class="op">$</span>sig.flower.vs.leaf[heat_twilight.aim2<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb26-164"><a href="#cb26-164"></a>heat_twilight.aim2<span class="op">$</span>sig.beetle.vs.leaf[heat_twilight.aim2<span class="op">$</span>beetle.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb26-165"><a href="#cb26-165"></a>heat_twilight.aim2<span class="op">$</span>sig.beetle.vs.leaf[heat_twilight.aim2<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb26-166"><a href="#cb26-166"></a>heat_twilight.aim2<span class="op">$</span>sig.beetle.vs.leaf[heat_twilight.aim2<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb26-167"><a href="#cb26-167"></a>heat_twilight.aim2<span class="op">$</span>sig.beetle.vs.leaf[heat_twilight.aim2<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb26-168"><a href="#cb26-168"></a>heat_twilight.aim2<span class="op">$</span>sig.beetle.vs.flower[heat_twilight.aim2<span class="op">$</span>beetle.vs.flower <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb26-169"><a href="#cb26-169"></a>heat_twilight.aim2<span class="op">$</span>sig.beetle.vs.flower[heat_twilight.aim2<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb26-170"><a href="#cb26-170"></a>heat_twilight.aim2<span class="op">$</span>sig.beetle.vs.flower[heat_twilight.aim2<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb26-171"><a href="#cb26-171"></a>heat_twilight.aim2<span class="op">$</span>sig.beetle.vs.flower[heat_twilight.aim2<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span></code></pre></div>
<div id="results-of-aim-1-comparing-visual-systems-with-different-photoreceptor-combinations" class="section level3 tabset tabset-fade tabset-pills">
<h3>Results of Aim 1: comparing visual systems with different photoreceptor combinations</h3>
<p></br></p>
<p>Click the tabs to see the results for each comparison group ( <strong>Flower vs. Leaf</strong> / <strong>Beetle vs. Leaf</strong> / <strong>Beetle vs. Flower</strong>) and under different light conditions ( <strong>Daylight</strong> / <strong>Twilight</strong>)</p>
<p></br></p>
<div id="flower-v.s-leaf" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Flower v.s Leaf</strong></h4>
<div id="daylight-2" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">Anova</span>(m.flower.vs.leaf_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:76%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.flower.vs.leaf</strong></td>
<td align="center">78.74</td>
<td align="center">3</td>
<td align="center">5.727e-17</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_d65.aim1, <span class="dt">y=</span>VislistB_d65.aim1, <span class="dt">fill=</span>flower.vs.leaf)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_d65.aim1, VislistB_d65.aim1, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(flower.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.flower.vs.leaf)))<span class="op">+</span></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb28-7"><a href="#cb28-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb28-8"><a href="#cb28-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb28-9"><a href="#cb28-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb28-10"><a href="#cb28-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb28-11"><a href="#cb28-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
<div id="original-model-output" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>sum.flower.vs.leaf_d65.aim1</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.flower.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.flower.vs.leaf.aim1, REML = F)
## 
## Linear Hypotheses:
##                                                                          Estimate
## contrast.UVSW..LW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0  0.33900
## contrast.UVSWMW...flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0 -0.14259
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0  0.20280
## contrast.UVSWMW...flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0 -0.48158
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0 -0.13620
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSWMW...flower.vs.leaf == 0  0.34539
##                                                                          Std. Error
## contrast.UVSW..LW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0    0.05889
## contrast.UVSWMW...flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0    0.05889
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0    0.05889
## contrast.UVSWMW...flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0    0.05889
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0    0.05889
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSWMW...flower.vs.leaf == 0    0.05889
##                                                                          z value
## contrast.UVSW..LW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0   5.756
## contrast.UVSWMW...flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0  -2.421
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0   3.444
## contrast.UVSWMW...flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0  -8.178
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0  -2.313
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSWMW...flower.vs.leaf == 0   5.865
##                                                                          Pr(&gt;|z|)
## contrast.UVSW..LW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0 5.16e-08
## contrast.UVSWMW...flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0  0.09281
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0  0.00344
## contrast.UVSWMW...flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0 1.33e-15
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0  0.12443
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSWMW...flower.vs.leaf == 0 2.70e-08
##                                                                             
## contrast.UVSW..LW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0 ***
## contrast.UVSWMW...flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0 .  
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0 ** 
## contrast.UVSWMW...flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0 ***
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0    
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSWMW...flower.vs.leaf == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-6" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">Anova</span>(m.flower.vs.leaf_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:76%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.flower.vs.leaf</strong></td>
<td align="center">816.2</td>
<td align="center">3</td>
<td align="center">1.324e-176</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-1" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.aim1, <span class="dt">y=</span>VislistB_twilight.aim1, <span class="dt">fill=</span>flower.vs.leaf)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.aim1, VislistB_twilight.aim1, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(flower.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.flower.vs.leaf)))<span class="op">+</span></span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span></span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb32-7"><a href="#cb32-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb32-8"><a href="#cb32-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb32-9"><a href="#cb32-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb32-10"><a href="#cb32-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb32-11"><a href="#cb32-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="original-model-output-1" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>sum.flower.vs.leaf_twilight.aim1</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.flower.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.flower.vs.leaf_twilight.aim1, REML = F)
## 
## Linear Hypotheses:
##                                                                                             Estimate
## contrast.UVSW..LW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0  0.034171
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0 -0.094219
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0  0.131353
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0 -0.128391
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0  0.097181
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSWMW...flower.vs.leaf_twilight == 0  0.225572
##                                                                                            Std. Error
## contrast.UVSW..LW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0   0.007986
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0   0.007986
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0   0.007986
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0   0.007986
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0   0.007986
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSWMW...flower.vs.leaf_twilight == 0   0.007986
##                                                                                            z value
## contrast.UVSW..LW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0   4.279
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0 -11.798
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0  16.448
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0 -16.077
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0  12.169
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSWMW...flower.vs.leaf_twilight == 0  28.246
##                                                                                            Pr(&gt;|z|)
## contrast.UVSW..LW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0 0.000113
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0  &lt; 2e-16
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0  &lt; 2e-16
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0  &lt; 2e-16
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0  &lt; 2e-16
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSWMW...flower.vs.leaf_twilight == 0  &lt; 2e-16
##                                                                                               
## contrast.UVSW..LW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0 ***
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0 ***
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0 ***
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0 ***
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0 ***
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSWMW...flower.vs.leaf_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
</div>
<div id="beetle-vs.-leaf" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Beetle vs. Leaf</strong></h4>
<div id="daylight-3" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">Anova</span>(m.beetle.vs.leaf_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:76%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.leaf</strong></td>
<td align="center">665.3</td>
<td align="center">3</td>
<td align="center">6.952e-144</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-2" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_d65.aim1, <span class="dt">y=</span>VislistB_d65.aim1, <span class="dt">fill=</span>beetle.vs.leaf)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_d65.aim1, VislistB_d65.aim1, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.leaf))) <span class="op">+</span></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span></span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb36-7"><a href="#cb36-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb36-8"><a href="#cb36-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb36-9"><a href="#cb36-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb36-10"><a href="#cb36-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb36-11"><a href="#cb36-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
<div id="original-model-output-2" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>sum.beetle.vs.leaf_d65.aim1</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.beetle.vs.leaf.aim1, REML = F)
## 
## Linear Hypotheses:
##                                                                          Estimate
## contrast.UVSW..LW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0  0.01198
## contrast.UVSWMW...beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0 -1.12974
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0 -0.01463
## contrast.UVSWMW...beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0 -1.14172
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0 -0.02661
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSWMW...beetle.vs.leaf == 0  1.11512
##                                                                          Std. Error
## contrast.UVSW..LW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0    0.05361
## contrast.UVSWMW...beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0    0.05361
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0    0.05361
## contrast.UVSWMW...beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0    0.05361
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0    0.05361
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSWMW...beetle.vs.leaf == 0    0.05361
##                                                                          z value
## contrast.UVSW..LW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0   0.224
## contrast.UVSWMW...beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0 -21.073
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0  -0.273
## contrast.UVSWMW...beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0 -21.297
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0  -0.496
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSWMW...beetle.vs.leaf == 0  20.800
##                                                                          Pr(&gt;|z|)
## contrast.UVSW..LW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0        1
## contrast.UVSWMW...beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0   &lt;2e-16
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0        1
## contrast.UVSWMW...beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0   &lt;2e-16
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0        1
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSWMW...beetle.vs.leaf == 0   &lt;2e-16
##                                                                             
## contrast.UVSW..LW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0    
## contrast.UVSWMW...beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0 ***
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0    
## contrast.UVSWMW...beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0 ***
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0    
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSWMW...beetle.vs.leaf == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-7" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">Anova</span>(m.beetle.vs.leaf_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:76%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.leaf</strong></td>
<td align="center">2010</td>
<td align="center">3</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-3" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.aim1, <span class="dt">y=</span>VislistB_twilight.aim1, <span class="dt">fill=</span>beetle.vs.leaf)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.aim1, VislistB_twilight.aim1, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.leaf))) <span class="op">+</span></span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span></span>
<span id="cb40-5"><a href="#cb40-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb40-6"><a href="#cb40-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb40-7"><a href="#cb40-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb40-8"><a href="#cb40-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb40-9"><a href="#cb40-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb40-10"><a href="#cb40-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb40-11"><a href="#cb40-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
<div id="original-model-output-3" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>sum.beetle.vs.leaf_twilight.aim1</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.beetle.vs.leaf_twilight.aim1, REML = F)
## 
## Linear Hypotheses:
##                                                                                             Estimate
## contrast.UVSW..LW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0 -0.007469
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0 -0.182602
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0  0.069963
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0 -0.175132
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0  0.077433
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSWMW...beetle.vs.leaf_twilight == 0  0.252565
##                                                                                            Std. Error
## contrast.UVSW..LW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0   0.005875
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0   0.005875
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0   0.005875
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0   0.005875
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0   0.005875
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSWMW...beetle.vs.leaf_twilight == 0   0.005875
##                                                                                            z value
## contrast.UVSW..LW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0  -1.271
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0 -31.083
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0  11.910
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0 -29.812
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0  13.181
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSWMW...beetle.vs.leaf_twilight == 0  42.993
##                                                                                            Pr(&gt;|z|)
## contrast.UVSW..LW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0        1
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0   &lt;2e-16
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0   &lt;2e-16
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0   &lt;2e-16
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0   &lt;2e-16
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSWMW...beetle.vs.leaf_twilight == 0   &lt;2e-16
##                                                                                               
## contrast.UVSW..LW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0    
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0 ***
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0 ***
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0 ***
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0 ***
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSWMW...beetle.vs.leaf_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
</div>
<div id="beetle-vs.-flower" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Beetle vs. Flower</strong></h4>
<div id="daylight-4" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw">Anova</span>(m.beetle.vs.flower_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:79%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="43%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.flower</strong></td>
<td align="center">115</td>
<td align="center">3</td>
<td align="center">9.263e-25</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-4" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_d65.aim1, <span class="dt">y=</span>VislistB_d65.aim1, <span class="dt">fill=</span>beetle.vs.flower)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_d65.aim1, VislistB_d65.aim1, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.flower, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.flower)))<span class="op">+</span></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour </span></span>
<span id="cb44-5"><a href="#cb44-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb44-6"><a href="#cb44-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb44-7"><a href="#cb44-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb44-8"><a href="#cb44-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb44-9"><a href="#cb44-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb44-10"><a href="#cb44-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb44-11"><a href="#cb44-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
</div>
<div id="original-model-output-4" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>sum.beetle.vs.flower_d65.aim1</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.flower + (1 | patch2) + 
##     (1 | patch1), data = compare.beetle.vs.flower.aim1, REML = F)
## 
## Linear Hypotheses:
##                                                                               Estimate
## contrast.UVSW..LW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0  0.638342
## contrast.UVSWMW...beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0  0.009374
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0  0.488655
## contrast.UVSWMW...beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0 -0.628968
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0 -0.149687
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSWMW...beetle.vs.flower == 0  0.479281
##                                                                              Std. Error
## contrast.UVSW..LW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0   0.075013
## contrast.UVSWMW...beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0   0.075013
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0   0.075013
## contrast.UVSWMW...beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0   0.075013
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0   0.075013
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSWMW...beetle.vs.flower == 0   0.075013
##                                                                              z value
## contrast.UVSW..LW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0   8.510
## contrast.UVSWMW...beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0   0.125
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0   6.514
## contrast.UVSWMW...beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0  -8.385
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0  -1.995
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSWMW...beetle.vs.flower == 0   6.389
##                                                                              Pr(&gt;|z|)
## contrast.UVSW..LW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0  &lt; 2e-16
## contrast.UVSWMW...beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0    1.000
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0 4.38e-10
## contrast.UVSWMW...beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0  &lt; 2e-16
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0    0.276
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSWMW...beetle.vs.flower == 0 1.00e-09
##                                                                                 
## contrast.UVSW..LW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0 ***
## contrast.UVSWMW...beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0    
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0 ***
## contrast.UVSWMW...beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0 ***
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0    
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSWMW...beetle.vs.flower == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-8" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">Anova</span>(m.beetle.vs.flower_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:79%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="43%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.flower</strong></td>
<td align="center">740.2</td>
<td align="center">3</td>
<td align="center">4.024e-160</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-5" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.aim1, <span class="dt">y=</span>VislistB_twilight.aim1, <span class="dt">fill=</span>beetle.vs.flower)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.aim1, VislistB_twilight.aim1, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.flower, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.flower)))<span class="op">+</span></span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span></span>
<span id="cb48-5"><a href="#cb48-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb48-6"><a href="#cb48-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb48-7"><a href="#cb48-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb48-8"><a href="#cb48-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb48-9"><a href="#cb48-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb48-10"><a href="#cb48-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb48-11"><a href="#cb48-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
<div id="original-model-output-5" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>sum.beetle.vs.flower_twilight.aim1</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.flower + (1 | patch2) + 
##     (1 | patch1), data = compare.beetle.vs.flower_twilight.aim1, 
##     REML = F)
## 
## Linear Hypotheses:
##                                                                                                Estimate
## contrast.UVSW..LW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0  0.08163
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0 -0.07569
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0  0.19101
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0 -0.15731
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0  0.10938
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSWMW...beetle.vs.flower_twilight == 0  0.26670
##                                                                                                Std. Error
## contrast.UVSW..LW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0    0.01029
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0    0.01029
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0    0.01029
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0    0.01029
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0    0.01029
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSWMW...beetle.vs.flower_twilight == 0    0.01029
##                                                                                                z value
## contrast.UVSW..LW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0   7.934
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0  -7.356
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0  18.565
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0 -15.290
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0  10.631
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSWMW...beetle.vs.flower_twilight == 0  25.921
##                                                                                                Pr(&gt;|z|)
## contrast.UVSW..LW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0 1.33e-14
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0 1.14e-12
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0  &lt; 2e-16
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0  &lt; 2e-16
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0  &lt; 2e-16
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSWMW...beetle.vs.flower_twilight == 0  &lt; 2e-16
##                                                                                                   
## contrast.UVSW..LW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0 ***
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0 ***
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0 ***
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0 ***
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0 ***
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSWMW...beetle.vs.flower_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
</div>
</div>
<div id="results-of-aim-2-comparing-visual-systems-with-different-lws-peak-sensitivities" class="section level3 tabset tabset-fade tabset-pills">
<h3>Results of Aim 2: comparing visual systems with different LWS peak sensitivities</h3>
<p></br></p>
<p>Click the tabs to see the results for each comparison group ( <strong>Flower vs. Leaf</strong> / <strong>Beetle vs. Leaf</strong> / <strong>Beetle vs. Flower</strong>) and under different light conditions ( <strong>Daylight</strong> / <strong>Twilight</strong>)</p>
<p></br></p>
<div id="flower-v.s-leaf-1" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Flower v.s Leaf</strong></h4>
<div id="daylight-5" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="kw">Anova</span>(m.flower.vs.leaf_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:76%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.flower.vs.leaf</strong></td>
<td align="center">11416</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-6" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_d65.aim2, <span class="dt">y=</span>VislistB_d65.aim2, <span class="dt">fill=</span>flower.vs.leaf)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_d65.aim2, VislistB_d65.aim2, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(flower.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.flower.vs.leaf)))<span class="op">+</span></span>
<span id="cb52-4"><a href="#cb52-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span></span>
<span id="cb52-5"><a href="#cb52-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb52-6"><a href="#cb52-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb52-7"><a href="#cb52-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb52-8"><a href="#cb52-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb52-9"><a href="#cb52-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb52-10"><a href="#cb52-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb52-11"><a href="#cb52-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
<div id="original-model-output-6" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>sum.flower.vs.leaf_d65.aim2</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.flower.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.flower.vs.leaf.aim2, REML = F)
## 
## Linear Hypotheses:
##                                                    Estimate Std. Error z value
## bup600.flower.vs.leaf - bup580.flower.vs.leaf == 0  0.42097    0.02129  19.771
## bup620.flower.vs.leaf - bup580.flower.vs.leaf == 0  1.17568    0.02129  55.216
## bup640.flower.vs.leaf - bup580.flower.vs.leaf == 0  1.80399    0.02129  84.724
## bup660.flower.vs.leaf - bup580.flower.vs.leaf == 0  1.76193    0.02129  82.749
## bup620.flower.vs.leaf - bup600.flower.vs.leaf == 0  0.75471    0.02129  35.445
## bup640.flower.vs.leaf - bup600.flower.vs.leaf == 0  1.38301    0.02129  64.953
## bup660.flower.vs.leaf - bup600.flower.vs.leaf == 0  1.34096    0.02129  62.978
## bup640.flower.vs.leaf - bup620.flower.vs.leaf == 0  0.62831    0.02129  29.508
## bup660.flower.vs.leaf - bup620.flower.vs.leaf == 0  0.58625    0.02129  27.533
## bup660.flower.vs.leaf - bup640.flower.vs.leaf == 0 -0.04206    0.02129  -1.975
##                                                    Pr(&gt;|z|)    
## bup600.flower.vs.leaf - bup580.flower.vs.leaf == 0   &lt;2e-16 ***
## bup620.flower.vs.leaf - bup580.flower.vs.leaf == 0   &lt;2e-16 ***
## bup640.flower.vs.leaf - bup580.flower.vs.leaf == 0   &lt;2e-16 ***
## bup660.flower.vs.leaf - bup580.flower.vs.leaf == 0   &lt;2e-16 ***
## bup620.flower.vs.leaf - bup600.flower.vs.leaf == 0   &lt;2e-16 ***
## bup640.flower.vs.leaf - bup600.flower.vs.leaf == 0   &lt;2e-16 ***
## bup660.flower.vs.leaf - bup600.flower.vs.leaf == 0   &lt;2e-16 ***
## bup640.flower.vs.leaf - bup620.flower.vs.leaf == 0   &lt;2e-16 ***
## bup660.flower.vs.leaf - bup620.flower.vs.leaf == 0   &lt;2e-16 ***
## bup660.flower.vs.leaf - bup640.flower.vs.leaf == 0    0.482    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-9" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="kw">Anova</span>(m.flower.vs.leaf_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:76%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.flower.vs.leaf</strong></td>
<td align="center">12966</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-7" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.aim2, <span class="dt">y=</span>VislistB_twilight.aim2, <span class="dt">fill=</span>flower.vs.leaf)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb56-3"><a href="#cb56-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.aim2, VislistB_twilight.aim2, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(flower.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.flower.vs.leaf)))<span class="op">+</span></span>
<span id="cb56-4"><a href="#cb56-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span></span>
<span id="cb56-5"><a href="#cb56-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb56-6"><a href="#cb56-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb56-7"><a href="#cb56-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb56-8"><a href="#cb56-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb56-9"><a href="#cb56-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb56-10"><a href="#cb56-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb56-11"><a href="#cb56-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
</div>
<div id="original-model-output-7" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>sum.flower.vs.leaf_twilight.aim2</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.flower.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.flower.vs.leaf_twilight.aim2, REML = F)
## 
## Linear Hypotheses:
##                                                                       Estimate
## bup600.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  0.095342
## bup620.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  0.237202
## bup640.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  0.322447
## bup660.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  0.259795
## bup620.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0  0.141860
## bup640.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0  0.227104
## bup660.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0  0.164453
## bup640.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0  0.085245
## bup660.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0  0.022593
## bup660.flower.vs.leaf_twilight - bup640.flower.vs.leaf_twilight == 0 -0.062651
##                                                                      Std. Error
## bup600.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0   0.003273
## bup620.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0   0.003273
## bup640.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0   0.003273
## bup660.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0   0.003273
## bup620.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0   0.003273
## bup640.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0   0.003273
## bup660.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0   0.003273
## bup640.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0   0.003273
## bup660.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0   0.003273
## bup660.flower.vs.leaf_twilight - bup640.flower.vs.leaf_twilight == 0   0.003273
##                                                                      z value
## bup600.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  29.129
## bup620.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  72.471
## bup640.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  98.515
## bup660.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  79.374
## bup620.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0  43.342
## bup640.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0  69.386
## bup660.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0  50.245
## bup640.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0  26.044
## bup660.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0   6.903
## bup660.flower.vs.leaf_twilight - bup640.flower.vs.leaf_twilight == 0 -19.141
##                                                                      Pr(&gt;|z|)
## bup600.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  &lt; 2e-16
## bup620.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  &lt; 2e-16
## bup640.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  &lt; 2e-16
## bup660.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  &lt; 2e-16
## bup620.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0  &lt; 2e-16
## bup640.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0  &lt; 2e-16
## bup660.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0  &lt; 2e-16
## bup640.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0  &lt; 2e-16
## bup660.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0  5.1e-11
## bup660.flower.vs.leaf_twilight - bup640.flower.vs.leaf_twilight == 0  &lt; 2e-16
##                                                                         
## bup600.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0 ***
## bup620.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0 ***
## bup640.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0 ***
## bup660.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0 ***
## bup620.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0 ***
## bup640.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0 ***
## bup660.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0 ***
## bup640.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0 ***
## bup660.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0 ***
## bup660.flower.vs.leaf_twilight - bup640.flower.vs.leaf_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
</div>
<div id="beetle-vs.-leaf-1" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Beetle vs. Leaf</strong></h4>
<div id="daylight-6" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="kw">Anova</span>(m.beetle.vs.leaf_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:76%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.leaf</strong></td>
<td align="center">10679</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-8" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_d65.aim2, <span class="dt">y=</span>VislistB_d65.aim2, <span class="dt">fill=</span>beetle.vs.leaf)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb60-3"><a href="#cb60-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_d65.aim2, VislistB_d65.aim2, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.leaf))) <span class="op">+</span></span>
<span id="cb60-4"><a href="#cb60-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span></span>
<span id="cb60-5"><a href="#cb60-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb60-6"><a href="#cb60-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb60-7"><a href="#cb60-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb60-8"><a href="#cb60-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb60-9"><a href="#cb60-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb60-10"><a href="#cb60-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb60-11"><a href="#cb60-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
</div>
<div id="original-model-output-8" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>sum.beetle.vs.leaf_d65.aim2</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.beetle.vs.leaf.aim2, REML = F)
## 
## Linear Hypotheses:
##                                                    Estimate Std. Error z value
## bup600.beetle.vs.leaf - bup580.beetle.vs.leaf == 0  0.57356    0.02202  26.044
## bup620.beetle.vs.leaf - bup580.beetle.vs.leaf == 0  1.22449    0.02202  55.602
## bup640.beetle.vs.leaf - bup580.beetle.vs.leaf == 0  1.72490    0.02202  78.324
## bup660.beetle.vs.leaf - bup580.beetle.vs.leaf == 0  1.93477    0.02202  87.854
## bup620.beetle.vs.leaf - bup600.beetle.vs.leaf == 0  0.65093    0.02202  29.558
## bup640.beetle.vs.leaf - bup600.beetle.vs.leaf == 0  1.15135    0.02202  52.280
## bup660.beetle.vs.leaf - bup600.beetle.vs.leaf == 0  1.36121    0.02202  61.810
## bup640.beetle.vs.leaf - bup620.beetle.vs.leaf == 0  0.50041    0.02202  22.723
## bup660.beetle.vs.leaf - bup620.beetle.vs.leaf == 0  0.71028    0.02202  32.252
## bup660.beetle.vs.leaf - bup640.beetle.vs.leaf == 0  0.20986    0.02202   9.529
##                                                    Pr(&gt;|z|)    
## bup600.beetle.vs.leaf - bup580.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup620.beetle.vs.leaf - bup580.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup640.beetle.vs.leaf - bup580.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup660.beetle.vs.leaf - bup580.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup620.beetle.vs.leaf - bup600.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup640.beetle.vs.leaf - bup600.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup660.beetle.vs.leaf - bup600.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup640.beetle.vs.leaf - bup620.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup660.beetle.vs.leaf - bup620.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup660.beetle.vs.leaf - bup640.beetle.vs.leaf == 0   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-10" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="kw">Anova</span>(m.beetle.vs.leaf_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:76%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.leaf</strong></td>
<td align="center">13400</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-9" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.aim2, <span class="dt">y=</span>VislistB_twilight.aim2, <span class="dt">fill=</span>beetle.vs.leaf)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb64-3"><a href="#cb64-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.aim2, VislistB_twilight.aim2, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.leaf))) <span class="op">+</span></span>
<span id="cb64-4"><a href="#cb64-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span></span>
<span id="cb64-5"><a href="#cb64-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb64-6"><a href="#cb64-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb64-7"><a href="#cb64-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb64-8"><a href="#cb64-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb64-9"><a href="#cb64-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb64-10"><a href="#cb64-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb64-11"><a href="#cb64-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
</div>
<div id="original-model-output-9" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>sum.beetle.vs.leaf_twilight.aim2</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.beetle.vs.leaf_twilight.aim2, REML = F)
## 
## Linear Hypotheses:
##                                                                       Estimate
## bup600.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0  0.096971
## bup620.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0  0.194605
## bup640.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0  0.254535
## bup660.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0  0.252436
## bup620.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0  0.097635
## bup640.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0  0.157565
## bup660.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0  0.155465
## bup640.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0  0.059930
## bup660.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0  0.057830
## bup660.beetle.vs.leaf_twilight - bup640.beetle.vs.leaf_twilight == 0 -0.002100
##                                                                      Std. Error
## bup600.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0   0.002684
## bup620.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0   0.002684
## bup640.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0   0.002684
## bup660.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0   0.002684
## bup620.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0   0.002684
## bup640.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0   0.002684
## bup660.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0   0.002684
## bup640.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0   0.002684
## bup660.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0   0.002684
## bup660.beetle.vs.leaf_twilight - bup640.beetle.vs.leaf_twilight == 0   0.002684
##                                                                      z value
## bup600.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0  36.135
## bup620.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0  72.517
## bup640.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0  94.849
## bup660.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0  94.067
## bup620.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0  36.382
## bup640.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0  58.714
## bup660.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0  57.932
## bup640.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0  22.332
## bup660.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0  21.550
## bup660.beetle.vs.leaf_twilight - bup640.beetle.vs.leaf_twilight == 0  -0.782
##                                                                      Pr(&gt;|z|)
## bup600.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0   &lt;2e-16
## bup620.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0   &lt;2e-16
## bup640.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0   &lt;2e-16
## bup660.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0   &lt;2e-16
## bup620.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0   &lt;2e-16
## bup640.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0   &lt;2e-16
## bup660.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0   &lt;2e-16
## bup640.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0   &lt;2e-16
## bup660.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0   &lt;2e-16
## bup660.beetle.vs.leaf_twilight - bup640.beetle.vs.leaf_twilight == 0        1
##                                                                         
## bup600.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0 ***
## bup620.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0 ***
## bup640.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0 ***
## bup660.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0 ***
## bup620.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0 ***
## bup640.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0 ***
## bup660.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0 ***
## bup640.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0 ***
## bup660.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0 ***
## bup660.beetle.vs.leaf_twilight - bup640.beetle.vs.leaf_twilight == 0    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
</div>
<div id="beetle-vs.-flower-1" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Beetle vs. Flower</strong></h4>
<div id="daylight-7" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="kw">Anova</span>(m.beetle.vs.flower_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:79%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="43%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.flower</strong></td>
<td align="center">3063</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-10" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_d65.aim2, <span class="dt">y=</span>VislistB_d65.aim2, <span class="dt">fill=</span>beetle.vs.flower)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb68-3"><a href="#cb68-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_d65.aim2, VislistB_d65.aim2, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.flower, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.flower)))<span class="op">+</span></span>
<span id="cb68-4"><a href="#cb68-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour </span></span>
<span id="cb68-5"><a href="#cb68-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb68-6"><a href="#cb68-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb68-7"><a href="#cb68-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb68-8"><a href="#cb68-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb68-9"><a href="#cb68-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb68-10"><a href="#cb68-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb68-11"><a href="#cb68-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
<div id="original-model-output-10" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>sum.beetle.vs.flower_d65.aim2</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.flower + (1 | patch2) + 
##     (1 | patch1), data = compare.beetle.vs.flower.aim2, REML = F)
## 
## Linear Hypotheses:
##                                                        Estimate Std. Error
## bup600.beetle.vs.flower - bup580.beetle.vs.flower == 0  0.37988    0.03138
## bup620.beetle.vs.flower - bup580.beetle.vs.flower == 0  0.84419    0.03138
## bup640.beetle.vs.flower - bup580.beetle.vs.flower == 0  1.22628    0.03138
## bup660.beetle.vs.flower - bup580.beetle.vs.flower == 0  1.51287    0.03138
## bup620.beetle.vs.flower - bup600.beetle.vs.flower == 0  0.46431    0.03138
## bup640.beetle.vs.flower - bup600.beetle.vs.flower == 0  0.84640    0.03138
## bup660.beetle.vs.flower - bup600.beetle.vs.flower == 0  1.13299    0.03138
## bup640.beetle.vs.flower - bup620.beetle.vs.flower == 0  0.38209    0.03138
## bup660.beetle.vs.flower - bup620.beetle.vs.flower == 0  0.66868    0.03138
## bup660.beetle.vs.flower - bup640.beetle.vs.flower == 0  0.28659    0.03138
##                                                        z value Pr(&gt;|z|)    
## bup600.beetle.vs.flower - bup580.beetle.vs.flower == 0  12.106   &lt;2e-16 ***
## bup620.beetle.vs.flower - bup580.beetle.vs.flower == 0  26.902   &lt;2e-16 ***
## bup640.beetle.vs.flower - bup580.beetle.vs.flower == 0  39.077   &lt;2e-16 ***
## bup660.beetle.vs.flower - bup580.beetle.vs.flower == 0  48.210   &lt;2e-16 ***
## bup620.beetle.vs.flower - bup600.beetle.vs.flower == 0  14.796   &lt;2e-16 ***
## bup640.beetle.vs.flower - bup600.beetle.vs.flower == 0  26.972   &lt;2e-16 ***
## bup660.beetle.vs.flower - bup600.beetle.vs.flower == 0  36.104   &lt;2e-16 ***
## bup640.beetle.vs.flower - bup620.beetle.vs.flower == 0  12.176   &lt;2e-16 ***
## bup660.beetle.vs.flower - bup620.beetle.vs.flower == 0  21.308   &lt;2e-16 ***
## bup660.beetle.vs.flower - bup640.beetle.vs.flower == 0   9.133   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-11" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="kw">Anova</span>(m.beetle.vs.flower_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:79%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="43%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.flower</strong></td>
<td align="center">4664</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-11" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.aim2, <span class="dt">y=</span>VislistB_twilight.aim2, <span class="dt">fill=</span>beetle.vs.flower)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb72-3"><a href="#cb72-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.aim2, VislistB_twilight.aim2,  <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.flower, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.flower)))<span class="op">+</span></span>
<span id="cb72-4"><a href="#cb72-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span></span>
<span id="cb72-5"><a href="#cb72-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb72-6"><a href="#cb72-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb72-7"><a href="#cb72-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb72-8"><a href="#cb72-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb72-9"><a href="#cb72-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb72-10"><a href="#cb72-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb72-11"><a href="#cb72-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="main_models_old-code_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
</div>
<div id="original-model-output-11" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>sum.beetle.vs.flower_twilight.aim2</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.flower + (1 | patch2) + 
##     (1 | patch1), data = compare.beetle.vs.flower_twilight.aim2, 
##     REML = F)
## 
## Linear Hypotheses:
##                                                                          Estimate
## bup600.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0 0.095085
## bup620.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0 0.197770
## bup640.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0 0.268343
## bup660.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0 0.296354
## bup620.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0 0.102686
## bup640.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0 0.173259
## bup660.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0 0.201269
## bup640.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0 0.070573
## bup660.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0 0.098583
## bup660.beetle.vs.flower_twilight - bup640.beetle.vs.flower_twilight == 0 0.028010
##                                                                          Std. Error
## bup600.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0   0.005111
## bup620.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0   0.005111
## bup640.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0   0.005111
## bup660.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0   0.005111
## bup620.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0   0.005111
## bup640.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0   0.005111
## bup660.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0   0.005111
## bup640.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0   0.005111
## bup660.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0   0.005111
## bup660.beetle.vs.flower_twilight - bup640.beetle.vs.flower_twilight == 0   0.005111
##                                                                          z value
## bup600.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0  18.605
## bup620.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0  38.697
## bup640.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0  52.505
## bup660.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0  57.986
## bup620.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0  20.092
## bup640.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0  33.901
## bup660.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0  39.381
## bup640.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0  13.809
## bup660.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0  19.289
## bup660.beetle.vs.flower_twilight - bup640.beetle.vs.flower_twilight == 0   5.481
##                                                                          Pr(&gt;|z|)
## bup600.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0  &lt; 2e-16
## bup620.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0  &lt; 2e-16
## bup640.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0  &lt; 2e-16
## bup660.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0  &lt; 2e-16
## bup620.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0  &lt; 2e-16
## bup640.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0  &lt; 2e-16
## bup660.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0  &lt; 2e-16
## bup640.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0  &lt; 2e-16
## bup660.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0  &lt; 2e-16
## bup660.beetle.vs.flower_twilight - bup640.beetle.vs.flower_twilight == 0 4.24e-07
##                                                                             
## bup600.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0 ***
## bup620.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0 ***
## bup640.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0 ***
## bup660.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0 ***
## bup620.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0 ***
## bup640.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0 ***
## bup660.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0 ***
## bup640.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0 ***
## bup660.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0 ***
## bup660.beetle.vs.flower_twilight - bup640.beetle.vs.flower_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="plot-the-contrasts" class="section level1 tabset tabset-fade tabset-pills">
<h1>Plot the contrasts</h1>
<ul>
<li>Colours approximate human perception of either flower (left and right) or beetle (centre) colouration.</li>
<li>Lines of the same colors connect the same sample</li>
</ul>
<p></br></p>
<div id="aim-1-3" class="section level2 tabset tabset-fade tabset-pills">
<h2>aim 1</h2>
<div id="daylight-8" class="section level3">
<h3>Daylight</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="co">#import the flower color code </span></span>
<span id="cb75-2"><a href="#cb75-2"></a>color.code&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;data/color code list.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) </span>
<span id="cb75-3"><a href="#cb75-3"></a></span>
<span id="cb75-4"><a href="#cb75-4"></a><span class="co">#create a list of species name used in the spec data and </span></span>
<span id="cb75-5"><a href="#cb75-5"></a>name.list&lt;-<span class="kw">unique</span>(dataset.transpose<span class="op">$</span>species) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-6"><a href="#cb75-6"></a><span class="st">  </span><span class="kw">sort</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#order it alphebatically as well</span></span>
<span id="cb75-7"><a href="#cb75-7"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">species =</span> <span class="st">&quot;.&quot;</span>)<span class="co">#make it a data frame and name the column &quot;species&quot;</span></span>
<span id="cb75-8"><a href="#cb75-8"></a></span>
<span id="cb75-9"><a href="#cb75-9"></a><span class="co">#create flower name list for aim 1</span></span>
<span id="cb75-10"><a href="#cb75-10"></a>flower.colour.aim1 &lt;-<span class="st"> </span>name.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(species, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower names</span></span>
<span id="cb75-11"><a href="#cb75-11"></a><span class="st">  </span><span class="kw">cbind</span>(color.code <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(type, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(name)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower color codes and order it alphebatically</span></span>
<span id="cb75-12"><a href="#cb75-12"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#remove the redundant column</span></span>
<span id="cb75-13"><a href="#cb75-13"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">uncount</span>(count) <span class="co">#repeat each row for 4 times for 4 visual systems</span></span>
<span id="cb75-14"><a href="#cb75-14"></a></span>
<span id="cb75-15"><a href="#cb75-15"></a><span class="co">#create beetle name list for aim 1</span></span>
<span id="cb75-16"><a href="#cb75-16"></a>beetle.colour.aim1 &lt;-<span class="st"> </span>name.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(species, <span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower names</span></span>
<span id="cb75-17"><a href="#cb75-17"></a><span class="st">  </span><span class="kw">cbind</span>(color.code <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(type, <span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(name)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower color codes and order it alphebatically</span></span>
<span id="cb75-18"><a href="#cb75-18"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#remove the redundant column</span></span>
<span id="cb75-19"><a href="#cb75-19"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">uncount</span>(count) <span class="co">#repeat each row for 4 times for 4 visual systems</span></span>
<span id="cb75-20"><a href="#cb75-20"></a></span>
<span id="cb75-21"><a href="#cb75-21"></a></span>
<span id="cb75-22"><a href="#cb75-22"></a></span>
<span id="cb75-23"><a href="#cb75-23"></a><span class="co">#make flower vs leaf plot</span></span>
<span id="cb75-24"><a href="#cb75-24"></a><span class="co">##add the mean</span></span>
<span id="cb75-25"><a href="#cb75-25"></a>mean.fl_d65.aim1 &lt;-<span class="st"> </span>allvis.fl_d65.aim1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-26"><a href="#cb75-26"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.fl_d65.aim1<span class="op">$</span>vissys,allvis.fl_d65.aim1<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-27"><a href="#cb75-27"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span></span>
<span id="cb75-28"><a href="#cb75-28"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-29"><a href="#cb75-29"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean.dS.fl =</span> <span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-30"><a href="#cb75-30"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb75-31"><a href="#cb75-31"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-32"><a href="#cb75-32"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb75-33"><a href="#cb75-33"></a></span>
<span id="cb75-34"><a href="#cb75-34"></a><span class="co">##plot the mean</span></span>
<span id="cb75-35"><a href="#cb75-35"></a><span class="kw">names</span>(mean.fl_d65.aim1)[<span class="kw">names</span>(mean.fl_d65.aim1) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span> </span>
<span id="cb75-36"><a href="#cb75-36"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb75-37"><a href="#cb75-37"></a>mean.fl_d65.aim1&lt;-mean.fl_d65.aim1[<span class="kw">order</span>(mean.fl_d65.aim1<span class="op">$</span>flowerID),] </span>
<span id="cb75-38"><a href="#cb75-38"></a><span class="co">#make the data frame order by flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb75-39"><a href="#cb75-39"></a></span>
<span id="cb75-40"><a href="#cb75-40"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb75-41"><a href="#cb75-41"></a>mean.fl_d65.aim1<span class="op">$</span>match.name&lt;-flower.colour.aim1<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb75-42"><a href="#cb75-42"></a>mean.fl_d65.aim1<span class="op">$</span>colour&lt;-flower.colour.aim1<span class="op">$</span>colour</span>
<span id="cb75-43"><a href="#cb75-43"></a></span>
<span id="cb75-44"><a href="#cb75-44"></a></span>
<span id="cb75-45"><a href="#cb75-45"></a>fl_d65.aim1&lt;-<span class="kw">ggplot</span>(mean.fl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.fl,<span class="dt">group=</span>flowerID))<span class="op">+</span></span>
<span id="cb75-46"><a href="#cb75-46"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.fl_d65.aim1<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb75-47"><a href="#cb75-47"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.fl_d65.aim1<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb75-48"><a href="#cb75-48"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb75-49"><a href="#cb75-49"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb75-50"><a href="#cb75-50"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">21</span>)<span class="op">+</span></span>
<span id="cb75-51"><a href="#cb75-51"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb75-52"><a href="#cb75-52"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span></span>
<span id="cb75-53"><a href="#cb75-53"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb75-54"><a href="#cb75-54"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle=</span><span class="dv">90</span>),</span>
<span id="cb75-55"><a href="#cb75-55"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb75-56"><a href="#cb75-56"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb75-57"><a href="#cb75-57"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb75-58"><a href="#cb75-58"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb75-59"><a href="#cb75-59"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb75-60"><a href="#cb75-60"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb75-61"><a href="#cb75-61"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb75-62"><a href="#cb75-62"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb75-63"><a href="#cb75-63"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>),</span>
<span id="cb75-64"><a href="#cb75-64"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;USM&quot;</span>, <span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USML&quot;</span>))<span class="op">+</span></span>
<span id="cb75-65"><a href="#cb75-65"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.fl_d65.aim1<span class="op">$</span>dS)), </span>
<span id="cb75-66"><a href="#cb75-66"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb75-67"><a href="#cb75-67"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.fl_d65.aim1<span class="op">$</span>dS)), </span>
<span id="cb75-68"><a href="#cb75-68"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb75-69"><a href="#cb75-69"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.fl_d65.aim1<span class="op">$</span>dS)), </span>
<span id="cb75-70"><a href="#cb75-70"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb75-71"><a href="#cb75-71"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.fl_d65.aim1<span class="op">$</span>dS)), </span>
<span id="cb75-72"><a href="#cb75-72"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb75-73"><a href="#cb75-73"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb75-74"><a href="#cb75-74"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Flower vs. Leaf&quot;</span>)<span class="op">+</span></span>
<span id="cb75-75"><a href="#cb75-75"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>), <span class="dt">y =</span> <span class="dv">21</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;b&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb75-76"><a href="#cb75-76"></a></span>
<span id="cb75-77"><a href="#cb75-77"></a></span>
<span id="cb75-78"><a href="#cb75-78"></a></span>
<span id="cb75-79"><a href="#cb75-79"></a><span class="co">#make beetle vs leaf plot</span></span>
<span id="cb75-80"><a href="#cb75-80"></a><span class="co">##add the mean</span></span>
<span id="cb75-81"><a href="#cb75-81"></a>mean.bl_d65.aim1&lt;-allvis.bl_d65.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bl_d65.aim1<span class="op">$</span>vissys,allvis.bl_d65.aim1<span class="op">$</span>patch2,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-82"><a href="#cb75-82"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch2(beetles) and vissys</span></span>
<span id="cb75-83"><a href="#cb75-83"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-84"><a href="#cb75-84"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb75-85"><a href="#cb75-85"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-86"><a href="#cb75-86"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb75-87"><a href="#cb75-87"></a></span>
<span id="cb75-88"><a href="#cb75-88"></a><span class="co">##plot the mean</span></span>
<span id="cb75-89"><a href="#cb75-89"></a><span class="kw">names</span>(mean.bl_d65.aim1)[<span class="kw">names</span>(mean.bl_d65.aim1) <span class="op">==</span><span class="st"> &quot;patch2&quot;</span>] &lt;-<span class="st"> &quot;beetleID&quot;</span></span>
<span id="cb75-90"><a href="#cb75-90"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb75-91"><a href="#cb75-91"></a>mean.bl_d65.aim1&lt;-mean.bl_d65.aim1[<span class="kw">order</span>(mean.bl_d65.aim1<span class="op">$</span>beetleID),]</span>
<span id="cb75-92"><a href="#cb75-92"></a><span class="co">#make the data frame order bt beetleID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb75-93"><a href="#cb75-93"></a></span>
<span id="cb75-94"><a href="#cb75-94"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb75-95"><a href="#cb75-95"></a>mean.bl_d65.aim1<span class="op">$</span>match.name&lt;-beetle.colour.aim1<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb75-96"><a href="#cb75-96"></a>mean.bl_d65.aim1<span class="op">$</span>colour&lt;-beetle.colour.aim1<span class="op">$</span>colour</span>
<span id="cb75-97"><a href="#cb75-97"></a></span>
<span id="cb75-98"><a href="#cb75-98"></a></span>
<span id="cb75-99"><a href="#cb75-99"></a>bl_d65.aim1&lt;-<span class="kw">ggplot</span>(mean.bl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bl,<span class="dt">group=</span>beetleID))<span class="op">+</span></span>
<span id="cb75-100"><a href="#cb75-100"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bl_d65.aim1<span class="op">$</span>colour, <span class="dt">size=</span><span class="dv">1</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb75-101"><a href="#cb75-101"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bl_d65.aim1<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb75-102"><a href="#cb75-102"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb75-103"><a href="#cb75-103"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb75-104"><a href="#cb75-104"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">21</span>)<span class="op">+</span></span>
<span id="cb75-105"><a href="#cb75-105"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb75-106"><a href="#cb75-106"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb75-107"><a href="#cb75-107"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle=</span><span class="dv">90</span>),</span>
<span id="cb75-108"><a href="#cb75-108"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb75-109"><a href="#cb75-109"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb75-110"><a href="#cb75-110"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb75-111"><a href="#cb75-111"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb75-112"><a href="#cb75-112"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb75-113"><a href="#cb75-113"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb75-114"><a href="#cb75-114"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb75-115"><a href="#cb75-115"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb75-116"><a href="#cb75-116"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>),</span>
<span id="cb75-117"><a href="#cb75-117"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;USM&quot;</span>, <span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USML&quot;</span>))<span class="op">+</span></span>
<span id="cb75-118"><a href="#cb75-118"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bl_d65.aim1<span class="op">$</span>dS)), </span>
<span id="cb75-119"><a href="#cb75-119"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb75-120"><a href="#cb75-120"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bl_d65.aim1<span class="op">$</span>dS)), </span>
<span id="cb75-121"><a href="#cb75-121"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb75-122"><a href="#cb75-122"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bl_d65.aim1<span class="op">$</span>dS)), </span>
<span id="cb75-123"><a href="#cb75-123"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb75-124"><a href="#cb75-124"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bl_d65.aim1<span class="op">$</span>dS)), </span>
<span id="cb75-125"><a href="#cb75-125"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb75-126"><a href="#cb75-126"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb75-127"><a href="#cb75-127"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Leaf&quot;</span>)<span class="op">+</span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>), <span class="dt">y =</span> <span class="dv">21</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;b&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb75-128"><a href="#cb75-128"></a></span>
<span id="cb75-129"><a href="#cb75-129"></a></span>
<span id="cb75-130"><a href="#cb75-130"></a><span class="co">#make beetle vs flower plot</span></span>
<span id="cb75-131"><a href="#cb75-131"></a><span class="co">##add the mean</span></span>
<span id="cb75-132"><a href="#cb75-132"></a>mean.bf_d65.aim1&lt;-allvis.bf_d65.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bf_d65.aim1<span class="op">$</span>vissys,allvis.bf_d65.aim1<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-133"><a href="#cb75-133"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span></span>
<span id="cb75-134"><a href="#cb75-134"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#patch1(flowers</span></span>
<span id="cb75-135"><a href="#cb75-135"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb75-136"><a href="#cb75-136"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-137"><a href="#cb75-137"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb75-138"><a href="#cb75-138"></a></span>
<span id="cb75-139"><a href="#cb75-139"></a><span class="co">##plot the mean</span></span>
<span id="cb75-140"><a href="#cb75-140"></a><span class="kw">names</span>(mean.bf_d65.aim1)[<span class="kw">names</span>(mean.bf_d65.aim1) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span></span>
<span id="cb75-141"><a href="#cb75-141"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb75-142"><a href="#cb75-142"></a>mean.bf_d65.aim1&lt;-mean.bf_d65.aim1[<span class="kw">order</span>(mean.bf_d65.aim1<span class="op">$</span>flowerID),]</span>
<span id="cb75-143"><a href="#cb75-143"></a><span class="co">#make the data frame order bt flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb75-144"><a href="#cb75-144"></a></span>
<span id="cb75-145"><a href="#cb75-145"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb75-146"><a href="#cb75-146"></a>mean.bf_d65.aim1<span class="op">$</span>match.name&lt;-flower.colour.aim1<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb75-147"><a href="#cb75-147"></a>mean.bf_d65.aim1<span class="op">$</span>colour&lt;-flower.colour.aim1<span class="op">$</span>colour</span>
<span id="cb75-148"><a href="#cb75-148"></a></span>
<span id="cb75-149"><a href="#cb75-149"></a>bf_d65.aim1&lt;-<span class="kw">ggplot</span>(mean.bf_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bf,<span class="dt">group=</span>flowerID))<span class="op">+</span></span>
<span id="cb75-150"><a href="#cb75-150"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bf_d65.aim1<span class="op">$</span>colour, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb75-151"><a href="#cb75-151"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bf_d65.aim1<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb75-152"><a href="#cb75-152"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb75-153"><a href="#cb75-153"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb75-154"><a href="#cb75-154"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">21</span>)<span class="op">+</span></span>
<span id="cb75-155"><a href="#cb75-155"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb75-156"><a href="#cb75-156"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>),<span class="co">#make the backfround empty: panel.background = element_blank()</span></span>
<span id="cb75-157"><a href="#cb75-157"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb75-158"><a href="#cb75-158"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle=</span><span class="dv">90</span>),</span>
<span id="cb75-159"><a href="#cb75-159"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb75-160"><a href="#cb75-160"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb75-161"><a href="#cb75-161"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb75-162"><a href="#cb75-162"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb75-163"><a href="#cb75-163"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb75-164"><a href="#cb75-164"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb75-165"><a href="#cb75-165"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb75-166"><a href="#cb75-166"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb75-167"><a href="#cb75-167"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>),</span>
<span id="cb75-168"><a href="#cb75-168"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;USM&quot;</span>, <span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USML&quot;</span>))<span class="op">+</span></span>
<span id="cb75-169"><a href="#cb75-169"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bf_d65.aim1<span class="op">$</span>dS)), </span>
<span id="cb75-170"><a href="#cb75-170"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb75-171"><a href="#cb75-171"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bf_d65.aim1<span class="op">$</span>dS)), </span>
<span id="cb75-172"><a href="#cb75-172"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb75-173"><a href="#cb75-173"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bf_d65.aim1<span class="op">$</span>dS)), </span>
<span id="cb75-174"><a href="#cb75-174"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb75-175"><a href="#cb75-175"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bf_d65.aim1<span class="op">$</span>dS)), </span>
<span id="cb75-176"><a href="#cb75-176"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb75-177"><a href="#cb75-177"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb75-178"><a href="#cb75-178"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Flower&quot;</span>)<span class="op">+</span></span>
<span id="cb75-179"><a href="#cb75-179"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>), <span class="dt">y =</span> <span class="dv">21</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;b&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb75-180"><a href="#cb75-180"></a></span>
<span id="cb75-181"><a href="#cb75-181"></a><span class="co">#plot the contrasts from the 3 comparison groups together</span></span>
<span id="cb75-182"><a href="#cb75-182"></a>figure_d65.aim1 &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(fl_d65.aim1,bl_d65.aim1,bf_d65.aim1, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb75-183"><a href="#cb75-183"></a>figure_d65.aim1</span></code></pre></div>
<div class="figure">
<img src="main_models_old-code_files/figure-html/unnamed-chunk-60-1.png" alt="Figure caption: Comparison of chromatic contrast for visual systems with different photoreceptor combinations. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Three contrasts &gt; 10 JND are from flowers that have high UV - blue chroma compared to beetles and leaves." width="672" />
<p class="caption">
Figure caption: Comparison of chromatic contrast for visual systems with different photoreceptor combinations. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Three contrasts &gt; 10 JND are from flowers that have high UV - blue chroma compared to beetles and leaves.
</p>
</div>
</div>
<div id="twilight-12" class="section level3">
<h3>Twilight</h3>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="co">#make flower vs leaf plot</span></span>
<span id="cb76-2"><a href="#cb76-2"></a><span class="co">##add the mean</span></span>
<span id="cb76-3"><a href="#cb76-3"></a>mean.fl_twilight.aim1&lt;-allvis.fl_twilight.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.fl_twilight.aim1<span class="op">$</span>vissys,allvis.fl_twilight.aim1<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-4"><a href="#cb76-4"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span></span>
<span id="cb76-5"><a href="#cb76-5"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.fl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-6"><a href="#cb76-6"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb76-7"><a href="#cb76-7"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-8"><a href="#cb76-8"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb76-9"><a href="#cb76-9"></a></span>
<span id="cb76-10"><a href="#cb76-10"></a><span class="co">##plot the mean</span></span>
<span id="cb76-11"><a href="#cb76-11"></a><span class="kw">names</span>(mean.fl_twilight.aim1)[<span class="kw">names</span>(mean.fl_twilight.aim1) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span> </span>
<span id="cb76-12"><a href="#cb76-12"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb76-13"><a href="#cb76-13"></a>mean.fl_twilight.aim1&lt;-mean.fl_twilight.aim1[<span class="kw">order</span>(mean.fl_twilight.aim1<span class="op">$</span>flowerID),] </span>
<span id="cb76-14"><a href="#cb76-14"></a><span class="co">#make the data frame order by flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb76-15"><a href="#cb76-15"></a></span>
<span id="cb76-16"><a href="#cb76-16"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb76-17"><a href="#cb76-17"></a>mean.fl_twilight.aim1<span class="op">$</span>match.name&lt;-flower.colour.aim1<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb76-18"><a href="#cb76-18"></a>mean.fl_twilight.aim1<span class="op">$</span>colour&lt;-flower.colour.aim1<span class="op">$</span>colour</span>
<span id="cb76-19"><a href="#cb76-19"></a></span>
<span id="cb76-20"><a href="#cb76-20"></a></span>
<span id="cb76-21"><a href="#cb76-21"></a>fl_twilight.aim1&lt;-<span class="kw">ggplot</span>(mean.fl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.fl,<span class="dt">group=</span>flowerID))<span class="op">+</span></span>
<span id="cb76-22"><a href="#cb76-22"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.fl_twilight.aim1<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb76-23"><a href="#cb76-23"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.fl_twilight.aim1<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb76-24"><a href="#cb76-24"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb76-25"><a href="#cb76-25"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb76-26"><a href="#cb76-26"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb76-27"><a href="#cb76-27"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb76-28"><a href="#cb76-28"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span></span>
<span id="cb76-29"><a href="#cb76-29"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb76-30"><a href="#cb76-30"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle=</span><span class="dv">90</span>),</span>
<span id="cb76-31"><a href="#cb76-31"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb76-32"><a href="#cb76-32"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb76-33"><a href="#cb76-33"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb76-34"><a href="#cb76-34"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb76-35"><a href="#cb76-35"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb76-36"><a href="#cb76-36"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb76-37"><a href="#cb76-37"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb76-38"><a href="#cb76-38"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb76-39"><a href="#cb76-39"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>),</span>
<span id="cb76-40"><a href="#cb76-40"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;USM&quot;</span>, <span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USML&quot;</span>))<span class="op">+</span></span>
<span id="cb76-41"><a href="#cb76-41"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.fl_twilight.aim1<span class="op">$</span>dS)), </span>
<span id="cb76-42"><a href="#cb76-42"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb76-43"><a href="#cb76-43"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.fl_twilight.aim1<span class="op">$</span>dS)), </span>
<span id="cb76-44"><a href="#cb76-44"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb76-45"><a href="#cb76-45"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.fl_twilight.aim1<span class="op">$</span>dS)), </span>
<span id="cb76-46"><a href="#cb76-46"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb76-47"><a href="#cb76-47"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.fl_twilight.aim1<span class="op">$</span>dS)), </span>
<span id="cb76-48"><a href="#cb76-48"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb76-49"><a href="#cb76-49"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb76-50"><a href="#cb76-50"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Flower vs. Leaf&quot;</span>)<span class="op">+</span></span>
<span id="cb76-51"><a href="#cb76-51"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>), <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb76-52"><a href="#cb76-52"></a></span>
<span id="cb76-53"><a href="#cb76-53"></a></span>
<span id="cb76-54"><a href="#cb76-54"></a><span class="co">#make beetle vs leaf plot</span></span>
<span id="cb76-55"><a href="#cb76-55"></a><span class="co">##add the mean</span></span>
<span id="cb76-56"><a href="#cb76-56"></a>mean.bl_twilight.aim1&lt;-allvis.bl_twilight.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bl_twilight.aim1<span class="op">$</span>vissys,allvis.bl_twilight.aim1<span class="op">$</span>patch2,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-57"><a href="#cb76-57"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch2(beetles) and vissys</span></span>
<span id="cb76-58"><a href="#cb76-58"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-59"><a href="#cb76-59"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb76-60"><a href="#cb76-60"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-61"><a href="#cb76-61"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb76-62"><a href="#cb76-62"></a></span>
<span id="cb76-63"><a href="#cb76-63"></a><span class="co">##plot the mean</span></span>
<span id="cb76-64"><a href="#cb76-64"></a><span class="kw">names</span>(mean.bl_twilight.aim1)[<span class="kw">names</span>(mean.bl_twilight.aim1) <span class="op">==</span><span class="st"> &quot;patch2&quot;</span>] &lt;-<span class="st"> &quot;beetleID&quot;</span></span>
<span id="cb76-65"><a href="#cb76-65"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb76-66"><a href="#cb76-66"></a>mean.bl_twilight.aim1&lt;-mean.bl_twilight.aim1[<span class="kw">order</span>(mean.bl_twilight.aim1<span class="op">$</span>beetleID),]</span>
<span id="cb76-67"><a href="#cb76-67"></a><span class="co">#make the data frame order bt beetleID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb76-68"><a href="#cb76-68"></a></span>
<span id="cb76-69"><a href="#cb76-69"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb76-70"><a href="#cb76-70"></a>mean.bl_twilight.aim1<span class="op">$</span>match.name&lt;-beetle.colour.aim1<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb76-71"><a href="#cb76-71"></a>mean.bl_twilight.aim1<span class="op">$</span>colour&lt;-beetle.colour.aim1<span class="op">$</span>colour</span>
<span id="cb76-72"><a href="#cb76-72"></a></span>
<span id="cb76-73"><a href="#cb76-73"></a></span>
<span id="cb76-74"><a href="#cb76-74"></a>bl_twilight.aim1&lt;-<span class="kw">ggplot</span>(mean.bl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bl,<span class="dt">group=</span>beetleID))<span class="op">+</span></span>
<span id="cb76-75"><a href="#cb76-75"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bl_twilight.aim1<span class="op">$</span>colour, <span class="dt">size=</span><span class="dv">1</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb76-76"><a href="#cb76-76"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bl_twilight.aim1<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb76-77"><a href="#cb76-77"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb76-78"><a href="#cb76-78"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb76-79"><a href="#cb76-79"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb76-80"><a href="#cb76-80"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb76-81"><a href="#cb76-81"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb76-82"><a href="#cb76-82"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle=</span><span class="dv">90</span>),</span>
<span id="cb76-83"><a href="#cb76-83"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb76-84"><a href="#cb76-84"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb76-85"><a href="#cb76-85"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb76-86"><a href="#cb76-86"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb76-87"><a href="#cb76-87"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb76-88"><a href="#cb76-88"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb76-89"><a href="#cb76-89"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb76-90"><a href="#cb76-90"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb76-91"><a href="#cb76-91"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>),</span>
<span id="cb76-92"><a href="#cb76-92"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;USM&quot;</span>, <span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USML&quot;</span>))<span class="op">+</span></span>
<span id="cb76-93"><a href="#cb76-93"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bl_twilight.aim1<span class="op">$</span>dS)), </span>
<span id="cb76-94"><a href="#cb76-94"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb76-95"><a href="#cb76-95"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bl_twilight.aim1<span class="op">$</span>dS)), </span>
<span id="cb76-96"><a href="#cb76-96"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb76-97"><a href="#cb76-97"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bl_twilight.aim1<span class="op">$</span>dS)), </span>
<span id="cb76-98"><a href="#cb76-98"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb76-99"><a href="#cb76-99"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bl_twilight.aim1<span class="op">$</span>dS)), </span>
<span id="cb76-100"><a href="#cb76-100"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb76-101"><a href="#cb76-101"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb76-102"><a href="#cb76-102"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Leaf&quot;</span>)<span class="op">+</span></span>
<span id="cb76-103"><a href="#cb76-103"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>), <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb76-104"><a href="#cb76-104"></a></span>
<span id="cb76-105"><a href="#cb76-105"></a></span>
<span id="cb76-106"><a href="#cb76-106"></a></span>
<span id="cb76-107"><a href="#cb76-107"></a><span class="co">#make beetle vs flower plot</span></span>
<span id="cb76-108"><a href="#cb76-108"></a><span class="co">##add the mean</span></span>
<span id="cb76-109"><a href="#cb76-109"></a>mean.bf_twilight.aim1&lt;-allvis.bf_twilight.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bf_twilight.aim1<span class="op">$</span>vissys,allvis.bf_twilight.aim1<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-110"><a href="#cb76-110"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span></span>
<span id="cb76-111"><a href="#cb76-111"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#patch1(flowers</span></span>
<span id="cb76-112"><a href="#cb76-112"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb76-113"><a href="#cb76-113"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-114"><a href="#cb76-114"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb76-115"><a href="#cb76-115"></a></span>
<span id="cb76-116"><a href="#cb76-116"></a><span class="co">##plot the mean</span></span>
<span id="cb76-117"><a href="#cb76-117"></a><span class="kw">names</span>(mean.bf_twilight.aim1)[<span class="kw">names</span>(mean.bf_twilight.aim1) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span></span>
<span id="cb76-118"><a href="#cb76-118"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb76-119"><a href="#cb76-119"></a>mean.bf_twilight.aim1&lt;-mean.bf_twilight.aim1[<span class="kw">order</span>(mean.bf_twilight.aim1<span class="op">$</span>flowerID),]</span>
<span id="cb76-120"><a href="#cb76-120"></a><span class="co">#make the data frame order bt flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb76-121"><a href="#cb76-121"></a></span>
<span id="cb76-122"><a href="#cb76-122"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb76-123"><a href="#cb76-123"></a>mean.bf_twilight.aim1<span class="op">$</span>match.name&lt;-flower.colour.aim1<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb76-124"><a href="#cb76-124"></a>mean.bf_twilight.aim1<span class="op">$</span>colour&lt;-flower.colour.aim1<span class="op">$</span>colour</span>
<span id="cb76-125"><a href="#cb76-125"></a></span>
<span id="cb76-126"><a href="#cb76-126"></a>bf_twilight.aim1&lt;-<span class="kw">ggplot</span>(mean.bf_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bf,<span class="dt">group=</span>flowerID))<span class="op">+</span></span>
<span id="cb76-127"><a href="#cb76-127"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bf_twilight.aim1<span class="op">$</span>colour, <span class="dt">size=</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb76-128"><a href="#cb76-128"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bf_twilight.aim1<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb76-129"><a href="#cb76-129"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb76-130"><a href="#cb76-130"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb76-131"><a href="#cb76-131"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb76-132"><a href="#cb76-132"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb76-133"><a href="#cb76-133"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>),<span class="co">#make the backfround empty: panel.background = element_blank()</span></span>
<span id="cb76-134"><a href="#cb76-134"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb76-135"><a href="#cb76-135"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle=</span><span class="dv">90</span>),</span>
<span id="cb76-136"><a href="#cb76-136"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb76-137"><a href="#cb76-137"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb76-138"><a href="#cb76-138"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb76-139"><a href="#cb76-139"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb76-140"><a href="#cb76-140"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb76-141"><a href="#cb76-141"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb76-142"><a href="#cb76-142"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb76-143"><a href="#cb76-143"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb76-144"><a href="#cb76-144"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>),</span>
<span id="cb76-145"><a href="#cb76-145"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;USM&quot;</span>, <span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USML&quot;</span>))<span class="op">+</span></span>
<span id="cb76-146"><a href="#cb76-146"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bf_twilight.aim1<span class="op">$</span>dS)), </span>
<span id="cb76-147"><a href="#cb76-147"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb76-148"><a href="#cb76-148"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bf_twilight.aim1<span class="op">$</span>dS)), </span>
<span id="cb76-149"><a href="#cb76-149"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb76-150"><a href="#cb76-150"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bf_twilight.aim1<span class="op">$</span>dS)), </span>
<span id="cb76-151"><a href="#cb76-151"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb76-152"><a href="#cb76-152"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bf_twilight.aim1<span class="op">$</span>dS)), </span>
<span id="cb76-153"><a href="#cb76-153"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb76-154"><a href="#cb76-154"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb76-155"><a href="#cb76-155"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Flower&quot;</span>)<span class="op">+</span></span>
<span id="cb76-156"><a href="#cb76-156"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>), <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb76-157"><a href="#cb76-157"></a></span>
<span id="cb76-158"><a href="#cb76-158"></a></span>
<span id="cb76-159"><a href="#cb76-159"></a></span>
<span id="cb76-160"><a href="#cb76-160"></a><span class="co">#plot the contrasts from the 3 comparison groups together</span></span>
<span id="cb76-161"><a href="#cb76-161"></a>figure_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(fl_twilight.aim1,bl_twilight.aim1,bf_twilight.aim1, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb76-162"><a href="#cb76-162"></a>figure_twilight.aim1</span></code></pre></div>
<div class="figure">
<img src="main_models_old-code_files/figure-html/unnamed-chunk-61-1.png" alt="Figure caption: Comparison of chromatic contrast for visual systems with different photoreceptor combinations under civil twilight illumination. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1." width="672" />
<p class="caption">
Figure caption: Comparison of chromatic contrast for visual systems with different photoreceptor combinations under civil twilight illumination. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1.
</p>
</div>
</div>
</div>
<div id="aim-2-3" class="section level2 tabset tabset-fade tabset-pills">
<h2>Aim 2</h2>
<div id="daylight-9" class="section level3">
<h3>Daylight</h3>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="co">#creat flower name list for Aim 2</span></span>
<span id="cb77-2"><a href="#cb77-2"></a>flower.colour.aim2 &lt;-<span class="st"> </span>name.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(species, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower names</span></span>
<span id="cb77-3"><a href="#cb77-3"></a><span class="st">  </span><span class="kw">cbind</span>(color.code <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(type, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(name)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower color codes and order it alphebatically</span></span>
<span id="cb77-4"><a href="#cb77-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#remove the redundant column</span></span>
<span id="cb77-5"><a href="#cb77-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">uncount</span>(count) <span class="co">#repeat each row for 5 times for 5 visual systems</span></span>
<span id="cb77-6"><a href="#cb77-6"></a></span>
<span id="cb77-7"><a href="#cb77-7"></a><span class="co">#creat beetle name list for Aim 2</span></span>
<span id="cb77-8"><a href="#cb77-8"></a>beetle.colour.aim2 &lt;-<span class="st"> </span>name.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(species, <span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower names</span></span>
<span id="cb77-9"><a href="#cb77-9"></a><span class="st">  </span><span class="kw">cbind</span>(color.code <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(type, <span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(name)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower color codes and order it alphebatically</span></span>
<span id="cb77-10"><a href="#cb77-10"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#remove the redundant column</span></span>
<span id="cb77-11"><a href="#cb77-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">uncount</span>(count) <span class="co">#repeat each row for 5 times for 5 visual systems</span></span>
<span id="cb77-12"><a href="#cb77-12"></a></span>
<span id="cb77-13"><a href="#cb77-13"></a></span>
<span id="cb77-14"><a href="#cb77-14"></a><span class="co">#make flower vs leaf plot</span></span>
<span id="cb77-15"><a href="#cb77-15"></a><span class="co">##add the mean</span></span>
<span id="cb77-16"><a href="#cb77-16"></a>mean.fl_d65.aim2&lt;-allvis.fl_d65.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.fl_d65.aim2<span class="op">$</span>vissys,allvis.fl_d65.aim2<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-17"><a href="#cb77-17"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span></span>
<span id="cb77-18"><a href="#cb77-18"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.fl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-19"><a href="#cb77-19"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb77-20"><a href="#cb77-20"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-21"><a href="#cb77-21"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb77-22"><a href="#cb77-22"></a></span>
<span id="cb77-23"><a href="#cb77-23"></a><span class="co">##plot the mean</span></span>
<span id="cb77-24"><a href="#cb77-24"></a><span class="kw">names</span>(mean.fl_d65.aim2)[<span class="kw">names</span>(mean.fl_d65.aim2) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span> </span>
<span id="cb77-25"><a href="#cb77-25"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb77-26"><a href="#cb77-26"></a>mean.fl_d65.aim2&lt;-mean.fl_d65.aim2[<span class="kw">order</span>(mean.fl_d65.aim2<span class="op">$</span>flowerID),] </span>
<span id="cb77-27"><a href="#cb77-27"></a><span class="co">#make the data frame order by flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb77-28"><a href="#cb77-28"></a></span>
<span id="cb77-29"><a href="#cb77-29"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb77-30"><a href="#cb77-30"></a>mean.fl_d65.aim2<span class="op">$</span>match.name&lt;-flower.colour.aim2<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb77-31"><a href="#cb77-31"></a>mean.fl_d65.aim2<span class="op">$</span>colour&lt;-flower.colour.aim2<span class="op">$</span>colour</span>
<span id="cb77-32"><a href="#cb77-32"></a></span>
<span id="cb77-33"><a href="#cb77-33"></a>fl_d65.aim2&lt;-<span class="kw">ggplot</span>(mean.fl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.fl,<span class="dt">group=</span>flowerID))<span class="op">+</span></span>
<span id="cb77-34"><a href="#cb77-34"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.fl_d65.aim2<span class="op">$</span>colour,<span class="dt">size=</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb77-35"><a href="#cb77-35"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.fl_d65.aim2<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb77-36"><a href="#cb77-36"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb77-37"><a href="#cb77-37"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb77-38"><a href="#cb77-38"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb77-39"><a href="#cb77-39"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb77-40"><a href="#cb77-40"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span></span>
<span id="cb77-41"><a href="#cb77-41"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb77-42"><a href="#cb77-42"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),</span>
<span id="cb77-43"><a href="#cb77-43"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb77-44"><a href="#cb77-44"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb77-45"><a href="#cb77-45"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb77-46"><a href="#cb77-46"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb77-47"><a href="#cb77-47"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb77-48"><a href="#cb77-48"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb77-49"><a href="#cb77-49"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb77-50"><a href="#cb77-50"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb77-51"><a href="#cb77-51"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>,<span class="st">&quot;VS5.fl&quot;</span>),</span>
<span id="cb77-52"><a href="#cb77-52"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span></span>
<span id="cb77-53"><a href="#cb77-53"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.fl_d65.aim2<span class="op">$</span>dS)), </span>
<span id="cb77-54"><a href="#cb77-54"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb77-55"><a href="#cb77-55"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.fl_d65.aim2<span class="op">$</span>dS)), </span>
<span id="cb77-56"><a href="#cb77-56"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb77-57"><a href="#cb77-57"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.fl_d65.aim2<span class="op">$</span>dS)), </span>
<span id="cb77-58"><a href="#cb77-58"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb77-59"><a href="#cb77-59"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.fl_d65.aim2<span class="op">$</span>dS)), </span>
<span id="cb77-60"><a href="#cb77-60"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb77-61"><a href="#cb77-61"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.fl_d65.aim2<span class="op">$</span>dS)), </span>
<span id="cb77-62"><a href="#cb77-62"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb77-63"><a href="#cb77-63"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb77-64"><a href="#cb77-64"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Flower vs. Leaf&quot;</span>)<span class="op">+</span></span>
<span id="cb77-65"><a href="#cb77-65"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>,<span class="st">&quot;VS5.fl&quot;</span>), <span class="dt">y =</span> <span class="dv">20</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;d&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb77-66"><a href="#cb77-66"></a></span>
<span id="cb77-67"><a href="#cb77-67"></a></span>
<span id="cb77-68"><a href="#cb77-68"></a><span class="co">#make beetle vs leaf plot</span></span>
<span id="cb77-69"><a href="#cb77-69"></a><span class="co">##add the mean</span></span>
<span id="cb77-70"><a href="#cb77-70"></a>mean.bl_d65.aim2&lt;-allvis.bl_d65.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bl_d65.aim2<span class="op">$</span>vissys,allvis.bl_d65.aim2<span class="op">$</span>patch2,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-71"><a href="#cb77-71"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch2(beetles) and vissys</span></span>
<span id="cb77-72"><a href="#cb77-72"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-73"><a href="#cb77-73"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb77-74"><a href="#cb77-74"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-75"><a href="#cb77-75"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb77-76"><a href="#cb77-76"></a></span>
<span id="cb77-77"><a href="#cb77-77"></a><span class="co">##plot the mean</span></span>
<span id="cb77-78"><a href="#cb77-78"></a><span class="kw">names</span>(mean.bl_d65.aim2)[<span class="kw">names</span>(mean.bl_d65.aim2) <span class="op">==</span><span class="st"> &quot;patch2&quot;</span>] &lt;-<span class="st"> &quot;beetleID&quot;</span></span>
<span id="cb77-79"><a href="#cb77-79"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb77-80"><a href="#cb77-80"></a>mean.bl_d65.aim2&lt;-mean.bl_d65.aim2[<span class="kw">order</span>(mean.bl_d65.aim2<span class="op">$</span>beetleID),]</span>
<span id="cb77-81"><a href="#cb77-81"></a><span class="co">#make the data frame order bt beetleID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb77-82"><a href="#cb77-82"></a></span>
<span id="cb77-83"><a href="#cb77-83"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb77-84"><a href="#cb77-84"></a>mean.bl_d65.aim2<span class="op">$</span>match.name&lt;-beetle.colour.aim2<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb77-85"><a href="#cb77-85"></a>mean.bl_d65.aim2<span class="op">$</span>colour&lt;-beetle.colour.aim2<span class="op">$</span>colour</span>
<span id="cb77-86"><a href="#cb77-86"></a></span>
<span id="cb77-87"><a href="#cb77-87"></a></span>
<span id="cb77-88"><a href="#cb77-88"></a>bl_d65.aim2&lt;-<span class="kw">ggplot</span>(mean.bl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bl,<span class="dt">group=</span>beetleID))<span class="op">+</span></span>
<span id="cb77-89"><a href="#cb77-89"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bl_d65.aim2<span class="op">$</span>colour,<span class="dt">size=</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb77-90"><a href="#cb77-90"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bl_d65.aim2<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb77-91"><a href="#cb77-91"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb77-92"><a href="#cb77-92"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb77-93"><a href="#cb77-93"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb77-94"><a href="#cb77-94"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb77-95"><a href="#cb77-95"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb77-96"><a href="#cb77-96"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),</span>
<span id="cb77-97"><a href="#cb77-97"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb77-98"><a href="#cb77-98"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb77-99"><a href="#cb77-99"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb77-100"><a href="#cb77-100"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb77-101"><a href="#cb77-101"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb77-102"><a href="#cb77-102"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb77-103"><a href="#cb77-103"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb77-104"><a href="#cb77-104"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb77-105"><a href="#cb77-105"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>,<span class="st">&quot;VS5.bl&quot;</span>),</span>
<span id="cb77-106"><a href="#cb77-106"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span></span>
<span id="cb77-107"><a href="#cb77-107"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bl_d65.aim2<span class="op">$</span>dS)), </span>
<span id="cb77-108"><a href="#cb77-108"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb77-109"><a href="#cb77-109"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bl_d65.aim2<span class="op">$</span>dS)), </span>
<span id="cb77-110"><a href="#cb77-110"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb77-111"><a href="#cb77-111"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bl_d65.aim2<span class="op">$</span>dS)), </span>
<span id="cb77-112"><a href="#cb77-112"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb77-113"><a href="#cb77-113"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bl_d65.aim2<span class="op">$</span>dS)), </span>
<span id="cb77-114"><a href="#cb77-114"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb77-115"><a href="#cb77-115"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.bl_d65.aim2<span class="op">$</span>dS)), </span>
<span id="cb77-116"><a href="#cb77-116"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb77-117"><a href="#cb77-117"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb77-118"><a href="#cb77-118"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Leaf&quot;</span>)<span class="op">+</span></span>
<span id="cb77-119"><a href="#cb77-119"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>,<span class="st">&quot;VS5.bl&quot;</span>), <span class="dt">y =</span> <span class="dv">20</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb77-120"><a href="#cb77-120"></a></span>
<span id="cb77-121"><a href="#cb77-121"></a></span>
<span id="cb77-122"><a href="#cb77-122"></a><span class="co">#make beetle vs flower plot</span></span>
<span id="cb77-123"><a href="#cb77-123"></a><span class="co">##add the mean</span></span>
<span id="cb77-124"><a href="#cb77-124"></a>mean.bf_d65.aim2&lt;-allvis.bf_d65.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bf_d65.aim2<span class="op">$</span>vissys,allvis.bf_d65.aim2<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-125"><a href="#cb77-125"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span></span>
<span id="cb77-126"><a href="#cb77-126"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#patch1(flowers</span></span>
<span id="cb77-127"><a href="#cb77-127"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb77-128"><a href="#cb77-128"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-129"><a href="#cb77-129"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb77-130"><a href="#cb77-130"></a></span>
<span id="cb77-131"><a href="#cb77-131"></a></span>
<span id="cb77-132"><a href="#cb77-132"></a><span class="co">##plot the mean dS</span></span>
<span id="cb77-133"><a href="#cb77-133"></a><span class="kw">names</span>(mean.bf_d65.aim2)[<span class="kw">names</span>(mean.bf_d65.aim2) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span></span>
<span id="cb77-134"><a href="#cb77-134"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb77-135"><a href="#cb77-135"></a>mean.bf_d65.aim2&lt;-mean.bf_d65.aim2[<span class="kw">order</span>(mean.bf_d65.aim2<span class="op">$</span>flowerID),]</span>
<span id="cb77-136"><a href="#cb77-136"></a><span class="co">#make the data frame order bt flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb77-137"><a href="#cb77-137"></a></span>
<span id="cb77-138"><a href="#cb77-138"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb77-139"><a href="#cb77-139"></a>mean.bf_d65.aim2<span class="op">$</span>match.name&lt;-flower.colour.aim2<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb77-140"><a href="#cb77-140"></a>mean.bf_d65.aim2<span class="op">$</span>colour&lt;-flower.colour.aim2<span class="op">$</span>colour</span>
<span id="cb77-141"><a href="#cb77-141"></a></span>
<span id="cb77-142"><a href="#cb77-142"></a>bf_d65.aim2&lt;-<span class="kw">ggplot</span>(mean.bf_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bf,<span class="dt">group=</span>flowerID))<span class="op">+</span></span>
<span id="cb77-143"><a href="#cb77-143"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bf_d65.aim2<span class="op">$</span>colour, <span class="dt">size=</span> <span class="dv">1</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb77-144"><a href="#cb77-144"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bf_d65.aim2<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb77-145"><a href="#cb77-145"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb77-146"><a href="#cb77-146"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb77-147"><a href="#cb77-147"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb77-148"><a href="#cb77-148"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb77-149"><a href="#cb77-149"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span></span>
<span id="cb77-150"><a href="#cb77-150"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb77-151"><a href="#cb77-151"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),</span>
<span id="cb77-152"><a href="#cb77-152"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb77-153"><a href="#cb77-153"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb77-154"><a href="#cb77-154"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb77-155"><a href="#cb77-155"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb77-156"><a href="#cb77-156"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb77-157"><a href="#cb77-157"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb77-158"><a href="#cb77-158"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb77-159"><a href="#cb77-159"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb77-160"><a href="#cb77-160"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>,<span class="st">&quot;VS5.bf&quot;</span>),</span>
<span id="cb77-161"><a href="#cb77-161"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span></span>
<span id="cb77-162"><a href="#cb77-162"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bf_d65.aim2<span class="op">$</span>dS)), </span>
<span id="cb77-163"><a href="#cb77-163"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb77-164"><a href="#cb77-164"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bf_d65.aim2<span class="op">$</span>dS)), </span>
<span id="cb77-165"><a href="#cb77-165"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb77-166"><a href="#cb77-166"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bf_d65.aim2<span class="op">$</span>dS)), </span>
<span id="cb77-167"><a href="#cb77-167"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb77-168"><a href="#cb77-168"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bf_d65.aim2<span class="op">$</span>dS)), </span>
<span id="cb77-169"><a href="#cb77-169"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb77-170"><a href="#cb77-170"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.bf_d65.aim2<span class="op">$</span>dS)), </span>
<span id="cb77-171"><a href="#cb77-171"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb77-172"><a href="#cb77-172"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb77-173"><a href="#cb77-173"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Flower&quot;</span>)<span class="op">+</span></span>
<span id="cb77-174"><a href="#cb77-174"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>,<span class="st">&quot;VS5.bf&quot;</span>), <span class="dt">y =</span> <span class="dv">20</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb77-175"><a href="#cb77-175"></a></span>
<span id="cb77-176"><a href="#cb77-176"></a>figure_d65.aim2 &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(fl_d65.aim2,bl_d65.aim2,bf_d65.aim2, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb77-177"><a href="#cb77-177"></a>figure_d65.aim2</span></code></pre></div>
<div class="figure">
<img src="main_models_old-code_files/figure-html/unnamed-chunk-62-1.png" alt="Figure caption: Comparison of chromatic contrast between visual systems with the LWS photoreceptor peaking at different wavelengths. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Three contrasts &gt; 10 JND are from flowers that have high UV - blue chroma compared to beetles and leaves." width="672" />
<p class="caption">
Figure caption: Comparison of chromatic contrast between visual systems with the LWS photoreceptor peaking at different wavelengths. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Three contrasts &gt; 10 JND are from flowers that have high UV - blue chroma compared to beetles and leaves.
</p>
</div>
</div>
<div id="twilight-13" class="section level3">
<h3>Twilight</h3>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="co">#make flower vs leaf plot</span></span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="co">##add the mean</span></span>
<span id="cb78-3"><a href="#cb78-3"></a>mean.fl_twilight.aim2&lt;-allvis.fl_twilight.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.fl_twilight.aim2<span class="op">$</span>vissys,allvis.fl_twilight.aim2<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-4"><a href="#cb78-4"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span></span>
<span id="cb78-5"><a href="#cb78-5"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.fl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-6"><a href="#cb78-6"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb78-7"><a href="#cb78-7"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-8"><a href="#cb78-8"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb78-9"><a href="#cb78-9"></a></span>
<span id="cb78-10"><a href="#cb78-10"></a><span class="co">##plot the mean</span></span>
<span id="cb78-11"><a href="#cb78-11"></a><span class="kw">names</span>(mean.fl_twilight.aim2)[<span class="kw">names</span>(mean.fl_twilight.aim2) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span> </span>
<span id="cb78-12"><a href="#cb78-12"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb78-13"><a href="#cb78-13"></a>mean.fl_twilight.aim2&lt;-mean.fl_twilight.aim2[<span class="kw">order</span>(mean.fl_twilight.aim2<span class="op">$</span>flowerID),] </span>
<span id="cb78-14"><a href="#cb78-14"></a><span class="co">#make the data frame order by flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb78-15"><a href="#cb78-15"></a></span>
<span id="cb78-16"><a href="#cb78-16"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb78-17"><a href="#cb78-17"></a>mean.fl_twilight.aim2<span class="op">$</span>match.name&lt;-flower.colour.aim2<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb78-18"><a href="#cb78-18"></a>mean.fl_twilight.aim2<span class="op">$</span>colour&lt;-flower.colour.aim2<span class="op">$</span>colour</span>
<span id="cb78-19"><a href="#cb78-19"></a></span>
<span id="cb78-20"><a href="#cb78-20"></a>fl_twilight.aim2&lt;-<span class="kw">ggplot</span>(mean.fl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.fl,<span class="dt">group=</span>flowerID))<span class="op">+</span></span>
<span id="cb78-21"><a href="#cb78-21"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.fl_twilight.aim2<span class="op">$</span>colour,<span class="dt">size=</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb78-22"><a href="#cb78-22"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.fl_twilight.aim2<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb78-23"><a href="#cb78-23"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb78-24"><a href="#cb78-24"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb78-25"><a href="#cb78-25"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb78-26"><a href="#cb78-26"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb78-27"><a href="#cb78-27"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the background empty: panel.background = element_blank()</span></span>
<span id="cb78-28"><a href="#cb78-28"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb78-29"><a href="#cb78-29"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),</span>
<span id="cb78-30"><a href="#cb78-30"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb78-31"><a href="#cb78-31"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb78-32"><a href="#cb78-32"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb78-33"><a href="#cb78-33"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb78-34"><a href="#cb78-34"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb78-35"><a href="#cb78-35"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb78-36"><a href="#cb78-36"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb78-37"><a href="#cb78-37"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb78-38"><a href="#cb78-38"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>,<span class="st">&quot;VS5.fl&quot;</span>),</span>
<span id="cb78-39"><a href="#cb78-39"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span></span>
<span id="cb78-40"><a href="#cb78-40"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.fl_twilight.aim2<span class="op">$</span>dS)), </span>
<span id="cb78-41"><a href="#cb78-41"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb78-42"><a href="#cb78-42"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.fl_twilight.aim2<span class="op">$</span>dS)), </span>
<span id="cb78-43"><a href="#cb78-43"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb78-44"><a href="#cb78-44"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.fl_twilight.aim2<span class="op">$</span>dS)), </span>
<span id="cb78-45"><a href="#cb78-45"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb78-46"><a href="#cb78-46"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.fl_twilight.aim2<span class="op">$</span>dS)), </span>
<span id="cb78-47"><a href="#cb78-47"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb78-48"><a href="#cb78-48"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.fl_twilight.aim2<span class="op">$</span>dS)), </span>
<span id="cb78-49"><a href="#cb78-49"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb78-50"><a href="#cb78-50"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb78-51"><a href="#cb78-51"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Flower vs. Leaf&quot;</span>)<span class="op">+</span></span>
<span id="cb78-52"><a href="#cb78-52"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>,<span class="st">&quot;VS5.fl&quot;</span>), <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb78-53"><a href="#cb78-53"></a></span>
<span id="cb78-54"><a href="#cb78-54"></a></span>
<span id="cb78-55"><a href="#cb78-55"></a><span class="co">#make beetle vs leaf plot</span></span>
<span id="cb78-56"><a href="#cb78-56"></a><span class="co">##add the mean</span></span>
<span id="cb78-57"><a href="#cb78-57"></a>mean.bl_twilight.aim2&lt;-allvis.bl_twilight.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bl_twilight.aim2<span class="op">$</span>vissys,allvis.bl_twilight.aim2<span class="op">$</span>patch2,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-58"><a href="#cb78-58"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch2(beetles) and vissys</span></span>
<span id="cb78-59"><a href="#cb78-59"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-60"><a href="#cb78-60"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb78-61"><a href="#cb78-61"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-62"><a href="#cb78-62"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb78-63"><a href="#cb78-63"></a></span>
<span id="cb78-64"><a href="#cb78-64"></a><span class="co">##plot the mean</span></span>
<span id="cb78-65"><a href="#cb78-65"></a><span class="kw">names</span>(mean.bl_twilight.aim2)[<span class="kw">names</span>(mean.bl_twilight.aim2) <span class="op">==</span><span class="st"> &quot;patch2&quot;</span>] &lt;-<span class="st"> &quot;beetleID&quot;</span></span>
<span id="cb78-66"><a href="#cb78-66"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb78-67"><a href="#cb78-67"></a>mean.bl_twilight.aim2&lt;-mean.bl_twilight.aim2[<span class="kw">order</span>(mean.bl_twilight.aim2<span class="op">$</span>beetleID),]</span>
<span id="cb78-68"><a href="#cb78-68"></a><span class="co">#make the data frame order bt beetleID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb78-69"><a href="#cb78-69"></a></span>
<span id="cb78-70"><a href="#cb78-70"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb78-71"><a href="#cb78-71"></a>mean.bl_twilight.aim2<span class="op">$</span>match.name&lt;-beetle.colour.aim2<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb78-72"><a href="#cb78-72"></a>mean.bl_twilight.aim2<span class="op">$</span>colour&lt;-beetle.colour.aim2<span class="op">$</span>colour</span>
<span id="cb78-73"><a href="#cb78-73"></a></span>
<span id="cb78-74"><a href="#cb78-74"></a></span>
<span id="cb78-75"><a href="#cb78-75"></a>bl_twilight.aim2&lt;-<span class="kw">ggplot</span>(mean.bl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bl,<span class="dt">group=</span>beetleID))<span class="op">+</span></span>
<span id="cb78-76"><a href="#cb78-76"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bl_twilight.aim2<span class="op">$</span>colour,<span class="dt">size=</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb78-77"><a href="#cb78-77"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bl_twilight.aim2<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb78-78"><a href="#cb78-78"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb78-79"><a href="#cb78-79"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb78-80"><a href="#cb78-80"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb78-81"><a href="#cb78-81"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb78-82"><a href="#cb78-82"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb78-83"><a href="#cb78-83"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),</span>
<span id="cb78-84"><a href="#cb78-84"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb78-85"><a href="#cb78-85"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb78-86"><a href="#cb78-86"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb78-87"><a href="#cb78-87"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb78-88"><a href="#cb78-88"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb78-89"><a href="#cb78-89"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb78-90"><a href="#cb78-90"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb78-91"><a href="#cb78-91"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb78-92"><a href="#cb78-92"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>,<span class="st">&quot;VS5.bl&quot;</span>),</span>
<span id="cb78-93"><a href="#cb78-93"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span></span>
<span id="cb78-94"><a href="#cb78-94"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bl_twilight.aim2<span class="op">$</span>dS)), </span>
<span id="cb78-95"><a href="#cb78-95"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb78-96"><a href="#cb78-96"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bl_twilight.aim2<span class="op">$</span>dS)), </span>
<span id="cb78-97"><a href="#cb78-97"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb78-98"><a href="#cb78-98"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bl_twilight.aim2<span class="op">$</span>dS)), </span>
<span id="cb78-99"><a href="#cb78-99"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb78-100"><a href="#cb78-100"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bl_twilight.aim2<span class="op">$</span>dS)), </span>
<span id="cb78-101"><a href="#cb78-101"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb78-102"><a href="#cb78-102"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.bl_twilight.aim2<span class="op">$</span>dS)), </span>
<span id="cb78-103"><a href="#cb78-103"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb78-104"><a href="#cb78-104"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb78-105"><a href="#cb78-105"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Leaf&quot;</span>)<span class="op">+</span></span>
<span id="cb78-106"><a href="#cb78-106"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>,<span class="st">&quot;VS5.bl&quot;</span>), <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;d&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb78-107"><a href="#cb78-107"></a></span>
<span id="cb78-108"><a href="#cb78-108"></a></span>
<span id="cb78-109"><a href="#cb78-109"></a><span class="co">#make beetle vs flower plot</span></span>
<span id="cb78-110"><a href="#cb78-110"></a><span class="co">##add the mean</span></span>
<span id="cb78-111"><a href="#cb78-111"></a>mean.bf_twilight.aim2&lt;-allvis.bf_twilight.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bf_twilight.aim2<span class="op">$</span>vissys,allvis.bf_twilight.aim2<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-112"><a href="#cb78-112"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span></span>
<span id="cb78-113"><a href="#cb78-113"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#patch1(flowers</span></span>
<span id="cb78-114"><a href="#cb78-114"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb78-115"><a href="#cb78-115"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-116"><a href="#cb78-116"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb78-117"><a href="#cb78-117"></a></span>
<span id="cb78-118"><a href="#cb78-118"></a></span>
<span id="cb78-119"><a href="#cb78-119"></a><span class="co">##plot the mean dS</span></span>
<span id="cb78-120"><a href="#cb78-120"></a><span class="kw">names</span>(mean.bf_twilight.aim2)[<span class="kw">names</span>(mean.bf_twilight.aim2) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span></span>
<span id="cb78-121"><a href="#cb78-121"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb78-122"><a href="#cb78-122"></a>mean.bf_twilight.aim2&lt;-mean.bf_twilight.aim2[<span class="kw">order</span>(mean.bf_twilight.aim2<span class="op">$</span>flowerID),]</span>
<span id="cb78-123"><a href="#cb78-123"></a><span class="co">#make the data frame order bt flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb78-124"><a href="#cb78-124"></a></span>
<span id="cb78-125"><a href="#cb78-125"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb78-126"><a href="#cb78-126"></a>mean.bf_twilight.aim2<span class="op">$</span>match.name&lt;-flower.colour.aim2<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb78-127"><a href="#cb78-127"></a>mean.bf_twilight.aim2<span class="op">$</span>colour&lt;-flower.colour.aim2<span class="op">$</span>colour</span>
<span id="cb78-128"><a href="#cb78-128"></a></span>
<span id="cb78-129"><a href="#cb78-129"></a>bf_twilight.aim2&lt;-<span class="kw">ggplot</span>(mean.bf_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bf,<span class="dt">group=</span>flowerID))<span class="op">+</span></span>
<span id="cb78-130"><a href="#cb78-130"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bf_twilight.aim2<span class="op">$</span>colour, <span class="dt">size=</span> <span class="dv">1</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb78-131"><a href="#cb78-131"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bf_twilight.aim2<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb78-132"><a href="#cb78-132"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb78-133"><a href="#cb78-133"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb78-134"><a href="#cb78-134"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb78-135"><a href="#cb78-135"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb78-136"><a href="#cb78-136"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span></span>
<span id="cb78-137"><a href="#cb78-137"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb78-138"><a href="#cb78-138"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),</span>
<span id="cb78-139"><a href="#cb78-139"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb78-140"><a href="#cb78-140"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb78-141"><a href="#cb78-141"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb78-142"><a href="#cb78-142"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb78-143"><a href="#cb78-143"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb78-144"><a href="#cb78-144"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb78-145"><a href="#cb78-145"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb78-146"><a href="#cb78-146"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb78-147"><a href="#cb78-147"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>,<span class="st">&quot;VS5.bf&quot;</span>),</span>
<span id="cb78-148"><a href="#cb78-148"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span></span>
<span id="cb78-149"><a href="#cb78-149"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bf_twilight.aim2<span class="op">$</span>dS)), </span>
<span id="cb78-150"><a href="#cb78-150"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb78-151"><a href="#cb78-151"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bf_twilight.aim2<span class="op">$</span>dS)), </span>
<span id="cb78-152"><a href="#cb78-152"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb78-153"><a href="#cb78-153"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bf_twilight.aim2<span class="op">$</span>dS)), </span>
<span id="cb78-154"><a href="#cb78-154"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb78-155"><a href="#cb78-155"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bf_twilight.aim2<span class="op">$</span>dS)), </span>
<span id="cb78-156"><a href="#cb78-156"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb78-157"><a href="#cb78-157"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.bf_twilight.aim2<span class="op">$</span>dS)), </span>
<span id="cb78-158"><a href="#cb78-158"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb78-159"><a href="#cb78-159"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb78-160"><a href="#cb78-160"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Flower&quot;</span>)<span class="op">+</span></span>
<span id="cb78-161"><a href="#cb78-161"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>,<span class="st">&quot;VS5.bf&quot;</span>), <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb78-162"><a href="#cb78-162"></a></span>
<span id="cb78-163"><a href="#cb78-163"></a>figure_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(fl_twilight.aim2,bl_twilight.aim2,bf_twilight.aim2, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb78-164"><a href="#cb78-164"></a>figure_twilight.aim2</span></code></pre></div>
<div class="figure">
<img src="main_models_old-code_files/figure-html/unnamed-chunk-63-1.png" alt="Figure caption: Comparison of chromatic contrast between visual systems with the LWS photoreceptor peaking at different wavelengths under civil twilight illumination. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1." width="672" />
<p class="caption">
Figure caption: Comparison of chromatic contrast between visual systems with the LWS photoreceptor peaking at different wavelengths under civil twilight illumination. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1.
</p>
</div>
</div>
</div>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<ul>
<li>Visual models using hypothetical insect visual systems indicate that having both SWS and LWS receptors enhances the contrast of beetles with flowers and flowers with leaves, and a LWS receptor enhances the contrast of beetles against leaves. </br> </br></li>
<li>The optimal peak sensitivity of the LWS photoreceptor depends on what is being viewed. When comparing beetle colours with both leaves and flowers, contrast increases with increasing LWS λmax up to 660 nm; whereas when comparing flowers against leaves, contrast stops increasing beyond 640 nm. </br> </br></li>
<li>The contrasts of the models using civil twilight were substantially lower (often &lt; 1 JND) than those using daylight. The contrasts in twilight showed different patterns from those using daylight in Aim 1 models, but were qualitatively similar in Aim 2 models.</li>
</ul>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
