<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Opsin-shifted LWS photoreceptors: Visual models using opsin-shifted LWS receptors instead of filter-shifted LWS receptors in Main models</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Overview</a>
</li>
<li>
  <a href="main_models.html">Main models</a>
</li>
<li>
  <a href="even_spacing.html">Even spacing</a>
</li>
<li>
  <a href="opsin_shifed_models.html">Opsin-shifted visual systems</a>
</li>
<li>
  <a href="sensitivity_analysis.html">Sensitivity analysis</a>
</li>
<li>
  <a href="behavioural_assay.html">Behavioural assay</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Opsin-shifted LWS photoreceptors: Visual models using opsin-shifted LWS receptors instead of filter-shifted LWS receptors in Main models</h1>
<h3 class="subtitle">Supplementary Information</h3>

</div>


<div id="the-aim" class="section level1">
<h1>The aim</h1>
<ul>
<li><p>We tested how the LWS photoreceptors generated (opsin-shifted vs. filter-shifted) using different methods affect the contrasts.</p></li>
<li><p>In the following sections, we ran the same models as in the <a href="main_models.html">Main models</a> but using the opsin-shifted LWS receptors for comparison.</p></li>
<li><p>The model parameters and the statistical methods remain the same as described in the <a href="main_models.html">Main models</a>. </br> </br></p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Load R libraries </span>
<span class="kw">library</span>(pavo)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(stringr)
<span class="kw">library</span>(tidyr) <span class="co">#for gather() function</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(lme4)
<span class="kw">library</span>(car)
<span class="kw">library</span>(multcomp)
<span class="kw">library</span>(boot) <span class="co">#for mean() function</span>
<span class="kw">library</span>(pander) <span class="co">#for creating tidy tables</span>
<span class="kw">library</span>(ggpubr) <span class="co">#for ggarrange() function</span></code></pre></div>
<p></br> </br></p>
</div>
<div id="data-description" class="section level1">
<h1>Data description</h1>
<ul>
<li>We used the same spectral data and illumination as the <a href="main_models.html">Main models</a>.</li>
</ul>
<p></br></p>
<div id="sensitivity-curves" class="section level2">
<h2>Sensitivity curves</h2>
<ul>
<li><p>ALL photoreceptor sensitivities (UVS, SWS, MWS, LWS) were generated from the Govardovskii template without apply filters.</p></li>
<li><p>Note: UVS, SWS, MWS photoreceptors were the same as those in the main models</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#import sensitivity curves</span>
specsensbuprest.aim1 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/peak sensitivity_opsin shift_aim1.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">as.rspec</span>()
specsensbuprest.aim2 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/peak sensitivity_opsin shift_aim2.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">as.rspec</span>()


<span class="co">#import irradiance</span>
irradiance.d65 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/d65.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as.rspec</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">300</span>,<span class="dv">800</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#set import range</span>
<span class="st">  </span><span class="kw">procspec</span>(<span class="dt">opt =</span> <span class="kw">c</span>(<span class="st">&quot;min&quot;</span>, <span class="st">&quot;max&quot;</span>)) <span class="co">#standardize the illumination spectrum</span>
irradiance.twilight &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/civil twilight.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as.rspec</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">300</span>,<span class="dv">800</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">procspec</span>(<span class="dt">opt =</span> <span class="kw">c</span>(<span class="st">&quot;min&quot;</span>, <span class="st">&quot;max&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>( <span class="dt">twilight =</span> Irradiance) 
##process illumination data
illum &lt;-<span class="st"> </span><span class="kw">merge</span>(irradiance.d65, irradiance.twilight) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(light, illuminace, <span class="op">-</span>wl) 


<span class="co">#import backgound - average leaf</span>
aveleaf &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/aveleaf.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.rspec</span>()


<span class="co">#import and combind beetle, flower, leaf together</span>
raw.dataset&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;data/refelectance spectra.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.rspec</span>()
dataset&lt;-<span class="st"> </span><span class="kw">aggspec</span>(raw.dataset, <span class="dt">by =</span> <span class="dv">3</span>, <span class="dt">FUN =</span> mean) <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#average three measurements to a representative one</span>
<span class="st">  </span><span class="kw">procspec</span>(<span class="dt">opt =</span> <span class="st">&quot;smooth&quot;</span>, <span class="dt">span =</span> <span class="fl">0.1</span>, <span class="dt">fixneg =</span> <span class="st">&quot;zero&quot;</span>) <span class="co">#smooth the spectra and lift &lt;0 to 0</span>

<span class="co">#assign categoryies to each spectrum</span>
category.list &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;flower&quot;</span>,<span class="st">&quot;leaf&quot;</span>,<span class="st">&quot;beetle&quot;</span>)
category &lt;-<span class="st"> </span><span class="kw">rep</span>(category.list , <span class="kw">c</span>(<span class="dv">47</span><span class="op">*</span><span class="dv">501</span>,<span class="dv">46</span><span class="op">*</span><span class="dv">501</span>,<span class="dv">37</span><span class="op">*</span><span class="dv">501</span>))
wavelength&lt;-<span class="kw">rep</span>(dataset[,<span class="dv">1</span>])

<span class="co">#transform the data for ploting purpose</span>
dataset.transpose&lt;-<span class="kw">gather</span>(dataset[,<span class="dv">2</span><span class="op">:</span><span class="dv">131</span>], <span class="dt">key =</span> <span class="st">&quot;species&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;reflectance&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">FALSE</span>,
                          <span class="dt">convert =</span> <span class="ot">FALSE</span>, <span class="dt">factor_key =</span> <span class="ot">FALSE</span>)
dataset.plot.indivisually&lt;-<span class="kw">cbind</span>(dataset.transpose, wavelength,category)

<span class="co">#split data by categories for future use</span>
flower.spec&lt;-dataset.plot.indivisually[<span class="dv">1</span><span class="op">:</span><span class="dv">23547</span>,]
leaf.spec&lt;-dataset.plot.indivisually[<span class="dv">23548</span><span class="op">:</span><span class="dv">46593</span>,]
beetle.spec&lt;-dataset.plot.indivisually[<span class="dv">46594</span><span class="op">:</span><span class="dv">65130</span>,]

<span class="co">#merge the spectra before plot here</span>
dataset.plot.indivisually<span class="op">$</span>category2&lt;-<span class="kw">factor</span>(dataset.plot.indivisually<span class="op">$</span>category, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;leaf&quot;</span>,<span class="st">&quot;flower&quot;</span>,<span class="st">&quot;beetle&quot;</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wl&lt;-specsensbuprest.aim2[,<span class="dv">1</span>]
peaks&lt;-<span class="kw">gather</span>(specsensbuprest.aim2[,<span class="dv">2</span><span class="op">:</span><span class="dv">9</span>], peak, value) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(wl)

peak.order &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;UVS.380.A1.&quot;</span>, <span class="st">&quot;SWS.460.A1.&quot;</span>, <span class="st">&quot;MWS.520.A1.&quot;</span>, <span class="st">&quot;LWS.580.A1.&quot;</span>, <span class="st">&quot;LWS.600.A1.&quot;</span>, <span class="st">&quot;LWS.620.A1.&quot;</span>, <span class="st">&quot;LWS.640.A1.&quot;</span>, <span class="st">&quot;LWS.660.A1.&quot;</span>) <span class="co">#to order the peaks in the legend</span>
<span class="kw">ggplot</span>(peaks,<span class="kw">aes</span>(<span class="dt">x=</span>wl, <span class="dt">y=</span>value, <span class="dt">col=</span>peak))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">color=</span><span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="st">&quot;peak sensitivity&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_manual</span>(
    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkorchid4&quot;</span>, <span class="st">&quot;dodgerblue3&quot;</span>, <span class="st">&quot;olivedrab4&quot;</span>, <span class="st">&quot;orange1&quot;</span>, <span class="st">&quot;orange3&quot;</span>,<span class="st">&quot;darkorange3&quot;</span>, <span class="st">&quot;orangered1&quot;</span>, <span class="st">&quot;red2&quot;</span>),
    <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;380 nm&quot;</span>, <span class="st">&quot;460 nm&quot;</span>,<span class="st">&quot;520 nm&quot;</span>, <span class="st">&quot;580 nm&quot;</span>, <span class="st">&quot;600 nm&quot;</span>, <span class="st">&quot;620 nm&quot;</span>, <span class="st">&quot;640 nm&quot;</span>, <span class="st">&quot;660 nm&quot;</span> ),
    <span class="dt">breaks=</span>peak.order)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Wavelength (nm)&quot;</span>)<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Relative spectral sensitivity&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>()</code></pre></div>
<div class="figure">
<img src="opsin_shifed_models_files/figure-html/unnamed-chunk-2-1.png" alt="Figure caption: Sensitivity curves of the photoreceptors with different peak wavelengths." width="672" />
<p class="caption">
Figure caption: Sensitivity curves of the photoreceptors with different peak wavelengths.
</p>
</div>
<p></br> </br></p>
</div>
</div>
<div id="run-the-visual-models" class="section level1">
<h1>Run the visual models</h1>
<ul>
<li><p>We ran the visual models with the same parameter settings and steps as in the <a href="main_models.html">Main models</a>.</p></li>
<li><p>We first calculated the quantum catches, then calculated the contrasts.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Quantum catch calculation</span>
<span class="co">#Quantum catch - D65 - Aim 1</span>
vmUSM=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim1[, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
vmUML=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim1[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
vmUSL=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim1[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
vmUSML=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim1[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)

<span class="co">#Quantum catch - D65 - Aim 2</span>
buprest580=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest600=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest620=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">7</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest640=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">8</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest660=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">9</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)


<span class="co">#Quantum catch - twilight - Aim 1</span>
vmUSM_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim1[, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
vmUML_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim1[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
vmUSL_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim1[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
vmUSML_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim1[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)

<span class="co">#Quantum catch - twilight - Aim 2</span>
buprest580_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest600_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest620_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">7</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest640_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">8</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest660_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">9</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)




<span class="co">#contrast calculation</span>
<span class="co">#Contrast calculation- D65 - Aim 1</span>
CvmUSM =<span class="st"> </span><span class="kw">coldist</span>(vmUSM, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.6027</span>, <span class="fl">1.4059</span>, <span class="fl">1.7714</span>), <span class="dt">weber =</span> <span class="fl">0.0883</span>, <span class="dt">weber.ref =</span> <span class="dv">3</span>) 
CvmUML =<span class="st"> </span><span class="kw">coldist</span>(vmUML, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.4416</span>, <span class="fl">1.5933</span>, <span class="fl">1.7451</span>), <span class="dt">weber =</span> <span class="fl">0.0889</span>, <span class="dt">weber.ref =</span> <span class="dv">3</span>)
CvmUSL =<span class="st"> </span><span class="kw">coldist</span>(vmUSL, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.5481</span>, <span class="fl">1.3580</span>, <span class="fl">1.8740</span>), <span class="dt">weber =</span> <span class="fl">0.0858</span>, <span class="dt">weber.ref =</span> <span class="dv">3</span>)
CvmUSML =<span class="st"> </span><span class="kw">coldist</span>(vmUSML, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)

<span class="co">#Contrast calculation- D65 - Aim 2</span>
Cbuprest580 =<span class="st"> </span><span class="kw">coldist</span>(buprest580, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest600 =<span class="st"> </span><span class="kw">coldist</span>(buprest600, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest620 =<span class="st"> </span><span class="kw">coldist</span>(buprest620, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest640 =<span class="st"> </span><span class="kw">coldist</span>(buprest640, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest660 =<span class="st"> </span><span class="kw">coldist</span>(buprest660, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)

<span class="co">#Contrast calculation- twilight - Aim 1</span>
CvmUSM_twilight =<span class="st"> </span><span class="kw">coldist</span>(vmUSM_twilight, <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.6027</span>, <span class="fl">1.4059</span>, <span class="fl">1.7714</span>), <span class="dt">weber =</span> <span class="fl">0.0883</span>, <span class="dt">weber.ref =</span> <span class="dv">3</span>)  
CvmUML_twilight =<span class="st"> </span><span class="kw">coldist</span>(vmUML_twilight, <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.4416</span>, <span class="fl">1.5933</span>, <span class="fl">1.7451</span>), <span class="dt">weber =</span> <span class="fl">0.0889</span>, <span class="dt">weber.ref =</span> <span class="dv">3</span>)
CvmUSL_twilight =<span class="st"> </span><span class="kw">coldist</span>(vmUSL_twilight, <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.5481</span>, <span class="fl">1.3580</span>, <span class="fl">1.8740</span>), <span class="dt">weber =</span> <span class="fl">0.0858</span>, <span class="dt">weber.ref =</span> <span class="dv">3</span>)
CvmUSML_twilight =<span class="st"> </span><span class="kw">coldist</span>(vmUSML_twilight, <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>,  <span class="dt">weber.ref =</span> <span class="dv">4</span>)

<span class="co">#Contrast calculation- twilight - Aim 2</span>
Cbuprest580_twilight =<span class="st"> </span><span class="kw">coldist</span>(buprest580_twilight, <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest600_twilight =<span class="st"> </span><span class="kw">coldist</span>(buprest600_twilight, <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest620_twilight =<span class="st"> </span><span class="kw">coldist</span>(buprest620_twilight, <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest640_twilight =<span class="st"> </span><span class="kw">coldist</span>(buprest640_twilight, <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest660_twilight =<span class="st"> </span><span class="kw">coldist</span>(buprest660_twilight, <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)




<span class="co">#combine all contrast value in each comparison group</span>

<span class="co">#Daylight - Aim 1</span>

##flower vs leaf
VS1.fl_d65.aim1&lt;-<span class="st"> </span>CvmUSM<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
VS1.fl_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.fl&quot;</span>,<span class="dv">1</span>)
VS2.fl_d65.aim1&lt;-CvmUML<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
VS2.fl_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.fl&quot;</span>,<span class="dv">1</span>)
VS3.fl_d65.aim1&lt;-CvmUSL<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
VS3.fl_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.fl&quot;</span>,<span class="dv">1</span>)
VS4.fl_d65.aim1&lt;-CvmUSML<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
VS4.fl_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.fl&quot;</span>,<span class="dv">1</span>)
allvis.fl_d65.aim1&lt;-VS1.fl_d65.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.fl_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.fl_d65.aim1) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS4.fl_d65.aim1)

##beetle vs leaf
VS1.bl_d65.aim1&lt;-<span class="st"> </span>CvmUSM<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
VS1.bl_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bl&quot;</span>,<span class="dv">1</span>)
VS2.bl_d65.aim1&lt;-CvmUML<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
VS2.bl_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bl&quot;</span>,<span class="dv">1</span>)
VS3.bl_d65.aim1&lt;-CvmUSL<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
VS3.bl_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bl&quot;</span>,<span class="dv">1</span>)
VS4.bl_d65.aim1&lt;-CvmUSML<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
VS4.bl_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bl&quot;</span>,<span class="dv">1</span>)
allvis.bl_d65.aim1&lt;-VS1.bl_d65.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bl_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bl_d65.aim1) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS4.bl_d65.aim1)

##Beetle vs. Flower
VS1.bf_d65.aim1&lt;-<span class="st"> </span>CvmUSM<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
VS1.bf_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bf&quot;</span>,<span class="dv">1</span>)
VS2.bf_d65.aim1&lt;-CvmUML<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
VS2.bf_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bf&quot;</span>,<span class="dv">1</span>)
VS3.bf_d65.aim1&lt;-CvmUSL<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
VS3.bf_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bf&quot;</span>,<span class="dv">1</span>)
VS4.bf_d65.aim1&lt;-CvmUSML<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
VS4.bf_d65.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bf&quot;</span>,<span class="dv">1</span>)
allvis.bf_d65.aim1&lt;-VS1.bf_d65.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bf_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bf_d65.aim1)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(VS4.bf_d65.aim1)

<span class="co">#Twiligth - Aim 1</span>
##flower vs leaf
VS1.fl_twilight.aim1&lt;-<span class="st"> </span>CvmUSM_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
VS1.fl_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.fl&quot;</span>,<span class="dv">1</span>)
VS2.fl_twilight.aim1&lt;-CvmUML_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
VS2.fl_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.fl&quot;</span>,<span class="dv">1</span>)
VS3.fl_twilight.aim1&lt;-CvmUSL_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
VS3.fl_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.fl&quot;</span>,<span class="dv">1</span>)
VS4.fl_twilight.aim1&lt;-CvmUSML_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
VS4.fl_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.fl&quot;</span>,<span class="dv">1</span>)
allvis.fl_twilight.aim1&lt;-VS1.fl_twilight.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.fl_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.fl_twilight.aim1) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS4.fl_twilight.aim1)

##beetle vs leaf
VS1.bl_twilight.aim1&lt;-<span class="st"> </span>CvmUSM_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
VS1.bl_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bl&quot;</span>,<span class="dv">1</span>)
VS2.bl_twilight.aim1&lt;-CvmUML_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
VS2.bl_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bl&quot;</span>,<span class="dv">1</span>)
VS3.bl_twilight.aim1&lt;-CvmUSL_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
VS3.bl_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bl&quot;</span>,<span class="dv">1</span>)
VS4.bl_twilight.aim1&lt;-CvmUSML_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
VS4.bl_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bl&quot;</span>,<span class="dv">1</span>)
allvis.bl_twilight.aim1&lt;-VS1.bl_twilight.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bl_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bl_twilight.aim1) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS4.bl_twilight.aim1)


##Beetle vs. Flower
VS1.bf_twilight.aim1&lt;-<span class="st"> </span>CvmUSM_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
VS1.bf_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bf&quot;</span>,<span class="dv">1</span>)
VS2.bf_twilight.aim1&lt;-CvmUML_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
VS2.bf_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bf&quot;</span>,<span class="dv">1</span>)
VS3.bf_twilight.aim1&lt;-CvmUSL_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
VS3.bf_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bf&quot;</span>,<span class="dv">1</span>)
VS4.bf_twilight.aim1&lt;-CvmUSML_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
VS4.bf_twilight.aim1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bf&quot;</span>,<span class="dv">1</span>)
allvis.bf_twilight.aim1&lt;-VS1.bf_twilight.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bf_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bf_twilight.aim1) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS4.bf_twilight.aim1)



<span class="co">#Daylight - Aim 2</span>
##flower vs leaf
VS1.fl_d65.aim2&lt;-<span class="st"> </span>Cbuprest580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
VS1.fl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.fl&quot;</span>,<span class="dv">1</span>)
VS2.fl_d65.aim2&lt;-Cbuprest600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
VS2.fl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.fl&quot;</span>,<span class="dv">1</span>)
VS3.fl_d65.aim2&lt;-Cbuprest620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
VS3.fl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.fl&quot;</span>,<span class="dv">1</span>)
VS4.fl_d65.aim2&lt;-Cbuprest640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
VS4.fl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.fl&quot;</span>,<span class="dv">1</span>)
VS5.fl_d65.aim2&lt;-Cbuprest660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
VS5.fl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.fl&quot;</span>,<span class="dv">1</span>)

allvis.fl_d65.aim2&lt;-VS1.fl_d65.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.fl_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.fl_d65.aim2) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(VS4.fl_d65.aim2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS5.fl_d65.aim2)

##beetle vs leaf
VS1.bl_d65.aim2&lt;-<span class="st"> </span>Cbuprest580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
VS1.bl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bl&quot;</span>,<span class="dv">1</span>)
VS2.bl_d65.aim2&lt;-Cbuprest600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
VS2.bl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bl&quot;</span>,<span class="dv">1</span>)
VS3.bl_d65.aim2&lt;-Cbuprest620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
VS3.bl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bl&quot;</span>,<span class="dv">1</span>)
VS4.bl_d65.aim2&lt;-Cbuprest640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
VS4.bl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bl&quot;</span>,<span class="dv">1</span>)
VS5.bl_d65.aim2&lt;-Cbuprest660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
VS5.bl_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.bl&quot;</span>,<span class="dv">1</span>)

allvis.bl_d65.aim2&lt;-VS1.bl_d65.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bl_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bl_d65.aim2) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(VS4.bl_d65.aim2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS5.bl_d65.aim2) 


##Beetle vs. Flower
VS1.bf_d65.aim2&lt;-<span class="st"> </span>Cbuprest580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
VS1.bf_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bf&quot;</span>,<span class="dv">1</span>)
VS2.bf_d65.aim2&lt;-Cbuprest600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
VS2.bf_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bf&quot;</span>,<span class="dv">1</span>)
VS3.bf_d65.aim2&lt;-Cbuprest620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
VS3.bf_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bf&quot;</span>,<span class="dv">1</span>)
VS4.bf_d65.aim2&lt;-Cbuprest640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
VS4.bf_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bf&quot;</span>,<span class="dv">1</span>)
VS5.bf_d65.aim2&lt;-Cbuprest660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
VS5.bf_d65.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.bf&quot;</span>,<span class="dv">1</span>)

allvis.bf_d65.aim2&lt;-VS1.bf_d65.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bf_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bf_d65.aim2) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(VS4.bf_d65.aim2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS5.bf_d65.aim2) 

##Twiligth - Aim 2
##flower vs leaf
VS1.fl_twilight.aim2&lt;-<span class="st"> </span>Cbuprest580_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
VS1.fl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.fl&quot;</span>,<span class="dv">1</span>)
VS2.fl_twilight.aim2&lt;-Cbuprest600_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
VS2.fl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.fl&quot;</span>,<span class="dv">1</span>)
VS3.fl_twilight.aim2&lt;-Cbuprest620_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
VS3.fl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.fl&quot;</span>,<span class="dv">1</span>)
VS4.fl_twilight.aim2&lt;-Cbuprest640_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
VS4.fl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.fl&quot;</span>,<span class="dv">1</span>)
VS5.fl_twilight.aim2&lt;-Cbuprest660_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
VS5.fl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.fl&quot;</span>,<span class="dv">1</span>)

allvis.fl_twilight.aim2&lt;-VS1.fl_twilight.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.fl_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.fl_twilight.aim2) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(VS4.fl_twilight.aim2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS5.fl_twilight.aim2)

##beetle vs leaf
VS1.bl_twilight.aim2&lt;-<span class="st"> </span>Cbuprest580_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
VS1.bl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bl&quot;</span>,<span class="dv">1</span>)
VS2.bl_twilight.aim2&lt;-Cbuprest600_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
VS2.bl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bl&quot;</span>,<span class="dv">1</span>)
VS3.bl_twilight.aim2&lt;-Cbuprest620_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
VS3.bl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bl&quot;</span>,<span class="dv">1</span>)
VS4.bl_twilight.aim2&lt;-Cbuprest640_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
VS4.bl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bl&quot;</span>,<span class="dv">1</span>)
VS5.bl_twilight.aim2&lt;-Cbuprest660_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
VS5.bl_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.bl&quot;</span>,<span class="dv">1</span>)

allvis.bl_twilight.aim2&lt;-VS1.bl_twilight.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bl_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bl_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS4.bl_twilight.aim2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS5.bl_twilight.aim2)

##Beetle vs. Flower
VS1.bf_twilight.aim2&lt;-<span class="st"> </span>Cbuprest580_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
VS1.bf_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bf&quot;</span>,<span class="dv">1</span>)
VS2.bf_twilight.aim2&lt;-Cbuprest600_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
VS2.bf_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bf&quot;</span>,<span class="dv">1</span>)
VS3.bf_twilight.aim2&lt;-Cbuprest620_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
VS3.bf_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bf&quot;</span>,<span class="dv">1</span>)
VS4.bf_twilight.aim2&lt;-Cbuprest640_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
VS4.bf_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bf&quot;</span>,<span class="dv">1</span>)
VS5.bf_twilight.aim2&lt;-Cbuprest660_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
VS5.bf_twilight.aim2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.bf&quot;</span>,<span class="dv">1</span>)

allvis.bf_twilight.aim2&lt;-VS1.bf_twilight.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bf_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bf_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS4.bf_twilight.aim2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS5.bf_twilight.aim2)</code></pre></div>
<p></br></p>
<div id="contrast-tables" class="section level2 tabset tabset-fade tabset-pills">
<h2>Contrast tables</h2>
<p></br></p>
<div id="aim-1" class="section level3 tabset tabset-fade tabset-pills">
<h3>Aim 1</h3>
<p>The table shows the median contrast in each comparison group</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Visul model 1</span>
system.list.aim1&lt;-<span class="st"> </span><span class="kw">rbind.data.frame</span>(<span class="st">&quot;USM&quot;</span>, <span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>,  <span class="st">&quot;USML&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">system =</span> <span class="dv">1</span>) <span class="co"># make a list of system names</span></code></pre></div>
<div id="daylight" class="section level4">
<h4>Daylight</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Daylight</span>
##list contrast from each comparison group
fl.contrast_d65.aim1 &lt;-<span class="st"> </span><span class="kw">rbind.data.frame</span>(<span class="kw">median</span>(VS1.fl_d65.aim1<span class="op">$</span>dS), <span class="kw">median</span>(VS2.fl_d65.aim1<span class="op">$</span>dS),<span class="kw">median</span>(VS3.fl_d65.aim1<span class="op">$</span>dS),<span class="kw">median</span>(VS4.fl_d65.aim1<span class="op">$</span>dS))
bl.contrast_d65.aim1 &lt;-<span class="kw">rbind.data.frame</span>(<span class="kw">median</span>(VS1.bl_d65.aim1<span class="op">$</span>dS),<span class="kw">median</span>(VS2.bl_d65.aim1<span class="op">$</span>dS),<span class="kw">median</span>(VS3.bl_d65.aim1<span class="op">$</span>dS),<span class="kw">median</span>(VS4.bl_d65.aim1<span class="op">$</span>dS))
bf.contrast_d65.aim1 &lt;-<span class="kw">rbind.data.frame</span>(<span class="kw">median</span>(VS1.bf_d65.aim1<span class="op">$</span>dS), <span class="kw">median</span>(VS2.bf_d65.aim1<span class="op">$</span>dS),<span class="kw">median</span>(VS3.bf_d65.aim1<span class="op">$</span>dS),<span class="kw">median</span>(VS4.bf_d65.aim1<span class="op">$</span>dS))
<span class="co">#combind comparison groups together in a table</span>
contrast.list_d65.aim1&lt;-<span class="st"> </span>system.list.aim1 <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">cbind</span>(fl.contrast_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(bl.contrast_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(bf.contrast_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>() 
contrast.list_d65.aim1</code></pre></div>
<table style="width:85%;">
<colgroup>
<col width="12%" />
<col width="23%" />
<col width="23%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">system</th>
<th align="center">flower.vs.leaf</th>
<th align="center">beetle.vs.leaf</th>
<th align="center">beetle.vs.flower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">USM</td>
<td align="center">5.043</td>
<td align="center">3.298</td>
<td align="center">5.566</td>
</tr>
<tr class="even">
<td align="center">UML</td>
<td align="center">4.627</td>
<td align="center">4.002</td>
<td align="center">5.119</td>
</tr>
<tr class="odd">
<td align="center">USL</td>
<td align="center">5.518</td>
<td align="center">3.985</td>
<td align="center">5.999</td>
</tr>
<tr class="even">
<td align="center">USML</td>
<td align="center">5.155</td>
<td align="center">3.989</td>
<td align="center">5.702</td>
</tr>
</tbody>
</table>
</div>
<div id="twilight" class="section level4">
<h4>Twilight</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Twilight</span>
##list contrast from each comparison group
fl.contrast_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">rbind.data.frame</span>(<span class="kw">median</span>(VS1.fl_twilight.aim1<span class="op">$</span>dS), <span class="kw">median</span>(VS2.fl_twilight.aim1<span class="op">$</span>dS),<span class="kw">median</span>(VS3.fl_twilight.aim1<span class="op">$</span>dS),<span class="kw">median</span>(VS4.fl_twilight.aim1<span class="op">$</span>dS))
bl.contrast_twilight.aim1 &lt;-<span class="kw">rbind.data.frame</span>(<span class="kw">median</span>(VS1.bl_twilight.aim1<span class="op">$</span>dS),<span class="kw">median</span>(VS2.bl_twilight.aim1<span class="op">$</span>dS),<span class="kw">median</span>(VS3.bl_twilight.aim1<span class="op">$</span>dS),<span class="kw">median</span>(VS4.bl_twilight.aim1<span class="op">$</span>dS))
bf.contrast_twilight.aim1 &lt;-<span class="kw">rbind.data.frame</span>(<span class="kw">median</span>(VS1.bf_twilight.aim1<span class="op">$</span>dS), <span class="kw">median</span>(VS2.bf_twilight.aim1<span class="op">$</span>dS),<span class="kw">median</span>(VS3.bf_twilight.aim1<span class="op">$</span>dS),<span class="kw">median</span>(VS4.bf_twilight.aim1<span class="op">$</span>dS))
<span class="co">#combind comparison groups together in a table</span>
contrast.list_twilight.aim1&lt;-<span class="st"> </span>system.list.aim1 <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">cbind</span>(fl.contrast_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(bl.contrast_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(bf.contrast_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()
contrast.list_twilight.aim1</code></pre></div>
<table style="width:85%;">
<colgroup>
<col width="12%" />
<col width="23%" />
<col width="23%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">system</th>
<th align="center">flower.vs.leaf</th>
<th align="center">beetle.vs.leaf</th>
<th align="center">beetle.vs.flower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">USM</td>
<td align="center">0.5162</td>
<td align="center">0.253</td>
<td align="center">0.5467</td>
</tr>
<tr class="even">
<td align="center">UML</td>
<td align="center">0.4986</td>
<td align="center">0.3275</td>
<td align="center">0.5239</td>
</tr>
<tr class="odd">
<td align="center">USL</td>
<td align="center">0.5959</td>
<td align="center">0.3221</td>
<td align="center">0.6172</td>
</tr>
<tr class="even">
<td align="center">USML</td>
<td align="center">0.6344</td>
<td align="center">0.3742</td>
<td align="center">0.6746</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="aim-2" class="section level3 tabset tabset-fade tabset-pills">
<h3>Aim 2</h3>
<p>The table shows the median contrast in each comparison group</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">system.list.aim2&lt;-<span class="st"> </span><span class="kw">rbind.data.frame</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>, <span class="st">&quot;VS 640&quot;</span>, <span class="st">&quot;VS 660&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">system =</span> <span class="dv">1</span>) <span class="co"># make a list of system names</span></code></pre></div>
<div id="daylight-1" class="section level4">
<h4>Daylight</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Daylight</span>
##list contrast from each comparison group
fl.contrast_d65.aim2 &lt;-<span class="st"> </span><span class="kw">rbind.data.frame</span>(<span class="kw">median</span>(VS1.fl_d65.aim2<span class="op">$</span>dS), <span class="kw">median</span>(VS2.fl_d65.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS3.fl_d65.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS4.fl_d65.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS5.fl_d65.aim2<span class="op">$</span>dS))
bl.contrast_d65.aim2 &lt;-<span class="kw">rbind.data.frame</span>(<span class="kw">median</span>(VS1.bl_d65.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS2.bl_d65.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS3.bl_d65.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS4.bl_d65.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS5.bl_d65.aim2<span class="op">$</span>dS))
bf.contrast_d65.aim2 &lt;-<span class="kw">rbind.data.frame</span>(<span class="kw">median</span>(VS1.bf_d65.aim2<span class="op">$</span>dS), <span class="kw">median</span>(VS2.bf_d65.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS3.bf_d65.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS4.bf_d65.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS5.bf_d65.aim2<span class="op">$</span>dS))
<span class="co">#combind comparison groups together in a table</span>
contrast.list_d65.aim2&lt;-<span class="st"> </span>system.list.aim2 <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">cbind</span>(fl.contrast_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(bl.contrast_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(bf.contrast_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>() 
contrast.list_d65.aim2</code></pre></div>
<table style="width:85%;">
<colgroup>
<col width="12%" />
<col width="23%" />
<col width="23%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">system</th>
<th align="center">flower.vs.leaf</th>
<th align="center">beetle.vs.leaf</th>
<th align="center">beetle.vs.flower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">VS 580</td>
<td align="center">5.155</td>
<td align="center">3.989</td>
<td align="center">5.702</td>
</tr>
<tr class="even">
<td align="center">VS 600</td>
<td align="center">5.363</td>
<td align="center">4.585</td>
<td align="center">5.962</td>
</tr>
<tr class="odd">
<td align="center">VS 620</td>
<td align="center">5.561</td>
<td align="center">5.061</td>
<td align="center">6.274</td>
</tr>
<tr class="even">
<td align="center">VS 640</td>
<td align="center">5.709</td>
<td align="center">5.342</td>
<td align="center">6.589</td>
</tr>
<tr class="odd">
<td align="center">VS 660</td>
<td align="center">5.55</td>
<td align="center">5.476</td>
<td align="center">6.787</td>
</tr>
</tbody>
</table>
</div>
<div id="twilight-1" class="section level4">
<h4>Twilight</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Twilight</span>
##list contrast from each comparison group
fl.contrast_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">rbind.data.frame</span>(<span class="kw">median</span>(VS1.fl_twilight.aim2<span class="op">$</span>dS), <span class="kw">median</span>(VS2.fl_twilight.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS3.fl_twilight.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS4.fl_twilight.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS5.fl_twilight.aim2<span class="op">$</span>dS))
bl.contrast_twilight.aim2 &lt;-<span class="kw">rbind.data.frame</span>(<span class="kw">median</span>(VS1.bl_twilight.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS2.bl_twilight.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS3.bl_twilight.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS4.bl_twilight.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS5.bl_twilight.aim2<span class="op">$</span>dS))
bf.contrast_twilight.aim2 &lt;-<span class="kw">rbind.data.frame</span>(<span class="kw">median</span>(VS1.bf_twilight.aim2<span class="op">$</span>dS), <span class="kw">median</span>(VS2.bf_twilight.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS3.bf_twilight.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS4.bf_twilight.aim2<span class="op">$</span>dS),<span class="kw">median</span>(VS5.bf_twilight.aim2<span class="op">$</span>dS))
<span class="co">#combind comparison groups together in a table</span>
contrast.list_twilight.aim2&lt;-<span class="st"> </span>system.list.aim2 <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">cbind</span>(fl.contrast_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(bl.contrast_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(bf.contrast_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>() 
contrast.list_twilight.aim2</code></pre></div>
<table style="width:85%;">
<colgroup>
<col width="12%" />
<col width="23%" />
<col width="23%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">system</th>
<th align="center">flower.vs.leaf</th>
<th align="center">beetle.vs.leaf</th>
<th align="center">beetle.vs.flower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">VS 580</td>
<td align="center">0.6344</td>
<td align="center">0.3742</td>
<td align="center">0.6746</td>
</tr>
<tr class="even">
<td align="center">VS 600</td>
<td align="center">0.6596</td>
<td align="center">0.4351</td>
<td align="center">0.7246</td>
</tr>
<tr class="odd">
<td align="center">VS 620</td>
<td align="center">0.7028</td>
<td align="center">0.4978</td>
<td align="center">0.7919</td>
</tr>
<tr class="even">
<td align="center">VS 640</td>
<td align="center">0.7085</td>
<td align="center">0.5319</td>
<td align="center">0.8403</td>
</tr>
<tr class="odd">
<td align="center">VS 660</td>
<td align="center">0.6822</td>
<td align="center">0.5499</td>
<td align="center">0.868</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
</div>
</div>
</div>
</div>
<div id="compare-contrasts" class="section level1">
<h1>Compare contrasts</h1>
<ul>
<li>We applied the same statistical approaches to compare contrasts between visual systems as in the <a href="main_models.html">Main models</a>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#creat different comparison groups for furthur GLMM analysis</span>
<span class="co">#Organize data before GLMM</span>

<span class="co">#D65 - Aim 1</span>
##flower vs leaf
CvmUSM.flower.vs.leaf=
<span class="st">  </span>CvmUSM <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
CvmUML.flower.vs.leaf=
<span class="st">  </span>CvmUML <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
CvmUSL.flower.vs.leaf=
<span class="st">  </span>CvmUSL <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
CvmUSML.flower.vs.leaf=
<span class="st">  </span>CvmUSML <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))

C.flower.vs.leaf.aim1=
<span class="st">  </span>CvmUSM.flower.vs.leaf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvmUML.flower.vs.leaf) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(CvmUSL.flower.vs.leaf)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvmUSML.flower.vs.leaf)

contrast.UVSWMW...flower.vs.leaf&lt;-CvmUSM.flower.vs.leaf[,<span class="dv">3</span>]
contrast.UV..MWLW.flower.vs.leaf&lt;-CvmUML.flower.vs.leaf[,<span class="dv">3</span>]
contrast.UVSW..LW.flower.vs.leaf&lt;-CvmUSL.flower.vs.leaf[,<span class="dv">3</span>]
contrast.UVSWMWLW.flower.vs.leaf&lt;-CvmUSML.flower.vs.leaf[,<span class="dv">3</span>]

com.contrast.flower.vs.leaf.aim1&lt;-<span class="kw">cbind</span>(CvmUSM.flower.vs.leaf[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],contrast.UVSWMW...flower.vs.leaf,contrast.UV..MWLW.flower.vs.leaf,contrast.UVSW..LW.flower.vs.leaf,contrast.UVSWMWLW.flower.vs.leaf)
compare.flower.vs.leaf.aim1 &lt;-<span class="st"> </span>com.contrast.flower.vs.leaf.aim1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.flower.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)

##beetle vs leaf
CvmUSM.beetle.vs.leaf=
<span class="st">  </span>CvmUSM <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvmUML.beetle.vs.leaf=
<span class="st">  </span>CvmUML <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvmUSL.beetle.vs.leaf=
<span class="st">  </span>CvmUSL <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvmUSML.beetle.vs.leaf=
<span class="st">  </span>CvmUSML <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

C.beetle.vs.leaf.aim1=
<span class="st">  </span>CvmUSM.beetle.vs.leaf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvmUML.beetle.vs.leaf) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(CvmUSL.beetle.vs.leaf)<span class="op">%&gt;%</span><span class="st">  </span><span class="kw">rbind</span>(CvmUSML.beetle.vs.leaf)

contrast.UVSWMW...beetle.vs.leaf&lt;-CvmUSM.beetle.vs.leaf[,<span class="dv">3</span>]
contrast.UV..MWLW.beetle.vs.leaf&lt;-CvmUML.beetle.vs.leaf[,<span class="dv">3</span>]
contrast.UVSW..LW.beetle.vs.leaf&lt;-CvmUSL.beetle.vs.leaf[,<span class="dv">3</span>]
contrast.UVSWMWLW.beetle.vs.leaf&lt;-CvmUSML.beetle.vs.leaf[,<span class="dv">3</span>]

com.contrast.beetle.vs.leaf.aim1&lt;-<span class="kw">cbind</span>(CvmUSM.beetle.vs.leaf[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],contrast.UVSWMW...beetle.vs.leaf,contrast.UV..MWLW.beetle.vs.leaf,contrast.UVSW..LW.beetle.vs.leaf,contrast.UVSWMWLW.beetle.vs.leaf)
compare.beetle.vs.leaf.aim1 &lt;-<span class="st"> </span>com.contrast.beetle.vs.leaf.aim1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)

##Beetle vs. Flower
CvmUSM.beetle.vs.flower=
<span class="st">  </span>CvmUSM <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvmUML.beetle.vs.flower=
<span class="st">  </span>CvmUML <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvmUSL.beetle.vs.flower=
<span class="st">  </span>CvmUSL <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvmUSML.beetle.vs.flower=
<span class="st">  </span>CvmUSML <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

C.beetle.vs.flower.aim1=
<span class="st">  </span>CvmUSM.beetle.vs.flower <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvmUML.beetle.vs.flower) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(CvmUSL.beetle.vs.flower) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">rbind</span>(CvmUSML.beetle.vs.flower)

contrast.UVSWMW...beetle.vs.flower&lt;-CvmUSM.beetle.vs.flower[,<span class="dv">3</span>]
contrast.UV..MWLW.beetle.vs.flower&lt;-CvmUML.beetle.vs.flower[,<span class="dv">3</span>]
contrast.UVSW..LW.beetle.vs.flower&lt;-CvmUSL.beetle.vs.flower[,<span class="dv">3</span>]
contrast.UVSWMWLW.beetle.vs.flower&lt;-CvmUSML.beetle.vs.flower[,<span class="dv">3</span>]

com.contrast.beetle.vs.flower.aim1&lt;-<span class="kw">cbind</span>(CvmUSM.beetle.vs.flower[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],contrast.UVSWMW...beetle.vs.flower,contrast.UV..MWLW.beetle.vs.flower,contrast.UVSW..LW.beetle.vs.flower,contrast.UVSWMWLW.beetle.vs.flower)
compare.beetle.vs.flower.aim1 &lt;-<span class="st"> </span>com.contrast.beetle.vs.flower.aim1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.flower&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)



<span class="co">#D65 - Aim 2</span>
##flower vs leaf
Cbuprest580.flower.vs.leaf=
<span class="st">  </span>Cbuprest580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest600.flower.vs.leaf=
<span class="st">  </span>Cbuprest600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest620.flower.vs.leaf=
<span class="st">  </span>Cbuprest620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest640.flower.vs.leaf=
<span class="st">  </span>Cbuprest640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest660.flower.vs.leaf=
<span class="st">  </span>Cbuprest660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))

Cbuprest.flower.vs.leaf.aim2=
<span class="st">  </span>Cbuprest580.flower.vs.leaf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.flower.vs.leaf) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.flower.vs.leaf)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.flower.vs.leaf) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest660.flower.vs.leaf) 

bup580.flower.vs.leaf&lt;-Cbuprest580.flower.vs.leaf[,<span class="dv">3</span>]
bup600.flower.vs.leaf&lt;-Cbuprest600.flower.vs.leaf[,<span class="dv">3</span>]
bup620.flower.vs.leaf&lt;-Cbuprest620.flower.vs.leaf[,<span class="dv">3</span>]
bup640.flower.vs.leaf&lt;-Cbuprest640.flower.vs.leaf[,<span class="dv">3</span>]
bup660.flower.vs.leaf&lt;-Cbuprest660.flower.vs.leaf[,<span class="dv">3</span>]

com.bupcontrast.flower.vs.leaf.aim2&lt;-<span class="kw">cbind</span>(Cbuprest.flower.vs.leaf.aim2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.flower.vs.leaf,bup600.flower.vs.leaf,bup620.flower.vs.leaf,bup640.flower.vs.leaf,bup660.flower.vs.leaf)
compare.flower.vs.leaf.aim2 &lt;-<span class="st"> </span>com.bupcontrast.flower.vs.leaf.aim2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.flower.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)

##beetle vs leaf
Cbuprest580.beetle.vs.leaf=
<span class="st">  </span>Cbuprest580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest600.beetle.vs.leaf=
<span class="st">  </span>Cbuprest600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest620.beetle.vs.leaf=
<span class="st">  </span>Cbuprest620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest640.beetle.vs.leaf=
<span class="st">  </span>Cbuprest640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest660.beetle.vs.leaf=
<span class="st">  </span>Cbuprest660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

Cbuprest.beetle.vs.leaf.aim2=
<span class="st">  </span>Cbuprest580.beetle.vs.leaf  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.beetle.vs.leaf)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.beetle.vs.leaf)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.beetle.vs.leaf) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest660.beetle.vs.leaf)

bup580.beetle.vs.leaf&lt;-Cbuprest580.beetle.vs.leaf[,<span class="dv">3</span>]
bup600.beetle.vs.leaf&lt;-Cbuprest600.beetle.vs.leaf[,<span class="dv">3</span>]
bup620.beetle.vs.leaf&lt;-Cbuprest620.beetle.vs.leaf[,<span class="dv">3</span>]
bup640.beetle.vs.leaf&lt;-Cbuprest640.beetle.vs.leaf[,<span class="dv">3</span>]
bup660.beetle.vs.leaf&lt;-Cbuprest660.beetle.vs.leaf[,<span class="dv">3</span>]

com.bupcontrast.beetle.vs.leaf.aim2&lt;-<span class="kw">cbind</span>(Cbuprest.beetle.vs.leaf.aim2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.beetle.vs.leaf,bup600.beetle.vs.leaf,bup620.beetle.vs.leaf,bup640.beetle.vs.leaf,bup660.beetle.vs.leaf)
compare.beetle.vs.leaf.aim2 &lt;-<span class="st"> </span>com.bupcontrast.beetle.vs.leaf.aim2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)

##Beetle vs. Flower
Cbuprest580.beetle.vs.flower=
<span class="st">  </span>Cbuprest580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest600.beetle.vs.flower=
<span class="st">  </span>Cbuprest600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest620.beetle.vs.flower=
<span class="st">  </span>Cbuprest620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest640.beetle.vs.flower=
<span class="st">  </span>Cbuprest640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest660.beetle.vs.flower=
<span class="st">  </span>Cbuprest660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

Cbuprest.beetle.vs.flower.aim2=
<span class="st">  </span>Cbuprest580.beetle.vs.flower <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.beetle.vs.flower) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.beetle.vs.flower)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.beetle.vs.flower) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest660.beetle.vs.flower)

bup580.beetle.vs.flower&lt;-Cbuprest580.beetle.vs.flower[,<span class="dv">3</span>]
bup600.beetle.vs.flower&lt;-Cbuprest600.beetle.vs.flower[,<span class="dv">3</span>]
bup620.beetle.vs.flower&lt;-Cbuprest620.beetle.vs.flower[,<span class="dv">3</span>]
bup640.beetle.vs.flower&lt;-Cbuprest640.beetle.vs.flower[,<span class="dv">3</span>]
bup660.beetle.vs.flower&lt;-Cbuprest660.beetle.vs.flower[,<span class="dv">3</span>]

com.bupcontrast.beetle.vs.flower.aim2&lt;-<span class="kw">cbind</span>(Cbuprest.beetle.vs.flower.aim2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.beetle.vs.flower,bup600.beetle.vs.flower,bup620.beetle.vs.flower,bup640.beetle.vs.flower,bup660.beetle.vs.flower)
compare.beetle.vs.flower.aim2 &lt;-<span class="st"> </span>com.bupcontrast.beetle.vs.flower.aim2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.flower&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)


<span class="co">#Twilight - Aim 1</span>
##flower vs leaf
CvmUSM.flower.vs.leaf_twilight=
<span class="st">  </span>CvmUSM_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
CvmUML.flower.vs.leaf_twilight=
<span class="st">  </span>CvmUML_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
CvmUSL.flower.vs.leaf_twilight=
<span class="st">  </span>CvmUSL_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
CvmUSML.flower.vs.leaf_twilight=
<span class="st">  </span>CvmUSML_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))

C.flower.vs.leaf_twilight.aim1=
<span class="st">  </span>CvmUSM.flower.vs.leaf_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvmUML.flower.vs.leaf_twilight) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(CvmUSL.flower.vs.leaf_twilight)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvmUSML.flower.vs.leaf_twilight)

contrast.UVSWMW...flower.vs.leaf_twilight&lt;-CvmUSM.flower.vs.leaf_twilight[,<span class="dv">3</span>]
contrast.UV..MWLW.flower.vs.leaf_twilight&lt;-CvmUML.flower.vs.leaf_twilight[,<span class="dv">3</span>]
contrast.UVSW..LW.flower.vs.leaf_twilight&lt;-CvmUSL.flower.vs.leaf_twilight[,<span class="dv">3</span>]
contrast.UVSWMWLW.flower.vs.leaf_twilight&lt;-CvmUSML.flower.vs.leaf_twilight[,<span class="dv">3</span>]

com.contrast.flower.vs.leaf_twilight.aim1&lt;-<span class="kw">cbind</span>(CvmUSM.flower.vs.leaf_twilight[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],contrast.UVSWMW...flower.vs.leaf_twilight,contrast.UV..MWLW.flower.vs.leaf_twilight,contrast.UVSW..LW.flower.vs.leaf_twilight,contrast.UVSWMWLW.flower.vs.leaf_twilight)
compare.flower.vs.leaf_twilight.aim1 &lt;-<span class="st"> </span>com.contrast.flower.vs.leaf_twilight.aim1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.flower.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)

##beetle vs leaf
CvmUSM.beetle.vs.leaf_twilight=
<span class="st">  </span>CvmUSM_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvmUML.beetle.vs.leaf_twilight=
<span class="st">  </span>CvmUML_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvmUSL.beetle.vs.leaf_twilight=
<span class="st">  </span>CvmUSL_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvmUSML.beetle.vs.leaf_twilight=
<span class="st">  </span>CvmUSML_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

C.beetle.vs.leaf_twilight.aim1=
<span class="st">  </span>CvmUSM.beetle.vs.leaf_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvmUML.beetle.vs.leaf_twilight) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(CvmUSL.beetle.vs.leaf_twilight)<span class="op">%&gt;%</span><span class="st">  </span><span class="kw">rbind</span>(CvmUSML.beetle.vs.leaf_twilight)

contrast.UVSWMW...beetle.vs.leaf_twilight&lt;-CvmUSM.beetle.vs.leaf_twilight[,<span class="dv">3</span>]
contrast.UV..MWLW.beetle.vs.leaf_twilight&lt;-CvmUML.beetle.vs.leaf_twilight[,<span class="dv">3</span>]
contrast.UVSW..LW.beetle.vs.leaf_twilight&lt;-CvmUSL.beetle.vs.leaf_twilight[,<span class="dv">3</span>]
contrast.UVSWMWLW.beetle.vs.leaf_twilight&lt;-CvmUSML.beetle.vs.leaf_twilight[,<span class="dv">3</span>]

com.contrast.beetle.vs.leaf_twilight.aim1&lt;-<span class="kw">cbind</span>(CvmUSM.beetle.vs.leaf_twilight[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],contrast.UVSWMW...beetle.vs.leaf_twilight,contrast.UV..MWLW.beetle.vs.leaf_twilight,contrast.UVSW..LW.beetle.vs.leaf_twilight,contrast.UVSWMWLW.beetle.vs.leaf_twilight)
compare.beetle.vs.leaf_twilight.aim1 &lt;-<span class="st"> </span>com.contrast.beetle.vs.leaf_twilight.aim1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)

##Beetle vs. Flower
CvmUSM.beetle.vs.flower_twilight=
<span class="st">  </span>CvmUSM_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvmUML.beetle.vs.flower_twilight=
<span class="st">  </span>CvmUML_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvmUSL.beetle.vs.flower_twilight=
<span class="st">  </span>CvmUSL_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvmUSML.beetle.vs.flower_twilight=
<span class="st">  </span>CvmUSML_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

C.beetle.vs.flower_twilight.aim1=
<span class="st">  </span>CvmUSM.beetle.vs.flower_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvmUML.beetle.vs.flower_twilight) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(CvmUSL.beetle.vs.flower_twilight) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">rbind</span>(CvmUSML.beetle.vs.flower_twilight)

contrast.UVSWMW...beetle.vs.flower_twilight&lt;-CvmUSM.beetle.vs.flower_twilight[,<span class="dv">3</span>]
contrast.UV..MWLW.beetle.vs.flower_twilight&lt;-CvmUML.beetle.vs.flower_twilight[,<span class="dv">3</span>]
contrast.UVSW..LW.beetle.vs.flower_twilight&lt;-CvmUSL.beetle.vs.flower_twilight[,<span class="dv">3</span>]
contrast.UVSWMWLW.beetle.vs.flower_twilight&lt;-CvmUSML.beetle.vs.flower_twilight[,<span class="dv">3</span>]

com.contrast.beetle.vs.flower_twilight.aim1&lt;-<span class="kw">cbind</span>(CvmUSM.beetle.vs.flower_twilight[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],contrast.UVSWMW...beetle.vs.flower_twilight,contrast.UV..MWLW.beetle.vs.flower_twilight,contrast.UVSW..LW.beetle.vs.flower_twilight,contrast.UVSWMWLW.beetle.vs.flower_twilight)
compare.beetle.vs.flower_twilight.aim1 &lt;-<span class="st"> </span>com.contrast.beetle.vs.flower_twilight.aim1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.flower&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)



<span class="co">#Twilight - Aim 2</span>
##flower vs leaf
Cbuprest580.flower.vs.leaf_twilight=
<span class="st">  </span>Cbuprest580_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest600.flower.vs.leaf_twilight=
<span class="st">  </span>Cbuprest600_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest620.flower.vs.leaf_twilight=
<span class="st">  </span>Cbuprest620_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest640.flower.vs.leaf_twilight=
<span class="st">  </span>Cbuprest640_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest660.flower.vs.leaf_twilight=
<span class="st">  </span>Cbuprest660_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))

Cbuprest.flower.vs.leaf_twilight.aim2=
<span class="st">  </span>Cbuprest580.flower.vs.leaf_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.flower.vs.leaf_twilight) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.flower.vs.leaf_twilight)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.flower.vs.leaf_twilight) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest660.flower.vs.leaf_twilight)

bup580.flower.vs.leaf_twilight&lt;-Cbuprest580.flower.vs.leaf_twilight[,<span class="dv">3</span>]
bup600.flower.vs.leaf_twilight&lt;-Cbuprest600.flower.vs.leaf_twilight[,<span class="dv">3</span>]
bup620.flower.vs.leaf_twilight&lt;-Cbuprest620.flower.vs.leaf_twilight[,<span class="dv">3</span>]
bup640.flower.vs.leaf_twilight&lt;-Cbuprest640.flower.vs.leaf_twilight[,<span class="dv">3</span>]
bup660.flower.vs.leaf_twilight&lt;-Cbuprest660.flower.vs.leaf_twilight[,<span class="dv">3</span>]

com.bupcontrast.flower.vs.leaf_twilight.aim2&lt;-<span class="kw">cbind</span>(Cbuprest.flower.vs.leaf_twilight.aim2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.flower.vs.leaf_twilight,bup600.flower.vs.leaf_twilight,bup620.flower.vs.leaf_twilight,bup640.flower.vs.leaf_twilight,bup660.flower.vs.leaf_twilight)
compare.flower.vs.leaf_twilight.aim2 &lt;-<span class="st"> </span>com.bupcontrast.flower.vs.leaf_twilight.aim2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.flower.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)

##beetle vs leaf
Cbuprest580.beetle.vs.leaf_twilight=
<span class="st">  </span>Cbuprest580_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest600.beetle.vs.leaf_twilight=
<span class="st">  </span>Cbuprest600_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest620.beetle.vs.leaf_twilight=
<span class="st">  </span>Cbuprest620_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest640.beetle.vs.leaf_twilight=
<span class="st">  </span>Cbuprest640_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest660.beetle.vs.leaf_twilight=
<span class="st">  </span>Cbuprest660_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

Cbuprest.beetle.vs.leaf_twilight.aim2=
<span class="st">  </span>Cbuprest580.beetle.vs.leaf_twilight  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.beetle.vs.leaf_twilight)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.beetle.vs.leaf_twilight)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.beetle.vs.leaf_twilight) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest660.beetle.vs.leaf_twilight)

bup580.beetle.vs.leaf_twilight&lt;-Cbuprest580.beetle.vs.leaf_twilight[,<span class="dv">3</span>]
bup600.beetle.vs.leaf_twilight&lt;-Cbuprest600.beetle.vs.leaf_twilight[,<span class="dv">3</span>]
bup620.beetle.vs.leaf_twilight&lt;-Cbuprest620.beetle.vs.leaf_twilight[,<span class="dv">3</span>]
bup640.beetle.vs.leaf_twilight&lt;-Cbuprest640.beetle.vs.leaf_twilight[,<span class="dv">3</span>]
bup660.beetle.vs.leaf_twilight&lt;-Cbuprest660.beetle.vs.leaf_twilight[,<span class="dv">3</span>]

com.bupcontrast.beetle.vs.leaf_twilight.aim2&lt;-<span class="kw">cbind</span>(Cbuprest.beetle.vs.leaf_twilight.aim2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.beetle.vs.leaf_twilight,bup600.beetle.vs.leaf_twilight,bup620.beetle.vs.leaf_twilight,bup640.beetle.vs.leaf_twilight,bup660.beetle.vs.leaf_twilight)
compare.beetle.vs.leaf_twilight.aim2 &lt;-<span class="st"> </span>com.bupcontrast.beetle.vs.leaf_twilight.aim2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)

##Beetle vs. Flower
Cbuprest580.beetle.vs.flower_twilight=
<span class="st">  </span>Cbuprest580_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest600.beetle.vs.flower_twilight=
<span class="st">  </span>Cbuprest600_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest620.beetle.vs.flower_twilight=
<span class="st">  </span>Cbuprest620_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest640.beetle.vs.flower_twilight=
<span class="st">  </span>Cbuprest640_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest660.beetle.vs.flower_twilight=
<span class="st">  </span>Cbuprest660_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

Cbuprest.beetle.vs.flower_twilight.aim2=
<span class="st">  </span>Cbuprest580.beetle.vs.flower_twilight <span class="op">%&gt;%</span><span class="kw">rbind</span>(Cbuprest600.beetle.vs.flower_twilight) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.beetle.vs.flower_twilight) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.beetle.vs.flower_twilight) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest660.beetle.vs.flower_twilight)

bup580.beetle.vs.flower_twilight&lt;-Cbuprest580.beetle.vs.flower_twilight[,<span class="dv">3</span>]
bup600.beetle.vs.flower_twilight&lt;-Cbuprest600.beetle.vs.flower_twilight[,<span class="dv">3</span>]
bup620.beetle.vs.flower_twilight&lt;-Cbuprest620.beetle.vs.flower_twilight[,<span class="dv">3</span>]
bup640.beetle.vs.flower_twilight&lt;-Cbuprest640.beetle.vs.flower_twilight[,<span class="dv">3</span>]
bup660.beetle.vs.flower_twilight&lt;-Cbuprest660.beetle.vs.flower_twilight[,<span class="dv">3</span>]

com.bupcontrast.beetle.vs.flower_twilight.aim2&lt;-<span class="kw">cbind</span>(Cbuprest.beetle.vs.flower_twilight.aim2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.beetle.vs.flower_twilight,bup600.beetle.vs.flower_twilight,bup620.beetle.vs.flower_twilight,bup640.beetle.vs.flower_twilight,bup660.beetle.vs.flower_twilight)
compare.beetle.vs.flower_twilight.aim2 &lt;-<span class="st"> </span>com.bupcontrast.beetle.vs.flower_twilight.aim2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.flower&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)</code></pre></div>
<div id="check-assumptions" class="section level2 tabset tabset-fade tabset-pills">
<h2>Check assumptions</h2>
<ul>
<li>Before running the GLMMs, we first check if the data follows the assumption of normality and homogeneity of variance</li>
</ul>
<p></br></p>
<p>Click the tabs to choose the assumptions ( <strong>Normality</strong> / <strong>Homogeneity</strong> ) of the visual models ( <strong>Aim 1</strong> / <strong>Aim 2</strong> ) under different light conditions ( <strong>Daylight</strong> / <strong>Twilight</strong>)</p>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#checking assumptions</span>
##D65 - Aim 1
res.flower.vs.leaf_d65.aim1&lt;-<span class="kw">lm</span>(compare.flower.vs.leaf.aim1<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.flower.vs.leaf.aim1<span class="op">$</span>peak_wl.flower.vs.leaf)
res.beetle.vs.leaf_d65.aim1&lt;-<span class="kw">lm</span>(compare.beetle.vs.leaf.aim1<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.beetle.vs.leaf.aim1<span class="op">$</span>peak_wl.beetle.vs.leaf)
res.beetle.vs.flower_d65.aim1&lt;-<span class="kw">lm</span>(compare.beetle.vs.flower.aim1<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.beetle.vs.flower.aim1<span class="op">$</span>peak_wl.beetle.vs.flower)

##D65 - Aim 2
res.flower.vs.leaf_d65.aim2&lt;-<span class="kw">lm</span>(compare.flower.vs.leaf.aim2<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.flower.vs.leaf.aim2<span class="op">$</span>peak_wl.flower.vs.leaf)
res.beetle.vs.leaf_d65.aim2&lt;-<span class="kw">lm</span>(compare.beetle.vs.leaf.aim2<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.beetle.vs.leaf.aim2<span class="op">$</span>peak_wl.beetle.vs.leaf)
res.beetle.vs.flower_d65.aim2&lt;-<span class="kw">lm</span>(compare.beetle.vs.flower.aim2<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.beetle.vs.flower.aim2<span class="op">$</span>peak_wl.beetle.vs.flower)

##Twilight - Aim 1
res.flower.vs.leaf_twilight.aim1&lt;-<span class="kw">lm</span>(compare.flower.vs.leaf.aim1<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.flower.vs.leaf.aim1<span class="op">$</span>peak_wl.flower.vs.leaf)
res.beetle.vs.leaf_twilight.aim1&lt;-<span class="kw">lm</span>(compare.beetle.vs.leaf.aim1<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.beetle.vs.leaf.aim1<span class="op">$</span>peak_wl.beetle.vs.leaf)
res.beetle.vs.flower_twilight.aim1&lt;-<span class="kw">lm</span>(compare.beetle.vs.flower.aim1<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.beetle.vs.flower.aim1<span class="op">$</span>peak_wl.beetle.vs.flower)

##Twilight - Aim 2
res.flower.vs.leaf_twilight.aim2&lt;-<span class="kw">lm</span>(compare.flower.vs.leaf.aim2<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.flower.vs.leaf.aim2<span class="op">$</span>peak_wl.flower.vs.leaf)
res.beetle.vs.leaf_twilight.aim2&lt;-<span class="kw">lm</span>(compare.beetle.vs.leaf.aim2<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.beetle.vs.leaf.aim2<span class="op">$</span>peak_wl.beetle.vs.leaf)
res.beetle.vs.flower_twilight.aim2&lt;-<span class="kw">lm</span>(compare.beetle.vs.flower.aim2<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.beetle.vs.flower.aim2<span class="op">$</span>peak_wl.beetle.vs.flower)</code></pre></div>
<div id="normality" class="section level3 tabset tabset-fade tabset-pills">
<h3>Normality</h3>
<div id="aim-1-1" class="section level4 tabset tabset-fade tabset-pills">
<h4>Aim 1</h4>
<div id="d65" class="section level5">
<h5>D65</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">pin=</span><span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>))
<span class="kw">qqnorm</span>(res.flower.vs.leaf_d65.aim1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Flower vs. Leaf&quot;</span>)
<span class="kw">qqnorm</span>(res.beetle.vs.leaf_d65.aim1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs. Leaf&quot;</span>)
<span class="kw">qqnorm</span>(res.beetle.vs.flower_d65.aim1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs. Flower&quot;</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="twilight-2" class="section level5">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">pin=</span><span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>))
<span class="kw">qqnorm</span>(res.flower.vs.leaf_twilight.aim1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Flower vs. Leaf&quot;</span>)
<span class="kw">qqnorm</span>(res.beetle.vs.leaf_twilight.aim1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs. Leaf&quot;</span>)
<span class="kw">qqnorm</span>(res.beetle.vs.flower_twilight.aim1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs. Flower&quot;</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
</div>
<div id="aim-2-1" class="section level4 tabset tabset-fade tabset-pills">
<h4>Aim 2</h4>
<div id="d65-1" class="section level5">
<h5>D65</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">pin=</span><span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>))
<span class="kw">qqnorm</span>(res.flower.vs.leaf_d65.aim2<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Flower vs. Leaf&quot;</span>)
<span class="kw">qqnorm</span>(res.beetle.vs.leaf_d65.aim2<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs. Leaf&quot;</span>)
<span class="kw">qqnorm</span>(res.beetle.vs.flower_d65.aim2<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs. Flower&quot;</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="twilight-3" class="section level5">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">pin=</span><span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>))
<span class="kw">qqnorm</span>(res.flower.vs.leaf_twilight.aim2<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Flower vs. Leaf&quot;</span>)
<span class="kw">qqnorm</span>(res.beetle.vs.leaf_twilight.aim2<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs. Leaf&quot;</span>)
<span class="kw">qqnorm</span>(res.beetle.vs.flower_twilight.aim2<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs. Flower&quot;</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="homoscedasticity" class="section level3 tabset tabset-fade tabset-pills">
<h3>Homoscedasticity</h3>
<div id="aim-1-2" class="section level4 tabset tabset-fade tabset-pills">
<h4>Aim 1</h4>
<div id="d65-2" class="section level5">
<h5>D65</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>)) <span class="co">#oma=c() to creat space for common lables</span>
<span class="kw">boxplot</span>(compare.flower.vs.leaf.aim1<span class="op">$</span>dS<span class="op">~</span>compare.flower.vs.leaf.aim1<span class="op">$</span>peak_wl.flower.vs.leaf, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Flower vs. Leaf&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USM&quot;</span>, <span class="st">&quot;USML&quot;</span>))
<span class="kw">boxplot</span>(compare.beetle.vs.leaf.aim1<span class="op">$</span>dS<span class="op">~</span>compare.beetle.vs.leaf.aim1<span class="op">$</span>peak_wl.beetle.vs.leaf, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Beetle vs. Leaf&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USM&quot;</span>, <span class="st">&quot;USML&quot;</span>))
<span class="kw">boxplot</span>(compare.beetle.vs.flower.aim1<span class="op">$</span>dS<span class="op">~</span>compare.beetle.vs.flower.aim1<span class="op">$</span>peak_wl.beetle.vs.flower, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Beetle vs. Flower&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USM&quot;</span>, <span class="st">&quot;USML&quot;</span>))
<span class="kw">mtext</span>(<span class="st">&quot;Visual system&quot;</span>,<span class="dt">side=</span><span class="dv">1</span>,<span class="dt">line=</span><span class="dv">0</span>,<span class="dt">outer=</span><span class="ot">TRUE</span>,<span class="dt">cex=</span><span class="fl">1.3</span>) <span class="co">#side assigns the position of the text e.g. bottom</span>
<span class="kw">mtext</span>(<span class="st">&quot;Contrast (JND)&quot;</span>,<span class="dt">side=</span><span class="dv">2</span>,<span class="dt">line=</span><span class="dv">0</span>,<span class="dt">outer=</span><span class="ot">TRUE</span>,<span class="dt">cex=</span><span class="fl">1.3</span>,<span class="dt">las=</span><span class="dv">0</span>) <span class="co">#las assigns the orientation of the text</span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="twilight-4" class="section level5">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))
<span class="kw">boxplot</span>(compare.flower.vs.leaf_twilight.aim1<span class="op">$</span>dS<span class="op">~</span>compare.flower.vs.leaf_twilight.aim1<span class="op">$</span>peak_wl.flower.vs.leaf, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Flower vs. Leaf&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USM&quot;</span>, <span class="st">&quot;USML&quot;</span>))
<span class="kw">boxplot</span>(compare.beetle.vs.leaf_twilight.aim1<span class="op">$</span>dS<span class="op">~</span>compare.beetle.vs.leaf_twilight.aim1<span class="op">$</span>peak_wl.beetle.vs.leaf, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Beetle vs. Leaf&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USM&quot;</span>, <span class="st">&quot;USML&quot;</span>))
<span class="kw">boxplot</span>(compare.beetle.vs.flower_twilight.aim1<span class="op">$</span>dS<span class="op">~</span>compare.beetle.vs.flower_twilight.aim1<span class="op">$</span>peak_wl.beetle.vs.flower, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Beetle vs. Flower&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USM&quot;</span>, <span class="st">&quot;USML&quot;</span>))
<span class="kw">mtext</span>(<span class="st">&quot;Visual system&quot;</span>,<span class="dt">side=</span><span class="dv">1</span>,<span class="dt">line=</span><span class="dv">0</span>,<span class="dt">outer=</span><span class="ot">TRUE</span>,<span class="dt">cex=</span><span class="fl">1.3</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Contrast (JND)&quot;</span>,<span class="dt">side=</span><span class="dv">2</span>,<span class="dt">line=</span><span class="dv">0</span>,<span class="dt">outer=</span><span class="ot">TRUE</span>,<span class="dt">cex=</span><span class="fl">1.3</span>,<span class="dt">las=</span><span class="dv">0</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
</div>
<div id="aim-2-2" class="section level4 tabset tabset-fade tabset-pills">
<h4>Aim 2</h4>
<div id="d65-3" class="section level5">
<h5>D65</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))
<span class="kw">boxplot</span>(compare.flower.vs.leaf.aim2<span class="op">$</span>dS<span class="op">~</span>compare.flower.vs.leaf.aim2<span class="op">$</span>peak_wl.flower.vs.leaf, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Flower vs. Leaf&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>, <span class="st">&quot;VS 640&quot;</span>, <span class="st">&quot;VS 660&quot;</span>))
<span class="kw">boxplot</span>(compare.beetle.vs.leaf.aim2<span class="op">$</span>dS<span class="op">~</span>compare.beetle.vs.leaf.aim2<span class="op">$</span>peak_wl.beetle.vs.leaf, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Beetle vs. Leaf&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>, <span class="st">&quot;VS 640&quot;</span>, <span class="st">&quot;VS 660&quot;</span>))
<span class="kw">boxplot</span>(compare.beetle.vs.flower.aim2<span class="op">$</span>dS<span class="op">~</span>compare.beetle.vs.flower.aim2<span class="op">$</span>peak_wl.beetle.vs.flower, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Beetle vs. Flower&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>, <span class="st">&quot;VS 640&quot;</span>, <span class="st">&quot;VS 660&quot;</span>))
<span class="kw">mtext</span>(<span class="st">&quot;Visual system&quot;</span>,<span class="dt">side=</span><span class="dv">1</span>,<span class="dt">line=</span><span class="dv">0</span>,<span class="dt">outer=</span><span class="ot">TRUE</span>,<span class="dt">cex=</span><span class="fl">1.3</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Contrast (JND)&quot;</span>,<span class="dt">side=</span><span class="dv">2</span>,<span class="dt">line=</span><span class="dv">0</span>,<span class="dt">outer=</span><span class="ot">TRUE</span>,<span class="dt">cex=</span><span class="fl">1.3</span>,<span class="dt">las=</span><span class="dv">0</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="twilight-5" class="section level5">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))
<span class="kw">boxplot</span>(compare.flower.vs.leaf_twilight.aim2<span class="op">$</span>dS<span class="op">~</span>compare.flower.vs.leaf_twilight.aim2<span class="op">$</span>peak_wl.flower.vs.leaf, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Flower vs. Leaf&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>, <span class="st">&quot;VS 640&quot;</span>, <span class="st">&quot;VS 660&quot;</span>))
<span class="kw">boxplot</span>(compare.beetle.vs.leaf_twilight.aim2<span class="op">$</span>dS<span class="op">~</span>compare.beetle.vs.leaf_twilight.aim2<span class="op">$</span>peak_wl.beetle.vs.leaf, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Beetle vs. Leaf&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>, <span class="st">&quot;VS 640&quot;</span>, <span class="st">&quot;VS 660&quot;</span>))
<span class="kw">boxplot</span>(compare.beetle.vs.flower_twilight.aim2<span class="op">$</span>dS<span class="op">~</span>compare.beetle.vs.flower_twilight.aim2<span class="op">$</span>peak_wl.beetle.vs.flower, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Beetle vs. Flower&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>, <span class="st">&quot;VS 640&quot;</span>, <span class="st">&quot;VS 660&quot;</span>))
<span class="kw">mtext</span>(<span class="st">&quot;Visual system&quot;</span>,<span class="dt">side=</span><span class="dv">1</span>,<span class="dt">line=</span><span class="dv">0</span>,<span class="dt">outer=</span><span class="ot">TRUE</span>,<span class="dt">cex=</span><span class="fl">1.3</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Contrast (JND)&quot;</span>,<span class="dt">side=</span><span class="dv">2</span>,<span class="dt">line=</span><span class="dv">0</span>,<span class="dt">outer=</span><span class="ot">TRUE</span>,<span class="dt">cex=</span><span class="fl">1.3</span>,<span class="dt">las=</span><span class="dv">0</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p></br> </br></p>
</div>
</div>
</div>
</div>
<div id="glmm-results" class="section level2">
<h2>GLMM results</h2>
<p></br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#GLMM - D65 - Aim 1</span>
##Flower vs. Leaf
m.flower.vs.leaf_d65.aim1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.flower.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.flower.vs.leaf.aim1,<span class="dt">REML=</span>F)
sum.flower.vs.leaf_d65.aim1&lt;-<span class="kw">summary</span>(<span class="kw">glht</span>(m.flower.vs.leaf_d65.aim1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.flower.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
<span class="co">#REML=F, in order to fit the model using the likelihood ratio test. Otherwise, the lmer default will fit the model using the REML (REstricted Maximum Likelihood) criterion.</span>

##Beetle vs. Leaf
m.beetle.vs.leaf_d65.aim1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.leaf.aim1,<span class="dt">REML=</span>F)
sum.beetle.vs.leaf_d65.aim1 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.leaf_d65.aim1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))

##Beetle vs. Flower
m.beetle.vs.flower_d65.aim1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.flower <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.flower.aim1,<span class="dt">REML=</span>F)
sum.beetle.vs.flower_d65.aim1 &lt;-<span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.flower_d65.aim1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.flower =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))

###reshape data for heatmap
p1_d65.aim1&lt;-sum.flower.vs.leaf_d65.aim1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p2_d65.aim1&lt;-sum.beetle.vs.leaf_d65.aim1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p3_d65.aim1&lt;-sum.beetle.vs.flower_d65.aim1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]

VislistA_d65.aim1&lt;-<span class="kw">c</span>(<span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USM&quot;</span>,<span class="st">&quot;USML&quot;</span>,<span class="st">&quot;USM&quot;</span>,<span class="st">&quot;USML&quot;</span>,<span class="st">&quot;USML&quot;</span>)
VislistB_d65.aim1&lt;-<span class="kw">c</span>(<span class="st">&quot;UML&quot;</span>, <span class="st">&quot;UML&quot;</span>,<span class="st">&quot;UML&quot;</span>,<span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USM&quot;</span>)

heat_d65.aim1&lt;-<span class="kw">data.frame</span>(<span class="kw">names</span>(p1_d65.aim1),<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p1_d65.aim1,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p2_d65.aim1,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p3_d65.aim1,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">orignial.list =</span> <span class="dv">1</span>, <span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistA_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistB_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>orignial.list)

##add asterisks for significant pairs
heat_d65.aim1<span class="op">$</span>sig.flower.vs.leaf[heat_d65.aim1<span class="op">$</span>flower.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat_d65.aim1<span class="op">$</span>sig.flower.vs.leaf[heat_d65.aim1<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat_d65.aim1<span class="op">$</span>sig.flower.vs.leaf[heat_d65.aim1<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat_d65.aim1<span class="op">$</span>sig.flower.vs.leaf[heat_d65.aim1<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>
heat_d65.aim1<span class="op">$</span>sig.beetle.vs.leaf[heat_d65.aim1<span class="op">$</span>beetle.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat_d65.aim1<span class="op">$</span>sig.beetle.vs.leaf[heat_d65.aim1<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat_d65.aim1<span class="op">$</span>sig.beetle.vs.leaf[heat_d65.aim1<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat_d65.aim1<span class="op">$</span>sig.beetle.vs.leaf[heat_d65.aim1<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>
heat_d65.aim1<span class="op">$</span>sig.beetle.vs.flower[heat_d65.aim1<span class="op">$</span>beetle.vs.flower <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat_d65.aim1<span class="op">$</span>sig.beetle.vs.flower[heat_d65.aim1<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat_d65.aim1<span class="op">$</span>sig.beetle.vs.flower[heat_d65.aim1<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat_d65.aim1<span class="op">$</span>sig.beetle.vs.flower[heat_d65.aim1<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>


<span class="co">#GLMM - D65 - Aim 2</span>
##Flower vs. Leaf
m.flower.vs.leaf_d65.aim2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.flower.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.flower.vs.leaf.aim2,<span class="dt">REML=</span>F)
sum.flower.vs.leaf_d65.aim2 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.flower.vs.leaf_d65.aim2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.flower.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
##Beetle vs. Leaf
m.beetle.vs.leaf_d65.aim2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.leaf.aim2,<span class="dt">REML=</span>F)
sum.beetle.vs.leaf_d65.aim2 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.leaf_d65.aim2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
##Beetle vs. Flower
m.beetle.vs.flower_d65.aim2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.flower <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.flower.aim2,<span class="dt">REML=</span>F)
sum.beetle.vs.flower_d65.aim2 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.flower_d65.aim2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.flower =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))

###reshape data for heatmap
p1_d65.aim2&lt;-sum.flower.vs.leaf_d65.aim2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p2_d65.aim2&lt;-sum.beetle.vs.leaf_d65.aim2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p3_d65.aim2&lt;-sum.beetle.vs.flower_d65.aim2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]

VislistA_d65.aim2&lt;-<span class="kw">c</span>(<span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 660&quot;</span>)
VislistB_d65.aim2&lt;-<span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>)

heat_d65.aim2&lt;-<span class="kw">data.frame</span>(<span class="kw">names</span>(p1_d65.aim2),<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p1_d65.aim2,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p2_d65.aim2,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p3_d65.aim2,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">orignial.list =</span> <span class="dv">1</span>, <span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistA_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistB_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>orignial.list)

##add asterisks for significant pairs
heat_d65.aim2<span class="op">$</span>sig.flower.vs.leaf[heat_d65.aim2<span class="op">$</span>flower.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat_d65.aim2<span class="op">$</span>sig.flower.vs.leaf[heat_d65.aim2<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat_d65.aim2<span class="op">$</span>sig.flower.vs.leaf[heat_d65.aim2<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat_d65.aim2<span class="op">$</span>sig.flower.vs.leaf[heat_d65.aim2<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>
heat_d65.aim2<span class="op">$</span>sig.beetle.vs.leaf[heat_d65.aim2<span class="op">$</span>beetle.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat_d65.aim2<span class="op">$</span>sig.beetle.vs.leaf[heat_d65.aim2<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat_d65.aim2<span class="op">$</span>sig.beetle.vs.leaf[heat_d65.aim2<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat_d65.aim2<span class="op">$</span>sig.beetle.vs.leaf[heat_d65.aim2<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>
heat_d65.aim2<span class="op">$</span>sig.beetle.vs.flower[heat_d65.aim2<span class="op">$</span>beetle.vs.flower <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat_d65.aim2<span class="op">$</span>sig.beetle.vs.flower[heat_d65.aim2<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat_d65.aim2<span class="op">$</span>sig.beetle.vs.flower[heat_d65.aim2<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat_d65.aim2<span class="op">$</span>sig.beetle.vs.flower[heat_d65.aim2<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>




<span class="co">#GLMM - Twilight - Aim 1</span>
##Flower vs. Leaf
m.flower.vs.leaf_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.flower.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.flower.vs.leaf_twilight.aim1,<span class="dt">REML=</span>F)
sum.flower.vs.leaf_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.flower.vs.leaf_twilight.aim1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.flower.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
##Beetle vs. Leaf
m.beetle.vs.leaf_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.leaf_twilight.aim1,<span class="dt">REML=</span>F)
sum.beetle.vs.leaf_twilight.aim1&lt;-<span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.leaf_twilight.aim1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
##Beetle vs. Flower
m.beetle.vs.flower_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.flower <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.flower_twilight.aim1,<span class="dt">REML=</span>F)
sum.beetle.vs.flower_twilight.aim1&lt;-<span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.flower_twilight.aim1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.flower =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
###reshape data for heatmap
p1_twilight.aim1&lt;-sum.flower.vs.leaf_twilight.aim1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p2_twilight.aim1&lt;-sum.beetle.vs.leaf_twilight.aim1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p3_twilight.aim1&lt;-sum.beetle.vs.flower_twilight.aim1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]

VislistA_twilight.aim1&lt;-<span class="kw">c</span>(<span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USM&quot;</span>,<span class="st">&quot;USML&quot;</span>,<span class="st">&quot;USM&quot;</span>,<span class="st">&quot;USML&quot;</span>,<span class="st">&quot;USML&quot;</span>)
VislistB_twilight.aim1&lt;-<span class="kw">c</span>(<span class="st">&quot;UML&quot;</span>, <span class="st">&quot;UML&quot;</span>,<span class="st">&quot;UML&quot;</span>,<span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USM&quot;</span>)

heat_twilight.aim1&lt;-<span class="kw">data.frame</span>(<span class="kw">names</span>(p1_twilight.aim1),<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p1_twilight.aim1,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p2_twilight.aim1,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p3_twilight.aim1,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">orignial.list =</span> <span class="dv">1</span>, <span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistA_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistB_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>orignial.list)

##add asterisks for significant pairs
heat_twilight.aim1<span class="op">$</span>sig.flower.vs.leaf[heat_twilight.aim1<span class="op">$</span>flower.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat_twilight.aim1<span class="op">$</span>sig.flower.vs.leaf[heat_twilight.aim1<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat_twilight.aim1<span class="op">$</span>sig.flower.vs.leaf[heat_twilight.aim1<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat_twilight.aim1<span class="op">$</span>sig.flower.vs.leaf[heat_twilight.aim1<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>
heat_twilight.aim1<span class="op">$</span>sig.beetle.vs.leaf[heat_twilight.aim1<span class="op">$</span>beetle.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat_twilight.aim1<span class="op">$</span>sig.beetle.vs.leaf[heat_twilight.aim1<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat_twilight.aim1<span class="op">$</span>sig.beetle.vs.leaf[heat_twilight.aim1<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat_twilight.aim1<span class="op">$</span>sig.beetle.vs.leaf[heat_twilight.aim1<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>
heat_twilight.aim1<span class="op">$</span>sig.beetle.vs.flower[heat_twilight.aim1<span class="op">$</span>beetle.vs.flower <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat_twilight.aim1<span class="op">$</span>sig.beetle.vs.flower[heat_twilight.aim1<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat_twilight.aim1<span class="op">$</span>sig.beetle.vs.flower[heat_twilight.aim1<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat_twilight.aim1<span class="op">$</span>sig.beetle.vs.flower[heat_twilight.aim1<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>




<span class="co">#GLMM - Twilight - Aim 2</span>
##Flower vs. Leaf
m.flower.vs.leaf_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.flower.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.flower.vs.leaf_twilight.aim2,<span class="dt">REML=</span>F)
sum.flower.vs.leaf_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.flower.vs.leaf_twilight.aim2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.flower.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
##Beetle vs. Leaf
m.beetle.vs.leaf_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.leaf_twilight.aim2,<span class="dt">REML=</span>F)
sum.beetle.vs.leaf_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.leaf_twilight.aim2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
##Beetle vs. Flower
m.beetle.vs.flower_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.flower <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.flower_twilight.aim2,<span class="dt">REML=</span>F)
sum.beetle.vs.flower_twilight.aim2 &lt;-<span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.flower_twilight.aim2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.flower =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
###reshape data for heatmap
p1_twilight.aim2&lt;-sum.flower.vs.leaf_twilight.aim2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p2_twilight.aim2&lt;-sum.beetle.vs.leaf_twilight.aim2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p3_twilight.aim2&lt;-sum.beetle.vs.flower_twilight.aim2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]

VislistA_twilight.aim2&lt;-<span class="kw">c</span>(<span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 660&quot;</span>)
VislistB_twilight.aim2&lt;-<span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>)

heat_twilight.aim2&lt;-<span class="kw">data.frame</span>(<span class="kw">names</span>(p1_twilight.aim2),<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p1_twilight.aim2,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p2_twilight.aim2,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p3_twilight.aim2,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">orignial.list =</span> <span class="dv">1</span>, <span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistA_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistB_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>orignial.list)

##add asterisks for significant pairs
heat_twilight.aim2<span class="op">$</span>sig.flower.vs.leaf[heat_twilight.aim2<span class="op">$</span>flower.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat_twilight.aim2<span class="op">$</span>sig.flower.vs.leaf[heat_twilight.aim2<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat_twilight.aim2<span class="op">$</span>sig.flower.vs.leaf[heat_twilight.aim2<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat_twilight.aim2<span class="op">$</span>sig.flower.vs.leaf[heat_twilight.aim2<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>
heat_twilight.aim2<span class="op">$</span>sig.beetle.vs.leaf[heat_twilight.aim2<span class="op">$</span>beetle.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat_twilight.aim2<span class="op">$</span>sig.beetle.vs.leaf[heat_twilight.aim2<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat_twilight.aim2<span class="op">$</span>sig.beetle.vs.leaf[heat_twilight.aim2<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat_twilight.aim2<span class="op">$</span>sig.beetle.vs.leaf[heat_twilight.aim2<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>
heat_twilight.aim2<span class="op">$</span>sig.beetle.vs.flower[heat_twilight.aim2<span class="op">$</span>beetle.vs.flower <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat_twilight.aim2<span class="op">$</span>sig.beetle.vs.flower[heat_twilight.aim2<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat_twilight.aim2<span class="op">$</span>sig.beetle.vs.flower[heat_twilight.aim2<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat_twilight.aim2<span class="op">$</span>sig.beetle.vs.flower[heat_twilight.aim2<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></code></pre></div>
<div id="results-of-aim-1-comparing-visual-systems-with-different-photoreceptor-combinations" class="section level3 tabset tabset-fade tabset-pills">
<h3>Results of Aim 1: comparing visual systems with different photoreceptor combinations</h3>
<p></br></p>
<p>Click the tabs to see the results for each comparison group ( <strong>Flower vs. Leaf</strong> / <strong>Beetle vs. Leaf</strong> / <strong>Beetle vs. Flower</strong>) and under different light conditions ( <strong>Daylight</strong> / <strong>Twilight</strong>)</p>
<p></br></p>
<div id="flower-vs.leaf" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Flower vs. Leaf</strong></h4>
<div id="daylight-2" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.flower.vs.leaf_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.flower.vs.leaf</strong></td>
<td align="center">87.21</td>
<td align="center">3</td>
<td align="center">8.714e-19</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_d65.aim1, <span class="dt">y=</span>VislistB_d65.aim1, <span class="dt">fill=</span>flower.vs.leaf)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_d65.aim1, VislistB_d65.aim1, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(flower.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.flower.vs.leaf)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),
        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
<div id="original-model-output" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.flower.vs.leaf_d65.aim1</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.flower.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.flower.vs.leaf.aim1, REML = F)
## 
## Linear Hypotheses:
##                                                                          Estimate
## contrast.UVSW..LW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0  0.50672
## contrast.UVSWMW...flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0  0.36017
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0  0.32362
## contrast.UVSWMW...flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0 -0.14655
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0 -0.18310
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSWMW...flower.vs.leaf == 0 -0.03656
##                                                                          Std. Error
## contrast.UVSW..LW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0    0.05603
## contrast.UVSWMW...flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0    0.05603
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0    0.05603
## contrast.UVSWMW...flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0    0.05603
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0    0.05603
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSWMW...flower.vs.leaf == 0    0.05603
##                                                                          z value
## contrast.UVSW..LW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0   9.044
## contrast.UVSWMW...flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0   6.428
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0   5.776
## contrast.UVSWMW...flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0  -2.615
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0  -3.268
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSWMW...flower.vs.leaf == 0  -0.652
##                                                                          Pr(&gt;|z|)
## contrast.UVSW..LW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0  &lt; 2e-16
## contrast.UVSWMW...flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0 7.75e-10
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0 4.60e-08
## contrast.UVSWMW...flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0   0.0535
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0   0.0065
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSWMW...flower.vs.leaf == 0   1.0000
##                                                                             
## contrast.UVSW..LW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0 ***
## contrast.UVSWMW...flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0 ***
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UV..MWLW.flower.vs.leaf == 0 ***
## contrast.UVSWMW...flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0 .  
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSW..LW.flower.vs.leaf == 0 ** 
## contrast.UVSWMWLW.flower.vs.leaf - contrast.UVSWMW...flower.vs.leaf == 0    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-6" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.flower.vs.leaf_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.flower.vs.leaf</strong></td>
<td align="center">412.9</td>
<td align="center">3</td>
<td align="center">3.579e-89</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-1" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.aim1, <span class="dt">y=</span>VislistB_twilight.aim1, <span class="dt">fill=</span>flower.vs.leaf)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.aim1, VislistB_twilight.aim1, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(flower.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.flower.vs.leaf)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),
        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
<div id="original-model-output-1" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.flower.vs.leaf_twilight.aim1</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.flower.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.flower.vs.leaf_twilight.aim1, REML = F)
## 
## Linear Hypotheses:
##                                                                                             Estimate
## contrast.UVSW..LW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0  0.053522
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0  0.018899
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0  0.114977
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0 -0.034623
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0  0.061455
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSWMW...flower.vs.leaf_twilight == 0  0.096078
##                                                                                            Std. Error
## contrast.UVSW..LW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0   0.006092
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0   0.006092
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0   0.006092
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0   0.006092
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0   0.006092
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSWMW...flower.vs.leaf_twilight == 0   0.006092
##                                                                                            z value
## contrast.UVSW..LW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0   8.785
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0   3.102
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0  18.873
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0  -5.683
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0  10.088
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSWMW...flower.vs.leaf_twilight == 0  15.771
##                                                                                            Pr(&gt;|z|)
## contrast.UVSW..LW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0  &lt; 2e-16
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0   0.0115
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0  &lt; 2e-16
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0 7.93e-08
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0  &lt; 2e-16
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSWMW...flower.vs.leaf_twilight == 0  &lt; 2e-16
##                                                                                               
## contrast.UVSW..LW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0 ***
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0 *  
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UV..MWLW.flower.vs.leaf_twilight == 0 ***
## contrast.UVSWMW...flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0 ***
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSW..LW.flower.vs.leaf_twilight == 0 ***
## contrast.UVSWMWLW.flower.vs.leaf_twilight - contrast.UVSWMW...flower.vs.leaf_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
</div>
<div id="beetle-vs.leaf" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Beetle vs. Leaf</strong></h4>
<div id="daylight-3" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.beetle.vs.leaf_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.leaf</strong></td>
<td align="center">214.2</td>
<td align="center">3</td>
<td align="center">3.594e-46</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-2" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_d65.aim1, <span class="dt">y=</span>VislistB_d65.aim1, <span class="dt">fill=</span>beetle.vs.leaf)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_d65.aim1, VislistB_d65.aim1, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.leaf))) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),
        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="original-model-output-2" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.beetle.vs.leaf_d65.aim1</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.beetle.vs.leaf.aim1, REML = F)
## 
## Linear Hypotheses:
##                                                                          Estimate
## contrast.UVSW..LW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0  0.02591
## contrast.UVSWMW...beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0 -0.66337
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0 -0.06409
## contrast.UVSWMW...beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0 -0.68928
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0 -0.09001
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSWMW...beetle.vs.leaf == 0  0.59928
##                                                                          Std. Error
## contrast.UVSW..LW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0    0.05481
## contrast.UVSWMW...beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0    0.05481
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0    0.05481
## contrast.UVSWMW...beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0    0.05481
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0    0.05481
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSWMW...beetle.vs.leaf == 0    0.05481
##                                                                          z value
## contrast.UVSW..LW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0   0.473
## contrast.UVSWMW...beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0 -12.102
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0  -1.169
## contrast.UVSWMW...beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0 -12.575
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0  -1.642
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSWMW...beetle.vs.leaf == 0  10.933
##                                                                          Pr(&gt;|z|)
## contrast.UVSW..LW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0    1.000
## contrast.UVSWMW...beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0   &lt;2e-16
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0    1.000
## contrast.UVSWMW...beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0   &lt;2e-16
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0    0.603
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSWMW...beetle.vs.leaf == 0   &lt;2e-16
##                                                                             
## contrast.UVSW..LW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0    
## contrast.UVSWMW...beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0 ***
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UV..MWLW.beetle.vs.leaf == 0    
## contrast.UVSWMW...beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0 ***
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSW..LW.beetle.vs.leaf == 0    
## contrast.UVSWMWLW.beetle.vs.leaf - contrast.UVSWMW...beetle.vs.leaf == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-7" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.beetle.vs.leaf_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.leaf</strong></td>
<td align="center">690.7</td>
<td align="center">3</td>
<td align="center">2.184e-149</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-3" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.aim1, <span class="dt">y=</span>VislistB_twilight.aim1, <span class="dt">fill=</span>beetle.vs.leaf)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.aim1, VislistB_twilight.aim1, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.leaf))) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),
        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
<div id="original-model-output-3" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.beetle.vs.leaf_twilight.aim1</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.beetle.vs.leaf_twilight.aim1, REML = F)
## 
## Linear Hypotheses:
##                                                                                             Estimate
## contrast.UVSW..LW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0 -0.006644
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0 -0.076752
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0  0.039485
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0 -0.070108
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0  0.046129
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSWMW...beetle.vs.leaf_twilight == 0  0.116237
##                                                                                            Std. Error
## contrast.UVSW..LW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0   0.004506
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0   0.004506
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0   0.004506
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0   0.004506
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0   0.004506
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSWMW...beetle.vs.leaf_twilight == 0   0.004506
##                                                                                            z value
## contrast.UVSW..LW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0  -1.474
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0 -17.033
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0   8.763
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0 -15.559
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0  10.237
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSWMW...beetle.vs.leaf_twilight == 0  25.796
##                                                                                            Pr(&gt;|z|)
## contrast.UVSW..LW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0    0.842
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0   &lt;2e-16
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0   &lt;2e-16
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0   &lt;2e-16
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0   &lt;2e-16
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSWMW...beetle.vs.leaf_twilight == 0   &lt;2e-16
##                                                                                               
## contrast.UVSW..LW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0    
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0 ***
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UV..MWLW.beetle.vs.leaf_twilight == 0 ***
## contrast.UVSWMW...beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0 ***
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSW..LW.beetle.vs.leaf_twilight == 0 ***
## contrast.UVSWMWLW.beetle.vs.leaf_twilight - contrast.UVSWMW...beetle.vs.leaf_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
</div>
<div id="beetle-vs.flower" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Beetle vs. Flower</strong></h4>
<div id="daylight-4" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.beetle.vs.flower_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:78%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="43%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.flower</strong></td>
<td align="center">69.17</td>
<td align="center">3</td>
<td align="center">6.429e-15</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-4" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_d65.aim1, <span class="dt">y=</span>VislistB_d65.aim1, <span class="dt">fill=</span>beetle.vs.flower)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_d65.aim1, VislistB_d65.aim1, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.flower, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.flower)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour </span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),
        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
<div id="original-model-output-4" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.beetle.vs.flower_d65.aim1</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.flower + (1 | patch2) + 
##     (1 | patch1), data = compare.beetle.vs.flower.aim1, REML = F)
## 
## Linear Hypotheses:
##                                                                              Estimate
## contrast.UVSW..LW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0  0.64316
## contrast.UVSWMW...beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0  0.23613
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0  0.40918
## contrast.UVSWMW...beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0 -0.40703
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0 -0.23398
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSWMW...beetle.vs.flower == 0  0.17305
##                                                                              Std. Error
## contrast.UVSW..LW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0    0.08008
## contrast.UVSWMW...beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0    0.08008
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0    0.08008
## contrast.UVSWMW...beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0    0.08008
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0    0.08008
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSWMW...beetle.vs.flower == 0    0.08008
##                                                                              z value
## contrast.UVSW..LW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0   8.031
## contrast.UVSWMW...beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0   2.949
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0   5.109
## contrast.UVSWMW...beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0  -5.083
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0  -2.922
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSWMW...beetle.vs.flower == 0   2.161
##                                                                              Pr(&gt;|z|)
## contrast.UVSW..LW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0 5.33e-15
## contrast.UVSWMW...beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0   0.0192
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0 1.94e-06
## contrast.UVSWMW...beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0 2.23e-06
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0   0.0209
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSWMW...beetle.vs.flower == 0   0.1842
##                                                                                 
## contrast.UVSW..LW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0 ***
## contrast.UVSWMW...beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0 *  
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UV..MWLW.beetle.vs.flower == 0 ***
## contrast.UVSWMW...beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0 ***
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSW..LW.beetle.vs.flower == 0 *  
## contrast.UVSWMWLW.beetle.vs.flower - contrast.UVSWMW...beetle.vs.flower == 0    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-8" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.beetle.vs.flower_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:78%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="43%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.flower</strong></td>
<td align="center">342.6</td>
<td align="center">3</td>
<td align="center">5.872e-74</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-5" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.aim1, <span class="dt">y=</span>VislistB_twilight.aim1, <span class="dt">fill=</span>beetle.vs.flower)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.aim1, VislistB_twilight.aim1, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.flower, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.flower)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),
        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p value&quot;</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
</div>
<div id="original-model-output-5" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.beetle.vs.flower_twilight.aim1</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.flower + (1 | patch2) + 
##     (1 | patch1), data = compare.beetle.vs.flower_twilight.aim1, 
##     REML = F)
## 
## Linear Hypotheses:
##                                                                                                 Estimate
## contrast.UVSW..LW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0  0.064493
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0  0.001683
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0  0.132826
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0 -0.062810
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0  0.068333
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSWMW...beetle.vs.flower_twilight == 0  0.131143
##                                                                                                Std. Error
## contrast.UVSW..LW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0   0.008336
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0   0.008336
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0   0.008336
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0   0.008336
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0   0.008336
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSWMW...beetle.vs.flower_twilight == 0   0.008336
##                                                                                                z value
## contrast.UVSW..LW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0   7.737
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0   0.202
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0  15.934
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0  -7.535
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0   8.197
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSWMW...beetle.vs.flower_twilight == 0  15.732
##                                                                                                Pr(&gt;|z|)
## contrast.UVSW..LW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0 6.13e-14
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0        1
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0  &lt; 2e-16
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0 2.93e-13
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0 1.33e-15
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSWMW...beetle.vs.flower_twilight == 0  &lt; 2e-16
##                                                                                                   
## contrast.UVSW..LW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0 ***
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0    
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UV..MWLW.beetle.vs.flower_twilight == 0 ***
## contrast.UVSWMW...beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0 ***
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSW..LW.beetle.vs.flower_twilight == 0 ***
## contrast.UVSWMWLW.beetle.vs.flower_twilight - contrast.UVSWMW...beetle.vs.flower_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
</div>
</div>
<div id="results-of-aim-2-comparing-visual-systems-with-different-lws-peak-sensitivities" class="section level3 tabset tabset-fade tabset-pills">
<h3>Results of Aim 2: comparing visual systems with different LWS peak sensitivities</h3>
<p></br></p>
<p>Click the tabs to see the results for each comparison group ( <strong>Flower vs. Leaf</strong> / <strong>Beetle vs. Leaf</strong> / <strong>Beetle vs. Flower</strong>) and under different light conditions ( <strong>Daylight</strong> / <strong>Twilight</strong>)</p>
<p></br></p>
<div id="flower-vs.leaf-1" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Flower vs. Leaf</strong></h4>
<div id="daylight-5" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.flower.vs.leaf_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.flower.vs.leaf</strong></td>
<td align="center">1460</td>
<td align="center">4</td>
<td align="center">5.604e-315</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-6" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_d65.aim2, <span class="dt">y=</span>VislistB_d65.aim2, <span class="dt">fill=</span>flower.vs.leaf)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_d65.aim2, VislistB_d65.aim2, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(flower.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.flower.vs.leaf)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),
        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
<div id="original-model-output-6" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.flower.vs.leaf_d65.aim2</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.flower.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.flower.vs.leaf.aim2, REML = F)
## 
## Linear Hypotheses:
##                                                    Estimate Std. Error z value
## bup600.flower.vs.leaf - bup580.flower.vs.leaf == 0   0.2557     0.0193  13.249
## bup620.flower.vs.leaf - bup580.flower.vs.leaf == 0   0.5510     0.0193  28.546
## bup640.flower.vs.leaf - bup580.flower.vs.leaf == 0   0.6528     0.0193  33.819
## bup660.flower.vs.leaf - bup580.flower.vs.leaf == 0   0.4737     0.0193  24.541
## bup620.flower.vs.leaf - bup600.flower.vs.leaf == 0   0.2953     0.0193  15.297
## bup640.flower.vs.leaf - bup600.flower.vs.leaf == 0   0.3970     0.0193  20.570
## bup660.flower.vs.leaf - bup600.flower.vs.leaf == 0   0.2180     0.0193  11.292
## bup640.flower.vs.leaf - bup620.flower.vs.leaf == 0   0.1018     0.0193   5.273
## bup660.flower.vs.leaf - bup620.flower.vs.leaf == 0  -0.0773     0.0193  -4.005
## bup660.flower.vs.leaf - bup640.flower.vs.leaf == 0  -0.1791     0.0193  -9.278
##                                                    Pr(&gt;|z|)    
## bup600.flower.vs.leaf - bup580.flower.vs.leaf == 0  &lt; 2e-16 ***
## bup620.flower.vs.leaf - bup580.flower.vs.leaf == 0  &lt; 2e-16 ***
## bup640.flower.vs.leaf - bup580.flower.vs.leaf == 0  &lt; 2e-16 ***
## bup660.flower.vs.leaf - bup580.flower.vs.leaf == 0  &lt; 2e-16 ***
## bup620.flower.vs.leaf - bup600.flower.vs.leaf == 0  &lt; 2e-16 ***
## bup640.flower.vs.leaf - bup600.flower.vs.leaf == 0  &lt; 2e-16 ***
## bup660.flower.vs.leaf - bup600.flower.vs.leaf == 0  &lt; 2e-16 ***
## bup640.flower.vs.leaf - bup620.flower.vs.leaf == 0 1.34e-06 ***
## bup660.flower.vs.leaf - bup620.flower.vs.leaf == 0 0.000621 ***
## bup660.flower.vs.leaf - bup640.flower.vs.leaf == 0  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-9" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.flower.vs.leaf_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.flower.vs.leaf</strong></td>
<td align="center">2189</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-7" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.aim2, <span class="dt">y=</span>VislistB_twilight.aim2, <span class="dt">fill=</span>flower.vs.leaf)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.aim2, VislistB_twilight.aim2, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(flower.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.flower.vs.leaf)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),
        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
<div id="original-model-output-7" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.flower.vs.leaf_twilight.aim2</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.flower.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.flower.vs.leaf_twilight.aim2, REML = F)
## 
## Linear Hypotheses:
##                                                                       Estimate
## bup600.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  0.044608
## bup620.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  0.091530
## bup640.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  0.096832
## bup660.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  0.067608
## bup620.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0  0.046922
## bup640.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0  0.052224
## bup660.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0  0.022999
## bup640.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0  0.005302
## bup660.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0 -0.023923
## bup660.flower.vs.leaf_twilight - bup640.flower.vs.leaf_twilight == 0 -0.029225
##                                                                      Std. Error
## bup600.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0   0.002389
## bup620.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0   0.002389
## bup640.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0   0.002389
## bup660.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0   0.002389
## bup620.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0   0.002389
## bup640.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0   0.002389
## bup660.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0   0.002389
## bup640.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0   0.002389
## bup660.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0   0.002389
## bup660.flower.vs.leaf_twilight - bup640.flower.vs.leaf_twilight == 0   0.002389
##                                                                      z value
## bup600.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  18.676
## bup620.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  38.320
## bup640.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  40.540
## bup660.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0  28.305
## bup620.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0  19.644
## bup640.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0  21.864
## bup660.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0   9.629
## bup640.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0   2.220
## bup660.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0 -10.016
## bup660.flower.vs.leaf_twilight - bup640.flower.vs.leaf_twilight == 0 -12.235
##                                                                      Pr(&gt;|z|)
## bup600.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0   &lt;2e-16
## bup620.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0   &lt;2e-16
## bup640.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0   &lt;2e-16
## bup660.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0   &lt;2e-16
## bup620.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0   &lt;2e-16
## bup640.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0   &lt;2e-16
## bup660.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0   &lt;2e-16
## bup640.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0    0.264
## bup660.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0   &lt;2e-16
## bup660.flower.vs.leaf_twilight - bup640.flower.vs.leaf_twilight == 0   &lt;2e-16
##                                                                         
## bup600.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0 ***
## bup620.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0 ***
## bup640.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0 ***
## bup660.flower.vs.leaf_twilight - bup580.flower.vs.leaf_twilight == 0 ***
## bup620.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0 ***
## bup640.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0 ***
## bup660.flower.vs.leaf_twilight - bup600.flower.vs.leaf_twilight == 0 ***
## bup640.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0    
## bup660.flower.vs.leaf_twilight - bup620.flower.vs.leaf_twilight == 0 ***
## bup660.flower.vs.leaf_twilight - bup640.flower.vs.leaf_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
</div>
<div id="beetle-vs.leaf-1" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Beetle vs. Leaf</strong></h4>
<div id="daylight-6" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.beetle.vs.leaf_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.leaf</strong></td>
<td align="center">4851</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-8" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_d65.aim2, <span class="dt">y=</span>VislistB_d65.aim2, <span class="dt">fill=</span>beetle.vs.leaf)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_d65.aim2, VislistB_d65.aim2, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.leaf))) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),
        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
</div>
<div id="original-model-output-8" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.beetle.vs.leaf_d65.aim2</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.beetle.vs.leaf.aim2, REML = F)
## 
## Linear Hypotheses:
##                                                    Estimate Std. Error z value
## bup600.beetle.vs.leaf - bup580.beetle.vs.leaf == 0  0.40671    0.02109  19.288
## bup620.beetle.vs.leaf - bup580.beetle.vs.leaf == 0  0.80448    0.02109  38.151
## bup640.beetle.vs.leaf - bup580.beetle.vs.leaf == 0  1.09431    0.02109  51.896
## bup660.beetle.vs.leaf - bup580.beetle.vs.leaf == 0  1.28103    0.02109  60.752
## bup620.beetle.vs.leaf - bup600.beetle.vs.leaf == 0  0.39777    0.02109  18.864
## bup640.beetle.vs.leaf - bup600.beetle.vs.leaf == 0  0.68760    0.02109  32.609
## bup660.beetle.vs.leaf - bup600.beetle.vs.leaf == 0  0.87432    0.02109  41.464
## bup640.beetle.vs.leaf - bup620.beetle.vs.leaf == 0  0.28983    0.02109  13.745
## bup660.beetle.vs.leaf - bup620.beetle.vs.leaf == 0  0.47656    0.02109  22.600
## bup660.beetle.vs.leaf - bup640.beetle.vs.leaf == 0  0.18672    0.02109   8.855
##                                                    Pr(&gt;|z|)    
## bup600.beetle.vs.leaf - bup580.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup620.beetle.vs.leaf - bup580.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup640.beetle.vs.leaf - bup580.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup660.beetle.vs.leaf - bup580.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup620.beetle.vs.leaf - bup600.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup640.beetle.vs.leaf - bup600.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup660.beetle.vs.leaf - bup600.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup640.beetle.vs.leaf - bup620.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup660.beetle.vs.leaf - bup620.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup660.beetle.vs.leaf - bup640.beetle.vs.leaf == 0   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-10" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.beetle.vs.leaf_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.leaf</strong></td>
<td align="center">7630</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-9" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.aim2, <span class="dt">y=</span>VislistB_twilight.aim2, <span class="dt">fill=</span>beetle.vs.leaf)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.aim2, VislistB_twilight.aim2, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.leaf))) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),
        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
</div>
<div id="original-model-output-9" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.beetle.vs.leaf_twilight.aim2</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.beetle.vs.leaf_twilight.aim2, REML = F)
## 
## Linear Hypotheses:
##                                                                      Estimate
## bup600.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0 0.056473
## bup620.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0 0.110591
## bup640.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0 0.141964
## bup660.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0 0.152762
## bup620.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0 0.054118
## bup640.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0 0.085491
## bup660.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0 0.096289
## bup640.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0 0.031373
## bup660.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0 0.042171
## bup660.beetle.vs.leaf_twilight - bup640.beetle.vs.leaf_twilight == 0 0.010798
##                                                                      Std. Error
## bup600.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0   0.002064
## bup620.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0   0.002064
## bup640.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0   0.002064
## bup660.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0   0.002064
## bup620.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0   0.002064
## bup640.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0   0.002064
## bup660.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0   0.002064
## bup640.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0   0.002064
## bup660.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0   0.002064
## bup660.beetle.vs.leaf_twilight - bup640.beetle.vs.leaf_twilight == 0   0.002064
##                                                                      z value
## bup600.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0   27.36
## bup620.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0   53.57
## bup640.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0   68.77
## bup660.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0   74.00
## bup620.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0   26.21
## bup640.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0   41.41
## bup660.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0   46.64
## bup640.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0   15.20
## bup660.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0   20.43
## bup660.beetle.vs.leaf_twilight - bup640.beetle.vs.leaf_twilight == 0    5.23
##                                                                      Pr(&gt;|z|)
## bup600.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0  &lt; 2e-16
## bup620.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0  &lt; 2e-16
## bup640.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0  &lt; 2e-16
## bup660.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0  &lt; 2e-16
## bup620.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0  &lt; 2e-16
## bup640.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0  &lt; 2e-16
## bup660.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0  &lt; 2e-16
## bup640.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0  &lt; 2e-16
## bup660.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0  &lt; 2e-16
## bup660.beetle.vs.leaf_twilight - bup640.beetle.vs.leaf_twilight == 0 1.69e-06
##                                                                         
## bup600.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0 ***
## bup620.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0 ***
## bup640.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0 ***
## bup660.beetle.vs.leaf_twilight - bup580.beetle.vs.leaf_twilight == 0 ***
## bup620.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0 ***
## bup640.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0 ***
## bup660.beetle.vs.leaf_twilight - bup600.beetle.vs.leaf_twilight == 0 ***
## bup640.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0 ***
## bup660.beetle.vs.leaf_twilight - bup620.beetle.vs.leaf_twilight == 0 ***
## bup660.beetle.vs.leaf_twilight - bup640.beetle.vs.leaf_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
</div>
<div id="beetle-vs.flower-1" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Beetle vs. Flower</strong></h4>
<div id="daylight-7" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.beetle.vs.flower_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:78%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="43%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.flower</strong></td>
<td align="center">1462</td>
<td align="center">4</td>
<td align="center">2.029e-315</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-10" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_d65.aim2, <span class="dt">y=</span>VislistB_d65.aim2, <span class="dt">fill=</span>beetle.vs.flower)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_d65.aim2, VislistB_d65.aim2, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.flower, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.flower)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour </span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),
        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
</div>
<div id="original-model-output-10" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.beetle.vs.flower_d65.aim2</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.flower + (1 | patch2) + 
##     (1 | patch1), data = compare.beetle.vs.flower.aim2, REML = F)
## 
## Linear Hypotheses:
##                                                        Estimate Std. Error
## bup600.beetle.vs.flower - bup580.beetle.vs.flower == 0  0.23079    0.03177
## bup620.beetle.vs.flower - bup580.beetle.vs.flower == 0  0.50994    0.03177
## bup640.beetle.vs.flower - bup580.beetle.vs.flower == 0  0.80318    0.03177
## bup660.beetle.vs.flower - bup580.beetle.vs.flower == 0  1.07105    0.03177
## bup620.beetle.vs.flower - bup600.beetle.vs.flower == 0  0.27914    0.03177
## bup640.beetle.vs.flower - bup600.beetle.vs.flower == 0  0.57239    0.03177
## bup660.beetle.vs.flower - bup600.beetle.vs.flower == 0  0.84026    0.03177
## bup640.beetle.vs.flower - bup620.beetle.vs.flower == 0  0.29324    0.03177
## bup660.beetle.vs.flower - bup620.beetle.vs.flower == 0  0.56111    0.03177
## bup660.beetle.vs.flower - bup640.beetle.vs.flower == 0  0.26787    0.03177
##                                                        z value Pr(&gt;|z|)    
## bup600.beetle.vs.flower - bup580.beetle.vs.flower == 0   7.265 3.73e-12 ***
## bup620.beetle.vs.flower - bup580.beetle.vs.flower == 0  16.052  &lt; 2e-16 ***
## bup640.beetle.vs.flower - bup580.beetle.vs.flower == 0  25.282  &lt; 2e-16 ***
## bup660.beetle.vs.flower - bup580.beetle.vs.flower == 0  33.715  &lt; 2e-16 ***
## bup620.beetle.vs.flower - bup600.beetle.vs.flower == 0   8.787  &lt; 2e-16 ***
## bup640.beetle.vs.flower - bup600.beetle.vs.flower == 0  18.018  &lt; 2e-16 ***
## bup660.beetle.vs.flower - bup600.beetle.vs.flower == 0  26.450  &lt; 2e-16 ***
## bup640.beetle.vs.flower - bup620.beetle.vs.flower == 0   9.231  &lt; 2e-16 ***
## bup660.beetle.vs.flower - bup620.beetle.vs.flower == 0  17.663  &lt; 2e-16 ***
## bup660.beetle.vs.flower - bup640.beetle.vs.flower == 0   8.432  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-11" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.beetle.vs.flower_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:78%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="43%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.flower</strong></td>
<td align="center">2942</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-11" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.aim2, <span class="dt">y=</span>VislistB_twilight.aim2, <span class="dt">fill=</span>beetle.vs.flower)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.aim2, VislistB_twilight.aim2,  <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.flower, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.flower)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),
        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), 
                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
<div id="original-model-output-11" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.beetle.vs.flower_twilight.aim2</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.flower + (1 | patch2) + 
##     (1 | patch1), data = compare.beetle.vs.flower_twilight.aim2, 
##     REML = F)
## 
## Linear Hypotheses:
##                                                                          Estimate
## bup600.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0 0.049153
## bup620.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0 0.108933
## bup640.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0 0.159757
## bup660.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0 0.188036
## bup620.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0 0.059780
## bup640.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0 0.110605
## bup660.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0 0.138884
## bup640.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0 0.050825
## bup660.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0 0.079104
## bup660.beetle.vs.flower_twilight - bup640.beetle.vs.flower_twilight == 0 0.028279
##                                                                          Std. Error
## bup600.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0   0.004038
## bup620.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0   0.004038
## bup640.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0   0.004038
## bup660.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0   0.004038
## bup620.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0   0.004038
## bup640.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0   0.004038
## bup660.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0   0.004038
## bup640.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0   0.004038
## bup660.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0   0.004038
## bup660.beetle.vs.flower_twilight - bup640.beetle.vs.flower_twilight == 0   0.004038
##                                                                          z value
## bup600.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0  12.173
## bup620.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0  26.978
## bup640.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0  39.566
## bup660.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0  46.569
## bup620.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0  14.805
## bup640.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0  27.392
## bup660.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0  34.396
## bup640.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0  12.587
## bup660.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0  19.591
## bup660.beetle.vs.flower_twilight - bup640.beetle.vs.flower_twilight == 0   7.004
##                                                                          Pr(&gt;|z|)
## bup600.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0  &lt; 2e-16
## bup620.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0  &lt; 2e-16
## bup640.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0  &lt; 2e-16
## bup660.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0  &lt; 2e-16
## bup620.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0  &lt; 2e-16
## bup640.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0  &lt; 2e-16
## bup660.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0  &lt; 2e-16
## bup640.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0  &lt; 2e-16
## bup660.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0  &lt; 2e-16
## bup660.beetle.vs.flower_twilight - bup640.beetle.vs.flower_twilight == 0 2.49e-11
##                                                                             
## bup600.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0 ***
## bup620.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0 ***
## bup640.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0 ***
## bup660.beetle.vs.flower_twilight - bup580.beetle.vs.flower_twilight == 0 ***
## bup620.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0 ***
## bup640.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0 ***
## bup660.beetle.vs.flower_twilight - bup600.beetle.vs.flower_twilight == 0 ***
## bup640.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0 ***
## bup660.beetle.vs.flower_twilight - bup620.beetle.vs.flower_twilight == 0 ***
## bup660.beetle.vs.flower_twilight - bup640.beetle.vs.flower_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="plot-the-contrasts" class="section level1 tabset tabset-fade tabset-pills">
<h1>Plot the contrasts</h1>
<ul>
<li>Colours approximate human perception of either flower (left and right) or beetle (centre) colouration.</li>
<li>Lines of the same colors connect the same sample</li>
</ul>
<p></br></p>
<div id="aim-1-3" class="section level2 tabset tabset-fade tabset-pills">
<h2>Aim 1</h2>
<div id="daylight-8" class="section level3">
<h3>Daylight</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#import the flower color code </span>
color.code&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;data/color code list.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) 

<span class="co">#creat a list of species name used in the spec data and </span>
name.list&lt;-<span class="kw">unique</span>(dataset.transpose<span class="op">$</span>species) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">sort</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#order it alphebatically as well</span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">species =</span> <span class="st">&quot;.&quot;</span>)<span class="co">#make it a data frame and name the column &quot;species&quot;</span>

<span class="co">#creat flower name list for Aim 1</span>
flower.colour.aim1 &lt;-<span class="st"> </span>name.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(species, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower names</span>
<span class="st">  </span><span class="kw">cbind</span>(color.code <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(type, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(name)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower color codes and order it alphebatically</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#remove the redundant column</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">uncount</span>(count) <span class="co">#repeat each row for 4 times for 4 visual systems</span>

<span class="co">#creat beetle name list for Aim 1</span>
beetle.colour.aim1 &lt;-<span class="st"> </span>name.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(species, <span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower names</span>
<span class="st">  </span><span class="kw">cbind</span>(color.code <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(type, <span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(name)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower color codes and order it alphebatically</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#remove the redundant column</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">uncount</span>(count) <span class="co">#repeat each row for 4 times for 4 visual systems</span>



<span class="co">#make flower vs leaf plot</span>
##add the mean
mean.fl_d65.aim1&lt;-allvis.fl_d65.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.fl_d65.aim1<span class="op">$</span>vissys,allvis.fl_d65.aim1<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.fl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

##plot the mean
<span class="kw">names</span>(mean.fl_d65.aim1)[<span class="kw">names</span>(mean.fl_d65.aim1) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span> 
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.fl_d65.aim1&lt;-mean.fl_d65.aim1[<span class="kw">order</span>(mean.fl_d65.aim1<span class="op">$</span>flowerID),] 
<span class="co">#make the data frame order by flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.fl_d65.aim1<span class="op">$</span>match.name&lt;-flower.colour.aim1<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.fl_d65.aim1<span class="op">$</span>colour&lt;-flower.colour.aim1<span class="op">$</span>colour


fl_d65.aim1&lt;-<span class="kw">ggplot</span>(mean.fl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.fl,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.fl_d65.aim1<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.fl_d65.aim1<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle=</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;USM&quot;</span>, <span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USML&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.fl_d65.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.fl_d65.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.fl_d65.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.fl_d65.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Flower vs. Leaf&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;ac&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;c&quot;</span>)) <span class="co">#add stitistical info</span>



<span class="co">#make beetle vs leaf plot</span>
##add the mean
mean.bl_d65.aim1&lt;-allvis.bl_d65.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bl_d65.aim1<span class="op">$</span>vissys,allvis.bl_d65.aim1<span class="op">$</span>patch2,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch2(beetles) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

##plot the mean
<span class="kw">names</span>(mean.bl_d65.aim1)[<span class="kw">names</span>(mean.bl_d65.aim1) <span class="op">==</span><span class="st"> &quot;patch2&quot;</span>] &lt;-<span class="st"> &quot;beetleID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.bl_d65.aim1&lt;-mean.bl_d65.aim1[<span class="kw">order</span>(mean.bl_d65.aim1<span class="op">$</span>beetleID),]
<span class="co">#make the data frame order bt beetleID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.bl_d65.aim1<span class="op">$</span>match.name&lt;-beetle.colour.aim1<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.bl_d65.aim1<span class="op">$</span>colour&lt;-beetle.colour.aim1<span class="op">$</span>colour


bl_d65.aim1&lt;-<span class="kw">ggplot</span>(mean.bl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bl,<span class="dt">group=</span>beetleID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bl_d65.aim1<span class="op">$</span>colour, <span class="dt">size=</span><span class="dv">3</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bl_d65.aim1<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), 
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle=</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;USM&quot;</span>, <span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USML&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bl_d65.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bl_d65.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bl_d65.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bl_d65.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Leaf&quot;</span>)<span class="op">+</span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;b&quot;</span>)) <span class="co">#add stitistical info</span>


<span class="co">#make Beetle vs. Flower plot</span>
##add the mean
mean.bf_d65.aim1&lt;-allvis.bf_d65.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bf_d65.aim1<span class="op">$</span>vissys,allvis.bf_d65.aim1<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#patch1(flowers</span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

##plot the mean
<span class="kw">names</span>(mean.bf_d65.aim1)[<span class="kw">names</span>(mean.bf_d65.aim1) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.bf_d65.aim1&lt;-mean.bf_d65.aim1[<span class="kw">order</span>(mean.bf_d65.aim1<span class="op">$</span>flowerID),]
<span class="co">#make the data frame order bt flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.bf_d65.aim1<span class="op">$</span>match.name&lt;-flower.colour.aim1<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.bf_d65.aim1<span class="op">$</span>colour&lt;-flower.colour.aim1<span class="op">$</span>colour

bf_d65.aim1&lt;-<span class="kw">ggplot</span>(mean.bf_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bf,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bf_d65.aim1<span class="op">$</span>colour, <span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bf_d65.aim1<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>),<span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle=</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;USM&quot;</span>, <span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USML&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bf_d65.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bf_d65.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bf_d65.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bf_d65.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Flower&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;a&quot;</span>)) <span class="co">#add stitistical info</span>

<span class="co">#plot the contrasts from the 3 comparison groups together</span>
figure_d65.aim1 &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(fl_d65.aim1,bl_d65.aim1,bf_d65.aim1, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)
figure_d65.aim1</code></pre></div>
<div class="figure">
<img src="opsin_shifed_models_files/figure-html/unnamed-chunk-57-1.png" alt="Figure caption: Comparison of chromatic contrast for visual systems with different photoreceptor combinations and the opsin-shifted LWS photoreceptor. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Two contrasts &gt; 10 JND are from flowers that have high UV - blue chroma compared to beetles and leaves." width="672" />
<p class="caption">
Figure caption: Comparison of chromatic contrast for visual systems with different photoreceptor combinations and the opsin-shifted LWS photoreceptor. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Two contrasts &gt; 10 JND are from flowers that have high UV - blue chroma compared to beetles and leaves.
</p>
</div>
<p></br> </br></p>
</div>
<div id="twilight-12" class="section level3">
<h3>Twilight</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#make flower vs leaf plot</span>
##add the mean
mean.fl_twilight.aim1&lt;-allvis.fl_twilight.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.fl_twilight.aim1<span class="op">$</span>vissys,allvis.fl_twilight.aim1<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.fl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

##plot the mean
<span class="kw">names</span>(mean.fl_twilight.aim1)[<span class="kw">names</span>(mean.fl_twilight.aim1) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span> 
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.fl_twilight.aim1&lt;-mean.fl_twilight.aim1[<span class="kw">order</span>(mean.fl_twilight.aim1<span class="op">$</span>flowerID),] 
<span class="co">#make the data frame order by flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.fl_twilight.aim1<span class="op">$</span>match.name&lt;-flower.colour.aim1<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.fl_twilight.aim1<span class="op">$</span>colour&lt;-flower.colour.aim1<span class="op">$</span>colour


fl_twilight.aim1&lt;-<span class="kw">ggplot</span>(mean.fl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.fl,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.fl_twilight.aim1<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.fl_twilight.aim1<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">2</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle=</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;USM&quot;</span>, <span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USML&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.fl_twilight.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.fl_twilight.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.fl_twilight.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.fl_twilight.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Flower vs. Leaf&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>), <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>)) <span class="co">#add stitistical info</span>


<span class="co">#make beetle vs leaf plot</span>
##add the mean
mean.bl_twilight.aim1&lt;-allvis.bl_twilight.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bl_twilight.aim1<span class="op">$</span>vissys,allvis.bl_twilight.aim1<span class="op">$</span>patch2,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch2(beetles) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

##plot the mean
<span class="kw">names</span>(mean.bl_twilight.aim1)[<span class="kw">names</span>(mean.bl_twilight.aim1) <span class="op">==</span><span class="st"> &quot;patch2&quot;</span>] &lt;-<span class="st"> &quot;beetleID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.bl_twilight.aim1&lt;-mean.bl_twilight.aim1[<span class="kw">order</span>(mean.bl_twilight.aim1<span class="op">$</span>beetleID),]
<span class="co">#make the data frame order bt beetleID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.bl_twilight.aim1<span class="op">$</span>match.name&lt;-beetle.colour.aim1<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.bl_twilight.aim1<span class="op">$</span>colour&lt;-beetle.colour.aim1<span class="op">$</span>colour


bl_twilight.aim1&lt;-<span class="kw">ggplot</span>(mean.bl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bl,<span class="dt">group=</span>beetleID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bl_twilight.aim1<span class="op">$</span>colour, <span class="dt">size=</span><span class="dv">3</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bl_twilight.aim1<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">2</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), 
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle=</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;USM&quot;</span>, <span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USML&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bl_twilight.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bl_twilight.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bl_twilight.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bl_twilight.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Leaf&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>), <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>)) <span class="co">#add stitistical info</span>



<span class="co">#make Beetle vs. Flower plot</span>
##add the mean
mean.bf_twilight.aim1&lt;-allvis.bf_twilight.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bf_twilight.aim1<span class="op">$</span>vissys,allvis.bf_twilight.aim1<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#patch1(flowers</span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

##plot the mean
<span class="kw">names</span>(mean.bf_twilight.aim1)[<span class="kw">names</span>(mean.bf_twilight.aim1) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.bf_twilight.aim1&lt;-mean.bf_twilight.aim1[<span class="kw">order</span>(mean.bf_twilight.aim1<span class="op">$</span>flowerID),]
<span class="co">#make the data frame order bt flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.bf_twilight.aim1<span class="op">$</span>match.name&lt;-flower.colour.aim1<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.bf_twilight.aim1<span class="op">$</span>colour&lt;-flower.colour.aim1<span class="op">$</span>colour

bf_twilight.aim1&lt;-<span class="kw">ggplot</span>(mean.bf_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bf,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bf_twilight.aim1<span class="op">$</span>colour, <span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bf_twilight.aim1<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">2</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>),<span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle=</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;USM&quot;</span>, <span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USML&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bf_twilight.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bf_twilight.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bf_twilight.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.aim1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bf_twilight.aim1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Flower&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>), <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>)) <span class="co">#add stitistical info</span>



<span class="co">#plot the contrasts from the 3 comparison groups together</span>
figure_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(fl_twilight.aim1,bl_twilight.aim1,bf_twilight.aim1, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)
figure_twilight.aim1</code></pre></div>
<div class="figure">
<img src="opsin_shifed_models_files/figure-html/unnamed-chunk-58-1.png" alt="Figure caption: Comparison of chromatic contrast for visual systems with different photoreceptor combinations and the opsin-shifted LWS photoreceptor under twilight illumination. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Two contrasts &gt; 10 JND are from flowers that have high UV - blue chroma compared to beetles and leaves." width="672" />
<p class="caption">
Figure caption: Comparison of chromatic contrast for visual systems with different photoreceptor combinations and the opsin-shifted LWS photoreceptor under twilight illumination. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Two contrasts &gt; 10 JND are from flowers that have high UV - blue chroma compared to beetles and leaves.
</p>
</div>
<p></br> </br></p>
</div>
</div>
<div id="aim-2-3" class="section level2 tabset tabset-fade tabset-pills">
<h2>Aim 2</h2>
<div id="daylight-9" class="section level3">
<h3>Daylight</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#creat flower name list for Aim 2</span>
flower.colour.aim2 &lt;-<span class="st"> </span>name.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(species, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower names</span>
<span class="st">  </span><span class="kw">cbind</span>(color.code <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(type, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(name)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower color codes and order it alphebatically</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#remove the redundant column</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">uncount</span>(count) <span class="co">#repeat each row for 5 times for 5 visual systems</span>

<span class="co">#creat beetle name list for Aim 2</span>
beetle.colour.aim2 &lt;-<span class="st"> </span>name.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(species, <span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower names</span>
<span class="st">  </span><span class="kw">cbind</span>(color.code <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(type, <span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(name)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower color codes and order it alphebatically</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#remove the redundant column</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">uncount</span>(count) <span class="co">#repeat each row for 5 times for 5 visual systems</span>


<span class="co">#make flower vs leaf plot</span>
##add the mean
mean.fl_d65.aim2&lt;-allvis.fl_d65.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.fl_d65.aim2<span class="op">$</span>vissys,allvis.fl_d65.aim2<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.fl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

##plot the mean
<span class="kw">names</span>(mean.fl_d65.aim2)[<span class="kw">names</span>(mean.fl_d65.aim2) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span> 
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.fl_d65.aim2&lt;-mean.fl_d65.aim2[<span class="kw">order</span>(mean.fl_d65.aim2<span class="op">$</span>flowerID),] 
<span class="co">#make the data frame order by flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.fl_d65.aim2<span class="op">$</span>match.name&lt;-flower.colour.aim2<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.fl_d65.aim2<span class="op">$</span>colour&lt;-flower.colour.aim2<span class="op">$</span>colour

fl_d65.aim2&lt;-<span class="kw">ggplot</span>(mean.fl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.fl,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.fl_d65.aim2<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.fl_d65.aim2<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>,<span class="st">&quot;VS5.fl&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.fl_d65.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.fl_d65.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.fl_d65.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.fl_d65.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.fl_d65.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Flower vs. Leaf&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>,<span class="st">&quot;VS5.fl&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add stitistical info</span>


<span class="co">#make beetle vs leaf plot</span>
##add the mean
mean.bl_d65.aim2&lt;-allvis.bl_d65.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bl_d65.aim2<span class="op">$</span>vissys,allvis.bl_d65.aim2<span class="op">$</span>patch2,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch2(beetles) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

##plot the mean
<span class="kw">names</span>(mean.bl_d65.aim2)[<span class="kw">names</span>(mean.bl_d65.aim2) <span class="op">==</span><span class="st"> &quot;patch2&quot;</span>] &lt;-<span class="st"> &quot;beetleID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.bl_d65.aim2&lt;-mean.bl_d65.aim2[<span class="kw">order</span>(mean.bl_d65.aim2<span class="op">$</span>beetleID),]
<span class="co">#make the data frame order bt beetleID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.bl_d65.aim2<span class="op">$</span>match.name&lt;-beetle.colour.aim2<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.bl_d65.aim2<span class="op">$</span>colour&lt;-beetle.colour.aim2<span class="op">$</span>colour


bl_d65.aim2&lt;-<span class="kw">ggplot</span>(mean.bl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bl,<span class="dt">group=</span>beetleID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bl_d65.aim2<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bl_d65.aim2<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>,<span class="st">&quot;VS5.bl&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bl_d65.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bl_d65.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bl_d65.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bl_d65.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.bl_d65.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Leaf&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>,<span class="st">&quot;VS5.bl&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add stitistical info</span>


<span class="co">#make Beetle vs. Flower plot</span>
##add the mean
mean.bf_d65.aim2&lt;-allvis.bf_d65.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bf_d65.aim2<span class="op">$</span>vissys,allvis.bf_d65.aim2<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#patch1(flowers</span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>


##plot the mean dS
<span class="kw">names</span>(mean.bf_d65.aim2)[<span class="kw">names</span>(mean.bf_d65.aim2) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.bf_d65.aim2&lt;-mean.bf_d65.aim2[<span class="kw">order</span>(mean.bf_d65.aim2<span class="op">$</span>flowerID),]
<span class="co">#make the data frame order bt flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.bf_d65.aim2<span class="op">$</span>match.name&lt;-flower.colour.aim2<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.bf_d65.aim2<span class="op">$</span>colour&lt;-flower.colour.aim2<span class="op">$</span>colour

bf_d65.aim2&lt;-<span class="kw">ggplot</span>(mean.bf_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bf,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bf_d65.aim2<span class="op">$</span>colour, <span class="dt">size=</span><span class="dv">3</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bf_d65.aim2<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>,<span class="st">&quot;VS5.bf&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bf_d65.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bf_d65.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bf_d65.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bf_d65.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.bf_d65.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Flower&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>,<span class="st">&quot;VS5.bf&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add stitistical info</span>

figure_d65.aim2 &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(fl_d65.aim2,bl_d65.aim2,bf_d65.aim2, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)
figure_d65.aim2</code></pre></div>
<div class="figure">
<img src="opsin_shifed_models_files/figure-html/unnamed-chunk-59-1.png" alt="Figure caption: Comparison of chromatic contrast between visual systems with the opsin-shifted LWS photoreceptor peaking at different wavelengths. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Two contrasts &gt; 10 JND are from flowers that have high UV - blue chroma compared to beetles and leaves." width="672" />
<p class="caption">
Figure caption: Comparison of chromatic contrast between visual systems with the opsin-shifted LWS photoreceptor peaking at different wavelengths. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Two contrasts &gt; 10 JND are from flowers that have high UV - blue chroma compared to beetles and leaves.
</p>
</div>
<p></br> </br></p>
</div>
<div id="twilight-13" class="section level3">
<h3>Twilight</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#make flower vs leaf plot</span>
##add the mean
mean.fl_twilight.aim2&lt;-allvis.fl_twilight.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.fl_twilight.aim2<span class="op">$</span>vissys,allvis.fl_twilight.aim2<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.fl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

##plot the mean
<span class="kw">names</span>(mean.fl_twilight.aim2)[<span class="kw">names</span>(mean.fl_twilight.aim2) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span> 
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.fl_twilight.aim2&lt;-mean.fl_twilight.aim2[<span class="kw">order</span>(mean.fl_twilight.aim2<span class="op">$</span>flowerID),] 
<span class="co">#make the data frame order by flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.fl_twilight.aim2<span class="op">$</span>match.name&lt;-flower.colour.aim2<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.fl_twilight.aim2<span class="op">$</span>colour&lt;-flower.colour.aim2<span class="op">$</span>colour

fl_twilight.aim2&lt;-<span class="kw">ggplot</span>(mean.fl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.fl,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.fl_twilight.aim2<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.fl_twilight.aim2<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">2</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>,<span class="st">&quot;VS5.fl&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.fl_twilight.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.fl_twilight.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.fl_twilight.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.fl_twilight.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.fl_twilight.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Flower vs. Leaf&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>,<span class="st">&quot;VS5.fl&quot;</span>), <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>)) <span class="co">#add stitistical info</span>


<span class="co">#make beetle vs leaf plot</span>
##add the mean
mean.bl_twilight.aim2&lt;-allvis.bl_twilight.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bl_twilight.aim2<span class="op">$</span>vissys,allvis.bl_twilight.aim2<span class="op">$</span>patch2,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch2(beetles) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

##plot the mean
<span class="kw">names</span>(mean.bl_twilight.aim2)[<span class="kw">names</span>(mean.bl_twilight.aim2) <span class="op">==</span><span class="st"> &quot;patch2&quot;</span>] &lt;-<span class="st"> &quot;beetleID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.bl_twilight.aim2&lt;-mean.bl_twilight.aim2[<span class="kw">order</span>(mean.bl_twilight.aim2<span class="op">$</span>beetleID),]
<span class="co">#make the data frame order bt beetleID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.bl_twilight.aim2<span class="op">$</span>match.name&lt;-beetle.colour.aim2<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.bl_twilight.aim2<span class="op">$</span>colour&lt;-beetle.colour.aim2<span class="op">$</span>colour


bl_twilight.aim2&lt;-<span class="kw">ggplot</span>(mean.bl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bl,<span class="dt">group=</span>beetleID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bl_twilight.aim2<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bl_twilight.aim2<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">2</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>,<span class="st">&quot;VS5.bl&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bl_twilight.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bl_twilight.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bl_twilight.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bl_twilight.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.bl_twilight.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Leaf&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>,<span class="st">&quot;VS5.bl&quot;</span>), <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add stitistical info</span>


<span class="co">#make Beetle vs. Flower plot</span>
##add the mean
mean.bf_twilight.aim2&lt;-allvis.bf_twilight.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bf_twilight.aim2<span class="op">$</span>vissys,allvis.bf_twilight.aim2<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#patch1(flowers</span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>


##plot the mean dS
<span class="kw">names</span>(mean.bf_twilight.aim2)[<span class="kw">names</span>(mean.bf_twilight.aim2) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.bf_twilight.aim2&lt;-mean.bf_twilight.aim2[<span class="kw">order</span>(mean.bf_twilight.aim2<span class="op">$</span>flowerID),]
<span class="co">#make the data frame order bt flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.bf_twilight.aim2<span class="op">$</span>match.name&lt;-flower.colour.aim2<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.bf_twilight.aim2<span class="op">$</span>colour&lt;-flower.colour.aim2<span class="op">$</span>colour

bf_twilight.aim2&lt;-<span class="kw">ggplot</span>(mean.bf_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bf,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bf_twilight.aim2<span class="op">$</span>colour, <span class="dt">size=</span><span class="dv">3</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bf_twilight.aim2<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">2</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>,<span class="st">&quot;VS5.bf&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bf_twilight.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bf_twilight.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bf_twilight.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bf_twilight.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.aim2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.bf_twilight.aim2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Flower&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>,<span class="st">&quot;VS5.bf&quot;</span>), <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add stitistical info</span>

figure_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(fl_twilight.aim2,bl_twilight.aim2,bf_twilight.aim2, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)
figure_twilight.aim2</code></pre></div>
<div class="figure">
<img src="opsin_shifed_models_files/figure-html/unnamed-chunk-60-1.png" alt="Figure caption: Comparison of chromatic contrast between visual systems with the opsin-shifted LWS photoreceptor peaking at different wavelengths under twilight illumination. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Two contrasts &gt; 10 JND are from flowers that have high UV - blue chroma compared to beetles and leaves." width="672" />
<p class="caption">
Figure caption: Comparison of chromatic contrast between visual systems with the opsin-shifted LWS photoreceptor peaking at different wavelengths under twilight illumination. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Two contrasts &gt; 10 JND are from flowers that have high UV - blue chroma compared to beetles and leaves.
</p>
</div>
<p></br> </br></p>
</div>
</div>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<ul>
<li>Models with opsin-shifted LWS receptors showed qualitatively similar results with a LWS receptor improving contrasts of beetles against leaves. However, only the presence of a SWS receptor improved contrasts of beetles with flowers and flowers with leaves.</li>
<li>When increasing peak sensitivities from 580 nm to 660 nm,the results were similar to that of filter-shifted models – the contrasts of the opsin-shifted visual systems increased from VS 580 to at least VS 640, but the difference in contrast between visual systems were smaller</li>
</ul>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
