<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Opsin-shifted LWS photoreceptors: Visual models using opsin-shifted LWS receptors instead of filter-shifted LWS receptors in Main models</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Overview</a>
</li>
<li>
  <a href="main_models.html">Main models</a>
</li>
<li>
  <a href="opsin_shifed_models.html">Opsin-shifted visual systems</a>
</li>
<li>
  <a href="evenly_space.html">Evenly space</a>
</li>
<li>
  <a href="sensitivity_analysis.html">Sensitivity analysis</a>
</li>
<li>
  <a href="behavioural_assay.html">Behavioural assay</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Opsin-shifted LWS photoreceptors: Visual models using opsin-shifted LWS receptors instead of filter-shifted LWS receptors in Main models</h1>
<h3 class="subtitle">Supplementary Information</h3>

</div>


<div id="the-aim" class="section level1">
<h1>The aim</h1>
<ul>
<li><p>We tested how the LWS photoreceptors generated (opsin-shifted vs. filter-shifted) using different methods affect the contrasts.</p></li>
<li><p>In the following sections, we ran the same models as in the <a href="main_models.html">Main models</a> but using the opsin-shifted LWS receptors for comparison.</p></li>
<li><p>The model parameters and the statistical methods remain the same as described in the <a href="main_models.html">Main models</a>. </br> </br></p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">#Load R libraries </span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(pavo)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">library</span>(stringr)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">library</span>(tidyr) <span class="co">#for gather() function</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw">library</span>(lme4)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">library</span>(car)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="kw">library</span>(multcomp)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="kw">library</span>(boot) <span class="co">#for mean() function</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="kw">library</span>(pander) <span class="co">#for creating tidy tables</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="kw">library</span>(ggpubr) <span class="co">#for ggarrange() function</span></span></code></pre></div>
<p></br> </br></p>
</div>
<div id="data-description" class="section level1">
<h1>Data description</h1>
<ul>
<li>We used the same spectral data and illumination as the <a href="main_models.html">Main models</a>.</li>
</ul>
<p></br></p>
<div id="sensitivity-curves" class="section level2">
<h2>Sensitivity curves</h2>
<ul>
<li><p>ALL photoreceptor sensitivities (UVS, SWS, MWS, LWS) were generated from the Govardovskii template without apply filters.</p></li>
<li><p>Note: UVS, SWS, MWS photoreceptors were the same as those in the main models</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">#import sensitivity curves</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>specsensbuprest.aim1 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/peak sensitivity_opsin shift_aim1.csv&quot;</span>,<span class="dt">header =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="st">  </span><span class="kw">as.rspec</span>()</span>
<span id="cb2-4"><a href="#cb2-4"></a>specsensbuprest.aim2 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/peak sensitivity_opsin shift_aim2.csv&quot;</span>,<span class="dt">header =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="st">  </span><span class="kw">as.rspec</span>()</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co"># import irradiance</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>irradiance.d65 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/d65.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="st">  </span><span class="kw">as.rspec</span>(<span class="dt">lim =</span> <span class="kw">c</span>(<span class="dv">300</span>,<span class="dv">800</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#set import range</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="st">  </span><span class="kw">procspec</span>(<span class="dt">opt =</span> <span class="kw">c</span>(<span class="st">&quot;min&quot;</span>, <span class="st">&quot;max&quot;</span>)) <span class="co">#standardize the illumination spectrum</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>irradiance.twilight &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/civil twilight.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="st">  </span><span class="kw">as.rspec</span>(<span class="dt">lim =</span> <span class="kw">c</span>(<span class="dv">300</span>,<span class="dv">800</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="st">  </span><span class="kw">rename</span>( <span class="dt">twilight =</span> Irradiance) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="st">  </span><span class="kw">irrad2flux</span>() <span class="co">#convert the irradiance (μ Watt.cm^{-2}) to photon flux (μ mol.s^{-1}.m^{-2}) to derive correct quantum catch.</span></span>
<span id="cb2-16"><a href="#cb2-16"></a></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">#import background - average leaf</span></span>
<span id="cb2-18"><a href="#cb2-18"></a>aveleaf &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/aveleaf.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="st">  </span><span class="kw">as.rspec</span>()</span>
<span id="cb2-20"><a href="#cb2-20"></a></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co">#import and combine beetle, flower, leaf together</span></span>
<span id="cb2-22"><a href="#cb2-22"></a>raw.dataset &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/refelectance spectra.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="st">  </span><span class="kw">as.rspec</span>()</span>
<span id="cb2-24"><a href="#cb2-24"></a>dataset &lt;-<span class="st"> </span><span class="kw">aggspec</span>(raw.dataset, <span class="dt">by =</span> <span class="dv">3</span>, <span class="dt">FUN =</span> mean) <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#average three measurements to a representative one</span></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="st">  </span><span class="kw">procspec</span>(<span class="dt">opt =</span> <span class="st">&quot;smooth&quot;</span>, <span class="dt">span =</span> <span class="fl">0.1</span>, <span class="dt">fixneg =</span> <span class="st">&quot;zero&quot;</span>) <span class="co">#smooth the spectra and lift &lt;0 to 0</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>wl &lt;-<span class="st"> </span>specsensbuprest.aim2[,<span class="dv">1</span>]</span>
<span id="cb3-2"><a href="#cb3-2"></a>peaks &lt;-<span class="st"> </span><span class="kw">gather</span>(specsensbuprest.aim2[,<span class="dv">2</span><span class="op">:</span><span class="dv">9</span>], peak, value) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="st">  </span><span class="kw">cbind</span>(wl)</span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#order the peaks in the legend</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>wl &lt;-<span class="st"> </span>specsensbuprest.aim2[,<span class="dv">1</span>]</span>
<span id="cb3-7"><a href="#cb3-7"></a>peaks&lt;-<span class="kw">gather</span>(specsensbuprest.aim2[,<span class="dv">2</span><span class="op">:</span><span class="dv">9</span>], peak, value) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(wl)</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a>peak.order &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;UVS.355.A1.&quot;</span>, <span class="st">&quot;SWS.445.A1.&quot;</span>, <span class="st">&quot;MWS.530.A1.&quot;</span>, <span class="st">&quot;LWS.580.A1.&quot;</span>, <span class="st">&quot;LWS.600.A1.&quot;</span>, <span class="st">&quot;LWS.620.A1.&quot;</span>, <span class="st">&quot;LWS.640.A1.&quot;</span>, <span class="st">&quot;LWS.660.A1.&quot;</span>) <span class="co">#to order the peaks in the legend</span></span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="kw">ggplot</span>(peaks,</span>
<span id="cb3-12"><a href="#cb3-12"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> wl, <span class="dt">y =</span> value, <span class="dt">col =</span> peak))<span class="op">+</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">&quot;peak sensitivity&quot;</span>))<span class="op">+</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(</span>
<span id="cb3-16"><a href="#cb3-16"></a>    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkorchid4&quot;</span>, <span class="st">&quot;dodgerblue3&quot;</span>, <span class="st">&quot;olivedrab4&quot;</span>, <span class="st">&quot;orange1&quot;</span>, <span class="st">&quot;orange3&quot;</span>,<span class="st">&quot;darkorange3&quot;</span>, <span class="st">&quot;orangered1&quot;</span>, <span class="st">&quot;red2&quot;</span>),</span>
<span id="cb3-17"><a href="#cb3-17"></a>    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;355 nm&quot;</span>, <span class="st">&quot;445 nm&quot;</span>,<span class="st">&quot;530 nm&quot;</span>, <span class="st">&quot;580 nm&quot;</span>, <span class="st">&quot;600 nm&quot;</span>, <span class="st">&quot;620 nm&quot;</span>, <span class="st">&quot;640 nm&quot;</span>, <span class="st">&quot;660 nm&quot;</span>),</span>
<span id="cb3-18"><a href="#cb3-18"></a>    <span class="dt">breaks =</span> peak.order)<span class="op">+</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Wavelength (nm)&quot;</span>)<span class="op">+</span><span class="st"> </span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Relative spectral sensitivity&quot;</span>)<span class="op">+</span></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<div class="figure">
<img src="opsin_shifed_models_files/figure-html/unnamed-chunk-2-1.png" alt="Figure caption: Sensitivity curves of the photoreceptors with different peak wavelengths." width="672" />
<p class="caption">
Figure caption: Sensitivity curves of the photoreceptors with different peak wavelengths.
</p>
</div>
<p></br> </br></p>
</div>
</div>
<div id="run-the-visual-models" class="section level1">
<h1>Run the visual models</h1>
<ul>
<li><p>We ran the visual models with the same parameter settings and steps as in the <a href="main_models.html">Main models</a>.</p></li>
<li><p>We first calculated the quantum catches, then calculated the contrasts.</p></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">## D65</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>get.d65.vismodel &lt;-<span class="st"> </span><span class="cf">function</span>(i){</span>
<span id="cb4-3"><a href="#cb4-3"></a>  </span>
<span id="cb4-4"><a href="#cb4-4"></a>  vs.i &lt;-<span class="st"> </span><span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], </span>
<span id="cb4-5"><a href="#cb4-5"></a>                   <span class="dt">visual =</span> i, <span class="co">#this need to change according to the visual system</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>                   <span class="dt">bkg =</span> aveleaf<span class="op">$</span>aveleaf, </span>
<span id="cb4-7"><a href="#cb4-7"></a>                   <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], </span>
<span id="cb4-8"><a href="#cb4-8"></a>                   <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, </span>
<span id="cb4-9"><a href="#cb4-9"></a>                   <span class="dt">relative =</span> <span class="ot">FALSE</span>,</span>
<span id="cb4-10"><a href="#cb4-10"></a>                   <span class="dt">vonkries =</span> <span class="ot">TRUE</span>)</span>
<span id="cb4-11"><a href="#cb4-11"></a>  <span class="kw">return</span>(vs.i)</span>
<span id="cb4-12"><a href="#cb4-12"></a>}</span>
<span id="cb4-13"><a href="#cb4-13"></a></span>
<span id="cb4-14"><a href="#cb4-14"></a></span>
<span id="cb4-15"><a href="#cb4-15"></a></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="co">## Twilight</span></span>
<span id="cb4-17"><a href="#cb4-17"></a>get.twilight.vismodel &lt;-<span class="st"> </span><span class="cf">function</span>(i){</span>
<span id="cb4-18"><a href="#cb4-18"></a>  </span>
<span id="cb4-19"><a href="#cb4-19"></a>  vs.i &lt;-<span class="st"> </span><span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], </span>
<span id="cb4-20"><a href="#cb4-20"></a>                   <span class="dt">visual =</span> i, </span>
<span id="cb4-21"><a href="#cb4-21"></a>                   <span class="dt">bkg =</span> aveleaf<span class="op">$</span>aveleaf, </span>
<span id="cb4-22"><a href="#cb4-22"></a>                   <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], </span>
<span id="cb4-23"><a href="#cb4-23"></a>                   <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, </span>
<span id="cb4-24"><a href="#cb4-24"></a>                   <span class="dt">relative =</span> <span class="ot">FALSE</span>, </span>
<span id="cb4-25"><a href="#cb4-25"></a>                   <span class="dt">vonkries =</span> <span class="ot">TRUE</span>)</span>
<span id="cb4-26"><a href="#cb4-26"></a>  <span class="kw">return</span>(vs.i)</span>
<span id="cb4-27"><a href="#cb4-27"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># set up sensitivity list for Aim 1 and Aim 2</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>sens.list &lt;-<span class="st"> </span><span class="kw">list</span>(USM &lt;-<span class="st"> </span>specsensbuprest.aim1[, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>],</span>
<span id="cb5-3"><a href="#cb5-3"></a>                  UML &lt;-<span class="st"> </span>specsensbuprest.aim1[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>)],</span>
<span id="cb5-4"><a href="#cb5-4"></a>                  USL &lt;-<span class="st"> </span>specsensbuprest.aim1[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)],</span>
<span id="cb5-5"><a href="#cb5-5"></a>                  USML &lt;-<span class="st"> </span>specsensbuprest.aim1[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>],</span>
<span id="cb5-6"><a href="#cb5-6"></a>                  VS580 &lt;-<span class="st"> </span>specsensbuprest.aim2[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>],</span>
<span id="cb5-7"><a href="#cb5-7"></a>                  VS600 &lt;-<span class="st"> </span>specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>)],</span>
<span id="cb5-8"><a href="#cb5-8"></a>                  VS620 &lt;-<span class="st"> </span>specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">7</span>)],</span>
<span id="cb5-9"><a href="#cb5-9"></a>                  VS640 &lt;-<span class="st"> </span>specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">8</span>)],</span>
<span id="cb5-10"><a href="#cb5-10"></a>                  VS660 &lt;-<span class="st"> </span>specsensbuprest.aim2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">9</span>)])</span>
<span id="cb5-11"><a href="#cb5-11"></a></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co"># Quantum catch - D65 - Aim 1 &amp; Aim 2</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">## set up list for holding output</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>d65.vismodel.output &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">USM =</span> <span class="ot">NA</span>, <span class="dt">UML =</span> <span class="ot">NA</span>, <span class="dt">USL =</span> <span class="ot">NA</span>, <span class="dt">USML =</span> <span class="ot">NA</span>,</span>
<span id="cb5-15"><a href="#cb5-15"></a>                            <span class="dt">VS580 =</span> <span class="ot">NA</span>, <span class="dt">VS600 =</span> <span class="ot">NA</span>, <span class="dt">VS620 =</span> <span class="ot">NA</span>, <span class="dt">VS640 =</span> <span class="ot">NA</span>, <span class="dt">VS660 =</span> <span class="ot">NA</span>)</span>
<span id="cb5-16"><a href="#cb5-16"></a>twilight.vismodel.output &lt;-<span class="st"> </span>d65.vismodel.output <span class="co"># replicate a same empty list for twilight</span></span>
<span id="cb5-17"><a href="#cb5-17"></a></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="co">## Run the loop</span></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sens.list)){</span>
<span id="cb5-20"><a href="#cb5-20"></a>  </span>
<span id="cb5-21"><a href="#cb5-21"></a>  vs.result.d65 &lt;-<span class="st"> </span><span class="kw">get.d65.vismodel</span>(sens.list[[i]]) <span class="co"># for D65</span></span>
<span id="cb5-22"><a href="#cb5-22"></a>  d65.vismodel.output[[i]] &lt;-<span class="st"> </span>vs.result.d65</span>
<span id="cb5-23"><a href="#cb5-23"></a>  </span>
<span id="cb5-24"><a href="#cb5-24"></a>  vs.result.twilight &lt;-<span class="st"> </span><span class="kw">get.twilight.vismodel</span>(sens.list[[i]]) <span class="co"># for twilight</span></span>
<span id="cb5-25"><a href="#cb5-25"></a>  twilight.vismodel.output[[i]] &lt;-<span class="st"> </span>vs.result.twilight</span>
<span id="cb5-26"><a href="#cb5-26"></a></span>
<span id="cb5-27"><a href="#cb5-27"></a>}</span>
<span id="cb5-28"><a href="#cb5-28"></a></span>
<span id="cb5-29"><a href="#cb5-29"></a><span class="co">## D65 Aim 1 &amp; Aim 2 vismodel output</span></span>
<span id="cb5-30"><a href="#cb5-30"></a>vsUSM &lt;-<span class="st"> </span>d65.vismodel.output<span class="op">$</span>USM</span>
<span id="cb5-31"><a href="#cb5-31"></a>vsUML &lt;-<span class="st"> </span>d65.vismodel.output<span class="op">$</span>UML</span>
<span id="cb5-32"><a href="#cb5-32"></a>vsUSL &lt;-<span class="st"> </span>d65.vismodel.output<span class="op">$</span>USL</span>
<span id="cb5-33"><a href="#cb5-33"></a>vsUSML &lt;-<span class="st"> </span>d65.vismodel.output<span class="op">$</span>USML</span>
<span id="cb5-34"><a href="#cb5-34"></a>buprest580 &lt;-<span class="st"> </span>d65.vismodel.output<span class="op">$</span>VS580</span>
<span id="cb5-35"><a href="#cb5-35"></a>buprest600 &lt;-<span class="st"> </span>d65.vismodel.output<span class="op">$</span>VS600</span>
<span id="cb5-36"><a href="#cb5-36"></a>buprest620 &lt;-<span class="st"> </span>d65.vismodel.output<span class="op">$</span>VS620</span>
<span id="cb5-37"><a href="#cb5-37"></a>buprest640 &lt;-<span class="st"> </span>d65.vismodel.output<span class="op">$</span>VS640</span>
<span id="cb5-38"><a href="#cb5-38"></a>buprest660 &lt;-<span class="st"> </span>d65.vismodel.output<span class="op">$</span>VS660</span>
<span id="cb5-39"><a href="#cb5-39"></a></span>
<span id="cb5-40"><a href="#cb5-40"></a><span class="co">## Twilight Aim 1 &amp; Aim 2 vismodel output</span></span>
<span id="cb5-41"><a href="#cb5-41"></a>vsUSM_twilight &lt;-<span class="st"> </span>twilight.vismodel.output<span class="op">$</span>USM</span>
<span id="cb5-42"><a href="#cb5-42"></a>vsUML_twilight &lt;-<span class="st"> </span>twilight.vismodel.output<span class="op">$</span>UML</span>
<span id="cb5-43"><a href="#cb5-43"></a>vsUSL_twilight &lt;-<span class="st"> </span>twilight.vismodel.output<span class="op">$</span>USL</span>
<span id="cb5-44"><a href="#cb5-44"></a>vsUSML_twilight &lt;-<span class="st"> </span>twilight.vismodel.output<span class="op">$</span>USML</span>
<span id="cb5-45"><a href="#cb5-45"></a>buprest580_twilight &lt;-<span class="st"> </span>twilight.vismodel.output<span class="op">$</span>VS580</span>
<span id="cb5-46"><a href="#cb5-46"></a>buprest600_twilight &lt;-<span class="st"> </span>twilight.vismodel.output<span class="op">$</span>VS600</span>
<span id="cb5-47"><a href="#cb5-47"></a>buprest620_twilight &lt;-<span class="st"> </span>twilight.vismodel.output<span class="op">$</span>VS620</span>
<span id="cb5-48"><a href="#cb5-48"></a>buprest640_twilight &lt;-<span class="st"> </span>twilight.vismodel.output<span class="op">$</span>VS640</span>
<span id="cb5-49"><a href="#cb5-49"></a>buprest660_twilight &lt;-<span class="st"> </span>twilight.vismodel.output<span class="op">$</span>VS660</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># set up common list before running loop for calculating contrast</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">## receptor density</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>aim1.recep.density.list &lt;-<span class="st"> </span><span class="kw">list</span>(USM &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.6027</span>, <span class="fl">1.4059</span>, <span class="fl">1.7714</span>),</span>
<span id="cb6-4"><a href="#cb6-4"></a>                                UML &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.4416</span>, <span class="fl">1.5933</span>, <span class="fl">1.7451</span>),</span>
<span id="cb6-5"><a href="#cb6-5"></a>                                USL &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.5481</span>, <span class="fl">1.3580</span>, <span class="fl">1.8740</span>),</span>
<span id="cb6-6"><a href="#cb6-6"></a>                                USML &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.14</span>, <span class="dv">1</span>, <span class="fl">1.26</span>, <span class="fl">1.38</span>))</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">## Weber fraction</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>aim1.web.list &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1059</span>, <span class="fl">0.1067</span>, <span class="fl">0.1030</span>, <span class="fl">0.12</span>)</span>
<span id="cb6-10"><a href="#cb6-10"></a>aim1.web.ref &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb6-11"><a href="#cb6-11"></a></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co"># Contrast calculation- D65 - aim 1</span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co">## create model data list</span></span>
<span id="cb6-14"><a href="#cb6-14"></a>aim1.d65.vismodel.list &lt;-<span class="st"> </span><span class="kw">list</span>(vsUSM, vsUML, vsUSL, vsUSML)</span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co">## combine list before running the loop</span></span>
<span id="cb6-16"><a href="#cb6-16"></a>aim1.d65.comb.list &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">vis.list =</span> aim1.d65.vismodel.list,</span>
<span id="cb6-17"><a href="#cb6-17"></a>                           <span class="dt">recp.dens.list =</span> aim1.recep.density.list,</span>
<span id="cb6-18"><a href="#cb6-18"></a>                           <span class="dt">web.list =</span> aim1.web.list,</span>
<span id="cb6-19"><a href="#cb6-19"></a>                           <span class="dt">web.ref =</span> aim1.web.ref)</span>
<span id="cb6-20"><a href="#cb6-20"></a></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co"># list for holding output</span></span>
<span id="cb6-22"><a href="#cb6-22"></a>aim1.d65.contrast.output &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">USM =</span> <span class="ot">NA</span>, <span class="dt">UML =</span> <span class="ot">NA</span>, <span class="dt">USL =</span> <span class="ot">NA</span>, <span class="dt">USML =</span> <span class="ot">NA</span>)</span>
<span id="cb6-23"><a href="#cb6-23"></a></span>
<span id="cb6-24"><a href="#cb6-24"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(aim1.d65.comb.list)) {</span>
<span id="cb6-25"><a href="#cb6-25"></a> </span>
<span id="cb6-26"><a href="#cb6-26"></a>  coldist.result &lt;-<span class="st"> </span><span class="kw">coldist</span>(<span class="dt">modeldata =</span> aim1.d65.comb.list<span class="op">$</span>vis.list[[i]], <span class="co"># change input model data</span></span>
<span id="cb6-27"><a href="#cb6-27"></a>                            <span class="dt">noise =</span> <span class="st">&quot;neural&quot;</span>,</span>
<span id="cb6-28"><a href="#cb6-28"></a>                            <span class="dt">achro =</span> <span class="ot">FALSE</span>, </span>
<span id="cb6-29"><a href="#cb6-29"></a>                            <span class="dt">n =</span> aim1.d65.comb.list<span class="op">$</span>recp.dens.list[[i]] , <span class="co"># change receptor density</span></span>
<span id="cb6-30"><a href="#cb6-30"></a>                            <span class="dt">weber =</span> aim1.d65.comb.list<span class="op">$</span>web.list[[i]], <span class="co"># change weber&#39;s fraction</span></span>
<span id="cb6-31"><a href="#cb6-31"></a>                            <span class="dt">weber.ref =</span> aim1.d65.comb.list<span class="op">$</span>web.ref[[i]] )</span>
<span id="cb6-32"><a href="#cb6-32"></a>  </span>
<span id="cb6-33"><a href="#cb6-33"></a>  aim1.d65.contrast.output[[i]] &lt;-<span class="st"> </span>coldist.result</span>
<span id="cb6-34"><a href="#cb6-34"></a>}</span>
<span id="cb6-35"><a href="#cb6-35"></a></span>
<span id="cb6-36"><a href="#cb6-36"></a>CvsUSM &lt;-<span class="st"> </span>aim1.d65.contrast.output<span class="op">$</span>USM</span>
<span id="cb6-37"><a href="#cb6-37"></a>CvsUML &lt;-<span class="st"> </span>aim1.d65.contrast.output<span class="op">$</span>UML</span>
<span id="cb6-38"><a href="#cb6-38"></a>CvsUSL &lt;-<span class="st"> </span>aim1.d65.contrast.output<span class="op">$</span>USL</span>
<span id="cb6-39"><a href="#cb6-39"></a>CvsUSML &lt;-<span class="st"> </span>aim1.d65.contrast.output<span class="op">$</span>USML</span>
<span id="cb6-40"><a href="#cb6-40"></a></span>
<span id="cb6-41"><a href="#cb6-41"></a></span>
<span id="cb6-42"><a href="#cb6-42"></a><span class="co">#Contrast calculation- D65 - Aim 2</span></span>
<span id="cb6-43"><a href="#cb6-43"></a>get.aim2.d65.coldist &lt;-<span class="st"> </span><span class="cf">function</span>(i){</span>
<span id="cb6-44"><a href="#cb6-44"></a>  </span>
<span id="cb6-45"><a href="#cb6-45"></a>  con &lt;-<span class="st"> </span><span class="kw">coldist</span>(<span class="dt">modeldata =</span> i, <span class="co"># put output of vismodel()</span></span>
<span id="cb6-46"><a href="#cb6-46"></a>                   <span class="dt">noise =</span> <span class="st">&quot;neural&quot;</span>, </span>
<span id="cb6-47"><a href="#cb6-47"></a>                   <span class="dt">achro =</span> <span class="ot">FALSE</span>, </span>
<span id="cb6-48"><a href="#cb6-48"></a>                   <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>, <span class="dv">1</span>, <span class="fl">1.26</span>, <span class="fl">1.38</span>),</span>
<span id="cb6-49"><a href="#cb6-49"></a>                   <span class="dt">weber =</span> <span class="fl">0.12</span>,</span>
<span id="cb6-50"><a href="#cb6-50"></a>                   <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb6-51"><a href="#cb6-51"></a>  </span>
<span id="cb6-52"><a href="#cb6-52"></a>  <span class="kw">return</span>(con)</span>
<span id="cb6-53"><a href="#cb6-53"></a>}</span>
<span id="cb6-54"><a href="#cb6-54"></a></span>
<span id="cb6-55"><a href="#cb6-55"></a>aim2.d65.contrast.output &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">VS580 =</span> <span class="ot">NA</span>, <span class="dt">VS600 =</span> <span class="ot">NA</span>, <span class="dt">VS620 =</span> <span class="ot">NA</span>, <span class="dt">VS640 =</span> <span class="ot">NA</span>, <span class="dt">VS660 =</span> <span class="ot">NA</span>)</span>
<span id="cb6-56"><a href="#cb6-56"></a>aim2.d65.vismodel.list &lt;-<span class="st"> </span><span class="kw">list</span>(buprest580, </span>
<span id="cb6-57"><a href="#cb6-57"></a>                               buprest600, </span>
<span id="cb6-58"><a href="#cb6-58"></a>                               buprest620, </span>
<span id="cb6-59"><a href="#cb6-59"></a>                               buprest640, </span>
<span id="cb6-60"><a href="#cb6-60"></a>                               buprest660)</span>
<span id="cb6-61"><a href="#cb6-61"></a></span>
<span id="cb6-62"><a href="#cb6-62"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(aim2.d65.vismodel.list)) {</span>
<span id="cb6-63"><a href="#cb6-63"></a>  </span>
<span id="cb6-64"><a href="#cb6-64"></a>  contrast.result.i &lt;-<span class="st"> </span><span class="kw">get.aim2.d65.coldist</span>(aim2.d65.vismodel.list[[i]])</span>
<span id="cb6-65"><a href="#cb6-65"></a>  aim2.d65.contrast.output[[i]] &lt;-<span class="st"> </span>contrast.result.i</span>
<span id="cb6-66"><a href="#cb6-66"></a>}</span>
<span id="cb6-67"><a href="#cb6-67"></a></span>
<span id="cb6-68"><a href="#cb6-68"></a>Cbuprest580 &lt;-<span class="st"> </span>aim2.d65.contrast.output<span class="op">$</span>VS580</span>
<span id="cb6-69"><a href="#cb6-69"></a>Cbuprest600 &lt;-<span class="st"> </span>aim2.d65.contrast.output<span class="op">$</span>VS600</span>
<span id="cb6-70"><a href="#cb6-70"></a>Cbuprest620 &lt;-<span class="st"> </span>aim2.d65.contrast.output<span class="op">$</span>VS620</span>
<span id="cb6-71"><a href="#cb6-71"></a>Cbuprest640 &lt;-<span class="st"> </span>aim2.d65.contrast.output<span class="op">$</span>VS640</span>
<span id="cb6-72"><a href="#cb6-72"></a>Cbuprest660 &lt;-<span class="st"> </span>aim2.d65.contrast.output<span class="op">$</span>VS660</span>
<span id="cb6-73"><a href="#cb6-73"></a></span>
<span id="cb6-74"><a href="#cb6-74"></a></span>
<span id="cb6-75"><a href="#cb6-75"></a><span class="co">#Contrast calculation- twilight - aim 1</span></span>
<span id="cb6-76"><a href="#cb6-76"></a>aim1.twilight.vismodel.list &lt;-<span class="st"> </span><span class="kw">list</span>(vsUSM_twilight, </span>
<span id="cb6-77"><a href="#cb6-77"></a>                                    vsUML_twilight, </span>
<span id="cb6-78"><a href="#cb6-78"></a>                                    vsUSL_twilight,</span>
<span id="cb6-79"><a href="#cb6-79"></a>                                    vsUSML_twilight)</span>
<span id="cb6-80"><a href="#cb6-80"></a><span class="co"># Here have to create one comb.list is becasue vis.model input is different from D65</span></span>
<span id="cb6-81"><a href="#cb6-81"></a>aim1.twilight.comb.list &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">vis.list =</span> aim1.twilight.vismodel.list,</span>
<span id="cb6-82"><a href="#cb6-82"></a>                                <span class="dt">recp.dens.list =</span> aim1.recep.density.list,</span>
<span id="cb6-83"><a href="#cb6-83"></a>                                <span class="dt">web.list =</span> aim1.web.list,</span>
<span id="cb6-84"><a href="#cb6-84"></a>                                <span class="dt">web.ref =</span> aim1.web.ref)</span>
<span id="cb6-85"><a href="#cb6-85"></a></span>
<span id="cb6-86"><a href="#cb6-86"></a><span class="co"># list for holding output</span></span>
<span id="cb6-87"><a href="#cb6-87"></a>aim1.twilight.contrast.output &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">USM =</span> <span class="ot">NA</span>, <span class="dt">UML =</span> <span class="ot">NA</span>, <span class="dt">USL =</span> <span class="ot">NA</span>, <span class="dt">USML =</span> <span class="ot">NA</span>)</span>
<span id="cb6-88"><a href="#cb6-88"></a></span>
<span id="cb6-89"><a href="#cb6-89"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(aim1.twilight.comb.list)) {</span>
<span id="cb6-90"><a href="#cb6-90"></a> </span>
<span id="cb6-91"><a href="#cb6-91"></a>  coldist.result &lt;-<span class="st"> </span><span class="kw">coldist</span>(<span class="dt">modeldata =</span> aim1.twilight.comb.list<span class="op">$</span>vis.list[[i]], <span class="co"># change input model data</span></span>
<span id="cb6-92"><a href="#cb6-92"></a>                            <span class="dt">noise =</span> <span class="st">&quot;quantum&quot;</span>, </span>
<span id="cb6-93"><a href="#cb6-93"></a>                            <span class="dt">achro =</span> <span class="ot">FALSE</span>, </span>
<span id="cb6-94"><a href="#cb6-94"></a>                            <span class="dt">n =</span> aim1.twilight.comb.list<span class="op">$</span>recp.dens.list[[i]] , <span class="co"># change receptor density ratio </span></span>
<span id="cb6-95"><a href="#cb6-95"></a>                            <span class="dt">weber =</span> aim1.twilight.comb.list<span class="op">$</span>web.list[[i]], <span class="co"># change weber&#39;s fraction</span></span>
<span id="cb6-96"><a href="#cb6-96"></a>                            <span class="dt">weber.ref =</span> aim1.twilight.comb.list<span class="op">$</span>web.ref[[i]])</span>
<span id="cb6-97"><a href="#cb6-97"></a>  </span>
<span id="cb6-98"><a href="#cb6-98"></a>  aim1.twilight.contrast.output[[i]] &lt;-<span class="st"> </span>coldist.result</span>
<span id="cb6-99"><a href="#cb6-99"></a>}</span>
<span id="cb6-100"><a href="#cb6-100"></a></span>
<span id="cb6-101"><a href="#cb6-101"></a>CvsUSM_twilight &lt;-<span class="st"> </span>aim1.twilight.contrast.output<span class="op">$</span>USM</span>
<span id="cb6-102"><a href="#cb6-102"></a>CvsUML_twilight &lt;-<span class="st"> </span>aim1.twilight.contrast.output<span class="op">$</span>UML</span>
<span id="cb6-103"><a href="#cb6-103"></a>CvsUSL_twilight &lt;-<span class="st"> </span>aim1.twilight.contrast.output<span class="op">$</span>USL</span>
<span id="cb6-104"><a href="#cb6-104"></a>CvsUSML_twilight &lt;-<span class="st"> </span>aim1.twilight.contrast.output<span class="op">$</span>USML</span>
<span id="cb6-105"><a href="#cb6-105"></a></span>
<span id="cb6-106"><a href="#cb6-106"></a></span>
<span id="cb6-107"><a href="#cb6-107"></a></span>
<span id="cb6-108"><a href="#cb6-108"></a><span class="co">#Contrast calculation- twilight - Aim 2</span></span>
<span id="cb6-109"><a href="#cb6-109"></a>get.aim2.twilight.coldist &lt;-<span class="st"> </span><span class="cf">function</span>(i){</span>
<span id="cb6-110"><a href="#cb6-110"></a>  </span>
<span id="cb6-111"><a href="#cb6-111"></a>  con &lt;-<span class="st"> </span><span class="kw">coldist</span>(<span class="dt">modeldata =</span> i,  </span>
<span id="cb6-112"><a href="#cb6-112"></a>                   <span class="dt">noise=</span><span class="st">&quot;quantum&quot;</span>, </span>
<span id="cb6-113"><a href="#cb6-113"></a>                   <span class="dt">achro=</span><span class="ot">FALSE</span>, </span>
<span id="cb6-114"><a href="#cb6-114"></a>                   <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), </span>
<span id="cb6-115"><a href="#cb6-115"></a>                   <span class="dt">weber =</span> <span class="fl">0.12</span>, </span>
<span id="cb6-116"><a href="#cb6-116"></a>                   <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb6-117"><a href="#cb6-117"></a>  </span>
<span id="cb6-118"><a href="#cb6-118"></a>  <span class="kw">return</span>(con)</span>
<span id="cb6-119"><a href="#cb6-119"></a>}</span>
<span id="cb6-120"><a href="#cb6-120"></a></span>
<span id="cb6-121"><a href="#cb6-121"></a>aim2.twilight.contrast.output &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">VS580 =</span> <span class="ot">NA</span>, <span class="dt">VS600 =</span> <span class="ot">NA</span>, <span class="dt">VS620 =</span> <span class="ot">NA</span>, <span class="dt">VS640 =</span> <span class="ot">NA</span>, <span class="dt">VS660 =</span> <span class="ot">NA</span>)</span>
<span id="cb6-122"><a href="#cb6-122"></a>aim2.twilight.vismodel.list &lt;-<span class="st"> </span><span class="kw">list</span>(buprest580_twilight, </span>
<span id="cb6-123"><a href="#cb6-123"></a>                                    buprest600_twilight, </span>
<span id="cb6-124"><a href="#cb6-124"></a>                                    buprest620_twilight, </span>
<span id="cb6-125"><a href="#cb6-125"></a>                                    buprest640_twilight,</span>
<span id="cb6-126"><a href="#cb6-126"></a>                                    buprest660_twilight)</span>
<span id="cb6-127"><a href="#cb6-127"></a></span>
<span id="cb6-128"><a href="#cb6-128"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(aim2.twilight.vismodel.list)) {</span>
<span id="cb6-129"><a href="#cb6-129"></a>  </span>
<span id="cb6-130"><a href="#cb6-130"></a>  contrast.result.i &lt;-<span class="st"> </span><span class="kw">get.aim2.twilight.coldist</span>(aim2.twilight.vismodel.list[[i]])</span>
<span id="cb6-131"><a href="#cb6-131"></a>  aim2.twilight.contrast.output[[i]] &lt;-<span class="st"> </span>contrast.result.i</span>
<span id="cb6-132"><a href="#cb6-132"></a>}</span>
<span id="cb6-133"><a href="#cb6-133"></a></span>
<span id="cb6-134"><a href="#cb6-134"></a>Cbuprest580_twilight &lt;-<span class="st"> </span>aim2.twilight.contrast.output<span class="op">$</span>VS580</span>
<span id="cb6-135"><a href="#cb6-135"></a>Cbuprest600_twilight &lt;-<span class="st"> </span>aim2.twilight.contrast.output<span class="op">$</span>VS600</span>
<span id="cb6-136"><a href="#cb6-136"></a>Cbuprest620_twilight &lt;-<span class="st"> </span>aim2.twilight.contrast.output<span class="op">$</span>VS620</span>
<span id="cb6-137"><a href="#cb6-137"></a>Cbuprest640_twilight &lt;-<span class="st"> </span>aim2.twilight.contrast.output<span class="op">$</span>VS640</span>
<span id="cb6-138"><a href="#cb6-138"></a>Cbuprest660_twilight &lt;-<span class="st"> </span>aim2.twilight.contrast.output<span class="op">$</span>VS660</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Get a column for visual system names </span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">## Create list required in the loops</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>aim1.fl.vissys &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;UVSWMW...fl&quot;</span>,</span>
<span id="cb7-4"><a href="#cb7-4"></a>                       <span class="st">&quot;UV..MWLW.fl&quot;</span>, </span>
<span id="cb7-5"><a href="#cb7-5"></a>                       <span class="st">&quot;UVSW..LW.fl&quot;</span>,</span>
<span id="cb7-6"><a href="#cb7-6"></a>                       <span class="st">&quot;UVSWMWLW.fl&quot;</span>)</span>
<span id="cb7-7"><a href="#cb7-7"></a>aim1.bl.vissys &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;UVSWMW...bl&quot;</span>,</span>
<span id="cb7-8"><a href="#cb7-8"></a>                       <span class="st">&quot;UV..MWLW.bl&quot;</span>, </span>
<span id="cb7-9"><a href="#cb7-9"></a>                       <span class="st">&quot;UVSW..LW.bl&quot;</span>,</span>
<span id="cb7-10"><a href="#cb7-10"></a>                       <span class="st">&quot;UVSWMWLW.bl&quot;</span>)</span>
<span id="cb7-11"><a href="#cb7-11"></a>aim1.bf.vissys &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;UVSWMW...bf&quot;</span>,</span>
<span id="cb7-12"><a href="#cb7-12"></a>                       <span class="st">&quot;UV..MWLW.bf&quot;</span>,</span>
<span id="cb7-13"><a href="#cb7-13"></a>                       <span class="st">&quot;UVSW..LW.bf&quot;</span>,</span>
<span id="cb7-14"><a href="#cb7-14"></a>                       <span class="st">&quot;UVSWMWLW.bf&quot;</span>)</span>
<span id="cb7-15"><a href="#cb7-15"></a>aim2.fl.vissys &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;VS580.fl&quot;</span>, <span class="st">&quot;VS600.fl&quot;</span>, <span class="st">&quot;VS620.fl&quot;</span>, <span class="st">&quot;VS640.fl&quot;</span>, <span class="st">&quot;VS660.fl&quot;</span>) </span>
<span id="cb7-16"><a href="#cb7-16"></a>aim2.bl.vissys &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;VS580.bl&quot;</span>, <span class="st">&quot;VS600.bl&quot;</span>, <span class="st">&quot;VS620.bl&quot;</span>, <span class="st">&quot;VS640.bl&quot;</span>, <span class="st">&quot;VS660.bl&quot;</span>)</span>
<span id="cb7-17"><a href="#cb7-17"></a>aim2.bf.vissys &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;VS580.bf&quot;</span>, <span class="st">&quot;VS600.bf&quot;</span>, <span class="st">&quot;VS620.bf&quot;</span>, <span class="st">&quot;VS640.bf&quot;</span>, <span class="st">&quot;VS660.bf&quot;</span>) </span>
<span id="cb7-18"><a href="#cb7-18"></a></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co">## Daylight - aim 1</span></span>
<span id="cb7-20"><a href="#cb7-20"></a>aim1.vissys_d65 &lt;-<span class="st"> </span><span class="kw">list</span>(CvsUSM, CvsUML, CvsUSL, CvsUSML)</span>
<span id="cb7-21"><a href="#cb7-21"></a></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co">### flower vs leaf</span></span>
<span id="cb7-23"><a href="#cb7-23"></a></span>
<span id="cb7-24"><a href="#cb7-24"></a>allvis.fl_d65.aim1 &lt;-<span class="st"> </span><span class="kw">data_frame</span>()</span>
<span id="cb7-25"><a href="#cb7-25"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(aim1.vissys_d65)) {</span>
<span id="cb7-26"><a href="#cb7-26"></a>  </span>
<span id="cb7-27"><a href="#cb7-27"></a>  temp.i &lt;-<span class="st"> </span>aim1.vissys_d65[[i]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-28"><a href="#cb7-28"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-29"><a href="#cb7-29"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-30"><a href="#cb7-30"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb7-31"><a href="#cb7-31"></a>  </span>
<span id="cb7-32"><a href="#cb7-32"></a>  temp.i<span class="op">$</span>vissys &lt;-<span class="st"> </span><span class="kw">strrep</span>(aim1.fl.vissys[[i]],<span class="dv">1</span>)</span>
<span id="cb7-33"><a href="#cb7-33"></a>  </span>
<span id="cb7-34"><a href="#cb7-34"></a>  allvis.fl_d65.aim1 &lt;-<span class="st"> </span>temp.i <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(allvis.fl_d65.aim1)  </span>
<span id="cb7-35"><a href="#cb7-35"></a>}</span>
<span id="cb7-36"><a href="#cb7-36"></a></span>
<span id="cb7-37"><a href="#cb7-37"></a><span class="co">### beetle vs leaf</span></span>
<span id="cb7-38"><a href="#cb7-38"></a>allvis.bl_d65.aim1 &lt;-<span class="st"> </span><span class="kw">data_frame</span>()</span>
<span id="cb7-39"><a href="#cb7-39"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(aim1.vissys_d65)) {</span>
<span id="cb7-40"><a href="#cb7-40"></a>  </span>
<span id="cb7-41"><a href="#cb7-41"></a>  temp.i &lt;-<span class="st"> </span>aim1.vissys_d65[[i]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-42"><a href="#cb7-42"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-43"><a href="#cb7-43"></a><span class="st">    </span><span class="co"># Note: for beelte vs. leaf, have to filter from patch 2 then pactch 1</span></span>
<span id="cb7-44"><a href="#cb7-44"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-45"><a href="#cb7-45"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb7-46"><a href="#cb7-46"></a>  </span>
<span id="cb7-47"><a href="#cb7-47"></a>  temp.i<span class="op">$</span>vissys &lt;-<span class="st"> </span><span class="kw">strrep</span>(aim1.bl.vissys[[i]],<span class="dv">1</span>)</span>
<span id="cb7-48"><a href="#cb7-48"></a>  </span>
<span id="cb7-49"><a href="#cb7-49"></a>  allvis.bl_d65.aim1 &lt;-<span class="st"> </span>temp.i <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(allvis.bl_d65.aim1)  </span>
<span id="cb7-50"><a href="#cb7-50"></a>}</span>
<span id="cb7-51"><a href="#cb7-51"></a></span>
<span id="cb7-52"><a href="#cb7-52"></a><span class="co">### beetle vs flower</span></span>
<span id="cb7-53"><a href="#cb7-53"></a>allvis.bf_d65.aim1 &lt;-<span class="st"> </span><span class="kw">data_frame</span>()</span>
<span id="cb7-54"><a href="#cb7-54"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(aim1.vissys_d65)) {</span>
<span id="cb7-55"><a href="#cb7-55"></a>  </span>
<span id="cb7-56"><a href="#cb7-56"></a>  temp.i &lt;-<span class="st"> </span>aim1.vissys_d65[[i]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-57"><a href="#cb7-57"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-58"><a href="#cb7-58"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-59"><a href="#cb7-59"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb7-60"><a href="#cb7-60"></a>  </span>
<span id="cb7-61"><a href="#cb7-61"></a>  temp.i<span class="op">$</span>vissys &lt;-<span class="st"> </span><span class="kw">strrep</span>(aim1.bf.vissys[[i]],<span class="dv">1</span>)</span>
<span id="cb7-62"><a href="#cb7-62"></a>  </span>
<span id="cb7-63"><a href="#cb7-63"></a>  allvis.bf_d65.aim1 &lt;-<span class="st"> </span>temp.i <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(allvis.bf_d65.aim1)  </span>
<span id="cb7-64"><a href="#cb7-64"></a>}</span>
<span id="cb7-65"><a href="#cb7-65"></a></span>
<span id="cb7-66"><a href="#cb7-66"></a></span>
<span id="cb7-67"><a href="#cb7-67"></a></span>
<span id="cb7-68"><a href="#cb7-68"></a></span>
<span id="cb7-69"><a href="#cb7-69"></a><span class="co">## Twilight - aim 1</span></span>
<span id="cb7-70"><a href="#cb7-70"></a>aim1.vissys_twilight &lt;-<span class="st"> </span><span class="kw">list</span>(CvsUSM_twilight, CvsUML_twilight, CvsUSL_twilight, CvsUSML_twilight)</span>
<span id="cb7-71"><a href="#cb7-71"></a></span>
<span id="cb7-72"><a href="#cb7-72"></a><span class="co">### flower vs leaf</span></span>
<span id="cb7-73"><a href="#cb7-73"></a>allvis.fl_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">data_frame</span>()</span>
<span id="cb7-74"><a href="#cb7-74"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(aim1.vissys_twilight)) {</span>
<span id="cb7-75"><a href="#cb7-75"></a>  </span>
<span id="cb7-76"><a href="#cb7-76"></a>  temp.i &lt;-<span class="st"> </span>aim1.vissys_twilight[[i]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-77"><a href="#cb7-77"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-78"><a href="#cb7-78"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-79"><a href="#cb7-79"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb7-80"><a href="#cb7-80"></a>  </span>
<span id="cb7-81"><a href="#cb7-81"></a>  temp.i<span class="op">$</span>vissys &lt;-<span class="st"> </span><span class="kw">strrep</span>(aim1.fl.vissys[[i]],<span class="dv">1</span>)</span>
<span id="cb7-82"><a href="#cb7-82"></a>  </span>
<span id="cb7-83"><a href="#cb7-83"></a>  allvis.fl_twilight.aim1 &lt;-<span class="st"> </span>temp.i <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(allvis.fl_twilight.aim1)  </span>
<span id="cb7-84"><a href="#cb7-84"></a>}</span>
<span id="cb7-85"><a href="#cb7-85"></a></span>
<span id="cb7-86"><a href="#cb7-86"></a><span class="co">### beetle vs leaf</span></span>
<span id="cb7-87"><a href="#cb7-87"></a>allvis.bl_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">data_frame</span>()</span>
<span id="cb7-88"><a href="#cb7-88"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(aim1.vissys_twilight)) {</span>
<span id="cb7-89"><a href="#cb7-89"></a>  </span>
<span id="cb7-90"><a href="#cb7-90"></a>  temp.i &lt;-<span class="st"> </span>aim1.vissys_twilight[[i]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-91"><a href="#cb7-91"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-92"><a href="#cb7-92"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-93"><a href="#cb7-93"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb7-94"><a href="#cb7-94"></a>  </span>
<span id="cb7-95"><a href="#cb7-95"></a>  temp.i<span class="op">$</span>vissys &lt;-<span class="st"> </span><span class="kw">strrep</span>(aim1.bl.vissys[[i]],<span class="dv">1</span>)</span>
<span id="cb7-96"><a href="#cb7-96"></a>  </span>
<span id="cb7-97"><a href="#cb7-97"></a>  allvis.bl_twilight.aim1 &lt;-<span class="st"> </span>temp.i <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(allvis.bl_twilight.aim1)  </span>
<span id="cb7-98"><a href="#cb7-98"></a>}</span>
<span id="cb7-99"><a href="#cb7-99"></a></span>
<span id="cb7-100"><a href="#cb7-100"></a><span class="co">### beetle vs flower</span></span>
<span id="cb7-101"><a href="#cb7-101"></a>allvis.bf_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">data_frame</span>()</span>
<span id="cb7-102"><a href="#cb7-102"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(aim1.vissys_twilight)) {</span>
<span id="cb7-103"><a href="#cb7-103"></a>  </span>
<span id="cb7-104"><a href="#cb7-104"></a>  temp.i &lt;-<span class="st"> </span>aim1.vissys_twilight[[i]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-105"><a href="#cb7-105"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-106"><a href="#cb7-106"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-107"><a href="#cb7-107"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb7-108"><a href="#cb7-108"></a>  </span>
<span id="cb7-109"><a href="#cb7-109"></a>  temp.i<span class="op">$</span>vissys &lt;-<span class="st"> </span><span class="kw">strrep</span>(aim1.bf.vissys[[i]],<span class="dv">1</span>)</span>
<span id="cb7-110"><a href="#cb7-110"></a>  </span>
<span id="cb7-111"><a href="#cb7-111"></a>  allvis.bf_twilight.aim1 &lt;-<span class="st"> </span>temp.i <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(allvis.bf_twilight.aim1)  </span>
<span id="cb7-112"><a href="#cb7-112"></a>}</span>
<span id="cb7-113"><a href="#cb7-113"></a></span>
<span id="cb7-114"><a href="#cb7-114"></a></span>
<span id="cb7-115"><a href="#cb7-115"></a><span class="co">## Daylight - aim 2</span></span>
<span id="cb7-116"><a href="#cb7-116"></a>aim2.vissys_d65 &lt;-<span class="st"> </span><span class="kw">list</span>(Cbuprest580, Cbuprest600, Cbuprest620, Cbuprest640, Cbuprest660)</span>
<span id="cb7-117"><a href="#cb7-117"></a></span>
<span id="cb7-118"><a href="#cb7-118"></a><span class="co">### flower vs leaf</span></span>
<span id="cb7-119"><a href="#cb7-119"></a>allvis.fl_d65.aim2 &lt;-<span class="st"> </span><span class="kw">data_frame</span>()</span>
<span id="cb7-120"><a href="#cb7-120"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(aim2.vissys_d65)) {</span>
<span id="cb7-121"><a href="#cb7-121"></a>  </span>
<span id="cb7-122"><a href="#cb7-122"></a>  temp.i &lt;-<span class="st"> </span>aim2.vissys_d65[[i]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-123"><a href="#cb7-123"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-124"><a href="#cb7-124"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-125"><a href="#cb7-125"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb7-126"><a href="#cb7-126"></a>  </span>
<span id="cb7-127"><a href="#cb7-127"></a>  temp.i<span class="op">$</span>vissys &lt;-<span class="st"> </span><span class="kw">strrep</span>(aim2.fl.vissys[[i]],<span class="dv">1</span>)</span>
<span id="cb7-128"><a href="#cb7-128"></a>  </span>
<span id="cb7-129"><a href="#cb7-129"></a>  allvis.fl_d65.aim2 &lt;-<span class="st"> </span>temp.i <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(allvis.fl_d65.aim2)  </span>
<span id="cb7-130"><a href="#cb7-130"></a>}</span>
<span id="cb7-131"><a href="#cb7-131"></a></span>
<span id="cb7-132"><a href="#cb7-132"></a><span class="co">### beetle vs leaf</span></span>
<span id="cb7-133"><a href="#cb7-133"></a>allvis.bl_d65.aim2 &lt;-<span class="st"> </span><span class="kw">data_frame</span>()</span>
<span id="cb7-134"><a href="#cb7-134"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(aim2.vissys_d65)) {</span>
<span id="cb7-135"><a href="#cb7-135"></a>  </span>
<span id="cb7-136"><a href="#cb7-136"></a>  temp.i &lt;-<span class="st"> </span>aim2.vissys_d65[[i]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-137"><a href="#cb7-137"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-138"><a href="#cb7-138"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-139"><a href="#cb7-139"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb7-140"><a href="#cb7-140"></a>  </span>
<span id="cb7-141"><a href="#cb7-141"></a>  temp.i<span class="op">$</span>vissys &lt;-<span class="st"> </span><span class="kw">strrep</span>(aim2.bl.vissys[[i]],<span class="dv">1</span>)</span>
<span id="cb7-142"><a href="#cb7-142"></a>  </span>
<span id="cb7-143"><a href="#cb7-143"></a>  allvis.bl_d65.aim2 &lt;-<span class="st"> </span>temp.i <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(allvis.bl_d65.aim2)  </span>
<span id="cb7-144"><a href="#cb7-144"></a>}</span>
<span id="cb7-145"><a href="#cb7-145"></a></span>
<span id="cb7-146"><a href="#cb7-146"></a><span class="co">### beetle vs flower</span></span>
<span id="cb7-147"><a href="#cb7-147"></a>allvis.bf_d65.aim2 &lt;-<span class="st"> </span><span class="kw">data_frame</span>()</span>
<span id="cb7-148"><a href="#cb7-148"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(aim2.vissys_d65)) {</span>
<span id="cb7-149"><a href="#cb7-149"></a>  </span>
<span id="cb7-150"><a href="#cb7-150"></a>  temp.i &lt;-<span class="st"> </span>aim2.vissys_d65[[i]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-151"><a href="#cb7-151"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-152"><a href="#cb7-152"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-153"><a href="#cb7-153"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb7-154"><a href="#cb7-154"></a>  </span>
<span id="cb7-155"><a href="#cb7-155"></a>  temp.i<span class="op">$</span>vissys &lt;-<span class="st"> </span><span class="kw">strrep</span>(aim2.bf.vissys[[i]],<span class="dv">1</span>)</span>
<span id="cb7-156"><a href="#cb7-156"></a>  </span>
<span id="cb7-157"><a href="#cb7-157"></a>  allvis.bf_d65.aim2 &lt;-<span class="st"> </span>temp.i <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(allvis.bf_d65.aim2)  </span>
<span id="cb7-158"><a href="#cb7-158"></a>}</span>
<span id="cb7-159"><a href="#cb7-159"></a></span>
<span id="cb7-160"><a href="#cb7-160"></a></span>
<span id="cb7-161"><a href="#cb7-161"></a><span class="co">##Twilight - aim 2</span></span>
<span id="cb7-162"><a href="#cb7-162"></a>aim2.vissys_twilight &lt;-<span class="st"> </span><span class="kw">list</span>(Cbuprest580_twilight, Cbuprest600_twilight, Cbuprest620_twilight, Cbuprest640_twilight, Cbuprest660_twilight)</span>
<span id="cb7-163"><a href="#cb7-163"></a></span>
<span id="cb7-164"><a href="#cb7-164"></a><span class="co">### flower vs leaf</span></span>
<span id="cb7-165"><a href="#cb7-165"></a>allvis.fl_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">data_frame</span>()</span>
<span id="cb7-166"><a href="#cb7-166"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(aim2.vissys_twilight)) {</span>
<span id="cb7-167"><a href="#cb7-167"></a>  </span>
<span id="cb7-168"><a href="#cb7-168"></a>  temp.i &lt;-<span class="st"> </span>aim2.vissys_twilight[[i]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-169"><a href="#cb7-169"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-170"><a href="#cb7-170"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-171"><a href="#cb7-171"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb7-172"><a href="#cb7-172"></a>  </span>
<span id="cb7-173"><a href="#cb7-173"></a>  temp.i<span class="op">$</span>vissys &lt;-<span class="st"> </span><span class="kw">strrep</span>(aim2.fl.vissys[[i]],<span class="dv">1</span>)</span>
<span id="cb7-174"><a href="#cb7-174"></a>  </span>
<span id="cb7-175"><a href="#cb7-175"></a>  allvis.fl_twilight.aim2 &lt;-<span class="st"> </span>temp.i <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(allvis.fl_twilight.aim2)  </span>
<span id="cb7-176"><a href="#cb7-176"></a>}</span>
<span id="cb7-177"><a href="#cb7-177"></a></span>
<span id="cb7-178"><a href="#cb7-178"></a><span class="co">### beetle vs leaf</span></span>
<span id="cb7-179"><a href="#cb7-179"></a>allvis.bl_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">data_frame</span>()</span>
<span id="cb7-180"><a href="#cb7-180"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(aim2.vissys_twilight)) {</span>
<span id="cb7-181"><a href="#cb7-181"></a>  </span>
<span id="cb7-182"><a href="#cb7-182"></a>  temp.i &lt;-<span class="st"> </span>aim2.vissys_twilight[[i]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-183"><a href="#cb7-183"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-184"><a href="#cb7-184"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-185"><a href="#cb7-185"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb7-186"><a href="#cb7-186"></a>  </span>
<span id="cb7-187"><a href="#cb7-187"></a>  temp.i<span class="op">$</span>vissys &lt;-<span class="st"> </span><span class="kw">strrep</span>(aim2.bl.vissys[[i]],<span class="dv">1</span>)</span>
<span id="cb7-188"><a href="#cb7-188"></a>  </span>
<span id="cb7-189"><a href="#cb7-189"></a>  allvis.bl_twilight.aim2 &lt;-<span class="st"> </span>temp.i <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(allvis.bl_twilight.aim2)  </span>
<span id="cb7-190"><a href="#cb7-190"></a>}</span>
<span id="cb7-191"><a href="#cb7-191"></a></span>
<span id="cb7-192"><a href="#cb7-192"></a><span class="co">### beetle vs flower</span></span>
<span id="cb7-193"><a href="#cb7-193"></a>allvis.bf_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">data_frame</span>()</span>
<span id="cb7-194"><a href="#cb7-194"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(aim2.vissys_twilight)) {</span>
<span id="cb7-195"><a href="#cb7-195"></a>  </span>
<span id="cb7-196"><a href="#cb7-196"></a>  temp.i &lt;-<span class="st"> </span>aim2.vissys_twilight[[i]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-197"><a href="#cb7-197"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-198"><a href="#cb7-198"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-199"><a href="#cb7-199"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb7-200"><a href="#cb7-200"></a>  </span>
<span id="cb7-201"><a href="#cb7-201"></a>  temp.i<span class="op">$</span>vissys &lt;-<span class="st"> </span><span class="kw">strrep</span>(aim2.bf.vissys[[i]],<span class="dv">1</span>)</span>
<span id="cb7-202"><a href="#cb7-202"></a>  </span>
<span id="cb7-203"><a href="#cb7-203"></a>  allvis.bf_twilight.aim2 &lt;-<span class="st"> </span>temp.i <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(allvis.bf_twilight.aim2)  </span>
<span id="cb7-204"><a href="#cb7-204"></a>}</span></code></pre></div>
<p></br></p>
<div id="contrast-tables" class="section level2 tabset tabset-fade tabset-pills">
<h2>Contrast tables</h2>
<p></br></p>
<div id="aim-1" class="section level3 tabset tabset-fade tabset-pills">
<h3>Aim 1</h3>
<p>The table shows the mean contrast in each comparison group</p>
<div id="daylight" class="section level4">
<h4>Daylight</h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Combine comparison groups together in a table</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">## create a input list for the loop</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>allvis.aim1_d65.list &lt;-<span class="st"> </span><span class="kw">list</span>(allvis.fl_d65.aim1, allvis.bl_d65.aim1, allvis.bf_d65.aim1)</span>
<span id="cb8-4"><a href="#cb8-4"></a></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">## create a data frame to hold the loop output</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>contrast.list_d65.aim1 &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">system =</span> <span class="kw">c</span>(<span class="st">&quot;USM&quot;</span>, <span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USML&quot;</span>),</span>
<span id="cb8-7"><a href="#cb8-7"></a>                                     <span class="dt">flower.vs.leaf =</span> <span class="ot">NA</span>, </span>
<span id="cb8-8"><a href="#cb8-8"></a>                                     <span class="dt">beetle.vs.leaf =</span> <span class="ot">NA</span>, </span>
<span id="cb8-9"><a href="#cb8-9"></a>                                     <span class="dt">beetle.vs.flower =</span> <span class="ot">NA</span>)</span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">## loop</span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(allvis.aim1_d65.list)) {</span>
<span id="cb8-12"><a href="#cb8-12"></a>  </span>
<span id="cb8-13"><a href="#cb8-13"></a>   meantable.i &lt;-<span class="st"> </span><span class="kw">aggregate</span>(allvis.aim1_d65.list[[i]][,<span class="st">&quot;dS&quot;</span>], </span>
<span id="cb8-14"><a href="#cb8-14"></a>                            <span class="dt">by =</span> <span class="kw">list</span>(allvis.aim1_d65.list[[i]]<span class="op">$</span>vissys), </span>
<span id="cb8-15"><a href="#cb8-15"></a>                            mean) </span>
<span id="cb8-16"><a href="#cb8-16"></a>   mean.i &lt;-<span class="st"> </span>meantable.i[, <span class="dv">2</span>] </span>
<span id="cb8-17"><a href="#cb8-17"></a>   contrast.list_d65.aim1[,i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>mean.i <span class="co"># here same at column i+1 because the 1st column is the visual system names</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>}</span>
<span id="cb8-19"><a href="#cb8-19"></a></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="co">## print out the table </span></span>
<span id="cb8-21"><a href="#cb8-21"></a>contrast.list_d65.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>() </span></code></pre></div>
<table style="width:86%;">
<colgroup>
<col width="12%" />
<col width="23%" />
<col width="23%" />
<col width="26%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">system</th>
<th align="center">flower.vs.leaf</th>
<th align="center">beetle.vs.leaf</th>
<th align="center">beetle.vs.flower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">USM</td>
<td align="center">5.523</td>
<td align="center">4.36</td>
<td align="center">5.571</td>
</tr>
<tr class="even">
<td align="center">UML</td>
<td align="center">5.851</td>
<td align="center">4.347</td>
<td align="center">6.202</td>
</tr>
<tr class="odd">
<td align="center">USL</td>
<td align="center">5.866</td>
<td align="center">3.87</td>
<td align="center">6.203</td>
</tr>
<tr class="even">
<td align="center">USML</td>
<td align="center">5.786</td>
<td align="center">4.374</td>
<td align="center">6.122</td>
</tr>
</tbody>
</table>
</div>
<div id="twilight" class="section level4">
<h4>Twilight</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>allvis.aim1_twilight.list &lt;-<span class="st"> </span><span class="kw">list</span>(allvis.fl_twilight.aim1, allvis.bl_twilight.aim1, allvis.bf_twilight.aim1)</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">## create a data frame to hold the loop output</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>contrast.list_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">system =</span> <span class="kw">c</span>(<span class="st">&quot;USM&quot;</span>, <span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USML&quot;</span>),</span>
<span id="cb9-5"><a href="#cb9-5"></a>                                          <span class="dt">flower.vs.leaf =</span> <span class="ot">NA</span>, </span>
<span id="cb9-6"><a href="#cb9-6"></a>                                          <span class="dt">beetle.vs.leaf =</span> <span class="ot">NA</span>, </span>
<span id="cb9-7"><a href="#cb9-7"></a>                                          <span class="dt">beetle.vs.flower =</span> <span class="ot">NA</span>)</span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">## loop</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(allvis.aim1_twilight.list)) {</span>
<span id="cb9-10"><a href="#cb9-10"></a>  </span>
<span id="cb9-11"><a href="#cb9-11"></a>   meantable.i &lt;-<span class="st"> </span><span class="kw">aggregate</span>(allvis.aim1_twilight.list[[i]][,<span class="st">&quot;dS&quot;</span>], </span>
<span id="cb9-12"><a href="#cb9-12"></a>                            <span class="dt">by =</span> <span class="kw">list</span>(allvis.aim1_twilight.list[[i]]<span class="op">$</span>vissys), </span>
<span id="cb9-13"><a href="#cb9-13"></a>                            mean) </span>
<span id="cb9-14"><a href="#cb9-14"></a>   mean.i &lt;-<span class="st"> </span>meantable.i[, <span class="dv">2</span>] </span>
<span id="cb9-15"><a href="#cb9-15"></a>   contrast.list_twilight.aim1[,i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>mean.i <span class="co"># here same at column i+1 because the 1st column is the visual system names</span></span>
<span id="cb9-16"><a href="#cb9-16"></a>}</span>
<span id="cb9-17"><a href="#cb9-17"></a></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">## print out the table </span></span>
<span id="cb9-19"><a href="#cb9-19"></a>contrast.list_twilight.aim1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>() </span></code></pre></div>
<table style="width:86%;">
<colgroup>
<col width="12%" />
<col width="23%" />
<col width="23%" />
<col width="26%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">system</th>
<th align="center">flower.vs.leaf</th>
<th align="center">beetle.vs.leaf</th>
<th align="center">beetle.vs.flower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">USM</td>
<td align="center">0.75</td>
<td align="center">0.4678</td>
<td align="center">0.7249</td>
</tr>
<tr class="even">
<td align="center">UML</td>
<td align="center">0.781</td>
<td align="center">0.456</td>
<td align="center">0.7989</td>
</tr>
<tr class="odd">
<td align="center">USL</td>
<td align="center">0.7393</td>
<td align="center">0.3659</td>
<td align="center">0.7503</td>
</tr>
<tr class="even">
<td align="center">USML</td>
<td align="center">0.8778</td>
<td align="center">0.5297</td>
<td align="center">0.9064</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="aim-2" class="section level3 tabset tabset-fade tabset-pills">
<h3>Aim 2</h3>
<p>The table shows the mean contrast in each comparison group</p>
<div id="daylight-1" class="section level4">
<h4>Daylight</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>allvis.aim2_d65.list &lt;-<span class="st"> </span><span class="kw">list</span>(allvis.fl_d65.aim2, allvis.bl_d65.aim2, allvis.bf_d65.aim2)</span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co">## create a data frame to hold the loop output</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>contrast.list_d65.aim2 &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">system =</span> <span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>, <span class="st">&quot;VS 640&quot;</span>, <span class="st">&quot;VS 660&quot;</span>),</span>
<span id="cb10-5"><a href="#cb10-5"></a>                                     <span class="dt">flower.vs.leaf =</span> <span class="ot">NA</span>, </span>
<span id="cb10-6"><a href="#cb10-6"></a>                                     <span class="dt">beetle.vs.leaf =</span> <span class="ot">NA</span>, </span>
<span id="cb10-7"><a href="#cb10-7"></a>                                     <span class="dt">beetle.vs.flower =</span> <span class="ot">NA</span>)</span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">## loop</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(allvis.aim2_d65.list)) {</span>
<span id="cb10-10"><a href="#cb10-10"></a>  </span>
<span id="cb10-11"><a href="#cb10-11"></a>   meantable.i &lt;-<span class="st"> </span><span class="kw">aggregate</span>(allvis.aim2_d65.list[[i]][,<span class="st">&quot;dS&quot;</span>], </span>
<span id="cb10-12"><a href="#cb10-12"></a>                            <span class="dt">by =</span> <span class="kw">list</span>(allvis.aim2_d65.list[[i]]<span class="op">$</span>vissys), </span>
<span id="cb10-13"><a href="#cb10-13"></a>                            mean) </span>
<span id="cb10-14"><a href="#cb10-14"></a>   mean.i &lt;-<span class="st"> </span>meantable.i[, <span class="dv">2</span>] </span>
<span id="cb10-15"><a href="#cb10-15"></a>   contrast.list_d65.aim2[,i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>mean.i <span class="co"># here same at column i+1 because the 1st column is the visual system names</span></span>
<span id="cb10-16"><a href="#cb10-16"></a>}</span>
<span id="cb10-17"><a href="#cb10-17"></a></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="co">## print out the table </span></span>
<span id="cb10-19"><a href="#cb10-19"></a>contrast.list_d65.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>() </span></code></pre></div>
<table style="width:86%;">
<colgroup>
<col width="12%" />
<col width="23%" />
<col width="23%" />
<col width="26%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">system</th>
<th align="center">flower.vs.leaf</th>
<th align="center">beetle.vs.leaf</th>
<th align="center">beetle.vs.flower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">VS 580</td>
<td align="center">5.57</td>
<td align="center">4.089</td>
<td align="center">5.96</td>
</tr>
<tr class="even">
<td align="center">VS 600</td>
<td align="center">5.786</td>
<td align="center">4.374</td>
<td align="center">6.122</td>
</tr>
<tr class="odd">
<td align="center">VS 620</td>
<td align="center">6.034</td>
<td align="center">4.666</td>
<td align="center">6.335</td>
</tr>
<tr class="even">
<td align="center">VS 640</td>
<td align="center">6.119</td>
<td align="center">4.882</td>
<td align="center">6.566</td>
</tr>
<tr class="odd">
<td align="center">VS 660</td>
<td align="center">5.968</td>
<td align="center">5.03</td>
<td align="center">6.778</td>
</tr>
</tbody>
</table>
</div>
<div id="twilight-1" class="section level4">
<h4>Twilight</h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>allvis.aim2_twilight.list &lt;-<span class="st"> </span><span class="kw">list</span>(allvis.fl_twilight.aim2, allvis.bl_twilight.aim2, allvis.bf_twilight.aim2)</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">## create a data frame to hold the loop output</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>contrast.list_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">system =</span> <span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>, <span class="st">&quot;VS 640&quot;</span>, <span class="st">&quot;VS 660&quot;</span>),</span>
<span id="cb11-5"><a href="#cb11-5"></a>                                          <span class="dt">flower.vs.leaf =</span> <span class="ot">NA</span>,</span>
<span id="cb11-6"><a href="#cb11-6"></a>                                          <span class="dt">beetle.vs.leaf =</span> <span class="ot">NA</span>, </span>
<span id="cb11-7"><a href="#cb11-7"></a>                                          <span class="dt">beetle.vs.flower =</span> <span class="ot">NA</span>)</span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">## loop</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(allvis.aim2_twilight.list)) {</span>
<span id="cb11-10"><a href="#cb11-10"></a>  </span>
<span id="cb11-11"><a href="#cb11-11"></a>   meantable.i &lt;-<span class="st"> </span><span class="kw">aggregate</span>(allvis.aim2_twilight.list[[i]][,<span class="st">&quot;dS&quot;</span>], </span>
<span id="cb11-12"><a href="#cb11-12"></a>                            <span class="dt">by =</span> <span class="kw">list</span>(allvis.aim2_twilight.list[[i]]<span class="op">$</span>vissys), </span>
<span id="cb11-13"><a href="#cb11-13"></a>                            mean) </span>
<span id="cb11-14"><a href="#cb11-14"></a>   mean.i &lt;-<span class="st"> </span>meantable.i[, <span class="dv">2</span>] </span>
<span id="cb11-15"><a href="#cb11-15"></a>   contrast.list_twilight.aim2[,i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>mean.i <span class="co"># here same at column i+1 because the 1st column is the visual system names</span></span>
<span id="cb11-16"><a href="#cb11-16"></a>}</span>
<span id="cb11-17"><a href="#cb11-17"></a></span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="co">## print out the table </span></span>
<span id="cb11-19"><a href="#cb11-19"></a>contrast.list_twilight.aim2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>() </span></code></pre></div>
<table style="width:86%;">
<colgroup>
<col width="12%" />
<col width="23%" />
<col width="23%" />
<col width="26%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">system</th>
<th align="center">flower.vs.leaf</th>
<th align="center">beetle.vs.leaf</th>
<th align="center">beetle.vs.flower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">VS 580</td>
<td align="center">0.828</td>
<td align="center">0.4746</td>
<td align="center">0.8592</td>
</tr>
<tr class="even">
<td align="center">VS 600</td>
<td align="center">0.8778</td>
<td align="center">0.5297</td>
<td align="center">0.9064</td>
</tr>
<tr class="odd">
<td align="center">VS 620</td>
<td align="center">0.9217</td>
<td align="center">0.5801</td>
<td align="center">0.9647</td>
</tr>
<tr class="even">
<td align="center">VS 640</td>
<td align="center">0.9157</td>
<td align="center">0.6059</td>
<td align="center">1.012</td>
</tr>
<tr class="odd">
<td align="center">VS 660</td>
<td align="center">0.8802</td>
<td align="center">0.6152</td>
<td align="center">1.037</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="compare-contrasts" class="section level1">
<h1>Compare contrasts</h1>
<ul>
<li>We applied the same statistical approaches to compare contrasts between visual systems as in the <a href="main_models.html">Main models</a>.</li>
</ul>
<div id="check-assumptions" class="section level2 tabset tabset-fade tabset-pills">
<h2>Check assumptions</h2>
<ul>
<li>Before running the GLMMs, we first check if the data follows the assumption of normality and homogeneity of variance</li>
</ul>
<p></br></p>
<p>Click the tabs to choose the assumptions ( <strong>Normality</strong> / <strong>Homogeneity</strong> ) of the visual models ( <strong>Aim 1</strong> / <strong>Aim 2</strong> ) under different light conditions ( <strong>Daylight</strong> / <strong>Twilight</strong>)</p>
<p></br></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># list data for the following loops</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>input.list.regres_d65.aim1 &lt;-<span class="st"> </span><span class="kw">list</span>(allvis.fl_d65.aim1,</span>
<span id="cb12-3"><a href="#cb12-3"></a>                                   allvis.bl_d65.aim1,</span>
<span id="cb12-4"><a href="#cb12-4"></a>                                   allvis.bf_d65.aim1)</span>
<span id="cb12-5"><a href="#cb12-5"></a>input.list.regres_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">list</span>(allvis.fl_twilight.aim1,</span>
<span id="cb12-6"><a href="#cb12-6"></a>                                        allvis.bl_twilight.aim1,</span>
<span id="cb12-7"><a href="#cb12-7"></a>                                        allvis.bf_twilight.aim1)</span>
<span id="cb12-8"><a href="#cb12-8"></a>input.list.regres_d65.aim2 &lt;-<span class="st"> </span><span class="kw">list</span>(allvis.fl_d65.aim2,</span>
<span id="cb12-9"><a href="#cb12-9"></a>                                   allvis.bl_d65.aim2,</span>
<span id="cb12-10"><a href="#cb12-10"></a>                                   allvis.bf_d65.aim2)</span>
<span id="cb12-11"><a href="#cb12-11"></a>input.list.regres_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">list</span>(allvis.fl_twilight.aim2,</span>
<span id="cb12-12"><a href="#cb12-12"></a>                                        allvis.bl_twilight.aim2,</span>
<span id="cb12-13"><a href="#cb12-13"></a>                                        allvis.bf_twilight.aim2)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co">##D65 - aim 1</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>res.list_d65.aim1 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="ot">NA</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(input.list.regres_d65.aim1)) {</span>
<span id="cb13-5"><a href="#cb13-5"></a>  res.i &lt;-<span class="st"> </span><span class="kw">lm</span>(</span>
<span id="cb13-6"><a href="#cb13-6"></a>    input.list.regres_d65.aim1[[i]]<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>input.list.regres_d65.aim1[[i]][,<span class="dv">4</span>])</span>
<span id="cb13-7"><a href="#cb13-7"></a>  res.list_d65.aim1[[i]] &lt;-<span class="st"> </span>res.i</span>
<span id="cb13-8"><a href="#cb13-8"></a>}</span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co">##D65 - Aim 2</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>res.list_d65.aim2 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="ot">NA</span>)</span>
<span id="cb13-13"><a href="#cb13-13"></a></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(input.list.regres_d65.aim2)) {</span>
<span id="cb13-15"><a href="#cb13-15"></a>  res.i &lt;-<span class="st"> </span><span class="kw">lm</span>(</span>
<span id="cb13-16"><a href="#cb13-16"></a>    input.list.regres_d65.aim2[[i]]<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>input.list.regres_d65.aim2[[i]][,<span class="dv">4</span>])</span>
<span id="cb13-17"><a href="#cb13-17"></a>  res.list_d65.aim2[[i]] &lt;-<span class="st"> </span>res.i</span>
<span id="cb13-18"><a href="#cb13-18"></a>}</span>
<span id="cb13-19"><a href="#cb13-19"></a></span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="co">##Twilight - aim 1</span></span>
<span id="cb13-21"><a href="#cb13-21"></a>res.list_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="ot">NA</span>)</span>
<span id="cb13-22"><a href="#cb13-22"></a></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(input.list.regres_twilight.aim1)) {</span>
<span id="cb13-24"><a href="#cb13-24"></a>  res.i &lt;-<span class="st"> </span><span class="kw">lm</span>(</span>
<span id="cb13-25"><a href="#cb13-25"></a>    input.list.regres_twilight.aim1[[i]]<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>input.list.regres_twilight.aim1[[i]][,<span class="dv">4</span>])</span>
<span id="cb13-26"><a href="#cb13-26"></a>  res.list_twilight.aim1[[i]] &lt;-<span class="st"> </span>res.i</span>
<span id="cb13-27"><a href="#cb13-27"></a>}</span>
<span id="cb13-28"><a href="#cb13-28"></a></span>
<span id="cb13-29"><a href="#cb13-29"></a><span class="co">##Twilight - Aim 2</span></span>
<span id="cb13-30"><a href="#cb13-30"></a>res.list_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="ot">NA</span>)</span>
<span id="cb13-31"><a href="#cb13-31"></a></span>
<span id="cb13-32"><a href="#cb13-32"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(input.list.regres_twilight.aim2)) {</span>
<span id="cb13-33"><a href="#cb13-33"></a>  res.i &lt;-<span class="st"> </span><span class="kw">lm</span>(</span>
<span id="cb13-34"><a href="#cb13-34"></a>    input.list.regres_twilight.aim2[[i]]<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>input.list.regres_twilight.aim2[[i]][,<span class="dv">4</span>])</span>
<span id="cb13-35"><a href="#cb13-35"></a>  res.list_twilight.aim2[[i]] &lt;-<span class="st"> </span>res.i</span>
<span id="cb13-36"><a href="#cb13-36"></a>}</span></code></pre></div>
<div id="normality" class="section level3 tabset tabset-fade tabset-pills">
<h3>Normality</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>group.list &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;Flower vs Leaf&quot;</span>, <span class="st">&quot;Beetle vs Leaf&quot;</span>, <span class="st">&quot;Beetle vs Flower&quot;</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>input.list.norm_d65.aim1 &lt;-<span class="st"> </span><span class="kw">list</span>(res.list_d65.aim1[[<span class="dv">1</span>]], </span>
<span id="cb14-3"><a href="#cb14-3"></a>                                 res.list_d65.aim1[[<span class="dv">2</span>]],</span>
<span id="cb14-4"><a href="#cb14-4"></a>                                 res.list_d65.aim1[[<span class="dv">3</span>]])</span>
<span id="cb14-5"><a href="#cb14-5"></a>input.list.norm_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">list</span>(res.list_twilight.aim1[[<span class="dv">1</span>]], </span>
<span id="cb14-6"><a href="#cb14-6"></a>                                      res.list_twilight.aim1[[<span class="dv">2</span>]],</span>
<span id="cb14-7"><a href="#cb14-7"></a>                                      res.list_twilight.aim1[[<span class="dv">3</span>]])</span>
<span id="cb14-8"><a href="#cb14-8"></a>input.list.norm_d65.aim2 &lt;-<span class="st"> </span><span class="kw">list</span>(res.list_d65.aim2[[<span class="dv">1</span>]], </span>
<span id="cb14-9"><a href="#cb14-9"></a>                                 res.list_d65.aim2[[<span class="dv">2</span>]],</span>
<span id="cb14-10"><a href="#cb14-10"></a>                                 res.list_d65.aim2[[<span class="dv">3</span>]])</span>
<span id="cb14-11"><a href="#cb14-11"></a>input.list.norm_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">list</span>(res.list_twilight.aim2[[<span class="dv">1</span>]], </span>
<span id="cb14-12"><a href="#cb14-12"></a>                                      res.list_twilight.aim2[[<span class="dv">2</span>]],</span>
<span id="cb14-13"><a href="#cb14-13"></a>                                      res.list_twilight.aim2[[<span class="dv">3</span>]])</span></code></pre></div>
<div id="aim-1-1" class="section level4 tabset tabset-fade tabset-pills">
<h4>Aim 1</h4>
<div id="d65" class="section level5">
<h5>D65</h5>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">pin =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>))</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(input.list.norm_d65.aim1)) {</span>
<span id="cb15-3"><a href="#cb15-3"></a>  </span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="kw">qqnorm</span>(input.list.norm_d65.aim1[[i]]<span class="op">$</span>residuals, </span>
<span id="cb15-5"><a href="#cb15-5"></a>         <span class="dt">main =</span> group.list[[i]])</span>
<span id="cb15-6"><a href="#cb15-6"></a>}</span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="twilight-2" class="section level5">
<h5>Twilight</h5>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">pin =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>))</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(input.list.norm_twilight.aim1)) {</span>
<span id="cb16-3"><a href="#cb16-3"></a>  </span>
<span id="cb16-4"><a href="#cb16-4"></a>  <span class="kw">qqnorm</span>(input.list.norm_twilight.aim1[[i]]<span class="op">$</span>residuals, </span>
<span id="cb16-5"><a href="#cb16-5"></a>         <span class="dt">main =</span> group.list[[i]])</span>
<span id="cb16-6"><a href="#cb16-6"></a>}</span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
</div>
<div id="aim-2-1" class="section level4 tabset tabset-fade tabset-pills">
<h4>Aim 2</h4>
<div id="d65-1" class="section level5">
<h5>D65</h5>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">pin =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>))</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(input.list.norm_d65.aim2)) {</span>
<span id="cb17-3"><a href="#cb17-3"></a>  </span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="kw">qqnorm</span>(input.list.norm_d65.aim2[[i]]<span class="op">$</span>residuals, </span>
<span id="cb17-5"><a href="#cb17-5"></a>         <span class="dt">main =</span> group.list[[i]])</span>
<span id="cb17-6"><a href="#cb17-6"></a>}</span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="twilight-3" class="section level5">
<h5>Twilight</h5>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">pin =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>))</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(input.list.norm_twilight.aim2)) {</span>
<span id="cb18-3"><a href="#cb18-3"></a>  </span>
<span id="cb18-4"><a href="#cb18-4"></a>  <span class="kw">qqnorm</span>(input.list.norm_twilight.aim2[[i]]<span class="op">$</span>residuals, </span>
<span id="cb18-5"><a href="#cb18-5"></a>         <span class="dt">main =</span> group.list[[i]])</span>
<span id="cb18-6"><a href="#cb18-6"></a>}</span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="homoscedasticity" class="section level3 tabset tabset-fade tabset-pills">
<h3>Homoscedasticity</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>vislist.aim1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USM&quot;</span>, <span class="st">&quot;USML&quot;</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>vislist.aim2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>, <span class="st">&quot;VS 640&quot;</span>, <span class="st">&quot;VS 660&quot;</span>)</span></code></pre></div>
<div id="aim-1-2" class="section level4 tabset tabset-fade tabset-pills">
<h4>Aim 1</h4>
<div id="d65-2" class="section level5">
<h5>D65</h5>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">par</span> (<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>)) <span class="co">#oma=c() to create space for common labels</span></span>
<span id="cb20-2"><a href="#cb20-2"></a></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(input.list.regres_d65.aim1)) {</span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="kw">boxplot</span>(input.list.regres_d65.aim1[[i]]<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>input.list.regres_d65.aim1[[i]][,<span class="dv">4</span>], </span>
<span id="cb20-5"><a href="#cb20-5"></a>        <span class="co"># the forth column is the compairson group name</span></span>
<span id="cb20-6"><a href="#cb20-6"></a>        <span class="dt">las =</span> <span class="dv">2</span>,</span>
<span id="cb20-7"><a href="#cb20-7"></a>        <span class="dt">main =</span> group.list[[i]],</span>
<span id="cb20-8"><a href="#cb20-8"></a>        <span class="dt">names =</span> vislist.aim1)</span>
<span id="cb20-9"><a href="#cb20-9"></a>}</span>
<span id="cb20-10"><a href="#cb20-10"></a></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="kw">mtext</span>(<span class="st">&quot;Visual system&quot;</span>,<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="dv">0</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">1.3</span>) </span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="co">#side assigns the position of the text e.g. bottom</span></span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="kw">mtext</span>(<span class="st">&quot;Contrast (JND)&quot;</span>,<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="dv">0</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">1.3</span>, <span class="dt">las =</span> <span class="dv">0</span>) </span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co">#las assigns the orientation of the text</span></span></code></pre></div>
</div>
<div id="twilight-4" class="section level5">
<h5>Twilight</h5>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">par</span> (<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb22-2"><a href="#cb22-2"></a></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(input.list.regres_twilight.aim1)) {</span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="kw">boxplot</span>(input.list.regres_twilight.aim1[[i]]<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>input.list.regres_twilight.aim1[[i]][,<span class="dv">4</span>], </span>
<span id="cb22-5"><a href="#cb22-5"></a>        <span class="dt">las =</span> <span class="dv">2</span>,</span>
<span id="cb22-6"><a href="#cb22-6"></a>        <span class="dt">main =</span> group.list[[i]],</span>
<span id="cb22-7"><a href="#cb22-7"></a>        <span class="dt">names =</span> vislist.aim1)</span>
<span id="cb22-8"><a href="#cb22-8"></a>}</span>
<span id="cb22-9"><a href="#cb22-9"></a></span>
<span id="cb22-10"><a href="#cb22-10"></a><span class="kw">mtext</span>(<span class="st">&quot;Visual system&quot;</span>,<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="dv">0</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">1.3</span>) </span>
<span id="cb22-11"><a href="#cb22-11"></a><span class="kw">mtext</span>(<span class="st">&quot;Contrast (JND)&quot;</span>,<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="dv">0</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">1.3</span>, <span class="dt">las =</span> <span class="dv">0</span>) </span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
</div>
<div id="aim-2-2" class="section level4 tabset tabset-fade tabset-pills">
<h4>Aim 2</h4>
<div id="d65-3" class="section level5">
<h5>D65</h5>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">par</span> (<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(input.list.regres_d65.aim2)) {</span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="kw">boxplot</span>(input.list.regres_d65.aim2[[i]]<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>input.list.regres_d65.aim2[[i]][,<span class="dv">4</span>], </span>
<span id="cb23-5"><a href="#cb23-5"></a>        <span class="dt">las =</span> <span class="dv">2</span>,</span>
<span id="cb23-6"><a href="#cb23-6"></a>        <span class="dt">main =</span> group.list[[i]],</span>
<span id="cb23-7"><a href="#cb23-7"></a>        <span class="dt">names =</span> vislist.aim2)</span>
<span id="cb23-8"><a href="#cb23-8"></a>}</span>
<span id="cb23-9"><a href="#cb23-9"></a></span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="kw">mtext</span>(<span class="st">&quot;Visual system&quot;</span>,<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="dv">0</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">1.3</span>) </span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="kw">mtext</span>(<span class="st">&quot;Contrast (JND)&quot;</span>,<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="dv">0</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">1.3</span>, <span class="dt">las =</span> <span class="dv">0</span>) </span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="twilight-5" class="section level5">
<h5>Twilight</h5>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">par</span> (<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb24-2"><a href="#cb24-2"></a></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(input.list.regres_twilight.aim2)) {</span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="kw">boxplot</span>(input.list.regres_twilight.aim2[[i]]<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>input.list.regres_twilight.aim2[[i]][,<span class="dv">4</span>], </span>
<span id="cb24-5"><a href="#cb24-5"></a>        <span class="dt">las =</span> <span class="dv">2</span>,</span>
<span id="cb24-6"><a href="#cb24-6"></a>        <span class="dt">main =</span> group.list[[i]],</span>
<span id="cb24-7"><a href="#cb24-7"></a>        <span class="dt">names =</span> vislist.aim2)</span>
<span id="cb24-8"><a href="#cb24-8"></a>}</span>
<span id="cb24-9"><a href="#cb24-9"></a></span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="kw">mtext</span>(<span class="st">&quot;Visual system&quot;</span>,<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="dv">0</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">1.3</span>) </span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="kw">mtext</span>(<span class="st">&quot;Contrast (JND)&quot;</span>,<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="dv">0</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">1.3</span>, <span class="dt">las =</span> <span class="dv">0</span>) </span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p></br> </br></p>
</div>
</div>
</div>
</div>
<div id="glmm-results" class="section level2">
<h2>GLMM results</h2>
<p></br></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>get.lmer &lt;-<span class="st"> </span><span class="cf">function</span>(datlist, compnnumber){</span>
<span id="cb25-2"><a href="#cb25-2"></a>  </span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="kw">lmer</span>(dS <span class="op">~</span><span class="st"> </span>vissys <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), </span>
<span id="cb25-4"><a href="#cb25-4"></a>       <span class="dt">data =</span> datlist[[compnnumber]], <span class="dt">REML =</span> F)</span>
<span id="cb25-5"><a href="#cb25-5"></a>  <span class="co">#REML=F, in order to fit the model using the likelihood ratio test. Otherwise, the lmer default will fit the model using the REML (REstricted Maximum Likelihood) criterion.</span></span>
<span id="cb25-6"><a href="#cb25-6"></a>}</span>
<span id="cb25-7"><a href="#cb25-7"></a></span>
<span id="cb25-8"><a href="#cb25-8"></a>get.posthocsum &lt;-<span class="st"> </span><span class="cf">function</span>(modelx){</span>
<span id="cb25-9"><a href="#cb25-9"></a>  </span>
<span id="cb25-10"><a href="#cb25-10"></a>  <span class="kw">summary</span>(<span class="kw">glht</span>(modelx, </span>
<span id="cb25-11"><a href="#cb25-11"></a>               <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">vissys =</span> <span class="st">&quot;Tukey&quot;</span>)), </span>
<span id="cb25-12"><a href="#cb25-12"></a>          <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb25-13"><a href="#cb25-13"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co">#GLMM - D65 - aim 1</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="co">##Flower vs Leaf</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>m.flower.vs.leaf_d65.aim1 &lt;-<span class="st"> </span><span class="kw">get.lmer</span>(input.list.regres_d65.aim1, <span class="dv">1</span>)</span>
<span id="cb26-4"><a href="#cb26-4"></a>sum.flower.vs.leaf_d65.aim1 &lt;-<span class="st"> </span><span class="kw">get.posthocsum</span>(m.flower.vs.leaf_d65.aim1)</span>
<span id="cb26-5"><a href="#cb26-5"></a></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="co">##Beetle vs Leaf</span></span>
<span id="cb26-7"><a href="#cb26-7"></a>m.beetle.vs.leaf_d65.aim1 &lt;-<span class="st"> </span><span class="kw">get.lmer</span>(input.list.regres_d65.aim1, <span class="dv">2</span>)</span>
<span id="cb26-8"><a href="#cb26-8"></a>sum.beetle.vs.leaf_d65.aim1 &lt;-<span class="st"> </span><span class="kw">get.posthocsum</span>(m.beetle.vs.leaf_d65.aim1)</span>
<span id="cb26-9"><a href="#cb26-9"></a></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="co">##Beetle vs Flower</span></span>
<span id="cb26-11"><a href="#cb26-11"></a>m.beetle.vs.flower_d65.aim1 &lt;-<span class="st"> </span><span class="kw">get.lmer</span>(input.list.regres_d65.aim1, <span class="dv">3</span>)</span>
<span id="cb26-12"><a href="#cb26-12"></a>sum.beetle.vs.flower_d65.aim1 &lt;-<span class="st"> </span><span class="kw">get.posthocsum</span>(m.beetle.vs.flower_d65.aim1)</span>
<span id="cb26-13"><a href="#cb26-13"></a></span>
<span id="cb26-14"><a href="#cb26-14"></a><span class="co">#GLMM - D65 - Aim 2</span></span>
<span id="cb26-15"><a href="#cb26-15"></a><span class="co">##Flower vs Leaf</span></span>
<span id="cb26-16"><a href="#cb26-16"></a>m.flower.vs.leaf_d65.aim2 &lt;-<span class="st"> </span><span class="kw">get.lmer</span>(input.list.regres_d65.aim2, <span class="dv">1</span>)</span>
<span id="cb26-17"><a href="#cb26-17"></a>sum.flower.vs.leaf_d65.aim2 &lt;-<span class="st"> </span><span class="kw">get.posthocsum</span>(m.flower.vs.leaf_d65.aim2)</span>
<span id="cb26-18"><a href="#cb26-18"></a></span>
<span id="cb26-19"><a href="#cb26-19"></a><span class="co">##Beetle vs Leaf</span></span>
<span id="cb26-20"><a href="#cb26-20"></a>m.beetle.vs.leaf_d65.aim2 &lt;-<span class="st"> </span><span class="kw">get.lmer</span>(input.list.regres_d65.aim2, <span class="dv">2</span>)</span>
<span id="cb26-21"><a href="#cb26-21"></a>sum.beetle.vs.leaf_d65.aim2 &lt;-<span class="st"> </span><span class="kw">get.posthocsum</span>(m.beetle.vs.leaf_d65.aim2)</span>
<span id="cb26-22"><a href="#cb26-22"></a></span>
<span id="cb26-23"><a href="#cb26-23"></a><span class="co">##Beetle vs Flower</span></span>
<span id="cb26-24"><a href="#cb26-24"></a>m.beetle.vs.flower_d65.aim2 &lt;-<span class="st"> </span><span class="kw">get.lmer</span>(input.list.regres_d65.aim2, <span class="dv">3</span>)</span>
<span id="cb26-25"><a href="#cb26-25"></a>sum.beetle.vs.flower_d65.aim2 &lt;-<span class="st"> </span><span class="kw">get.posthocsum</span>(m.beetle.vs.flower_d65.aim2)</span>
<span id="cb26-26"><a href="#cb26-26"></a></span>
<span id="cb26-27"><a href="#cb26-27"></a></span>
<span id="cb26-28"><a href="#cb26-28"></a><span class="co">#GLMM - Twilight - Aim 1</span></span>
<span id="cb26-29"><a href="#cb26-29"></a><span class="co">##Flower vs Leaf</span></span>
<span id="cb26-30"><a href="#cb26-30"></a>m.flower.vs.leaf_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">get.lmer</span>(input.list.regres_twilight.aim1, <span class="dv">1</span>)</span>
<span id="cb26-31"><a href="#cb26-31"></a>sum.flower.vs.leaf_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">get.posthocsum</span>(m.flower.vs.leaf_twilight.aim1)</span>
<span id="cb26-32"><a href="#cb26-32"></a></span>
<span id="cb26-33"><a href="#cb26-33"></a><span class="co">##Beetle vs Leaf</span></span>
<span id="cb26-34"><a href="#cb26-34"></a>m.beetle.vs.leaf_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">get.lmer</span>(input.list.regres_twilight.aim1, <span class="dv">2</span>)</span>
<span id="cb26-35"><a href="#cb26-35"></a>sum.beetle.vs.leaf_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">get.posthocsum</span>(m.beetle.vs.leaf_twilight.aim1)</span>
<span id="cb26-36"><a href="#cb26-36"></a></span>
<span id="cb26-37"><a href="#cb26-37"></a><span class="co">##Beetle vs Flower</span></span>
<span id="cb26-38"><a href="#cb26-38"></a>m.beetle.vs.flower_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">get.lmer</span>(input.list.regres_twilight.aim1, <span class="dv">3</span>)</span>
<span id="cb26-39"><a href="#cb26-39"></a>sum.beetle.vs.flower_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">get.posthocsum</span>(m.beetle.vs.flower_twilight.aim1)</span>
<span id="cb26-40"><a href="#cb26-40"></a></span>
<span id="cb26-41"><a href="#cb26-41"></a><span class="co">#GLMM - Twilight - Aim 2</span></span>
<span id="cb26-42"><a href="#cb26-42"></a><span class="co">##Flower vs Leaf</span></span>
<span id="cb26-43"><a href="#cb26-43"></a>m.flower.vs.leaf_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">get.lmer</span>(input.list.regres_twilight.aim2, <span class="dv">1</span>)</span>
<span id="cb26-44"><a href="#cb26-44"></a>sum.flower.vs.leaf_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">get.posthocsum</span>(m.flower.vs.leaf_twilight.aim2)</span>
<span id="cb26-45"><a href="#cb26-45"></a></span>
<span id="cb26-46"><a href="#cb26-46"></a><span class="co">##Beetle vs Leaf</span></span>
<span id="cb26-47"><a href="#cb26-47"></a>m.beetle.vs.leaf_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">get.lmer</span>(input.list.regres_twilight.aim2, <span class="dv">2</span>)</span>
<span id="cb26-48"><a href="#cb26-48"></a>sum.beetle.vs.leaf_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">get.posthocsum</span>(m.beetle.vs.leaf_twilight.aim2)</span>
<span id="cb26-49"><a href="#cb26-49"></a></span>
<span id="cb26-50"><a href="#cb26-50"></a><span class="co">##Beetle vs Flower</span></span>
<span id="cb26-51"><a href="#cb26-51"></a>m.beetle.vs.flower_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">get.lmer</span>(input.list.regres_twilight.aim2, <span class="dv">3</span>)</span>
<span id="cb26-52"><a href="#cb26-52"></a>sum.beetle.vs.flower_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">get.posthocsum</span>(m.beetle.vs.flower_twilight.aim2)</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># Set up lists</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>vislist.heatmap.aim1 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;USL&quot;</span>, <span class="st">&quot;USM&quot;</span>,<span class="st">&quot;USML&quot;</span>,<span class="st">&quot;USM&quot;</span>,<span class="st">&quot;USML&quot;</span>,<span class="st">&quot;USML&quot;</span>),</span>
<span id="cb27-3"><a href="#cb27-3"></a>                             <span class="kw">c</span>(<span class="st">&quot;UML&quot;</span>, <span class="st">&quot;UML&quot;</span>,<span class="st">&quot;UML&quot;</span>,<span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USM&quot;</span>))</span>
<span id="cb27-4"><a href="#cb27-4"></a>vislist.heatmap.aim2 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;VS 600&quot;</span>, <span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 660&quot;</span>),</span>
<span id="cb27-5"><a href="#cb27-5"></a>                             <span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>))</span>
<span id="cb27-6"><a href="#cb27-6"></a></span>
<span id="cb27-7"><a href="#cb27-7"></a><span class="co"># Set up the function</span></span>
<span id="cb27-8"><a href="#cb27-8"></a>get.heatmap.datframe &lt;-<span class="st"> </span><span class="cf">function</span>(i,z){</span>
<span id="cb27-9"><a href="#cb27-9"></a>  </span>
<span id="cb27-10"><a href="#cb27-10"></a>  heatmapdat.i &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(i[[<span class="dv">1</span>]],<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11"></a><span class="st">    </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(i[[<span class="dv">2</span>]],<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb27-12"><a href="#cb27-12"></a><span class="st">    </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(i[[<span class="dv">3</span>]],<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">flower.vs.leaf =</span> <span class="dv">1</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb27-14"><a href="#cb27-14"></a><span class="st">    </span><span class="kw">cbind</span>(z[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb27-15"><a href="#cb27-15"></a><span class="st">    </span><span class="kw">cbind</span>(z[[<span class="dv">2</span>]]) </span>
<span id="cb27-16"><a href="#cb27-16"></a>  </span>
<span id="cb27-17"><a href="#cb27-17"></a>  <span class="kw">colnames</span>(heatmapdat.i)[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;VislistA&quot;</span>, <span class="st">&quot;VislistB&quot;</span>)</span>
<span id="cb27-18"><a href="#cb27-18"></a>  </span>
<span id="cb27-19"><a href="#cb27-19"></a>  <span class="kw">return</span>(heatmapdat.i)</span>
<span id="cb27-20"><a href="#cb27-20"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># D65 - Aim 1</span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="co">## reshape data for heat map</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>pdata_d65.aim1 &lt;-<span class="st"> </span><span class="kw">list</span>(sum.flower.vs.leaf_d65.aim1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]],</span>
<span id="cb28-4"><a href="#cb28-4"></a>                       sum.beetle.vs.leaf_d65.aim1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]],</span>
<span id="cb28-5"><a href="#cb28-5"></a>                       sum.beetle.vs.flower_d65.aim1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]])</span>
<span id="cb28-6"><a href="#cb28-6"></a></span>
<span id="cb28-7"><a href="#cb28-7"></a>heat_d65.aim1 &lt;-<span class="st"> </span><span class="kw">get.heatmap.datframe</span>(pdata_d65.aim1, vislist.heatmap.aim1)</span>
<span id="cb28-8"><a href="#cb28-8"></a></span>
<span id="cb28-9"><a href="#cb28-9"></a></span>
<span id="cb28-10"><a href="#cb28-10"></a><span class="co"># D65 - Aim 2</span></span>
<span id="cb28-11"><a href="#cb28-11"></a><span class="co">## reshape data for heat map</span></span>
<span id="cb28-12"><a href="#cb28-12"></a>pdata_d65.aim2 &lt;-<span class="st"> </span><span class="kw">list</span>(sum.flower.vs.leaf_d65.aim2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]],</span>
<span id="cb28-13"><a href="#cb28-13"></a>                       sum.beetle.vs.leaf_d65.aim2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]],</span>
<span id="cb28-14"><a href="#cb28-14"></a>                       sum.beetle.vs.flower_d65.aim2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]])</span>
<span id="cb28-15"><a href="#cb28-15"></a></span>
<span id="cb28-16"><a href="#cb28-16"></a>heat_d65.aim2 &lt;-<span class="st"> </span><span class="kw">get.heatmap.datframe</span>(pdata_d65.aim2, vislist.heatmap.aim2)</span>
<span id="cb28-17"><a href="#cb28-17"></a></span>
<span id="cb28-18"><a href="#cb28-18"></a><span class="co">#Twilight - Aim 1</span></span>
<span id="cb28-19"><a href="#cb28-19"></a><span class="co">## reshape data for heatmap</span></span>
<span id="cb28-20"><a href="#cb28-20"></a>pdata_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">list</span>(sum.flower.vs.leaf_twilight.aim1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]],</span>
<span id="cb28-21"><a href="#cb28-21"></a>                            sum.beetle.vs.leaf_twilight.aim1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]],</span>
<span id="cb28-22"><a href="#cb28-22"></a>                            sum.beetle.vs.flower_twilight.aim1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]])</span>
<span id="cb28-23"><a href="#cb28-23"></a></span>
<span id="cb28-24"><a href="#cb28-24"></a>heat_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">get.heatmap.datframe</span>(pdata_twilight.aim1, vislist.heatmap.aim1)</span>
<span id="cb28-25"><a href="#cb28-25"></a></span>
<span id="cb28-26"><a href="#cb28-26"></a></span>
<span id="cb28-27"><a href="#cb28-27"></a><span class="co"># Twilight - Aim 2</span></span>
<span id="cb28-28"><a href="#cb28-28"></a><span class="co">##reshape data for heat map</span></span>
<span id="cb28-29"><a href="#cb28-29"></a>pdata_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">list</span>(sum.flower.vs.leaf_twilight.aim2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]],</span>
<span id="cb28-30"><a href="#cb28-30"></a>                       sum.beetle.vs.leaf_twilight.aim2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]],</span>
<span id="cb28-31"><a href="#cb28-31"></a>                       sum.beetle.vs.flower_twilight.aim2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]])</span>
<span id="cb28-32"><a href="#cb28-32"></a></span>
<span id="cb28-33"><a href="#cb28-33"></a>heat_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">get.heatmap.datframe</span>(pdata_twilight.aim2, vislist.heatmap.aim2)</span>
<span id="cb28-34"><a href="#cb28-34"></a></span>
<span id="cb28-35"><a href="#cb28-35"></a></span>
<span id="cb28-36"><a href="#cb28-36"></a><span class="co"># Assign asterisk signs</span></span>
<span id="cb28-37"><a href="#cb28-37"></a>pdatalist &lt;-<span class="st"> </span><span class="kw">list</span>(heat_d65.aim1, heat_d65.aim2, heat_twilight.aim1, heat_twilight.aim2)</span>
<span id="cb28-38"><a href="#cb28-38"></a></span>
<span id="cb28-39"><a href="#cb28-39"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(pdatalist)) {</span>
<span id="cb28-40"><a href="#cb28-40"></a>  </span>
<span id="cb28-41"><a href="#cb28-41"></a>  pdatalist[[i]]<span class="op">$</span>sig.flower.vs.leaf[pdatalist[[i]]<span class="op">$</span>flower.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb28-42"><a href="#cb28-42"></a>  pdatalist[[i]]<span class="op">$</span>sig.flower.vs.leaf[pdatalist[[i]]<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb28-43"><a href="#cb28-43"></a>  pdatalist[[i]]<span class="op">$</span>sig.flower.vs.leaf[pdatalist[[i]]<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb28-44"><a href="#cb28-44"></a>  pdatalist[[i]]<span class="op">$</span>sig.flower.vs.leaf[pdatalist[[i]]<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb28-45"><a href="#cb28-45"></a>  pdatalist[[i]]<span class="op">$</span>sig.beetle.vs.leaf[pdatalist[[i]]<span class="op">$</span>beetle.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb28-46"><a href="#cb28-46"></a>  pdatalist[[i]]<span class="op">$</span>sig.beetle.vs.leaf[pdatalist[[i]]<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb28-47"><a href="#cb28-47"></a>  pdatalist[[i]]<span class="op">$</span>sig.beetle.vs.leaf[pdatalist[[i]]<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb28-48"><a href="#cb28-48"></a>  pdatalist[[i]]<span class="op">$</span>sig.beetle.vs.leaf[pdatalist[[i]]<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb28-49"><a href="#cb28-49"></a>  pdatalist[[i]]<span class="op">$</span>sig.beetle.vs.flower[pdatalist[[i]]<span class="op">$</span>beetle.vs.flower <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb28-50"><a href="#cb28-50"></a>  pdatalist[[i]]<span class="op">$</span>sig.beetle.vs.flower[pdatalist[[i]]<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb28-51"><a href="#cb28-51"></a>  pdatalist[[i]]<span class="op">$</span>sig.beetle.vs.flower[pdatalist[[i]]<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb28-52"><a href="#cb28-52"></a>  pdatalist[[i]]<span class="op">$</span>sig.beetle.vs.flower[pdatalist[[i]]<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb28-53"><a href="#cb28-53"></a>  </span>
<span id="cb28-54"><a href="#cb28-54"></a>}</span>
<span id="cb28-55"><a href="#cb28-55"></a></span>
<span id="cb28-56"><a href="#cb28-56"></a><span class="co"># Because we did the assignment on a data list, now we need to link the loop output back to the data respectively</span></span>
<span id="cb28-57"><a href="#cb28-57"></a>heat_d65.aim1 &lt;-<span class="st"> </span>pdatalist[[<span class="dv">1</span>]] </span>
<span id="cb28-58"><a href="#cb28-58"></a>heat_d65.aim2 &lt;-<span class="st"> </span>pdatalist[[<span class="dv">2</span>]]</span>
<span id="cb28-59"><a href="#cb28-59"></a>heat_twilight.aim1 &lt;-<span class="st"> </span>pdatalist[[<span class="dv">3</span>]]</span>
<span id="cb28-60"><a href="#cb28-60"></a>heat_twilight.aim2 &lt;-<span class="st"> </span>pdatalist[[<span class="dv">4</span>]]</span></code></pre></div>
<div id="results-of-aim-1-comparing-visual-systems-with-different-photoreceptor-combinations" class="section level3 tabset tabset-fade tabset-pills">
<h3>Results of Aim 1: comparing visual systems with different photoreceptor combinations</h3>
<p></br></p>
<p>Click the tabs to see the results for each comparison group ( <strong>Flower vs. Leaf</strong> / <strong>Beetle vs. Leaf</strong> / <strong>Beetle vs. Flower</strong>) and under different light conditions ( <strong>Daylight</strong> / <strong>Twilight</strong>)</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># a = data</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="co"># b = 1/2/3; 1 for flower.vs.leaf, 2 for beetle.vs.leaf, 3 for beetle.vs.flower</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>get.pheatmap &lt;-<span class="st"> </span><span class="cf">function</span>(a, b){<span class="kw">ggplot</span>(<span class="dt">data =</span> a, </span>
<span id="cb29-4"><a href="#cb29-4"></a>                                        <span class="kw">aes</span>(<span class="dt">x =</span> VislistA, </span>
<span id="cb29-5"><a href="#cb29-5"></a>                                            <span class="dt">y =</span> VislistB, </span>
<span id="cb29-6"><a href="#cb29-6"></a>                                            <span class="dt">fill =</span> a[,b])) <span class="op">+</span><span class="st"> </span></span>
<span id="cb29-7"><a href="#cb29-7"></a><span class="st">    </span><span class="kw">geom_tile</span>(<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb29-8"><a href="#cb29-8"></a><span class="st">    </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA, </span>
<span id="cb29-9"><a href="#cb29-9"></a>                  VislistB, </span>
<span id="cb29-10"><a href="#cb29-10"></a>                  <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(a[,b], <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), </span>
<span id="cb29-11"><a href="#cb29-11"></a>                                a[, b<span class="op">+</span><span class="dv">5</span>])))<span class="op">+</span></span>
<span id="cb29-12"><a href="#cb29-12"></a><span class="st">    </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span></span>
<span id="cb29-13"><a href="#cb29-13"></a><span class="st">    </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb29-14"><a href="#cb29-14"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb29-15"><a href="#cb29-15"></a>          <span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb29-16"><a href="#cb29-16"></a>          <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb29-17"><a href="#cb29-17"></a>          <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb29-18"><a href="#cb29-18"></a>          <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb29-19"><a href="#cb29-19"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span>
<span id="cb29-20"><a href="#cb29-20"></a>  </span>
<span id="cb29-21"><a href="#cb29-21"></a>}</span></code></pre></div>
<p></br></p>
<div id="flower-v.s-leaf" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Flower v.s Leaf</strong></h4>
<div id="daylight-2" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">Anova</span>(m.flower.vs.leaf_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:54%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="18%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>vissys</strong></td>
<td align="center">46.46</td>
<td align="center">3</td>
<td align="center">4.524e-10</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">get.pheatmap</span>(heat_d65.aim1, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="original-model-output" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>sum.flower.vs.leaf_d65.aim1</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ vissys + (1 | patch2) + (1 | patch1), data = datlist[[compnnumber]], 
##     REML = F)
## 
## Linear Hypotheses:
##                                Estimate Std. Error z value Pr(&gt;|z|)    
## UVSW..LW.fl - UV..MWLW.fl == 0  0.32859    0.05741   5.724 6.26e-08 ***
## UVSWMW...fl - UV..MWLW.fl == 0  0.34351    0.05741   5.984 1.31e-08 ***
## UVSWMWLW.fl - UV..MWLW.fl == 0  0.26348    0.05741   4.590 2.67e-05 ***
## UVSWMW...fl - UVSW..LW.fl == 0  0.01492    0.05741   0.260     1.00    
## UVSWMWLW.fl - UVSW..LW.fl == 0 -0.06510    0.05741  -1.134     1.00    
## UVSWMWLW.fl - UVSWMW...fl == 0 -0.08003    0.05741  -1.394     0.98    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-6" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">Anova</span>(m.flower.vs.leaf_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:54%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="18%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>vissys</strong></td>
<td align="center">406.9</td>
<td align="center">3</td>
<td align="center">7.152e-88</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-1" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">get.pheatmap</span>(heat_twilight.aim1, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="original-model-output-1" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>sum.flower.vs.leaf_twilight.aim1</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ vissys + (1 | patch2) + (1 | patch1), data = datlist[[compnnumber]], 
##     REML = F)
## 
## Linear Hypotheses:
##                                 Estimate Std. Error z value Pr(&gt;|z|)    
## UVSW..LW.fl - UV..MWLW.fl == 0  0.031050   0.007655   4.056 0.000299 ***
## UVSWMW...fl - UV..MWLW.fl == 0 -0.010686   0.007655  -1.396 0.976174    
## UVSWMWLW.fl - UV..MWLW.fl == 0  0.127786   0.007655  16.694  &lt; 2e-16 ***
## UVSWMW...fl - UVSW..LW.fl == 0 -0.041736   0.007655  -5.452 2.98e-07 ***
## UVSWMWLW.fl - UVSW..LW.fl == 0  0.096736   0.007655  12.637  &lt; 2e-16 ***
## UVSWMWLW.fl - UVSWMW...fl == 0  0.138472   0.007655  18.090  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
</div>
<div id="beetle-vs.-leaf" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Beetle vs. Leaf</strong></h4>
<div id="daylight-3" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">Anova</span>(m.beetle.vs.leaf_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:54%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="18%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>vissys</strong></td>
<td align="center">147.4</td>
<td align="center">3</td>
<td align="center">9.691e-32</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-2" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">get.pheatmap</span>(heat_d65.aim1, <span class="dv">2</span>)</span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<div id="original-model-output-2" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>sum.beetle.vs.leaf_d65.aim1</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ vissys + (1 | patch2) + (1 | patch1), data = datlist[[compnnumber]], 
##     REML = F)
## 
## Linear Hypotheses:
##                                Estimate Std. Error z value Pr(&gt;|z|)    
## UVSW..LW.bl - UV..MWLW.bl == 0 -0.01336    0.04950  -0.270        1    
## UVSWMW...bl - UV..MWLW.bl == 0 -0.48983    0.04950  -9.896   &lt;2e-16 ***
## UVSWMWLW.bl - UV..MWLW.bl == 0  0.01423    0.04950   0.287        1    
## UVSWMW...bl - UVSW..LW.bl == 0 -0.47646    0.04950  -9.626   &lt;2e-16 ***
## UVSWMWLW.bl - UVSW..LW.bl == 0  0.02759    0.04950   0.557        1    
## UVSWMWLW.bl - UVSWMW...bl == 0  0.50405    0.04950  10.183   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-7" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="kw">Anova</span>(m.beetle.vs.leaf_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:54%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="18%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>vissys</strong></td>
<td align="center">1025</td>
<td align="center">3</td>
<td align="center">6.872e-222</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-3" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw">get.pheatmap</span>(heat_twilight.aim1, <span class="dv">2</span>)</span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
<div id="original-model-output-3" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>sum.beetle.vs.leaf_twilight.aim1</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ vissys + (1 | patch2) + (1 | patch1), data = datlist[[compnnumber]], 
##     REML = F)
## 
## Linear Hypotheses:
##                                 Estimate Std. Error z value Pr(&gt;|z|)    
## UVSW..LW.bl - UV..MWLW.bl == 0 -0.011746   0.005169  -2.272    0.138    
## UVSWMW...bl - UV..MWLW.bl == 0 -0.101920   0.005169 -19.716   &lt;2e-16 ***
## UVSWMWLW.bl - UV..MWLW.bl == 0  0.061953   0.005169  11.984   &lt;2e-16 ***
## UVSWMW...bl - UVSW..LW.bl == 0 -0.090174   0.005169 -17.444   &lt;2e-16 ***
## UVSWMWLW.bl - UVSW..LW.bl == 0  0.073699   0.005169  14.257   &lt;2e-16 ***
## UVSWMWLW.bl - UVSWMW...bl == 0  0.163873   0.005169  31.700   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
</div>
<div id="beetle-vs.-flower" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Beetle vs. Flower</strong></h4>
<div id="daylight-4" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">Anova</span>(m.beetle.vs.flower_d65.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:54%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="18%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>vissys</strong></td>
<td align="center">111.8</td>
<td align="center">3</td>
<td align="center">4.609e-24</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-4" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">get.pheatmap</span>(heat_d65.aim1, <span class="dv">3</span>)</span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
</div>
<div id="original-model-output-4" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>sum.beetle.vs.flower_d65.aim1</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ vissys + (1 | patch2) + (1 | patch1), data = datlist[[compnnumber]], 
##     REML = F)
## 
## Linear Hypotheses:
##                                  Estimate Std. Error z value Pr(&gt;|z|)    
## UVSW..LW.bf - UV..MWLW.bf == 0  0.6310334  0.0705664   8.942  &lt; 2e-16 ***
## UVSWMW...bf - UV..MWLW.bf == 0  0.6315562  0.0705664   8.950  &lt; 2e-16 ***
## UVSWMWLW.bf - UV..MWLW.bf == 0  0.5502121  0.0705664   7.797 3.86e-14 ***
## UVSWMW...bf - UVSW..LW.bf == 0  0.0005227  0.0705664   0.007        1    
## UVSWMWLW.bf - UVSW..LW.bf == 0 -0.0808214  0.0705664  -1.145        1    
## UVSWMWLW.bf - UVSWMW...bf == 0 -0.0813441  0.0705664  -1.153        1    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-8" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">Anova</span>(m.beetle.vs.flower_twilight.aim1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:54%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="18%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>vissys</strong></td>
<td align="center">445.2</td>
<td align="center">3</td>
<td align="center">3.629e-96</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-5" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="kw">get.pheatmap</span>(heat_twilight.aim1, <span class="dv">3</span>)</span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
</div>
<div id="original-model-output-5" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>sum.beetle.vs.flower_twilight.aim1</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ vissys + (1 | patch2) + (1 | patch1), data = datlist[[compnnumber]], 
##     REML = F)
## 
## Linear Hypotheses:
##                                Estimate Std. Error z value Pr(&gt;|z|)    
## UVSW..LW.bf - UV..MWLW.bf == 0  0.07396    0.00932   7.935 1.20e-14 ***
## UVSWMW...bf - UV..MWLW.bf == 0  0.02544    0.00932   2.730   0.0381 *  
## UVSWMWLW.bf - UV..MWLW.bf == 0  0.18151    0.00932  19.475  &lt; 2e-16 ***
## UVSWMW...bf - UVSW..LW.bf == 0 -0.04852    0.00932  -5.206 1.16e-06 ***
## UVSWMWLW.bf - UVSW..LW.bf == 0  0.10755    0.00932  11.540  &lt; 2e-16 ***
## UVSWMWLW.bf - UVSWMW...bf == 0  0.15607    0.00932  16.745  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
</div>
</div>
<div id="results-of-aim-2-comparing-visual-systems-with-different-lws-peak-sensitivities" class="section level3 tabset tabset-fade tabset-pills">
<h3>Results of Aim 2: comparing visual systems with different LWS peak sensitivities</h3>
<p></br></p>
<p>Click the tabs to see the results for each comparison group ( <strong>Flower vs. Leaf</strong> / <strong>Beetle vs. Leaf</strong> / <strong>Beetle vs. Flower</strong>) and under different light conditions ( <strong>Daylight</strong> / <strong>Twilight</strong>)</p>
<p></br></p>
<div id="flower-v.s-leaf-1" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Flower v.s Leaf</strong></h4>
<div id="daylight-5" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="kw">Anova</span>(m.flower.vs.leaf_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:54%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="18%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>vissys</strong></td>
<td align="center">181.1</td>
<td align="center">4</td>
<td align="center">4.271e-38</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-6" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="kw">get.pheatmap</span>(heat_d65.aim2, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
</div>
<div id="original-model-output-6" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>sum.flower.vs.leaf_d65.aim2</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ vissys + (1 | patch2) + (1 | patch1), data = datlist[[compnnumber]], 
##     REML = F)
## 
## Linear Hypotheses:
##                          Estimate Std. Error z value Pr(&gt;|z|)    
## VS600.fl - VS580.fl == 0  0.21665    0.04609   4.700 2.60e-05 ***
## VS620.fl - VS580.fl == 0  0.46460    0.04609  10.080  &lt; 2e-16 ***
## VS640.fl - VS580.fl == 0  0.54896    0.04609  11.910  &lt; 2e-16 ***
## VS660.fl - VS580.fl == 0  0.39846    0.04609   8.645  &lt; 2e-16 ***
## VS620.fl - VS600.fl == 0  0.24794    0.04609   5.379 7.48e-07 ***
## VS640.fl - VS600.fl == 0  0.33231    0.04609   7.210 5.61e-12 ***
## VS660.fl - VS600.fl == 0  0.18181    0.04609   3.944   0.0008 ***
## VS640.fl - VS620.fl == 0  0.08437    0.04609   1.830   0.6720    
## VS660.fl - VS620.fl == 0 -0.06614    0.04609  -1.435   1.0000    
## VS660.fl - VS640.fl == 0 -0.15050    0.04609  -3.265   0.0109 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-9" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">Anova</span>(m.flower.vs.leaf_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:54%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="18%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>vissys</strong></td>
<td align="center">232.3</td>
<td align="center">4</td>
<td align="center">4.18e-49</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-7" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="kw">get.pheatmap</span>(heat_twilight.aim2, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
<div id="original-model-output-7" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>sum.flower.vs.leaf_twilight.aim2</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ vissys + (1 | patch2) + (1 | patch1), data = datlist[[compnnumber]], 
##     REML = F)
## 
## Linear Hypotheses:
##                           Estimate Std. Error z value Pr(&gt;|z|)    
## VS600.fl - VS580.fl == 0  0.049807   0.006952   7.165 7.80e-12 ***
## VS620.fl - VS580.fl == 0  0.093697   0.006952  13.478  &lt; 2e-16 ***
## VS640.fl - VS580.fl == 0  0.087715   0.006952  12.618  &lt; 2e-16 ***
## VS660.fl - VS580.fl == 0  0.052183   0.006952   7.507 6.06e-13 ***
## VS620.fl - VS600.fl == 0  0.043891   0.006952   6.314 2.73e-09 ***
## VS640.fl - VS600.fl == 0  0.037908   0.006952   5.453 4.95e-07 ***
## VS660.fl - VS600.fl == 0  0.002376   0.006952   0.342        1    
## VS640.fl - VS620.fl == 0 -0.005982   0.006952  -0.861        1    
## VS660.fl - VS620.fl == 0 -0.041514   0.006952  -5.972 2.35e-08 ***
## VS660.fl - VS640.fl == 0 -0.035532   0.006952  -5.111 3.20e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
</div>
<div id="beetle-vs.-leaf-1" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Beetle vs. Leaf</strong></h4>
<div id="daylight-6" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="kw">Anova</span>(m.beetle.vs.leaf_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:54%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="18%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>vissys</strong></td>
<td align="center">634.8</td>
<td align="center">4</td>
<td align="center">4.527e-136</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-8" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="kw">get.pheatmap</span>(heat_d65.aim2, <span class="dv">2</span>)</span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
</div>
<div id="original-model-output-8" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>sum.beetle.vs.leaf_d65.aim2</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ vissys + (1 | patch2) + (1 | patch1), data = datlist[[compnnumber]], 
##     REML = F)
## 
## Linear Hypotheses:
##                          Estimate Std. Error z value Pr(&gt;|z|)    
## VS600.bl - VS580.bl == 0  0.28548    0.04277   6.676 2.46e-10 ***
## VS620.bl - VS580.bl == 0  0.57696    0.04277  13.491  &lt; 2e-16 ***
## VS640.bl - VS580.bl == 0  0.79306    0.04277  18.545  &lt; 2e-16 ***
## VS660.bl - VS580.bl == 0  0.94105    0.04277  22.005  &lt; 2e-16 ***
## VS620.bl - VS600.bl == 0  0.29148    0.04277   6.816 9.37e-11 ***
## VS640.bl - VS600.bl == 0  0.50758    0.04277  11.869  &lt; 2e-16 ***
## VS660.bl - VS600.bl == 0  0.65557    0.04277  15.329  &lt; 2e-16 ***
## VS640.bl - VS620.bl == 0  0.21610    0.04277   5.053 4.35e-06 ***
## VS660.bl - VS620.bl == 0  0.36409    0.04277   8.514  &lt; 2e-16 ***
## VS660.bl - VS640.bl == 0  0.14799    0.04277   3.460  0.00539 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-10" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="kw">Anova</span>(m.beetle.vs.leaf_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:54%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="18%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>vissys</strong></td>
<td align="center">1037</td>
<td align="center">4</td>
<td align="center">3.815e-223</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-9" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="kw">get.pheatmap</span>(heat_twilight.aim2, <span class="dv">2</span>)</span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
</div>
<div id="original-model-output-9" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>sum.beetle.vs.leaf_twilight.aim2</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ vissys + (1 | patch2) + (1 | patch1), data = datlist[[compnnumber]], 
##     REML = F)
## 
## Linear Hypotheses:
##                          Estimate Std. Error z value Pr(&gt;|z|)    
## VS600.bl - VS580.bl == 0 0.055165   0.005152  10.707  &lt; 2e-16 ***
## VS620.bl - VS580.bl == 0 0.105546   0.005152  20.485  &lt; 2e-16 ***
## VS640.bl - VS580.bl == 0 0.131285   0.005152  25.481  &lt; 2e-16 ***
## VS660.bl - VS580.bl == 0 0.140620   0.005152  27.292  &lt; 2e-16 ***
## VS620.bl - VS600.bl == 0 0.050382   0.005152   9.778  &lt; 2e-16 ***
## VS640.bl - VS600.bl == 0 0.076121   0.005152  14.774  &lt; 2e-16 ***
## VS660.bl - VS600.bl == 0 0.085456   0.005152  16.586  &lt; 2e-16 ***
## VS640.bl - VS620.bl == 0 0.025739   0.005152   4.996 5.87e-06 ***
## VS660.bl - VS620.bl == 0 0.035074   0.005152   6.807 9.94e-11 ***
## VS660.bl - VS640.bl == 0 0.009335   0.005152   1.812      0.7    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
</div>
<div id="beetle-vs.-flower-1" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Beetle vs. Flower</strong></h4>
<div id="daylight-7" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="kw">Anova</span>(m.beetle.vs.flower_d65.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:54%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="18%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>vissys</strong></td>
<td align="center">230.2</td>
<td align="center">4</td>
<td align="center">1.175e-48</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-10" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="kw">get.pheatmap</span>(heat_d65.aim2, <span class="dv">3</span>)</span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
</div>
<div id="original-model-output-10" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>sum.beetle.vs.flower_d65.aim2</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ vissys + (1 | patch2) + (1 | patch1), data = datlist[[compnnumber]], 
##     REML = F)
## 
## Linear Hypotheses:
##                          Estimate Std. Error z value Pr(&gt;|z|)    
## VS600.bf - VS580.bf == 0  0.16118    0.06141   2.625  0.08675 .  
## VS620.bf - VS580.bf == 0  0.37487    0.06141   6.104 1.03e-08 ***
## VS640.bf - VS580.bf == 0  0.60558    0.06141   9.861  &lt; 2e-16 ***
## VS660.bf - VS580.bf == 0  0.81779    0.06141  13.317  &lt; 2e-16 ***
## VS620.bf - VS600.bf == 0  0.21369    0.06141   3.480  0.00502 ** 
## VS640.bf - VS600.bf == 0  0.44440    0.06141   7.236 4.61e-12 ***
## VS660.bf - VS600.bf == 0  0.65661    0.06141  10.692  &lt; 2e-16 ***
## VS640.bf - VS620.bf == 0  0.23071    0.06141   3.757  0.00172 ** 
## VS660.bf - VS620.bf == 0  0.44292    0.06141   7.212 5.50e-12 ***
## VS660.bf - VS640.bf == 0  0.21221    0.06141   3.456  0.00549 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-11" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="kw">Anova</span>(m.beetle.vs.flower_twilight.aim2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:54%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="18%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>vissys</strong></td>
<td align="center">478.9</td>
<td align="center">4</td>
<td align="center">2.465e-102</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see posthoc results ( <strong>p-value summary plot</strong> / <strong>original model output</strong> )</p>
<div id="pair-wise-p-values-11" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="kw">get.pheatmap</span>(heat_twilight.aim2, <span class="dv">3</span>)</span></code></pre></div>
<p><img src="opsin_shifed_models_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
</div>
<div id="original-model-output-11" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>sum.beetle.vs.flower_twilight.aim2</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ vissys + (1 | patch2) + (1 | patch1), data = datlist[[compnnumber]], 
##     REML = F)
## 
## Linear Hypotheses:
##                          Estimate Std. Error z value Pr(&gt;|z|)    
## VS600.bf - VS580.bf == 0 0.047253   0.009514   4.967 6.80e-06 ***
## VS620.bf - VS580.bf == 0 0.105583   0.009514  11.098  &lt; 2e-16 ***
## VS640.bf - VS580.bf == 0 0.153271   0.009514  16.111  &lt; 2e-16 ***
## VS660.bf - VS580.bf == 0 0.177919   0.009514  18.702  &lt; 2e-16 ***
## VS620.bf - VS600.bf == 0 0.058330   0.009514   6.131 8.72e-09 ***
## VS640.bf - VS600.bf == 0 0.106018   0.009514  11.144  &lt; 2e-16 ***
## VS660.bf - VS600.bf == 0 0.130666   0.009514  13.735  &lt; 2e-16 ***
## VS640.bf - VS620.bf == 0 0.047688   0.009514   5.013 5.37e-06 ***
## VS660.bf - VS620.bf == 0 0.072336   0.009514   7.603 2.89e-13 ***
## VS660.bf - VS640.bf == 0 0.024648   0.009514   2.591   0.0958 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="plot-the-contrasts" class="section level1 tabset tabset-fade tabset-pills">
<h1>Plot the contrasts</h1>
<ul>
<li>Colours approximate human perception of either flower (left and right) or beetle (centre) colouration.</li>
<li>Lines of the same colors connect the same sample</li>
</ul>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="co">#import the sample color code </span></span>
<span id="cb78-2"><a href="#cb78-2"></a>color.code &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/color code list.csv&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>) </span>
<span id="cb78-3"><a href="#cb78-3"></a></span>
<span id="cb78-4"><a href="#cb78-4"></a><span class="co"># Set up a function to calculate means for the plot</span></span>
<span id="cb78-5"><a href="#cb78-5"></a>get.plotmeans &lt;-<span class="st"> </span><span class="cf">function</span>(a, b, c){</span>
<span id="cb78-6"><a href="#cb78-6"></a>  <span class="cf">if</span> (a <span class="op">==</span><span class="st"> &quot;aim1&quot;</span>){</span>
<span id="cb78-7"><a href="#cb78-7"></a>    <span class="cf">if</span>(b <span class="op">==</span><span class="st"> &quot;bl&quot;</span>){</span>
<span id="cb78-8"><a href="#cb78-8"></a>      plotmean.i &lt;-<span class="st"> </span>c <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-9"><a href="#cb78-9"></a><span class="st">        </span><span class="kw">group_by</span>(patch2, vissys) <span class="op">%&gt;%</span></span>
<span id="cb78-10"><a href="#cb78-10"></a><span class="st">        </span><span class="kw">summarize</span>(<span class="dt">mean.dS.sub =</span> <span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-11"><a href="#cb78-11"></a><span class="st">        </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-12"><a href="#cb78-12"></a><span class="st">        </span><span class="kw">rename</span>(<span class="dt">beetleID =</span> patch2) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-13"><a href="#cb78-13"></a><span class="st">        </span><span class="kw">merge</span>(beetle.colour.aim1[,<span class="kw">c</span>(<span class="st">&quot;species&quot;</span>, <span class="st">&quot;colour&quot;</span>)], <span class="dt">by.x =</span> <span class="kw">c</span>(<span class="st">&quot;beetleID&quot;</span>), <span class="dt">by.y =</span> <span class="kw">c</span>(<span class="st">&quot;species&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-14"><a href="#cb78-14"></a><span class="st">        </span><span class="kw">distinct</span>()</span>
<span id="cb78-15"><a href="#cb78-15"></a>      <span class="kw">return</span>(plotmean.i)</span>
<span id="cb78-16"><a href="#cb78-16"></a>    } <span class="cf">else</span> {</span>
<span id="cb78-17"><a href="#cb78-17"></a>      plotmean.i &lt;-<span class="st"> </span>c <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-18"><a href="#cb78-18"></a><span class="st">        </span><span class="kw">group_by</span>(patch1, vissys) <span class="op">%&gt;%</span></span>
<span id="cb78-19"><a href="#cb78-19"></a><span class="st">        </span><span class="kw">summarize</span>(<span class="dt">mean.dS.sub =</span> <span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-20"><a href="#cb78-20"></a><span class="st">        </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-21"><a href="#cb78-21"></a><span class="st">        </span><span class="kw">rename</span>(<span class="dt">flowerID =</span> patch1) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-22"><a href="#cb78-22"></a><span class="st">        </span><span class="kw">merge</span>(flower.colour.aim1[,<span class="kw">c</span>(<span class="st">&quot;species&quot;</span>, <span class="st">&quot;colour&quot;</span>)], <span class="dt">by.x =</span> <span class="kw">c</span>(<span class="st">&quot;flowerID&quot;</span>), <span class="dt">by.y =</span> <span class="kw">c</span>(<span class="st">&quot;species&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-23"><a href="#cb78-23"></a><span class="st">        </span><span class="kw">distinct</span>()</span>
<span id="cb78-24"><a href="#cb78-24"></a>      <span class="kw">return</span>(plotmean.i)</span>
<span id="cb78-25"><a href="#cb78-25"></a>    }</span>
<span id="cb78-26"><a href="#cb78-26"></a>  } <span class="cf">else</span> <span class="cf">if</span> (a <span class="op">==</span><span class="st"> &quot;aim2&quot;</span>){</span>
<span id="cb78-27"><a href="#cb78-27"></a>    <span class="cf">if</span> (b <span class="op">==</span><span class="st"> &quot;bl&quot;</span>){</span>
<span id="cb78-28"><a href="#cb78-28"></a>      plotmean.i &lt;-<span class="st"> </span>c <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-29"><a href="#cb78-29"></a><span class="st">        </span><span class="kw">group_by</span>(patch2, vissys) <span class="op">%&gt;%</span></span>
<span id="cb78-30"><a href="#cb78-30"></a><span class="st">        </span><span class="kw">summarize</span>(<span class="dt">mean.dS.sub =</span> <span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-31"><a href="#cb78-31"></a><span class="st">        </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-32"><a href="#cb78-32"></a><span class="st">        </span><span class="kw">rename</span>(<span class="dt">beetleID =</span> patch2) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-33"><a href="#cb78-33"></a><span class="st">        </span><span class="kw">merge</span>(beetle.colour.aim2[,<span class="kw">c</span>(<span class="st">&quot;species&quot;</span>, <span class="st">&quot;colour&quot;</span>)], <span class="dt">by.x =</span> <span class="kw">c</span>(<span class="st">&quot;beetleID&quot;</span>), <span class="dt">by.y =</span> <span class="kw">c</span>(<span class="st">&quot;species&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-34"><a href="#cb78-34"></a><span class="st">        </span><span class="kw">distinct</span>()</span>
<span id="cb78-35"><a href="#cb78-35"></a>      <span class="kw">return</span>(plotmean.i)</span>
<span id="cb78-36"><a href="#cb78-36"></a>    } <span class="cf">else</span> {</span>
<span id="cb78-37"><a href="#cb78-37"></a>      plotmean.i &lt;-<span class="st"> </span>c <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-38"><a href="#cb78-38"></a><span class="st">        </span><span class="kw">group_by</span>(patch1, vissys) <span class="op">%&gt;%</span></span>
<span id="cb78-39"><a href="#cb78-39"></a><span class="st">        </span><span class="kw">summarize</span>(<span class="dt">mean.dS.sub =</span> <span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-40"><a href="#cb78-40"></a><span class="st">        </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-41"><a href="#cb78-41"></a><span class="st">        </span><span class="kw">rename</span>(<span class="dt">flowerID =</span> patch1) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-42"><a href="#cb78-42"></a><span class="st">        </span><span class="kw">merge</span>(flower.colour.aim2[,<span class="kw">c</span>(<span class="st">&quot;species&quot;</span>, <span class="st">&quot;colour&quot;</span>)], <span class="dt">by.x =</span> <span class="kw">c</span>(<span class="st">&quot;flowerID&quot;</span>), <span class="dt">by.y =</span> <span class="kw">c</span>(<span class="st">&quot;species&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-43"><a href="#cb78-43"></a><span class="st">        </span><span class="kw">distinct</span>()</span>
<span id="cb78-44"><a href="#cb78-44"></a>      <span class="kw">return</span>(plotmean.i)</span>
<span id="cb78-45"><a href="#cb78-45"></a>    }</span>
<span id="cb78-46"><a href="#cb78-46"></a>  }</span>
<span id="cb78-47"><a href="#cb78-47"></a>}</span>
<span id="cb78-48"><a href="#cb78-48"></a></span>
<span id="cb78-49"><a href="#cb78-49"></a><span class="co"># What should be put in the function get.plotmeans()</span></span>
<span id="cb78-50"><a href="#cb78-50"></a><span class="co"># a = &quot;aim1&quot; or &quot;aim2&quot;</span></span>
<span id="cb78-51"><a href="#cb78-51"></a><span class="co"># b = comparison type: &quot;fl&quot;, &quot;bl&quot;, &quot;bf&quot;</span></span>
<span id="cb78-52"><a href="#cb78-52"></a><span class="co"># c = input data, e.g. allvis.fl_d65.aim1</span></span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="co"># transform the data for plotting purpose</span></span>
<span id="cb79-2"><a href="#cb79-2"></a>dataset.transpose &lt;-<span class="st"> </span><span class="kw">gather</span>(dataset[,<span class="dv">2</span><span class="op">:</span><span class="dv">131</span>], </span>
<span id="cb79-3"><a href="#cb79-3"></a>                            <span class="dt">key =</span> <span class="st">&quot;species&quot;</span>, </span>
<span id="cb79-4"><a href="#cb79-4"></a>                            <span class="dt">value =</span> <span class="st">&quot;reflectance&quot;</span>, </span>
<span id="cb79-5"><a href="#cb79-5"></a>                            <span class="dt">na.rm =</span> <span class="ot">FALSE</span>,</span>
<span id="cb79-6"><a href="#cb79-6"></a>                          <span class="dt">convert =</span> <span class="ot">FALSE</span>, </span>
<span id="cb79-7"><a href="#cb79-7"></a>                          <span class="dt">factor_key =</span> <span class="ot">FALSE</span>)</span>
<span id="cb79-8"><a href="#cb79-8"></a></span>
<span id="cb79-9"><a href="#cb79-9"></a><span class="co"># create a list of species name used in the spec data in oder to merge() with mean data set later</span></span>
<span id="cb79-10"><a href="#cb79-10"></a>name.list &lt;-<span class="st"> </span><span class="kw">unique</span>(dataset.transpose<span class="op">$</span>species) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-11"><a href="#cb79-11"></a><span class="st">  </span><span class="kw">sort</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#order it alphabetically </span></span>
<span id="cb79-12"><a href="#cb79-12"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-13"><a href="#cb79-13"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">species =</span> <span class="st">&quot;.&quot;</span>) <span class="co">#make it a data frame and name the column &quot;species&quot;</span></span>
<span id="cb79-14"><a href="#cb79-14"></a></span>
<span id="cb79-15"><a href="#cb79-15"></a><span class="co"># create flower and beetle name list </span></span>
<span id="cb79-16"><a href="#cb79-16"></a>colourgrouplist &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="st">&quot;flower&quot;</span>, <span class="st">&quot;beetle&quot;</span>)</span>
<span id="cb79-17"><a href="#cb79-17"></a>tempcolordat &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="dv">4</span>)</span>
<span id="cb79-18"><a href="#cb79-18"></a></span>
<span id="cb79-19"><a href="#cb79-19"></a><span class="co">## for aim 1</span></span>
<span id="cb79-20"><a href="#cb79-20"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(colourgrouplist)){</span>
<span id="cb79-21"><a href="#cb79-21"></a>  </span>
<span id="cb79-22"><a href="#cb79-22"></a>  ouput.i &lt;-<span class="st"> </span>name.list <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-23"><a href="#cb79-23"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(species, colourgrouplist[i])) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-24"><a href="#cb79-24"></a><span class="st">    </span><span class="kw">cbind</span>(color.code <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-25"><a href="#cb79-25"></a><span class="st">            </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(type, colourgrouplist[i])) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-26"><a href="#cb79-26"></a><span class="st">            </span><span class="kw">arrange</span>(name)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-27"><a href="#cb79-27"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-28"><a href="#cb79-28"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">count =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-29"><a href="#cb79-29"></a><span class="st">    </span><span class="kw">uncount</span>(count) </span>
<span id="cb79-30"><a href="#cb79-30"></a>  </span>
<span id="cb79-31"><a href="#cb79-31"></a>  tempcolordat[[i]] &lt;-<span class="st"> </span>ouput.i</span>
<span id="cb79-32"><a href="#cb79-32"></a>  </span>
<span id="cb79-33"><a href="#cb79-33"></a>}</span>
<span id="cb79-34"><a href="#cb79-34"></a>flower.colour.aim1 &lt;-<span class="st"> </span>tempcolordat[[<span class="dv">1</span>]]</span>
<span id="cb79-35"><a href="#cb79-35"></a>beetle.colour.aim1 &lt;-<span class="st"> </span>tempcolordat[[<span class="dv">2</span>]]</span>
<span id="cb79-36"><a href="#cb79-36"></a></span>
<span id="cb79-37"><a href="#cb79-37"></a><span class="co">## for Aim 2</span></span>
<span id="cb79-38"><a href="#cb79-38"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(colourgrouplist)){</span>
<span id="cb79-39"><a href="#cb79-39"></a>  </span>
<span id="cb79-40"><a href="#cb79-40"></a>  ouput.i &lt;-<span class="st"> </span>name.list <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-41"><a href="#cb79-41"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(species, colourgrouplist[i])) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-42"><a href="#cb79-42"></a><span class="st">    </span><span class="kw">cbind</span>(color.code <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-43"><a href="#cb79-43"></a><span class="st">            </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(type, colourgrouplist[i])) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-44"><a href="#cb79-44"></a><span class="st">            </span><span class="kw">arrange</span>(name)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-45"><a href="#cb79-45"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-46"><a href="#cb79-46"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">count =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-47"><a href="#cb79-47"></a><span class="st">    </span><span class="kw">uncount</span>(count) </span>
<span id="cb79-48"><a href="#cb79-48"></a>  </span>
<span id="cb79-49"><a href="#cb79-49"></a>  tempcolordat[[i<span class="op">+</span><span class="dv">2</span>]] &lt;-<span class="st"> </span>ouput.i <span class="co"># here same in i+2 because 1-2 is for aim1</span></span>
<span id="cb79-50"><a href="#cb79-50"></a>  </span>
<span id="cb79-51"><a href="#cb79-51"></a>}</span>
<span id="cb79-52"><a href="#cb79-52"></a>flower.colour.aim2 &lt;-<span class="st"> </span>tempcolordat[[<span class="dv">3</span>]]</span>
<span id="cb79-53"><a href="#cb79-53"></a>beetle.colour.aim2 &lt;-<span class="st"> </span>tempcolordat[[<span class="dv">4</span>]]</span></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>allvis.list &lt;-<span class="st"> </span><span class="kw">list</span>(allvis.fl_d65.aim1, allvis.bl_d65.aim1, allvis.bf_d65.aim1,</span>
<span id="cb80-2"><a href="#cb80-2"></a>                 allvis.fl_d65.aim2, allvis.bl_d65.aim2, allvis.bf_d65.aim2,</span>
<span id="cb80-3"><a href="#cb80-3"></a>                 allvis.fl_twilight.aim1, allvis.bl_twilight.aim1, allvis.bf_twilight.aim1,</span>
<span id="cb80-4"><a href="#cb80-4"></a>                 allvis.fl_twilight.aim2, allvis.bl_twilight.aim2, allvis.bf_twilight.aim2)</span>
<span id="cb80-5"><a href="#cb80-5"></a></span>
<span id="cb80-6"><a href="#cb80-6"></a>tempcolordat &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(allvis.list))</span>
<span id="cb80-7"><a href="#cb80-7"></a></span>
<span id="cb80-8"><a href="#cb80-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(allvis.list)){</span>
<span id="cb80-9"><a href="#cb80-9"></a>  </span>
<span id="cb80-10"><a href="#cb80-10"></a>  temp.meandS.i &lt;-<span class="st"> </span>allvis.list[[i]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb80-11"><a href="#cb80-11"></a><span class="st">    </span><span class="kw">group_by</span>(vissys) <span class="op">%&gt;%</span></span>
<span id="cb80-12"><a href="#cb80-12"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">mean.dS =</span> <span class="kw">mean</span>(dS))</span>
<span id="cb80-13"><a href="#cb80-13"></a>  </span>
<span id="cb80-14"><a href="#cb80-14"></a>  tempcolordat[[i]] &lt;-<span class="st"> </span>temp.meandS.i</span>
<span id="cb80-15"><a href="#cb80-15"></a>  </span>
<span id="cb80-16"><a href="#cb80-16"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>title.list &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;Flower vs. Leaf&quot;</span>, <span class="st">&quot;Beetle vs. Leaf&quot;</span>, <span class="st">&quot;Beetle vs. Flower&quot;</span>)</span>
<span id="cb81-2"><a href="#cb81-2"></a>ylim.list &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">2</span>) <span class="co"># 21 for aim1, 2 for aim2</span></span>
<span id="cb81-3"><a href="#cb81-3"></a>vislable.list &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;USM&quot;</span>, <span class="st">&quot;UML&quot;</span>, <span class="st">&quot;USL&quot;</span>,<span class="st">&quot;USML&quot;</span>), <span class="co"># aim1</span></span>
<span id="cb81-4"><a href="#cb81-4"></a>                      <span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>)) <span class="co"># aim2</span></span>
<span id="cb81-5"><a href="#cb81-5"></a></span>
<span id="cb81-6"><a href="#cb81-6"></a>vis.comp.list &lt;-<span class="st"> </span><span class="kw">list</span>(fl.aim1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;UVSWMW...fl&quot;</span>, <span class="st">&quot;UV..MWLW.fl&quot;</span>, <span class="st">&quot;UVSW..LW.fl&quot;</span>, <span class="st">&quot;UVSWMWLW.fl&quot;</span>),</span>
<span id="cb81-7"><a href="#cb81-7"></a>                      bl.aim1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;UVSWMW...bl&quot;</span>, <span class="st">&quot;UV..MWLW.bl&quot;</span>, <span class="st">&quot;UVSW..LW.bl&quot;</span>, <span class="st">&quot;UVSWMWLW.bl&quot;</span>),</span>
<span id="cb81-8"><a href="#cb81-8"></a>                      bf.aim1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;UVSWMW...bf&quot;</span>, <span class="st">&quot;UV..MWLW.bf&quot;</span>, <span class="st">&quot;UVSW..LW.bf&quot;</span>, <span class="st">&quot;UVSWMWLW.bf&quot;</span>),</span>
<span id="cb81-9"><a href="#cb81-9"></a>                      fl.aim2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;VS580.fl&quot;</span>, <span class="st">&quot;VS600.fl&quot;</span>, <span class="st">&quot;VS620.fl&quot;</span>, <span class="st">&quot;VS640.fl&quot;</span>, <span class="st">&quot;VS660.fl&quot;</span>),</span>
<span id="cb81-10"><a href="#cb81-10"></a>                      bl.aim2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;VS580.bl&quot;</span>, <span class="st">&quot;VS600.bl&quot;</span>, <span class="st">&quot;VS620.bl&quot;</span>, <span class="st">&quot;VS640.bl&quot;</span>, <span class="st">&quot;VS660.bl&quot;</span>),</span>
<span id="cb81-11"><a href="#cb81-11"></a>                      bf.aim2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;VS580.bf&quot;</span>, <span class="st">&quot;VS600.bf&quot;</span>, <span class="st">&quot;VS620.bf&quot;</span>, <span class="st">&quot;VS640.bf&quot;</span>, <span class="st">&quot;VS660.bf&quot;</span>))</span>
<span id="cb81-12"><a href="#cb81-12"></a></span>
<span id="cb81-13"><a href="#cb81-13"></a>stats.list &lt;-<span class="st"> </span><span class="kw">list</span>(fl_d65.aim1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;a&quot;</span>),</span>
<span id="cb81-14"><a href="#cb81-14"></a>                   bl_d65.aim1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;b&quot;</span>),</span>
<span id="cb81-15"><a href="#cb81-15"></a>                   bf_d65.aim1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;a&quot;</span>),</span>
<span id="cb81-16"><a href="#cb81-16"></a>                   fl_d65.aim2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;cd&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>),</span>
<span id="cb81-17"><a href="#cb81-17"></a>                   bl_d65.aim2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>),</span>
<span id="cb81-18"><a href="#cb81-18"></a>                   bf_d65.aim2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>),</span>
<span id="cb81-19"><a href="#cb81-19"></a>                   fl_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>),</span>
<span id="cb81-20"><a href="#cb81-20"></a>                   bl_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>),</span>
<span id="cb81-21"><a href="#cb81-21"></a>                   bf_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>),</span>
<span id="cb81-22"><a href="#cb81-22"></a>                   fl_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;b&quot;</span>),</span>
<span id="cb81-23"><a href="#cb81-23"></a>                   bl_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>),</span>
<span id="cb81-24"><a href="#cb81-24"></a>                   bf_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>))</span>
<span id="cb81-25"><a href="#cb81-25"></a></span>
<span id="cb81-26"><a href="#cb81-26"></a>backgorund.list &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;grey80&quot;</span>, <span class="ot">NA</span>) <span class="co"># choose NA for beetle.vs.leaf</span></span>
<span id="cb81-27"><a href="#cb81-27"></a></span>
<span id="cb81-28"><a href="#cb81-28"></a>get.contrastplot &lt;-<span class="st"> </span><span class="cf">function</span>(dat, title, vislable, upperylim, visomplist, compgroupnstats, background){</span>
<span id="cb81-29"><a href="#cb81-29"></a>  <span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x =</span> vissys, </span>
<span id="cb81-30"><a href="#cb81-30"></a>                <span class="dt">y =</span> mean.dS.sub,</span>
<span id="cb81-31"><a href="#cb81-31"></a>                <span class="dt">group =</span> <span class="kw">factor</span>(dat[,<span class="dv">1</span>])))<span class="op">+</span></span>
<span id="cb81-32"><a href="#cb81-32"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">col =</span> dat<span class="op">$</span>colour,</span>
<span id="cb81-33"><a href="#cb81-33"></a>               <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb81-34"><a href="#cb81-34"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">col =</span> dat<span class="op">$</span>colour, </span>
<span id="cb81-35"><a href="#cb81-35"></a>              <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb81-36"><a href="#cb81-36"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb81-37"><a href="#cb81-37"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb81-38"><a href="#cb81-38"></a><span class="st">    </span><span class="kw">ylim</span>(<span class="dv">0</span>, ylim.list[upperylim])<span class="op">+</span></span>
<span id="cb81-39"><a href="#cb81-39"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb81-40"><a href="#cb81-40"></a>          <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb81-41"><a href="#cb81-41"></a>          <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> backgorund.list[background], <span class="dt">size =</span> <span class="ot">NA</span>), </span>
<span id="cb81-42"><a href="#cb81-42"></a>          <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),  </span>
<span id="cb81-43"><a href="#cb81-43"></a>          <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span> <span class="dv">90</span>),</span>
<span id="cb81-44"><a href="#cb81-44"></a>          <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb81-45"><a href="#cb81-45"></a>          <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb81-46"><a href="#cb81-46"></a>          <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb81-47"><a href="#cb81-47"></a>          <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb81-48"><a href="#cb81-48"></a>          <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), </span>
<span id="cb81-49"><a href="#cb81-49"></a>          <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb81-50"><a href="#cb81-50"></a>          <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb81-51"><a href="#cb81-51"></a>          <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb81-52"><a href="#cb81-52"></a>          <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb81-53"><a href="#cb81-53"></a><span class="st">    </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> vis.comp.list[[visomplist]],</span>
<span id="cb81-54"><a href="#cb81-54"></a>                     <span class="dt">labels =</span> vislable.list[vislable])<span class="op">+</span></span>
<span id="cb81-55"><a href="#cb81-55"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> dat, </span>
<span id="cb81-56"><a href="#cb81-56"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> vis.comp.list[[visomplist]][<span class="dv">1</span>], </span>
<span id="cb81-57"><a href="#cb81-57"></a>                   <span class="dt">y =</span> tempcolordat[[compgroupnstats]]<span class="op">$</span>mean.dS[<span class="dv">1</span>]),</span>
<span id="cb81-58"><a href="#cb81-58"></a>               <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>)<span class="op">+</span></span>
<span id="cb81-59"><a href="#cb81-59"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> dat, </span>
<span id="cb81-60"><a href="#cb81-60"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> vis.comp.list[[visomplist]][<span class="dv">2</span>], </span>
<span id="cb81-61"><a href="#cb81-61"></a>                   <span class="dt">y =</span> tempcolordat[[compgroupnstats]]<span class="op">$</span>mean.dS[<span class="dv">2</span>]), </span>
<span id="cb81-62"><a href="#cb81-62"></a>               <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>)<span class="op">+</span></span>
<span id="cb81-63"><a href="#cb81-63"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> dat, </span>
<span id="cb81-64"><a href="#cb81-64"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> vis.comp.list[[visomplist]][<span class="dv">3</span>], </span>
<span id="cb81-65"><a href="#cb81-65"></a>                   <span class="dt">y =</span> tempcolordat[[compgroupnstats]]<span class="op">$</span>mean.dS[<span class="dv">3</span>]), </span>
<span id="cb81-66"><a href="#cb81-66"></a>               <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>)<span class="op">+</span></span>
<span id="cb81-67"><a href="#cb81-67"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> dat, </span>
<span id="cb81-68"><a href="#cb81-68"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> vis.comp.list[[visomplist]][<span class="dv">4</span>], </span>
<span id="cb81-69"><a href="#cb81-69"></a>                   <span class="dt">y =</span> tempcolordat[[compgroupnstats]]<span class="op">$</span>mean.dS[<span class="dv">4</span>]), </span>
<span id="cb81-70"><a href="#cb81-70"></a>               <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>)<span class="op">+</span></span>
<span id="cb81-71"><a href="#cb81-71"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> dat, </span>
<span id="cb81-72"><a href="#cb81-72"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> vis.comp.list[[visomplist]][<span class="dv">5</span>], </span>
<span id="cb81-73"><a href="#cb81-73"></a>                   <span class="dt">y =</span> tempcolordat[[compgroupnstats]]<span class="op">$</span>mean.dS[<span class="dv">5</span>]), </span>
<span id="cb81-74"><a href="#cb81-74"></a>               <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>)<span class="op">+</span></span>
<span id="cb81-75"><a href="#cb81-75"></a><span class="st">    </span><span class="kw">ggtitle</span>(title.list[[title]])<span class="op">+</span></span>
<span id="cb81-76"><a href="#cb81-76"></a><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> vis.comp.list[[visomplist]], <span class="dt">y =</span> ylim.list[upperylim], </span>
<span id="cb81-77"><a href="#cb81-77"></a>             <span class="dt">label =</span> stats.list[[compgroupnstats]])</span>
<span id="cb81-78"><a href="#cb81-78"></a>    </span>
<span id="cb81-79"><a href="#cb81-79"></a>}</span></code></pre></div>
<p></br></p>
<div id="aim-1-3" class="section level2 tabset tabset-fade tabset-pills">
<h2>Aim 1</h2>
<div id="daylight-8" class="section level3">
<h3>Daylight</h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="co"># create a data set for means</span></span>
<span id="cb82-2"><a href="#cb82-2"></a>mean.fl_d65.aim1 &lt;-<span class="st"> </span><span class="kw">get.plotmeans</span>(<span class="st">&quot;aim1&quot;</span>, <span class="st">&quot;fl&quot;</span>, allvis.fl_d65.aim1)</span>
<span id="cb82-3"><a href="#cb82-3"></a>mean.bl_d65.aim1 &lt;-<span class="st"> </span><span class="kw">get.plotmeans</span>(<span class="st">&quot;aim1&quot;</span>, <span class="st">&quot;bl&quot;</span>, allvis.bl_d65.aim1)</span>
<span id="cb82-4"><a href="#cb82-4"></a>mean.bf_d65.aim1 &lt;-<span class="st"> </span><span class="kw">get.plotmeans</span>(<span class="st">&quot;aim1&quot;</span>, <span class="st">&quot;bf&quot;</span>, allvis.bf_d65.aim1)</span>
<span id="cb82-5"><a href="#cb82-5"></a></span>
<span id="cb82-6"><a href="#cb82-6"></a><span class="co"># plot individual panel</span></span>
<span id="cb82-7"><a href="#cb82-7"></a>fl_d65.aim1 &lt;-<span class="st"> </span><span class="kw">get.contrastplot</span>(mean.fl_d65.aim1, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>) <span class="co"># flower vs leaf</span></span>
<span id="cb82-8"><a href="#cb82-8"></a>bl_d65.aim1 &lt;-<span class="st"> </span><span class="kw">get.contrastplot</span>(mean.bl_d65.aim1, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="co"># beetle vs leaf</span></span>
<span id="cb82-9"><a href="#cb82-9"></a>bf_d65.aim1 &lt;-<span class="st"> </span><span class="kw">get.contrastplot</span>(mean.bf_d65.aim1, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>) <span class="co"># beetle vs flower</span></span>
<span id="cb82-10"><a href="#cb82-10"></a></span>
<span id="cb82-11"><a href="#cb82-11"></a><span class="co"># bind the 3 panels</span></span>
<span id="cb82-12"><a href="#cb82-12"></a>figure_d65.aim1 &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(fl_d65.aim1,</span>
<span id="cb82-13"><a href="#cb82-13"></a>                             bl_d65.aim1,</span>
<span id="cb82-14"><a href="#cb82-14"></a>                             bf_d65.aim1, </span>
<span id="cb82-15"><a href="#cb82-15"></a>                             <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb82-16"><a href="#cb82-16"></a>figure_d65.aim1</span></code></pre></div>
<div class="figure">
<img src="opsin_shifed_models_files/figure-html/unnamed-chunk-52-1.png" alt="Figure caption: Comparison of chromatic contrast for visual systems with different photoreceptor combinations. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Three contrasts &gt; 13 JND are from flowers that have high UV - blue chroma compared to beetles and leaves." width="672" />
<p class="caption">
Figure caption: Comparison of chromatic contrast for visual systems with different photoreceptor combinations. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Three contrasts &gt; 13 JND are from flowers that have high UV - blue chroma compared to beetles and leaves.
</p>
</div>
</div>
<div id="twilight-12" class="section level3">
<h3>Twilight</h3>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="co"># create a data set for means</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>mean.fl_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">get.plotmeans</span>(<span class="st">&quot;aim1&quot;</span>, <span class="st">&quot;fl&quot;</span>, allvis.fl_twilight.aim1)</span>
<span id="cb83-3"><a href="#cb83-3"></a>mean.bl_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">get.plotmeans</span>(<span class="st">&quot;aim1&quot;</span>, <span class="st">&quot;bl&quot;</span>, allvis.bl_twilight.aim1)</span>
<span id="cb83-4"><a href="#cb83-4"></a>mean.bf_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">get.plotmeans</span>(<span class="st">&quot;aim1&quot;</span>, <span class="st">&quot;bf&quot;</span>, allvis.bf_twilight.aim1)</span>
<span id="cb83-5"><a href="#cb83-5"></a></span>
<span id="cb83-6"><a href="#cb83-6"></a><span class="co"># plot individual panel</span></span>
<span id="cb83-7"><a href="#cb83-7"></a>fl_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">get.contrastplot</span>(mean.fl_twilight.aim1, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">1</span>)</span>
<span id="cb83-8"><a href="#cb83-8"></a>bl_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">get.contrastplot</span>(mean.bl_twilight.aim1, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">2</span>)</span>
<span id="cb83-9"><a href="#cb83-9"></a>bf_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">get.contrastplot</span>(mean.bf_twilight.aim1, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">1</span>)</span>
<span id="cb83-10"><a href="#cb83-10"></a></span>
<span id="cb83-11"><a href="#cb83-11"></a><span class="co"># bind the 3 panels</span></span>
<span id="cb83-12"><a href="#cb83-12"></a>figure_twilight.aim1 &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(fl_twilight.aim1,</span>
<span id="cb83-13"><a href="#cb83-13"></a>                                  bl_twilight.aim1,</span>
<span id="cb83-14"><a href="#cb83-14"></a>                                  bf_twilight.aim1, </span>
<span id="cb83-15"><a href="#cb83-15"></a>                                  <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb83-16"><a href="#cb83-16"></a>figure_twilight.aim1</span></code></pre></div>
<div class="figure">
<img src="opsin_shifed_models_files/figure-html/unnamed-chunk-53-1.png" alt="Figure caption: Comparison of chromatic contrast for visual systems with different photoreceptor combinations under civil twilight illumination. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1." width="672" />
<p class="caption">
Figure caption: Comparison of chromatic contrast for visual systems with different photoreceptor combinations under civil twilight illumination. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1.
</p>
</div>
</div>
</div>
<div id="aim-2-3" class="section level2 tabset tabset-fade tabset-pills">
<h2>Aim 2</h2>
<div id="daylight-9" class="section level3">
<h3>Daylight</h3>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="co"># create a data set for means</span></span>
<span id="cb84-2"><a href="#cb84-2"></a>mean.fl_d65.aim2 &lt;-<span class="st"> </span><span class="kw">get.plotmeans</span>(<span class="st">&quot;aim2&quot;</span>, <span class="st">&quot;fl&quot;</span>, allvis.fl_d65.aim2)</span>
<span id="cb84-3"><a href="#cb84-3"></a>mean.bl_d65.aim2 &lt;-<span class="st"> </span><span class="kw">get.plotmeans</span>(<span class="st">&quot;aim2&quot;</span>, <span class="st">&quot;bl&quot;</span>, allvis.bl_d65.aim2)</span>
<span id="cb84-4"><a href="#cb84-4"></a>mean.bf_d65.aim2 &lt;-<span class="st"> </span><span class="kw">get.plotmeans</span>(<span class="st">&quot;aim2&quot;</span>, <span class="st">&quot;bf&quot;</span>, allvis.bf_d65.aim2)</span>
<span id="cb84-5"><a href="#cb84-5"></a></span>
<span id="cb84-6"><a href="#cb84-6"></a><span class="co"># plot individual panel</span></span>
<span id="cb84-7"><a href="#cb84-7"></a>fl_d65.aim2 &lt;-<span class="st"> </span><span class="kw">get.contrastplot</span>(mean.fl_d65.aim2, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>)</span>
<span id="cb84-8"><a href="#cb84-8"></a>bl_d65.aim2 &lt;-<span class="st"> </span><span class="kw">get.contrastplot</span>(mean.bl_d65.aim2, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">2</span>)</span>
<span id="cb84-9"><a href="#cb84-9"></a>bf_d65.aim2 &lt;-<span class="st"> </span><span class="kw">get.contrastplot</span>(mean.bf_d65.aim2, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">1</span>)</span>
<span id="cb84-10"><a href="#cb84-10"></a></span>
<span id="cb84-11"><a href="#cb84-11"></a><span class="co"># bind the 3 panels</span></span>
<span id="cb84-12"><a href="#cb84-12"></a>figure_d65.aim2 &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(fl_d65.aim2,</span>
<span id="cb84-13"><a href="#cb84-13"></a>                             bl_d65.aim2,</span>
<span id="cb84-14"><a href="#cb84-14"></a>                             bf_d65.aim2, </span>
<span id="cb84-15"><a href="#cb84-15"></a>                             <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb84-16"><a href="#cb84-16"></a>figure_d65.aim2</span></code></pre></div>
<div class="figure">
<img src="opsin_shifed_models_files/figure-html/unnamed-chunk-54-1.png" alt="Figure caption: Comparison of chromatic contrast between visual systems with the LWS photoreceptor peaking at different wavelengths. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Three contrasts &gt; 13 JND are from flowers that have high UV - blue chroma compared to beetles and leaves." width="672" />
<p class="caption">
Figure caption: Comparison of chromatic contrast between visual systems with the LWS photoreceptor peaking at different wavelengths. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Three contrasts &gt; 13 JND are from flowers that have high UV - blue chroma compared to beetles and leaves.
</p>
</div>
</div>
<div id="twilight-13" class="section level3">
<h3>Twilight</h3>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="co"># create a data set for means</span></span>
<span id="cb85-2"><a href="#cb85-2"></a>mean.fl_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">get.plotmeans</span>(<span class="st">&quot;aim2&quot;</span>, <span class="st">&quot;fl&quot;</span>, allvis.fl_twilight.aim2)</span>
<span id="cb85-3"><a href="#cb85-3"></a>mean.bl_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">get.plotmeans</span>(<span class="st">&quot;aim2&quot;</span>, <span class="st">&quot;bl&quot;</span>, allvis.bl_twilight.aim2)</span>
<span id="cb85-4"><a href="#cb85-4"></a>mean.bf_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">get.plotmeans</span>(<span class="st">&quot;aim2&quot;</span>, <span class="st">&quot;bf&quot;</span>, allvis.bf_twilight.aim2)</span>
<span id="cb85-5"><a href="#cb85-5"></a></span>
<span id="cb85-6"><a href="#cb85-6"></a><span class="co"># plot individual panel</span></span>
<span id="cb85-7"><a href="#cb85-7"></a>fl_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">get.contrastplot</span>(mean.fl_twilight.aim2, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">1</span>)</span>
<span id="cb85-8"><a href="#cb85-8"></a>bl_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">get.contrastplot</span>(mean.bl_twilight.aim2, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">11</span>, <span class="dv">2</span>)</span>
<span id="cb85-9"><a href="#cb85-9"></a>bf_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">get.contrastplot</span>(mean.bf_twilight.aim2, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">1</span>)</span>
<span id="cb85-10"><a href="#cb85-10"></a></span>
<span id="cb85-11"><a href="#cb85-11"></a><span class="co"># bind the 3 panels</span></span>
<span id="cb85-12"><a href="#cb85-12"></a>figure_twilight.aim2 &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(fl_twilight.aim2,</span>
<span id="cb85-13"><a href="#cb85-13"></a>                                  bl_twilight.aim2,</span>
<span id="cb85-14"><a href="#cb85-14"></a>                                  bf_twilight.aim2, </span>
<span id="cb85-15"><a href="#cb85-15"></a>                                  <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb85-16"><a href="#cb85-16"></a>figure_twilight.aim2</span></code></pre></div>
<div class="figure">
<img src="opsin_shifed_models_files/figure-html/unnamed-chunk-55-1.png" alt="Figure caption: Comparison of chromatic contrast between visual systems with the LWS photoreceptor peaking at different wavelengths under civil twilight illumination. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1." width="672" />
<p class="caption">
Figure caption: Comparison of chromatic contrast between visual systems with the LWS photoreceptor peaking at different wavelengths under civil twilight illumination. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1.
</p>
</div>
</div>
</div>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<ul>
<li>Models with opsin-shifted LWS receptors showed qualitatively similar results for the comparison of beetles against leaves, with a LWS receptor improving contrast. However, only the presence of a SWS receptor improved contrasts of beetles against flowers and flowers against leaves.</li>
<li>When increasing peak sensitivities from 580 nm to 660 nm,the results were similar to that of filter-shifted models – the contrasts increased from VS 580 to at least VS 640 but the differences in contrast between visual systems were smaller.</li>
</ul>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
