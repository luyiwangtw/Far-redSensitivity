<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>The effect of evenly spaced photoreceptors on chromatic contrast</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Overview</a>
</li>
<li>
  <a href="main_models.html">Main models</a>
</li>
<li>
  <a href="opsin_shifed_models.html">Opsin-shifted visual systems</a>
</li>
<li>
  <a href="evenly_space.html">Evenly space</a>
</li>
<li>
  <a href="sensitivity_analysis.html">Sensitivity analysis</a>
</li>
<li>
  <a href="behavioural_assay.html">Behavioural assay</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">The effect of evenly spaced photoreceptors on chromatic contrast</h1>
<h3 class="subtitle">Supplementary Information</h3>

</div>


<div id="the-aim" class="section level1 tabset tabset-fade tabset-pills">
<h1>The aim</h1>
<ul>
<li><p>Here, we tested the effect of even spacing of sensitivities on colour discrimination in a tetrachromatic visual system. Specifically, we ran visual models with <strong>an evenly spaced visual system</strong> and <strong>an unevenly spaced visual system</strong>, then compared spectral contrast in all three comparison groups (‘leaf vs. flower’, ‘leaf vs. beetle’, ‘beetle vs. flower’).</p></li>
<li><p>These two visual systems have the same upper and lower sensitivities with varying distribution of the two middle sensitivities. The evenly spaced visual system has peak sensitivities at 355 nm, 455 nm, 560 nm, and 660 nm, while VS 660 from the <a href="main_models.html">Main models</a> section is used to represent the unevenly spaced visual system, with peak sensitivities at 355 nm, 445 nm, 530 nm, and 660 nm.</p></li>
<li><p>The model parameters and the statistical methods remain the same as described in the main text.</p></li>
</ul>
<p></br> </br></p>
<div id="sensitivity-curves" class="section level2">
<h2>Sensitivity curves</h2>
<div class="figure">
<img src="evenly_space_files/figure-html/unnamed-chunk-2-1.png" alt="Figure caption: Sensitivity curves of the evenly spaced visual system (solid lines) and the unevenly spaced visual system (VS 660; dotted lines)." width="672" />
<p class="caption">
Figure caption: Sensitivity curves of the evenly spaced visual system (solid lines) and the unevenly spaced visual system (VS 660; dotted lines).
</p>
</div>
<p></br> </br></p>
</div>
<div id="normalised-sensitivity-curves" class="section level2">
<h2>Normalised sensitivity curves</h2>
<div class="figure">
<img src="evenly_space_files/figure-html/unnamed-chunk-3-1.png" alt="Figure caption: Normalised sensitivity curves of the evenly spaced visual system (solid lines) and the unevenly spaced visual system (VS 660; dotted lines)." width="672" />
<p class="caption">
Figure caption: Normalised sensitivity curves of the evenly spaced visual system (solid lines) and the unevenly spaced visual system (VS 660; dotted lines).
</p>
</div>
<p></br> </br></p>
</div>
</div>
<div id="data-description" class="section level1">
<h1>Data description</h1>
<ul>
<li>We used the same spectral data collected from beetles and plants as described in the <a href="main_models.html">Main models</a> section.</li>
</ul>
<p></br> </br></p>
</div>
<div id="run-the-visual-models" class="section level1">
<h1>Run the visual models</h1>
<ul>
<li>We ran the visual models with the same parameter settings and steps as in the main models.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">## D65</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>get.d65.vismodel &lt;-<span class="st"> </span><span class="cf">function</span>(i){</span>
<span id="cb1-3"><a href="#cb1-3"></a>  </span>
<span id="cb1-4"><a href="#cb1-4"></a>  vs.i &lt;-<span class="st"> </span><span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], </span>
<span id="cb1-5"><a href="#cb1-5"></a>                   <span class="dt">visual =</span> i, <span class="co">#this need to change according to the visual system</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>                   <span class="dt">bkg =</span> aveleaf<span class="op">$</span>aveleaf, </span>
<span id="cb1-7"><a href="#cb1-7"></a>                   <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], </span>
<span id="cb1-8"><a href="#cb1-8"></a>                   <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, </span>
<span id="cb1-9"><a href="#cb1-9"></a>                   <span class="dt">relative =</span> <span class="ot">FALSE</span>,</span>
<span id="cb1-10"><a href="#cb1-10"></a>                   <span class="dt">vonkries =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-11"><a href="#cb1-11"></a>  <span class="kw">return</span>(vs.i)</span>
<span id="cb1-12"><a href="#cb1-12"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>get.evenspace.coldist &lt;-<span class="st"> </span><span class="cf">function</span>(i){</span>
<span id="cb2-2"><a href="#cb2-2"></a>  </span>
<span id="cb2-3"><a href="#cb2-3"></a>  con &lt;-<span class="st"> </span><span class="kw">coldist</span>(<span class="dt">modeldata =</span> i, <span class="co"># put output of vismodel()</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>                   <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, </span>
<span id="cb2-5"><a href="#cb2-5"></a>                   <span class="dt">achro=</span><span class="ot">FALSE</span>, </span>
<span id="cb2-6"><a href="#cb2-6"></a>                   <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>),</span>
<span id="cb2-7"><a href="#cb2-7"></a>                   <span class="dt">weber =</span> <span class="fl">0.12</span>,</span>
<span id="cb2-8"><a href="#cb2-8"></a>                   <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb2-9"><a href="#cb2-9"></a>  </span>
<span id="cb2-10"><a href="#cb2-10"></a>  <span class="kw">return</span>(con)</span>
<span id="cb2-11"><a href="#cb2-11"></a>}</span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">#Contrast calculation</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>Cbuprest.even.space.d65  &lt;-<span class="st">  </span><span class="kw">get.evenspace.coldist</span>(buprest.even.space.d65)</span>
<span id="cb2-15"><a href="#cb2-15"></a></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">#VS660</span></span>
<span id="cb2-17"><a href="#cb2-17"></a>Cbuprest660 &lt;-<span class="st"> </span><span class="kw">get.evenspace.coldist</span>(buprest660)</span>
<span id="cb2-18"><a href="#cb2-18"></a></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co">#combine all contrast value in each comparison group</span></span>
<span id="cb2-20"><a href="#cb2-20"></a></span>
<span id="cb2-21"><a href="#cb2-21"></a>even.vissys_d65 &lt;-<span class="st"> </span><span class="kw">list</span>(Cbuprest.even.space.d65, Cbuprest660)</span>
<span id="cb2-22"><a href="#cb2-22"></a>even.fl.vissys &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;even.fl&quot;</span>, <span class="st">&quot;Vis5.fl&quot;</span>) </span>
<span id="cb2-23"><a href="#cb2-23"></a>even.bl.vissys &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;even.bl&quot;</span>, <span class="st">&quot;Vis5.bl&quot;</span>)</span>
<span id="cb2-24"><a href="#cb2-24"></a>even.bf.vissys &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;even.bf&quot;</span>, <span class="st">&quot;Vis5.bf&quot;</span>) </span>
<span id="cb2-25"><a href="#cb2-25"></a></span>
<span id="cb2-26"><a href="#cb2-26"></a><span class="co">### flower vs leaf</span></span>
<span id="cb2-27"><a href="#cb2-27"></a>allvis.fl_d65.even &lt;-<span class="st"> </span><span class="kw">data_frame</span>()</span>
<span id="cb2-28"><a href="#cb2-28"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(even.vissys_d65)) {</span>
<span id="cb2-29"><a href="#cb2-29"></a>  </span>
<span id="cb2-30"><a href="#cb2-30"></a>  temp.i &lt;-<span class="st"> </span>even.vissys_d65[[i]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-31"><a href="#cb2-31"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-32"><a href="#cb2-32"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb2-33"><a href="#cb2-33"></a>  </span>
<span id="cb2-34"><a href="#cb2-34"></a>  temp.i<span class="op">$</span>vissys &lt;-<span class="st"> </span><span class="kw">strrep</span>(even.fl.vissys[[i]],<span class="dv">1</span>)</span>
<span id="cb2-35"><a href="#cb2-35"></a>  </span>
<span id="cb2-36"><a href="#cb2-36"></a>  allvis.fl_d65.even &lt;-<span class="st"> </span>temp.i <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(allvis.fl_d65.even)  </span>
<span id="cb2-37"><a href="#cb2-37"></a>}</span>
<span id="cb2-38"><a href="#cb2-38"></a></span>
<span id="cb2-39"><a href="#cb2-39"></a><span class="co">### beetle vs leaf</span></span>
<span id="cb2-40"><a href="#cb2-40"></a>allvis.bl_d65.even &lt;-<span class="st"> </span><span class="kw">data_frame</span>()</span>
<span id="cb2-41"><a href="#cb2-41"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(even.vissys_d65)) {</span>
<span id="cb2-42"><a href="#cb2-42"></a>  </span>
<span id="cb2-43"><a href="#cb2-43"></a>  temp.i &lt;-<span class="st"> </span>even.vissys_d65[[i]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-44"><a href="#cb2-44"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-45"><a href="#cb2-45"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb2-46"><a href="#cb2-46"></a>  </span>
<span id="cb2-47"><a href="#cb2-47"></a>  temp.i<span class="op">$</span>vissys &lt;-<span class="st"> </span><span class="kw">strrep</span>(even.bl.vissys[[i]],<span class="dv">1</span>)</span>
<span id="cb2-48"><a href="#cb2-48"></a>  </span>
<span id="cb2-49"><a href="#cb2-49"></a>  allvis.bl_d65.even &lt;-<span class="st"> </span>temp.i <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(allvis.bl_d65.even)  </span>
<span id="cb2-50"><a href="#cb2-50"></a>}</span>
<span id="cb2-51"><a href="#cb2-51"></a></span>
<span id="cb2-52"><a href="#cb2-52"></a><span class="co">### beetle vs flower</span></span>
<span id="cb2-53"><a href="#cb2-53"></a>allvis.bf_d65.even &lt;-<span class="st"> </span><span class="kw">data_frame</span>()</span>
<span id="cb2-54"><a href="#cb2-54"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(even.vissys_d65)) {</span>
<span id="cb2-55"><a href="#cb2-55"></a>  </span>
<span id="cb2-56"><a href="#cb2-56"></a>  temp.i &lt;-<span class="st"> </span>even.vissys_d65[[i]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-57"><a href="#cb2-57"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-58"><a href="#cb2-58"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb2-59"><a href="#cb2-59"></a>  </span>
<span id="cb2-60"><a href="#cb2-60"></a>  temp.i<span class="op">$</span>vissys &lt;-<span class="st"> </span><span class="kw">strrep</span>(even.bf.vissys[[i]],<span class="dv">1</span>)</span>
<span id="cb2-61"><a href="#cb2-61"></a>  </span>
<span id="cb2-62"><a href="#cb2-62"></a>  allvis.bf_d65.even &lt;-<span class="st"> </span>temp.i <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(allvis.bf_d65.even)  </span>
<span id="cb2-63"><a href="#cb2-63"></a>}</span></code></pre></div>
<p></br> </br></p>
<div id="contrast-tables" class="section level2">
<h2>Contrast tables</h2>
<table style="width:90%;">
<colgroup>
<col width="16%" />
<col width="23%" />
<col width="23%" />
<col width="26%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">system</th>
<th align="center">flower.vs.leaf</th>
<th align="center">beetle.vs.leaf</th>
<th align="center">beetle.vs.flower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">evenspace</td>
<td align="center">7.439</td>
<td align="center">6.187</td>
<td align="center">7.684</td>
</tr>
<tr class="even">
<td align="center">VS 660</td>
<td align="center">7.553</td>
<td align="center">6.346</td>
<td align="center">7.815</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
</div>
</div>
<div id="compare-contrasts" class="section level1 tabset tabset-fade tabset-pills">
<h1>Compare contrasts</h1>
<ul>
<li><p>To compare contrasts between visual systems, We conducted Wald chi-square tests on generalised linear mixed models (GLMM) followed by posthoc tests.</p></li>
<li><p>In the models, we assigned</p>
<ul>
<li>Independent variable: <strong>contrast</strong></li>
<li>Dependent variable:
<ul>
<li>Fixed factor: <strong>visual system</strong></li>
<li>Random factor: <strong>sample ID</strong> of both targets in the comparison</li>
</ul></li>
</ul></li>
</ul>
<p></br></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>get.lmer &lt;-<span class="st"> </span><span class="cf">function</span>(datlist, compnnumber){</span>
<span id="cb3-2"><a href="#cb3-2"></a>  </span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="kw">lmer</span>(dS <span class="op">~</span><span class="st"> </span>vissys <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), </span>
<span id="cb3-4"><a href="#cb3-4"></a>       <span class="dt">data =</span> datlist[[compnnumber]], <span class="dt">REML =</span> F)</span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="co">#REML=F, in order to fit the model using the likelihood ratio test. Otherwise, the lmer default will fit the model using the REML (REstricted Maximum Likelihood) criterion.</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>}</span>
<span id="cb3-7"><a href="#cb3-7"></a></span>
<span id="cb3-8"><a href="#cb3-8"></a>get.posthocsum &lt;-<span class="st"> </span><span class="cf">function</span>(modelx){</span>
<span id="cb3-9"><a href="#cb3-9"></a>  </span>
<span id="cb3-10"><a href="#cb3-10"></a>  <span class="kw">summary</span>(<span class="kw">glht</span>(modelx, </span>
<span id="cb3-11"><a href="#cb3-11"></a>               <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">vissys =</span> <span class="st">&quot;Tukey&quot;</span>)), </span>
<span id="cb3-12"><a href="#cb3-12"></a>          <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb3-13"><a href="#cb3-13"></a>}</span></code></pre></div>
<div id="flower-vs.-leaf" class="section level2">
<h2><strong>Flower vs. Leaf</strong></h2>
<table style="width:54%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="18%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>vissys</strong></td>
<td align="center">9.796</td>
<td align="center">1</td>
<td align="center">0.001749</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
</div>
<div id="beetle-vs.-leaf" class="section level2">
<h2><strong>Beetle vs. Leaf</strong></h2>
<table style="width:54%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="18%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>vissys</strong></td>
<td align="center">16.88</td>
<td align="center">1</td>
<td align="center">3.984e-05</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
</div>
<div id="beetle-vs.-flower" class="section level2">
<h2><strong>Beetle vs. Flower</strong></h2>
<table style="width:54%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="18%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>vissys</strong></td>
<td align="center">5.045</td>
<td align="center">1</td>
<td align="center">0.0247</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
</div>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>For all three comparison groups, VS 660 (unevenly spaced visual system) has significantly higher contrast than the evenly spaced visual system. This indicates that our results were not biased by uneven spacing of spectral sensitivities in our hypothetical visual systems.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
