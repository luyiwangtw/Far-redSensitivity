<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content=" Lu-Yi Wang1, Devi Stuart-Fox1, Geoff Walker1, Nicholas W. Roberts2 and Amanda M. Franklin1   1School of Biosciences, The University of Melbourne, Australia   2School of Biological Sciences, University of Bristol, UK" />


<title>Sensitivity analysis</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Overview</a>
</li>
<li>
  <a href="main_models.html">Main models</a>
</li>
<li>
  <a href="even_space.html">Even space</a>
</li>
<li>
  <a href="sensitivity_analysis.html">Sensitivity analysis</a>
</li>
<li>
  <a href="behavioural_assay.html">Behavioural assay</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Sensitivity analysis</h1>
<h3 class="subtitle">Supplementary Information</h3>
<h4 class="author"><br>Lu-Yi Wang<sup>1</sup>, Devi Stuart-Fox<sup>1</sup>, Geoff Walker<sup>1</sup>, Nicholas W. Roberts<sup>2</sup> and Amanda M. Franklin<sup>1</sup> <br></br> <sup>1</sup>School of Biosciences, The University of Melbourne, Australia <br></br> <sup>2</sup>School of Biological Sciences, University of Bristol, UK <br></br></h4>

</div>


<div id="the-aim" class="section level1">
<h1>The aim</h1>
<p>To test whether the modelling results were sensitive to the photoreceptor ratios used, we repeated these analyses using published ratios that represent the known variation in insects. Specifically, we compared the tetrachomat visual sistem with peak sensitivities at 380, 460, 520 and 580 nm. </br> </br> We applied the same modelling method described in the main text but using ratios of different insects, including the jewel beetle, <em>Agrilus planipennis</em> (same as the ratio used in the main text; 1.14: 1: 1.26: 1.38; UVS: SWS: MWS: LWS), and two butterflies, <em>Papilio Xuthus</em> (1: 1: 4.08: 2.92) and <em>Heliconius</em> sp. type III (0.09: 0.13: 0.2: 1). </br> </br> The model parameters and the statistical methods remain the same as described in the main text.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pavo)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(stringr)
<span class="kw">library</span>(tidyr) <span class="co">#for gather() function</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(lme4)
<span class="kw">library</span>(car)
<span class="kw">library</span>(multcomp)
<span class="kw">library</span>(boot) <span class="co">#for mean() function</span>
<span class="kw">library</span>(pander) <span class="co">#for creating tidy tables</span>
<span class="kw">library</span>(ggpubr) <span class="co">#for ggarrange() function</span></code></pre></div>
<div class="figure">
<img src="sensitivity_analysis_files/figure-html/unnamed-chunk-4-1.png" alt="Figure caption: Vis 580 was used for the sensitivity analysis" width="672" />
<p class="caption">
Figure caption: Vis 580 was used for the sensitivity analysis
</p>
</div>
<p></br> </br></p>
</div>
<div id="data-description" class="section level1">
<h1>Data description</h1>
<p>We used the same spectral data collected from beetles and plants as described in the <a href="main_models.html">Main models</a> section.</p>
<p></br> </br></p>
</div>
<div id="run-the-visual-models" class="section level1">
<h1>Run the visual models</h1>
<p>We created 3 different visual systems using different receptor ratios from 3 insect species (UVS, SWS, MWS, LWS):</p>
<ul>
<li><em>Agrilus planipennis</em>: 1.14, 1, 1.26, 1.38</li>
<li><em>Papilio xuthus</em>: 1, 1, 4.08, 2.92</li>
<li><em>Heliconius</em> sp. type III : 1, 1.44, 2.22, 11.11</li>
</ul>
<p></br> </br></p>
<div id="first-quantum-catch-calculation" class="section level2">
<h2>First: Quantum catch calculation</h2>
<ul>
<li>We used the <code>vismodel</code> function in the package pavo to calculate quantum catch.</li>
<li>For each visual system, quantum catch was calculated based on Fechner’s law (the signal of the receptor channel is proportional to the logarithm of the quantum catch).</li>
<li>The average of all leaf spectra was used as the background adapting light.</li>
<li>The von Kries chromatic adaptation was applied.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Quantum catch - D65 - Visual model 2</span>
<span class="co">#shared between 3 species</span>
buprest580=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest600=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest620=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">7</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest640=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">8</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest660=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">9</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="second-contrast-calculation" class="section level2">
<h2>Second: Contrast calculation</h2>
<ul>
<li>To calculate chromatic contrast we used the <code>coldist</code> function in pavo.</li>
<li>We used a neural noise-limited model where the noise is proportional to the Weber fraction and is independent of the intensity of the signal received.</li>
<li>The Weber fraction was 0.1.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Contrast calculation- D65 - Visual model 2</span>
<span class="co">#for Agrilus planipennis</span>
Cbuprest580 =<span class="st"> </span><span class="kw">coldist</span>(buprest580, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest600 =<span class="st"> </span><span class="kw">coldist</span>(buprest600, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest620 =<span class="st"> </span><span class="kw">coldist</span>(buprest620, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest640 =<span class="st"> </span><span class="kw">coldist</span>(buprest640, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest660 =<span class="st"> </span><span class="kw">coldist</span>(buprest660, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)

<span class="co">#for Papilio xuthus</span>
Cpapilio580 =<span class="st"> </span><span class="kw">coldist</span>(buprest580, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">4.08</span>, <span class="fl">2.92</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cpapilio600 =<span class="st"> </span><span class="kw">coldist</span>(buprest600, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">4.08</span>, <span class="fl">2.92</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cpapilio620 =<span class="st"> </span><span class="kw">coldist</span>(buprest620, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">4.08</span>, <span class="fl">2.92</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cpapilio640 =<span class="st"> </span><span class="kw">coldist</span>(buprest640, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">4.08</span>, <span class="fl">2.92</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cpapilio660 =<span class="st"> </span><span class="kw">coldist</span>(buprest660, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">4.08</span>, <span class="fl">2.92</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)

<span class="co">#for Heliconius sp</span>
Cheliconius580 =<span class="st"> </span><span class="kw">coldist</span>(buprest580, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.44</span>, <span class="fl">2.22</span>, <span class="fl">11.11</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cheliconius600 =<span class="st"> </span><span class="kw">coldist</span>(buprest600, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.44</span>, <span class="fl">2.22</span>, <span class="fl">11.11</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cheliconius620 =<span class="st"> </span><span class="kw">coldist</span>(buprest620, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.44</span>, <span class="fl">2.22</span>, <span class="fl">11.11</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cheliconius640 =<span class="st"> </span><span class="kw">coldist</span>(buprest640, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.44</span>, <span class="fl">2.22</span>, <span class="fl">11.11</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cheliconius660 =<span class="st"> </span><span class="kw">coldist</span>(buprest660, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.44</span>, <span class="fl">2.22</span>, <span class="fl">11.11</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</code></pre></div>
</div>
</div>
<div id="compare-contrasts" class="section level1 tabset tabset-fade tabset-pills">
<h1>Compare contrasts</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#creat different comparison groups for furthur GLMM analysis</span>
<span class="co">#Organize data before GLMM</span>

<span class="co">#for Agrilus planipennis</span>
##flower vs leaf
Cbuprest580.leaf.vs.flower=
<span class="st">  </span>Cbuprest580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest600.leaf.vs.flower=
<span class="st">  </span>Cbuprest600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest620.leaf.vs.flower=
<span class="st">  </span>Cbuprest620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest640.leaf.vs.flower=
<span class="st">  </span>Cbuprest640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest660.leaf.vs.flower=
<span class="st">  </span>Cbuprest660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))

Cbuprest.leaf.vs.flower=
<span class="st">  </span>Cbuprest580.leaf.vs.flower <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.leaf.vs.flower) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.leaf.vs.flower)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.leaf.vs.flower) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest660.leaf.vs.flower) 

bup580.leaf.vs.flower&lt;-Cbuprest580.leaf.vs.flower[,<span class="dv">3</span>]
bup600.leaf.vs.flower&lt;-Cbuprest600.leaf.vs.flower[,<span class="dv">3</span>]
bup620.leaf.vs.flower&lt;-Cbuprest620.leaf.vs.flower[,<span class="dv">3</span>]
bup640.leaf.vs.flower&lt;-Cbuprest640.leaf.vs.flower[,<span class="dv">3</span>]
bup660.leaf.vs.flower&lt;-Cbuprest660.leaf.vs.flower[,<span class="dv">3</span>]

com.bupcontrast.leaf.vs.flower&lt;-<span class="kw">cbind</span>(Cbuprest.leaf.vs.flower[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.leaf.vs.flower,bup600.leaf.vs.flower,bup620.leaf.vs.flower,bup640.leaf.vs.flower,bup660.leaf.vs.flower)
compare.leaf.vs.flower.bup &lt;-<span class="st"> </span>com.bupcontrast.leaf.vs.flower <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.leaf.vs.flower&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)

##beetle vs leaf
Cbuprest580.leaf.vs.beetle=
<span class="st">  </span>Cbuprest580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest600.leaf.vs.beetle=
<span class="st">  </span>Cbuprest600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest620.leaf.vs.beetle=
<span class="st">  </span>Cbuprest620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest640.leaf.vs.beetle=
<span class="st">  </span>Cbuprest640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest660.leaf.vs.beetle=
<span class="st">  </span>Cbuprest660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

Cbuprest.leaf.vs.beetle=
<span class="st">  </span>Cbuprest580.leaf.vs.beetle  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.leaf.vs.beetle)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.leaf.vs.beetle)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.leaf.vs.beetle) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest660.leaf.vs.beetle) 

bup580.leaf.vs.beetle&lt;-Cbuprest580.leaf.vs.beetle[,<span class="dv">3</span>]
bup600.leaf.vs.beetle&lt;-Cbuprest600.leaf.vs.beetle[,<span class="dv">3</span>]
bup620.leaf.vs.beetle&lt;-Cbuprest620.leaf.vs.beetle[,<span class="dv">3</span>]
bup640.leaf.vs.beetle&lt;-Cbuprest640.leaf.vs.beetle[,<span class="dv">3</span>]
bup660.leaf.vs.beetle&lt;-Cbuprest660.leaf.vs.beetle[,<span class="dv">3</span>]

com.bupcontrast.leaf.vs.beetle&lt;-<span class="kw">cbind</span>(Cbuprest.leaf.vs.beetle[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.leaf.vs.beetle,bup600.leaf.vs.beetle,bup620.leaf.vs.beetle,bup640.leaf.vs.beetle,bup660.leaf.vs.beetle)
compare.leaf.vs.beetle.bup &lt;-<span class="st"> </span>com.bupcontrast.leaf.vs.beetle <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.leaf.vs.beetle&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)

##beetle vs flower
Cbuprest580.flower.vs.beetle=
<span class="st">  </span>Cbuprest580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest600.flower.vs.beetle=
<span class="st">  </span>Cbuprest600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest620.flower.vs.beetle=
<span class="st">  </span>Cbuprest620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest640.flower.vs.beetle=
<span class="st">  </span>Cbuprest640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest660.flower.vs.beetle=
<span class="st">  </span>Cbuprest660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

Cbuprest.flower.vs.beetle=
<span class="st">  </span>Cbuprest580.flower.vs.beetle <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.flower.vs.beetle) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.flower.vs.beetle)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.flower.vs.beetle) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest660.flower.vs.beetle)

bup580.flower.vs.beetle&lt;-Cbuprest580.flower.vs.beetle[,<span class="dv">3</span>]
bup600.flower.vs.beetle&lt;-Cbuprest600.flower.vs.beetle[,<span class="dv">3</span>]
bup620.flower.vs.beetle&lt;-Cbuprest620.flower.vs.beetle[,<span class="dv">3</span>]
bup640.flower.vs.beetle&lt;-Cbuprest640.flower.vs.beetle[,<span class="dv">3</span>]
bup660.flower.vs.beetle&lt;-Cbuprest660.flower.vs.beetle[,<span class="dv">3</span>]

com.bupcontrast.flower.vs.beetle&lt;-<span class="kw">cbind</span>(Cbuprest.flower.vs.beetle[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.flower.vs.beetle,bup600.flower.vs.beetle,bup620.flower.vs.beetle,bup640.flower.vs.beetle,bup660.flower.vs.beetle)
compare.flower.vs.beetle.bup &lt;-<span class="st"> </span>com.bupcontrast.flower.vs.beetle <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.flower.vs.beetle&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)




<span class="co">#for Papilio xuthus</span>
##flower vs leaf
Cpapilio580.leaf.vs.flower=
<span class="st">  </span>Cpapilio580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cpapilio600.leaf.vs.flower=
<span class="st">  </span>Cpapilio600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cpapilio620.leaf.vs.flower=
<span class="st">  </span>Cpapilio620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cpapilio640.leaf.vs.flower=
<span class="st">  </span>Cpapilio640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cpapilio660.leaf.vs.flower=
<span class="st">  </span>Cpapilio660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))

Cpapilio.leaf.vs.flower=
<span class="st">  </span>Cpapilio580.leaf.vs.flower <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cpapilio600.leaf.vs.flower) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Cpapilio620.leaf.vs.flower)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cpapilio640.leaf.vs.flower) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cpapilio660.leaf.vs.flower) 

pap580.leaf.vs.flower&lt;-Cpapilio580.leaf.vs.flower[,<span class="dv">3</span>]
pap600.leaf.vs.flower&lt;-Cpapilio600.leaf.vs.flower[,<span class="dv">3</span>]
pap620.leaf.vs.flower&lt;-Cpapilio620.leaf.vs.flower[,<span class="dv">3</span>]
pap640.leaf.vs.flower&lt;-Cpapilio640.leaf.vs.flower[,<span class="dv">3</span>]
pap660.leaf.vs.flower&lt;-Cpapilio660.leaf.vs.flower[,<span class="dv">3</span>]

com.papcontrast.leaf.vs.flower&lt;-<span class="kw">cbind</span>(Cpapilio.leaf.vs.flower[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],pap580.leaf.vs.flower,pap600.leaf.vs.flower,pap620.leaf.vs.flower,pap640.leaf.vs.flower,pap660.leaf.vs.flower)
compare.leaf.vs.flower.pap &lt;-<span class="st"> </span>com.papcontrast.leaf.vs.flower <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.leaf.vs.flower&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)

##beetle vs leaf
Cpapilio580.leaf.vs.beetle=
<span class="st">  </span>Cpapilio580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cpapilio600.leaf.vs.beetle=
<span class="st">  </span>Cpapilio600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cpapilio620.leaf.vs.beetle=
<span class="st">  </span>Cpapilio620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cpapilio640.leaf.vs.beetle=
<span class="st">  </span>Cpapilio640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cpapilio660.leaf.vs.beetle=
<span class="st">  </span>Cpapilio660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

Cpapilio.leaf.vs.beetle=
<span class="st">  </span>Cpapilio580.leaf.vs.beetle  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cpapilio600.leaf.vs.beetle)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Cpapilio620.leaf.vs.beetle)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cpapilio640.leaf.vs.beetle) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cpapilio660.leaf.vs.beetle) 

pap580.leaf.vs.beetle&lt;-Cpapilio580.leaf.vs.beetle[,<span class="dv">3</span>]
pap600.leaf.vs.beetle&lt;-Cpapilio600.leaf.vs.beetle[,<span class="dv">3</span>]
pap620.leaf.vs.beetle&lt;-Cpapilio620.leaf.vs.beetle[,<span class="dv">3</span>]
pap640.leaf.vs.beetle&lt;-Cpapilio640.leaf.vs.beetle[,<span class="dv">3</span>]
pap660.leaf.vs.beetle&lt;-Cpapilio660.leaf.vs.beetle[,<span class="dv">3</span>]

com.papcontrast.leaf.vs.beetle&lt;-<span class="kw">cbind</span>(Cpapilio.leaf.vs.beetle[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],pap580.leaf.vs.beetle,pap600.leaf.vs.beetle,pap620.leaf.vs.beetle,pap640.leaf.vs.beetle,pap660.leaf.vs.beetle)
compare.leaf.vs.beetle.pap &lt;-<span class="st"> </span>com.papcontrast.leaf.vs.beetle <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.leaf.vs.beetle&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)

##beetle vs flower
Cpapilio580.flower.vs.beetle=
<span class="st">  </span>Cpapilio580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cpapilio600.flower.vs.beetle=
<span class="st">  </span>Cpapilio600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cpapilio620.flower.vs.beetle=
<span class="st">  </span>Cpapilio620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cpapilio640.flower.vs.beetle=
<span class="st">  </span>Cpapilio640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cpapilio660.flower.vs.beetle=
<span class="st">  </span>Cpapilio660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

Cpapilio.flower.vs.beetle=
<span class="st">  </span>Cpapilio580.flower.vs.beetle <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cpapilio600.flower.vs.beetle) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(Cpapilio620.flower.vs.beetle)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cpapilio640.flower.vs.beetle) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(Cpapilio660.flower.vs.beetle)

pap580.flower.vs.beetle&lt;-Cpapilio580.flower.vs.beetle[,<span class="dv">3</span>]
pap600.flower.vs.beetle&lt;-Cpapilio600.flower.vs.beetle[,<span class="dv">3</span>]
pap620.flower.vs.beetle&lt;-Cpapilio620.flower.vs.beetle[,<span class="dv">3</span>]
pap640.flower.vs.beetle&lt;-Cpapilio640.flower.vs.beetle[,<span class="dv">3</span>]
pap660.flower.vs.beetle&lt;-Cpapilio660.flower.vs.beetle[,<span class="dv">3</span>]

com.papcontrast.flower.vs.beetle&lt;-<span class="kw">cbind</span>(Cpapilio.flower.vs.beetle[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],pap580.flower.vs.beetle,pap600.flower.vs.beetle,pap620.flower.vs.beetle,pap640.flower.vs.beetle,pap660.flower.vs.beetle)
compare.flower.vs.beetle.pap &lt;-<span class="st"> </span>com.papcontrast.flower.vs.beetle <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.flower.vs.beetle&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)



<span class="co">#for Heliconius sp</span>
##flower vs leaf
Cheliconius580.leaf.vs.flower=
<span class="st">  </span>Cheliconius580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cheliconius600.leaf.vs.flower=
<span class="st">  </span>Cheliconius600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cheliconius620.leaf.vs.flower=
<span class="st">  </span>Cheliconius620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cheliconius640.leaf.vs.flower=
<span class="st">  </span>Cheliconius640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cheliconius660.leaf.vs.flower=
<span class="st">  </span>Cheliconius660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))

Cheliconius.leaf.vs.flower=
<span class="st">  </span>Cheliconius580.leaf.vs.flower <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cheliconius600.leaf.vs.flower) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Cheliconius620.leaf.vs.flower)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cheliconius640.leaf.vs.flower) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cheliconius660.leaf.vs.flower) 

heli580.leaf.vs.flower&lt;-Cheliconius580.leaf.vs.flower[,<span class="dv">3</span>]
heli600.leaf.vs.flower&lt;-Cheliconius600.leaf.vs.flower[,<span class="dv">3</span>]
heli620.leaf.vs.flower&lt;-Cheliconius620.leaf.vs.flower[,<span class="dv">3</span>]
heli640.leaf.vs.flower&lt;-Cheliconius640.leaf.vs.flower[,<span class="dv">3</span>]
heli660.leaf.vs.flower&lt;-Cheliconius660.leaf.vs.flower[,<span class="dv">3</span>]

com.helicontrast.leaf.vs.flower&lt;-<span class="kw">cbind</span>(Cheliconius.leaf.vs.flower[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],heli580.leaf.vs.flower,heli600.leaf.vs.flower,heli620.leaf.vs.flower,heli640.leaf.vs.flower,heli660.leaf.vs.flower)
compare.leaf.vs.flower.heli &lt;-<span class="st"> </span>com.helicontrast.leaf.vs.flower <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.leaf.vs.flower&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)

##beetle vs leaf
Cheliconius580.leaf.vs.beetle=
<span class="st">  </span>Cheliconius580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cheliconius600.leaf.vs.beetle=
<span class="st">  </span>Cheliconius600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cheliconius620.leaf.vs.beetle=
<span class="st">  </span>Cheliconius620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cheliconius640.leaf.vs.beetle=
<span class="st">  </span>Cheliconius640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cheliconius660.leaf.vs.beetle=
<span class="st">  </span>Cheliconius660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

Cheliconius.leaf.vs.beetle=
<span class="st">  </span>Cheliconius580.leaf.vs.beetle  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cheliconius600.leaf.vs.beetle)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Cheliconius620.leaf.vs.beetle)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cheliconius640.leaf.vs.beetle) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cheliconius660.leaf.vs.beetle) 

heli580.leaf.vs.beetle&lt;-Cheliconius580.leaf.vs.beetle[,<span class="dv">3</span>]
heli600.leaf.vs.beetle&lt;-Cheliconius600.leaf.vs.beetle[,<span class="dv">3</span>]
heli620.leaf.vs.beetle&lt;-Cheliconius620.leaf.vs.beetle[,<span class="dv">3</span>]
heli640.leaf.vs.beetle&lt;-Cheliconius640.leaf.vs.beetle[,<span class="dv">3</span>]
heli660.leaf.vs.beetle&lt;-Cheliconius660.leaf.vs.beetle[,<span class="dv">3</span>]

com.helicontrast.leaf.vs.beetle&lt;-<span class="kw">cbind</span>(Cheliconius.leaf.vs.beetle[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],heli580.leaf.vs.beetle,heli600.leaf.vs.beetle,heli620.leaf.vs.beetle,heli640.leaf.vs.beetle,heli660.leaf.vs.beetle)
compare.leaf.vs.beetle.heli &lt;-<span class="st"> </span>com.helicontrast.leaf.vs.beetle <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.leaf.vs.beetle&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)

##beetle vs flower
Cheliconius580.flower.vs.beetle=
<span class="st">  </span>Cheliconius580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cheliconius600.flower.vs.beetle=
<span class="st">  </span>Cheliconius600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cheliconius620.flower.vs.beetle=
<span class="st">  </span>Cheliconius620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cheliconius640.flower.vs.beetle=
<span class="st">  </span>Cheliconius640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cheliconius660.flower.vs.beetle=
<span class="st">  </span>Cheliconius660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

Cheliconius.flower.vs.beetle=
<span class="st">  </span>Cheliconius580.flower.vs.beetle <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cheliconius600.flower.vs.beetle) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(Cheliconius620.flower.vs.beetle)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cheliconius640.flower.vs.beetle) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(Cheliconius660.flower.vs.beetle)

heli580.flower.vs.beetle&lt;-Cheliconius580.flower.vs.beetle[,<span class="dv">3</span>]
heli600.flower.vs.beetle&lt;-Cheliconius600.flower.vs.beetle[,<span class="dv">3</span>]
heli620.flower.vs.beetle&lt;-Cheliconius620.flower.vs.beetle[,<span class="dv">3</span>]
heli640.flower.vs.beetle&lt;-Cheliconius640.flower.vs.beetle[,<span class="dv">3</span>]
heli660.flower.vs.beetle&lt;-Cheliconius660.flower.vs.beetle[,<span class="dv">3</span>]

com.helicontrast.flower.vs.beetle&lt;-<span class="kw">cbind</span>(Cheliconius.flower.vs.beetle[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],heli580.flower.vs.beetle,heli600.flower.vs.beetle,heli620.flower.vs.beetle,heli640.flower.vs.beetle,heli660.flower.vs.beetle)
compare.flower.vs.beetle.heli &lt;-<span class="st"> </span>com.helicontrast.flower.vs.beetle<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.flower.vs.beetle&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)</code></pre></div>
<p></br> </br></p>
<ul>
<li><p>To compare contrasts between visual systems, We conducted Wald chi-square tests on generalised linear mixed models (GLMM) followed by posthoc tests.</p></li>
<li>In the models, we assigned
<ul>
<li>Independent variable: <strong>contrast</strong></li>
<li>Dependent variable:
<ul>
<li>Fixed factor: <strong>visual system</strong></li>
<li>Random factor: <strong>sample ID</strong> of both targets in the comparison </br> </br></li>
</ul></li>
</ul></li>
</ul>
<p>Click the tabs to see the results for each comparison group ( <strong>Leaf vs. Flower</strong> / <strong>Leaf vs. Beetle</strong> / <strong>Beetle vs. Flower</strong>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#for Agrilus planipennis</span>
##Leaf vs Flower
m.leaf.vs.flower.bup &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.leaf.vs.flower <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.leaf.vs.flower.bup,<span class="dt">REML=</span>F)
sum.leaf.vs.flower.bup &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.leaf.vs.flower.bup, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.leaf.vs.flower =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
##Leaf vs Beetle
m.leaf.vs.beetle.bup &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.leaf.vs.beetle <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.leaf.vs.beetle.bup,<span class="dt">REML=</span>F)
sum.leaf.vs.beetle.bup &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.leaf.vs.beetle.bup, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.leaf.vs.beetle =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
##Beetle vs Flower
m.flower.vs.beetle.bup &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.flower.vs.beetle <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.flower.vs.beetle.bup,<span class="dt">REML=</span>F)
sum.flower.vs.beetle.bup &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.flower.vs.beetle.bup, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.flower.vs.beetle =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))

###reshape data for heatmap
p1.bup&lt;-sum.leaf.vs.flower.bup[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p2.bup&lt;-sum.leaf.vs.beetle.bup[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p3.bup&lt;-sum.flower.vs.beetle.bup[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]

VislistA.bup&lt;-<span class="kw">c</span>(<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>)
VislistB.bup&lt;-<span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>)

heat.bup&lt;-<span class="kw">data.frame</span>(<span class="kw">names</span>(p1.bup),<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p1.bup,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p2.bup,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p3.bup,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">orignial.list =</span> <span class="dv">1</span>, <span class="dt">leaf.vs.flower =</span> <span class="dv">2</span>, <span class="dt">leaf.vs.beetle =</span> <span class="dv">3</span>, <span class="dt">flower.vs.beetle =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistA.bup) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistB.bup) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>orignial.list)

##add asterisks for significant pairs
heat.bup<span class="op">$</span>sig.leaf.vs.flower[heat.bup<span class="op">$</span>leaf.vs.flower <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat.bup<span class="op">$</span>sig.leaf.vs.flower[heat.bup<span class="op">$</span>leaf.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat.bup<span class="op">$</span>sig.leaf.vs.flower[heat.bup<span class="op">$</span>leaf.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat.bup<span class="op">$</span>sig.leaf.vs.flower[heat.bup<span class="op">$</span>leaf.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>
heat.bup<span class="op">$</span>sig.leaf.vs.beetle[heat.bup<span class="op">$</span>leaf.vs.beetle <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat.bup<span class="op">$</span>sig.leaf.vs.beetle[heat.bup<span class="op">$</span>leaf.vs.beetle <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat.bup<span class="op">$</span>sig.leaf.vs.beetle[heat.bup<span class="op">$</span>leaf.vs.beetle <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat.bup<span class="op">$</span>sig.leaf.vs.beetle[heat.bup<span class="op">$</span>leaf.vs.beetle <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>
heat.bup<span class="op">$</span>sig.flower.vs.beetle[heat.bup<span class="op">$</span>flower.vs.beetle <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat.bup<span class="op">$</span>sig.flower.vs.beetle[heat.bup<span class="op">$</span>flower.vs.beetle <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat.bup<span class="op">$</span>sig.flower.vs.beetle[heat.bup<span class="op">$</span>flower.vs.beetle <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat.bup<span class="op">$</span>sig.flower.vs.beetle[heat.bup<span class="op">$</span>flower.vs.beetle <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>



<span class="co">#for Papilio xuthus</span>
##Leaf vs Flower
m.leaf.vs.flower.pap &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.leaf.vs.flower <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.leaf.vs.flower.pap,<span class="dt">REML=</span>F)
sum.leaf.vs.flower.pap &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.leaf.vs.flower.pap, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.leaf.vs.flower =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
##Leaf vs Beetle
m.leaf.vs.beetle.pap &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.leaf.vs.beetle <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.leaf.vs.beetle.pap,<span class="dt">REML=</span>F)
sum.leaf.vs.beetle.pap &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.leaf.vs.beetle.pap, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.leaf.vs.beetle =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
##Beetle vs Flower
m.flower.vs.beetle.pap &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.flower.vs.beetle <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.flower.vs.beetle.pap,<span class="dt">REML=</span>F)
sum.flower.vs.beetle.pap &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.flower.vs.beetle.pap, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.flower.vs.beetle =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))

###reshape data for heatmap
p1.pap&lt;-sum.leaf.vs.flower.pap[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p2.pap&lt;-sum.leaf.vs.beetle.pap[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p3.pap&lt;-sum.flower.vs.beetle.pap[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]

VislistA.pap&lt;-<span class="kw">c</span>(<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>)
VislistB.pap&lt;-<span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>)

heat.pap&lt;-<span class="kw">data.frame</span>(<span class="kw">names</span>(p1.pap),<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p1.pap,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p2.pap,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p3.pap,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">orignial.list =</span> <span class="dv">1</span>, <span class="dt">leaf.vs.flower =</span> <span class="dv">2</span>, <span class="dt">leaf.vs.beetle =</span> <span class="dv">3</span>, <span class="dt">flower.vs.beetle =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistA.pap) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistB.pap) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>orignial.list)

##add asterisks for significant pairs
heat.pap<span class="op">$</span>sig.leaf.vs.flower[heat.pap<span class="op">$</span>leaf.vs.flower <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat.pap<span class="op">$</span>sig.leaf.vs.flower[heat.pap<span class="op">$</span>leaf.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat.pap<span class="op">$</span>sig.leaf.vs.flower[heat.pap<span class="op">$</span>leaf.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat.pap<span class="op">$</span>sig.leaf.vs.flower[heat.pap<span class="op">$</span>leaf.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>
heat.pap<span class="op">$</span>sig.leaf.vs.beetle[heat.pap<span class="op">$</span>leaf.vs.beetle <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat.pap<span class="op">$</span>sig.leaf.vs.beetle[heat.pap<span class="op">$</span>leaf.vs.beetle <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat.pap<span class="op">$</span>sig.leaf.vs.beetle[heat.pap<span class="op">$</span>leaf.vs.beetle <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat.pap<span class="op">$</span>sig.leaf.vs.beetle[heat.pap<span class="op">$</span>leaf.vs.beetle <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>
heat.pap<span class="op">$</span>sig.flower.vs.beetle[heat.pap<span class="op">$</span>flower.vs.beetle <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat.pap<span class="op">$</span>sig.flower.vs.beetle[heat.pap<span class="op">$</span>flower.vs.beetle <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat.pap<span class="op">$</span>sig.flower.vs.beetle[heat.pap<span class="op">$</span>flower.vs.beetle <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat.pap<span class="op">$</span>sig.flower.vs.beetle[heat.pap<span class="op">$</span>flower.vs.beetle <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>



<span class="co">#for Heliconius sp</span>
##Leaf vs Flower
m.leaf.vs.flower.heli &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.leaf.vs.flower <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.leaf.vs.flower.heli,<span class="dt">REML=</span>F)
sum.leaf.vs.flower.heli &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.leaf.vs.flower.heli, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.leaf.vs.flower =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
##Leaf vs Beetle
m.leaf.vs.beetle.heli &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.leaf.vs.beetle <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.leaf.vs.beetle.heli,<span class="dt">REML=</span>F)
sum.leaf.vs.beetle.heli &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.leaf.vs.beetle.heli, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.leaf.vs.beetle =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
##Beetle vs Flower
m.flower.vs.beetle.heli &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.flower.vs.beetle <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.flower.vs.beetle.heli,<span class="dt">REML=</span>F)
sum.flower.vs.beetle.heli &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.flower.vs.beetle.heli, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.flower.vs.beetle =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))

###reshape data for heatmap
p1.heli&lt;-sum.leaf.vs.flower.heli[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p2.heli&lt;-sum.leaf.vs.beetle.heli[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p3.heli&lt;-sum.flower.vs.beetle.heli[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]

VislistA.heli&lt;-<span class="kw">c</span>(<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>)
VislistB.heli&lt;-<span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>)

heat.heli&lt;-<span class="kw">data.frame</span>(<span class="kw">names</span>(p1.heli),<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p1.heli,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p2.heli,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p3.heli,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">orignial.list =</span> <span class="dv">1</span>, <span class="dt">leaf.vs.flower =</span> <span class="dv">2</span>, <span class="dt">leaf.vs.beetle =</span> <span class="dv">3</span>, <span class="dt">flower.vs.beetle =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistA.heli) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistB.heli) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>orignial.list)

##add asterisks for significant pairs
heat.heli<span class="op">$</span>sig.leaf.vs.flower[heat.heli<span class="op">$</span>leaf.vs.flower <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat.heli<span class="op">$</span>sig.leaf.vs.flower[heat.heli<span class="op">$</span>leaf.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat.heli<span class="op">$</span>sig.leaf.vs.flower[heat.heli<span class="op">$</span>leaf.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat.heli<span class="op">$</span>sig.leaf.vs.flower[heat.heli<span class="op">$</span>leaf.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>
heat.heli<span class="op">$</span>sig.leaf.vs.beetle[heat.heli<span class="op">$</span>leaf.vs.beetle <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat.heli<span class="op">$</span>sig.leaf.vs.beetle[heat.heli<span class="op">$</span>leaf.vs.beetle <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat.heli<span class="op">$</span>sig.leaf.vs.beetle[heat.heli<span class="op">$</span>leaf.vs.beetle <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat.heli<span class="op">$</span>sig.leaf.vs.beetle[heat.heli<span class="op">$</span>leaf.vs.beetle <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span>
heat.heli<span class="op">$</span>sig.flower.vs.beetle[heat.heli<span class="op">$</span>flower.vs.beetle <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span>
heat.heli<span class="op">$</span>sig.flower.vs.beetle[heat.heli<span class="op">$</span>flower.vs.beetle <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span>
heat.heli<span class="op">$</span>sig.flower.vs.beetle[heat.heli<span class="op">$</span>flower.vs.beetle <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span>
heat.heli<span class="op">$</span>sig.flower.vs.beetle[heat.heli<span class="op">$</span>flower.vs.beetle <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></code></pre></div>
<div id="leaf-vs-flower" class="section level2 tabset tabset-fade tabset-pills">
<h2><strong>Leaf vs Flower</strong></h2>
<div id="agrilus-planipennis" class="section level3 tabset tabset-fade tabset-pills">
<h3><em>Agrilus planipennis</em></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.leaf.vs.flower.bup) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.leaf.vs.flower</strong></td>
<td align="center">17104</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values" class="section level4">
<h4>Pair-wise p-values</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat.bup, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA.bup, <span class="dt">y=</span>VislistB.bup, <span class="dt">fill=</span>leaf.vs.flower)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA.bup, VislistB.bup, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(leaf.vs.flower, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.leaf.vs.flower)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p></br> </br></p>
</div>
<div id="original-model-output" class="section level4">
<h4>Original model output</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.leaf.vs.flower.bup</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.leaf.vs.flower + (1 | patch2) + (1 | 
##     patch1), data = compare.leaf.vs.flower.bup, REML = F)
## 
## Linear Hypotheses:
##                                                    Estimate Std. Error z value
## bup600.leaf.vs.flower - bup580.leaf.vs.flower == 0  0.50183    0.02128  23.578
## bup620.leaf.vs.flower - bup580.leaf.vs.flower == 0  1.41836    0.02128  66.640
## bup640.leaf.vs.flower - bup580.leaf.vs.flower == 0  2.20495    0.02128 103.597
## bup660.leaf.vs.flower - bup580.leaf.vs.flower == 0  2.15094    0.02128 101.059
## bup620.leaf.vs.flower - bup600.leaf.vs.flower == 0  0.91653    0.02128  43.062
## bup640.leaf.vs.flower - bup600.leaf.vs.flower == 0  1.70312    0.02128  80.019
## bup660.leaf.vs.flower - bup600.leaf.vs.flower == 0  1.64911    0.02128  77.481
## bup640.leaf.vs.flower - bup620.leaf.vs.flower == 0  0.78658    0.02128  36.957
## bup660.leaf.vs.flower - bup620.leaf.vs.flower == 0  0.73258    0.02128  34.419
## bup660.leaf.vs.flower - bup640.leaf.vs.flower == 0 -0.05400    0.02128  -2.537
##                                                    Pr(&gt;|z|)    
## bup600.leaf.vs.flower - bup580.leaf.vs.flower == 0   &lt;2e-16 ***
## bup620.leaf.vs.flower - bup580.leaf.vs.flower == 0   &lt;2e-16 ***
## bup640.leaf.vs.flower - bup580.leaf.vs.flower == 0   &lt;2e-16 ***
## bup660.leaf.vs.flower - bup580.leaf.vs.flower == 0   &lt;2e-16 ***
## bup620.leaf.vs.flower - bup600.leaf.vs.flower == 0   &lt;2e-16 ***
## bup640.leaf.vs.flower - bup600.leaf.vs.flower == 0   &lt;2e-16 ***
## bup660.leaf.vs.flower - bup600.leaf.vs.flower == 0   &lt;2e-16 ***
## bup640.leaf.vs.flower - bup620.leaf.vs.flower == 0   &lt;2e-16 ***
## bup660.leaf.vs.flower - bup620.leaf.vs.flower == 0   &lt;2e-16 ***
## bup660.leaf.vs.flower - bup640.leaf.vs.flower == 0    0.112    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
<div id="papilio-xuthus" class="section level3 tabset tabset-fade tabset-pills">
<h3><em>Papilio xuthus</em></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.leaf.vs.flower.pap) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.leaf.vs.flower</strong></td>
<td align="center">35546</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-1" class="section level4">
<h4>Pair-wise p-values</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat.pap, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA.pap, <span class="dt">y=</span>VislistB.pap, <span class="dt">fill=</span>leaf.vs.flower)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA.pap, VislistB.pap, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(leaf.vs.flower, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.leaf.vs.flower)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p></br> </br></p>
</div>
<div id="original-model-output-1" class="section level4">
<h4>Original model output</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.leaf.vs.flower.pap</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.leaf.vs.flower + (1 | patch2) + (1 | 
##     patch1), data = compare.leaf.vs.flower.pap, REML = F)
## 
## Linear Hypotheses:
##                                                    Estimate Std. Error z value
## pap600.leaf.vs.flower - pap580.leaf.vs.flower == 0  0.68777    0.01788   38.47
## pap620.leaf.vs.flower - pap580.leaf.vs.flower == 0  1.78751    0.01788   99.97
## pap640.leaf.vs.flower - pap580.leaf.vs.flower == 0  2.67839    0.01788  149.79
## pap660.leaf.vs.flower - pap580.leaf.vs.flower == 0  2.64872    0.01788  148.13
## pap620.leaf.vs.flower - pap600.leaf.vs.flower == 0  1.09974    0.01788   61.51
## pap640.leaf.vs.flower - pap600.leaf.vs.flower == 0  1.99062    0.01788  111.33
## pap660.leaf.vs.flower - pap600.leaf.vs.flower == 0  1.96095    0.01788  109.67
## pap640.leaf.vs.flower - pap620.leaf.vs.flower == 0  0.89088    0.01788   49.82
## pap660.leaf.vs.flower - pap620.leaf.vs.flower == 0  0.86121    0.01788   48.16
## pap660.leaf.vs.flower - pap640.leaf.vs.flower == 0 -0.02967    0.01788   -1.66
##                                                    Pr(&gt;|z|)    
## pap600.leaf.vs.flower - pap580.leaf.vs.flower == 0   &lt;2e-16 ***
## pap620.leaf.vs.flower - pap580.leaf.vs.flower == 0   &lt;2e-16 ***
## pap640.leaf.vs.flower - pap580.leaf.vs.flower == 0   &lt;2e-16 ***
## pap660.leaf.vs.flower - pap580.leaf.vs.flower == 0   &lt;2e-16 ***
## pap620.leaf.vs.flower - pap600.leaf.vs.flower == 0   &lt;2e-16 ***
## pap640.leaf.vs.flower - pap600.leaf.vs.flower == 0   &lt;2e-16 ***
## pap660.leaf.vs.flower - pap600.leaf.vs.flower == 0   &lt;2e-16 ***
## pap640.leaf.vs.flower - pap620.leaf.vs.flower == 0   &lt;2e-16 ***
## pap660.leaf.vs.flower - pap620.leaf.vs.flower == 0   &lt;2e-16 ***
## pap660.leaf.vs.flower - pap640.leaf.vs.flower == 0     0.97    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
<div id="heliconius-sp" class="section level3 tabset tabset-fade tabset-pills">
<h3><em>Heliconius</em> sp</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.leaf.vs.flower.heli) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.leaf.vs.flower</strong></td>
<td align="center">36265</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-2" class="section level4">
<h4>Pair-wise p-values</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat.heli, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA.heli, <span class="dt">y=</span>VislistB.heli, <span class="dt">fill=</span>leaf.vs.flower)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA.heli, VislistB.heli, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(leaf.vs.flower, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.leaf.vs.flower)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p></br> </br></p>
</div>
<div id="original-model-output-2" class="section level4">
<h4>Original model output</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.leaf.vs.flower.heli</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.leaf.vs.flower + (1 | patch2) + (1 | 
##     patch1), data = compare.leaf.vs.flower.heli, REML = F)
## 
## Linear Hypotheses:
##                                                      Estimate Std. Error
## heli600.leaf.vs.flower - heli580.leaf.vs.flower == 0  0.41766    0.01140
## heli620.leaf.vs.flower - heli580.leaf.vs.flower == 0  1.12981    0.01140
## heli640.leaf.vs.flower - heli580.leaf.vs.flower == 0  1.72481    0.01140
## heli660.leaf.vs.flower - heli580.leaf.vs.flower == 0  1.68946    0.01140
## heli620.leaf.vs.flower - heli600.leaf.vs.flower == 0  0.71215    0.01140
## heli640.leaf.vs.flower - heli600.leaf.vs.flower == 0  1.30715    0.01140
## heli660.leaf.vs.flower - heli600.leaf.vs.flower == 0  1.27181    0.01140
## heli640.leaf.vs.flower - heli620.leaf.vs.flower == 0  0.59500    0.01140
## heli660.leaf.vs.flower - heli620.leaf.vs.flower == 0  0.55965    0.01140
## heli660.leaf.vs.flower - heli640.leaf.vs.flower == 0 -0.03535    0.01140
##                                                      z value Pr(&gt;|z|)    
## heli600.leaf.vs.flower - heli580.leaf.vs.flower == 0  36.637   &lt;2e-16 ***
## heli620.leaf.vs.flower - heli580.leaf.vs.flower == 0  99.108   &lt;2e-16 ***
## heli640.leaf.vs.flower - heli580.leaf.vs.flower == 0 151.302   &lt;2e-16 ***
## heli660.leaf.vs.flower - heli580.leaf.vs.flower == 0 148.201   &lt;2e-16 ***
## heli620.leaf.vs.flower - heli600.leaf.vs.flower == 0  62.471   &lt;2e-16 ***
## heli640.leaf.vs.flower - heli600.leaf.vs.flower == 0 114.665   &lt;2e-16 ***
## heli660.leaf.vs.flower - heli600.leaf.vs.flower == 0 111.564   &lt;2e-16 ***
## heli640.leaf.vs.flower - heli620.leaf.vs.flower == 0  52.194   &lt;2e-16 ***
## heli660.leaf.vs.flower - heli620.leaf.vs.flower == 0  49.093   &lt;2e-16 ***
## heli660.leaf.vs.flower - heli640.leaf.vs.flower == 0  -3.101   0.0193 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
</div>
<div id="leaf-vs-beetle" class="section level2 tabset tabset-fade tabset-pills">
<h2><strong>Leaf vs Beetle</strong></h2>
<div id="agrilus-planipennis-1" class="section level3 tabset tabset-fade tabset-pills">
<h3><em>Agrilus planipennis</em></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.leaf.vs.beetle.bup) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.leaf.vs.beetle</strong></td>
<td align="center">13682</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-3" class="section level4">
<h4>Pair-wise p-values</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat.bup, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA.bup, <span class="dt">y=</span>VislistB.bup, <span class="dt">fill=</span>leaf.vs.beetle)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA.bup, VislistB.bup, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(leaf.vs.beetle, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.leaf.vs.beetle))) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p></br> </br></p>
</div>
<div id="original-model-output-3" class="section level4">
<h4>Original model output</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.leaf.vs.beetle.bup</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.leaf.vs.beetle + (1 | patch2) + (1 | 
##     patch1), data = compare.leaf.vs.beetle.bup, REML = F)
## 
## Linear Hypotheses:
##                                                    Estimate Std. Error z value
## bup600.leaf.vs.beetle - bup580.leaf.vs.beetle == 0  0.78343    0.02537   30.88
## bup620.leaf.vs.beetle - bup580.leaf.vs.beetle == 0  1.62883    0.02537   64.20
## bup640.leaf.vs.beetle - bup580.leaf.vs.beetle == 0  2.26393    0.02537   89.23
## bup660.leaf.vs.beetle - bup580.leaf.vs.beetle == 0  2.52825    0.02537   99.65
## bup620.leaf.vs.beetle - bup600.leaf.vs.beetle == 0  0.84540    0.02537   33.32
## bup640.leaf.vs.beetle - bup600.leaf.vs.beetle == 0  1.48050    0.02537   58.35
## bup660.leaf.vs.beetle - bup600.leaf.vs.beetle == 0  1.74482    0.02537   68.77
## bup640.leaf.vs.beetle - bup620.leaf.vs.beetle == 0  0.63510    0.02537   25.03
## bup660.leaf.vs.beetle - bup620.leaf.vs.beetle == 0  0.89943    0.02537   35.45
## bup660.leaf.vs.beetle - bup640.leaf.vs.beetle == 0  0.26432    0.02537   10.42
##                                                    Pr(&gt;|z|)    
## bup600.leaf.vs.beetle - bup580.leaf.vs.beetle == 0   &lt;2e-16 ***
## bup620.leaf.vs.beetle - bup580.leaf.vs.beetle == 0   &lt;2e-16 ***
## bup640.leaf.vs.beetle - bup580.leaf.vs.beetle == 0   &lt;2e-16 ***
## bup660.leaf.vs.beetle - bup580.leaf.vs.beetle == 0   &lt;2e-16 ***
## bup620.leaf.vs.beetle - bup600.leaf.vs.beetle == 0   &lt;2e-16 ***
## bup640.leaf.vs.beetle - bup600.leaf.vs.beetle == 0   &lt;2e-16 ***
## bup660.leaf.vs.beetle - bup600.leaf.vs.beetle == 0   &lt;2e-16 ***
## bup640.leaf.vs.beetle - bup620.leaf.vs.beetle == 0   &lt;2e-16 ***
## bup660.leaf.vs.beetle - bup620.leaf.vs.beetle == 0   &lt;2e-16 ***
## bup660.leaf.vs.beetle - bup640.leaf.vs.beetle == 0   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
<div id="papilio-xuthus-1" class="section level3 tabset tabset-fade tabset-pills">
<h3><em>Papilio xuthus</em></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.leaf.vs.beetle.pap) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.leaf.vs.beetle</strong></td>
<td align="center">23492</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-4" class="section level4">
<h4>Pair-wise p-values</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat.pap, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA.pap, <span class="dt">y=</span>VislistB.pap, <span class="dt">fill=</span>leaf.vs.beetle)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA.pap, VislistB.pap, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(leaf.vs.beetle, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.leaf.vs.beetle))) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p></br> </br></p>
</div>
<div id="original-model-output-4" class="section level4">
<h4>Original model output</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.leaf.vs.beetle.pap</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.leaf.vs.beetle + (1 | patch2) + (1 | 
##     patch1), data = compare.leaf.vs.beetle.pap, REML = F)
## 
## Linear Hypotheses:
##                                                    Estimate Std. Error z value
## pap600.leaf.vs.beetle - pap580.leaf.vs.beetle == 0   0.9245     0.0219   42.22
## pap620.leaf.vs.beetle - pap580.leaf.vs.beetle == 0   1.8772     0.0219   85.72
## pap640.leaf.vs.beetle - pap580.leaf.vs.beetle == 0   2.5745     0.0219  117.56
## pap660.leaf.vs.beetle - pap580.leaf.vs.beetle == 0   2.8658     0.0219  130.86
## pap620.leaf.vs.beetle - pap600.leaf.vs.beetle == 0   0.9527     0.0219   43.50
## pap640.leaf.vs.beetle - pap600.leaf.vs.beetle == 0   1.6500     0.0219   75.34
## pap660.leaf.vs.beetle - pap600.leaf.vs.beetle == 0   1.9413     0.0219   88.65
## pap640.leaf.vs.beetle - pap620.leaf.vs.beetle == 0   0.6973     0.0219   31.84
## pap660.leaf.vs.beetle - pap620.leaf.vs.beetle == 0   0.9886     0.0219   45.14
## pap660.leaf.vs.beetle - pap640.leaf.vs.beetle == 0   0.2913     0.0219   13.30
##                                                    Pr(&gt;|z|)    
## pap600.leaf.vs.beetle - pap580.leaf.vs.beetle == 0   &lt;2e-16 ***
## pap620.leaf.vs.beetle - pap580.leaf.vs.beetle == 0   &lt;2e-16 ***
## pap640.leaf.vs.beetle - pap580.leaf.vs.beetle == 0   &lt;2e-16 ***
## pap660.leaf.vs.beetle - pap580.leaf.vs.beetle == 0   &lt;2e-16 ***
## pap620.leaf.vs.beetle - pap600.leaf.vs.beetle == 0   &lt;2e-16 ***
## pap640.leaf.vs.beetle - pap600.leaf.vs.beetle == 0   &lt;2e-16 ***
## pap660.leaf.vs.beetle - pap600.leaf.vs.beetle == 0   &lt;2e-16 ***
## pap640.leaf.vs.beetle - pap620.leaf.vs.beetle == 0   &lt;2e-16 ***
## pap660.leaf.vs.beetle - pap620.leaf.vs.beetle == 0   &lt;2e-16 ***
## pap660.leaf.vs.beetle - pap640.leaf.vs.beetle == 0   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
<div id="heliconius-sp-1" class="section level3 tabset tabset-fade tabset-pills">
<h3><em>Heliconius</em> sp</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.leaf.vs.beetle.heli) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.leaf.vs.beetle</strong></td>
<td align="center">20864</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-5" class="section level4">
<h4>Pair-wise p-values</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat.heli, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA.heli, <span class="dt">y=</span>VislistB.heli, <span class="dt">fill=</span>leaf.vs.beetle)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA.heli, VislistB.heli, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(leaf.vs.beetle, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.leaf.vs.beetle))) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p></br> </br></p>
</div>
<div id="original-model-output-5" class="section level4">
<h4>Original model output</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.leaf.vs.beetle.heli</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.leaf.vs.beetle + (1 | patch2) + (1 | 
##     patch1), data = compare.leaf.vs.beetle.heli, REML = F)
## 
## Linear Hypotheses:
##                                                      Estimate Std. Error
## heli600.leaf.vs.beetle - heli580.leaf.vs.beetle == 0  0.60569    0.01519
## heli620.leaf.vs.beetle - heli580.leaf.vs.beetle == 0  1.22235    0.01519
## heli640.leaf.vs.beetle - heli580.leaf.vs.beetle == 0  1.67850    0.01519
## heli660.leaf.vs.beetle - heli580.leaf.vs.beetle == 0  1.87806    0.01519
## heli620.leaf.vs.beetle - heli600.leaf.vs.beetle == 0  0.61666    0.01519
## heli640.leaf.vs.beetle - heli600.leaf.vs.beetle == 0  1.07281    0.01519
## heli660.leaf.vs.beetle - heli600.leaf.vs.beetle == 0  1.27237    0.01519
## heli640.leaf.vs.beetle - heli620.leaf.vs.beetle == 0  0.45615    0.01519
## heli660.leaf.vs.beetle - heli620.leaf.vs.beetle == 0  0.65571    0.01519
## heli660.leaf.vs.beetle - heli640.leaf.vs.beetle == 0  0.19956    0.01519
##                                                      z value Pr(&gt;|z|)    
## heli600.leaf.vs.beetle - heli580.leaf.vs.beetle == 0   39.88   &lt;2e-16 ***
## heli620.leaf.vs.beetle - heli580.leaf.vs.beetle == 0   80.48   &lt;2e-16 ***
## heli640.leaf.vs.beetle - heli580.leaf.vs.beetle == 0  110.51   &lt;2e-16 ***
## heli660.leaf.vs.beetle - heli580.leaf.vs.beetle == 0  123.65   &lt;2e-16 ***
## heli620.leaf.vs.beetle - heli600.leaf.vs.beetle == 0   40.60   &lt;2e-16 ***
## heli640.leaf.vs.beetle - heli600.leaf.vs.beetle == 0   70.63   &lt;2e-16 ***
## heli660.leaf.vs.beetle - heli600.leaf.vs.beetle == 0   83.77   &lt;2e-16 ***
## heli640.leaf.vs.beetle - heli620.leaf.vs.beetle == 0   30.03   &lt;2e-16 ***
## heli660.leaf.vs.beetle - heli620.leaf.vs.beetle == 0   43.17   &lt;2e-16 ***
## heli660.leaf.vs.beetle - heli640.leaf.vs.beetle == 0   13.14   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
</div>
<div id="beetle-vs-flower" class="section level2 tabset tabset-fade tabset-pills">
<h2><strong>Beetle vs Flower</strong></h2>
<div id="agrilus-planipennis-2" class="section level3 tabset tabset-fade tabset-pills">
<h3><em>Agrilus planipennis</em></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.flower.vs.beetle.bup) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:78%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="43%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.flower.vs.beetle</strong></td>
<td align="center">3286</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-6" class="section level4">
<h4>Pair-wise p-values</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat.bup, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA.bup, <span class="dt">y=</span>VislistB.bup, <span class="dt">fill=</span>flower.vs.beetle)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA.bup, VislistB.bup, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(flower.vs.beetle, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.flower.vs.beetle)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour </span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-28-1.png" width="672" /> </br> </br></p>
</div>
<div id="original-model-output-6" class="section level4">
<h4>Original model output</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.flower.vs.beetle.bup</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.flower.vs.beetle + (1 | patch2) + 
##     (1 | patch1), data = compare.flower.vs.beetle.bup, REML = F)
## 
## Linear Hypotheses:
##                                                        Estimate Std. Error
## bup600.flower.vs.beetle - bup580.flower.vs.beetle == 0  0.51295    0.03801
## bup620.flower.vs.beetle - bup580.flower.vs.beetle == 0  1.09066    0.03801
## bup640.flower.vs.beetle - bup580.flower.vs.beetle == 0  1.55818    0.03801
## bup660.flower.vs.beetle - bup580.flower.vs.beetle == 0  1.90435    0.03801
## bup620.flower.vs.beetle - bup600.flower.vs.beetle == 0  0.57771    0.03801
## bup640.flower.vs.beetle - bup600.flower.vs.beetle == 0  1.04523    0.03801
## bup660.flower.vs.beetle - bup600.flower.vs.beetle == 0  1.39140    0.03801
## bup640.flower.vs.beetle - bup620.flower.vs.beetle == 0  0.46752    0.03801
## bup660.flower.vs.beetle - bup620.flower.vs.beetle == 0  0.81369    0.03801
## bup660.flower.vs.beetle - bup640.flower.vs.beetle == 0  0.34617    0.03801
##                                                        z value Pr(&gt;|z|)    
## bup600.flower.vs.beetle - bup580.flower.vs.beetle == 0  13.494   &lt;2e-16 ***
## bup620.flower.vs.beetle - bup580.flower.vs.beetle == 0  28.692   &lt;2e-16 ***
## bup640.flower.vs.beetle - bup580.flower.vs.beetle == 0  40.991   &lt;2e-16 ***
## bup660.flower.vs.beetle - bup580.flower.vs.beetle == 0  50.098   &lt;2e-16 ***
## bup620.flower.vs.beetle - bup600.flower.vs.beetle == 0  15.198   &lt;2e-16 ***
## bup640.flower.vs.beetle - bup600.flower.vs.beetle == 0  27.497   &lt;2e-16 ***
## bup660.flower.vs.beetle - bup600.flower.vs.beetle == 0  36.604   &lt;2e-16 ***
## bup640.flower.vs.beetle - bup620.flower.vs.beetle == 0  12.299   &lt;2e-16 ***
## bup660.flower.vs.beetle - bup620.flower.vs.beetle == 0  21.406   &lt;2e-16 ***
## bup660.flower.vs.beetle - bup640.flower.vs.beetle == 0   9.107   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
<div id="papilio-xuthus-2" class="section level3 tabset tabset-fade tabset-pills">
<h3><em>Papilio xuthus</em></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.flower.vs.beetle.pap) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:78%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="43%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.flower.vs.beetle</strong></td>
<td align="center">6287</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-7" class="section level4">
<h4>Pair-wise p-values</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat.pap, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA.pap, <span class="dt">y=</span>VislistB.pap, <span class="dt">fill=</span>flower.vs.beetle)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA.pap, VislistB.pap, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(flower.vs.beetle, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.flower.vs.beetle)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour </span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p></br> </br></p>
</div>
<div id="original-model-output-7" class="section level4">
<h4>Original model output</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.flower.vs.beetle.pap</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.flower.vs.beetle + (1 | patch2) + 
##     (1 | patch1), data = compare.flower.vs.beetle.pap, REML = F)
## 
## Linear Hypotheses:
##                                                        Estimate Std. Error
## pap600.flower.vs.beetle - pap580.flower.vs.beetle == 0  0.70965    0.03564
## pap620.flower.vs.beetle - pap580.flower.vs.beetle == 0  1.46083    0.03564
## pap640.flower.vs.beetle - pap580.flower.vs.beetle == 0  2.04391    0.03564
## pap660.flower.vs.beetle - pap580.flower.vs.beetle == 0  2.47570    0.03564
## pap620.flower.vs.beetle - pap600.flower.vs.beetle == 0  0.75118    0.03564
## pap640.flower.vs.beetle - pap600.flower.vs.beetle == 0  1.33426    0.03564
## pap660.flower.vs.beetle - pap600.flower.vs.beetle == 0  1.76605    0.03564
## pap640.flower.vs.beetle - pap620.flower.vs.beetle == 0  0.58308    0.03564
## pap660.flower.vs.beetle - pap620.flower.vs.beetle == 0  1.01487    0.03564
## pap660.flower.vs.beetle - pap640.flower.vs.beetle == 0  0.43179    0.03564
##                                                        z value Pr(&gt;|z|)    
## pap600.flower.vs.beetle - pap580.flower.vs.beetle == 0   19.91   &lt;2e-16 ***
## pap620.flower.vs.beetle - pap580.flower.vs.beetle == 0   40.99   &lt;2e-16 ***
## pap640.flower.vs.beetle - pap580.flower.vs.beetle == 0   57.35   &lt;2e-16 ***
## pap660.flower.vs.beetle - pap580.flower.vs.beetle == 0   69.47   &lt;2e-16 ***
## pap620.flower.vs.beetle - pap600.flower.vs.beetle == 0   21.08   &lt;2e-16 ***
## pap640.flower.vs.beetle - pap600.flower.vs.beetle == 0   37.44   &lt;2e-16 ***
## pap660.flower.vs.beetle - pap600.flower.vs.beetle == 0   49.55   &lt;2e-16 ***
## pap640.flower.vs.beetle - pap620.flower.vs.beetle == 0   16.36   &lt;2e-16 ***
## pap660.flower.vs.beetle - pap620.flower.vs.beetle == 0   28.48   &lt;2e-16 ***
## pap660.flower.vs.beetle - pap640.flower.vs.beetle == 0   12.12   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
<div id="heliconius-sp-2" class="section level3 tabset tabset-fade tabset-pills">
<h3><em>Heliconius</em> sp</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.flower.vs.beetle.heli) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:78%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="43%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.flower.vs.beetle</strong></td>
<td align="center">5680</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-8" class="section level4">
<h4>Pair-wise p-values</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat.heli, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA.heli, <span class="dt">y=</span>VislistB.heli, <span class="dt">fill=</span>flower.vs.beetle)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA.heli, VislistB.heli, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(flower.vs.beetle, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.flower.vs.beetle)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour </span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p></br> </br></p>
</div>
<div id="original-model-output-8" class="section level4">
<h4>Original model output</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.flower.vs.beetle.heli</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.flower.vs.beetle + (1 | patch2) + 
##     (1 | patch1), data = compare.flower.vs.beetle.heli, REML = F)
## 
## Linear Hypotheses:
##                                                          Estimate Std. Error
## heli600.flower.vs.beetle - heli580.flower.vs.beetle == 0  0.43550    0.02327
## heli620.flower.vs.beetle - heli580.flower.vs.beetle == 0  0.89992    0.02327
## heli640.flower.vs.beetle - heli580.flower.vs.beetle == 0  1.26637    0.02327
## heli660.flower.vs.beetle - heli580.flower.vs.beetle == 0  1.53563    0.02327
## heli620.flower.vs.beetle - heli600.flower.vs.beetle == 0  0.46443    0.02327
## heli640.flower.vs.beetle - heli600.flower.vs.beetle == 0  0.83087    0.02327
## heli660.flower.vs.beetle - heli600.flower.vs.beetle == 0  1.10013    0.02327
## heli640.flower.vs.beetle - heli620.flower.vs.beetle == 0  0.36645    0.02327
## heli660.flower.vs.beetle - heli620.flower.vs.beetle == 0  0.63571    0.02327
## heli660.flower.vs.beetle - heli640.flower.vs.beetle == 0  0.26926    0.02327
##                                                          z value Pr(&gt;|z|)    
## heli600.flower.vs.beetle - heli580.flower.vs.beetle == 0   18.72   &lt;2e-16 ***
## heli620.flower.vs.beetle - heli580.flower.vs.beetle == 0   38.67   &lt;2e-16 ***
## heli640.flower.vs.beetle - heli580.flower.vs.beetle == 0   54.42   &lt;2e-16 ***
## heli660.flower.vs.beetle - heli580.flower.vs.beetle == 0   65.99   &lt;2e-16 ***
## heli620.flower.vs.beetle - heli600.flower.vs.beetle == 0   19.96   &lt;2e-16 ***
## heli640.flower.vs.beetle - heli600.flower.vs.beetle == 0   35.71   &lt;2e-16 ***
## heli660.flower.vs.beetle - heli600.flower.vs.beetle == 0   47.28   &lt;2e-16 ***
## heli640.flower.vs.beetle - heli620.flower.vs.beetle == 0   15.75   &lt;2e-16 ***
## heli660.flower.vs.beetle - heli620.flower.vs.beetle == 0   27.32   &lt;2e-16 ***
## heli660.flower.vs.beetle - heli640.flower.vs.beetle == 0   11.57   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
</div>
</div>
<div id="plot-the-contrasts" class="section level1 tabset tabset-fade tabset-pills">
<h1>Plot the contrasts</h1>
<ul>
<li>Colours approximate human perception of either flower (left and right) or beetle (centre) colouration.</li>
<li>Lines of the same colors connect the same sample</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#combine all contrast value in each comparison group</span>
##for Agrilus planipennis
###flower vs leaf
Vis1.lf.bup&lt;-<span class="st"> </span>Cbuprest580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis1.lf.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.lf&quot;</span>,<span class="dv">1</span>)
Vis2.lf.bup&lt;-Cbuprest600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis2.lf.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.lf&quot;</span>,<span class="dv">1</span>)
Vis3.lf.bup&lt;-Cbuprest620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis3.lf.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.lf&quot;</span>,<span class="dv">1</span>)
Vis4.lf.bup&lt;-Cbuprest640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis4.lf.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.lf&quot;</span>,<span class="dv">1</span>)
Vis5.lf.bup&lt;-Cbuprest660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis5.lf.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis5.lf&quot;</span>,<span class="dv">1</span>)

allvis.lf.bup&lt;-Vis1.lf.bup <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.lf.bup) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.lf.bup) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Vis4.lf.bup) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis5.lf.bup) 

###beetle vs leaf
Vis1.lb.bup&lt;-<span class="st"> </span>Cbuprest580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis1.lb.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.lb&quot;</span>,<span class="dv">1</span>)
Vis2.lb.bup&lt;-Cbuprest600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis2.lb.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.lb&quot;</span>,<span class="dv">1</span>)
Vis3.lb.bup&lt;-Cbuprest620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis3.lb.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.lb&quot;</span>,<span class="dv">1</span>)
Vis4.lb.bup&lt;-Cbuprest640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis4.lb.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.lb&quot;</span>,<span class="dv">1</span>)
Vis5.lb.bup&lt;-Cbuprest660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis5.lb.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis5.lb&quot;</span>,<span class="dv">1</span>)

allvis.lb.bup&lt;-Vis1.lb.bup <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.lb.bup) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.lb.bup) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Vis4.lb.bup) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis5.lb.bup)

###beetle vs flower
Vis1.bf.bup&lt;-<span class="st"> </span>Cbuprest580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis1.bf.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.bf&quot;</span>,<span class="dv">1</span>)
Vis2.bf.bup&lt;-Cbuprest600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis2.bf.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.bf&quot;</span>,<span class="dv">1</span>)
Vis3.bf.bup&lt;-Cbuprest620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis3.bf.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.bf&quot;</span>,<span class="dv">1</span>)
Vis4.bf.bup&lt;-Cbuprest640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis4.bf.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.bf&quot;</span>,<span class="dv">1</span>)
Vis5.bf.bup&lt;-Cbuprest660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis5.bf.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis5.bf&quot;</span>,<span class="dv">1</span>)

allvis.bf.bup&lt;-Vis1.bf.bup <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.bf.bup) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.bf.bup) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Vis4.bf.bup) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis5.bf.bup) 



##for Papilio xuthus
###flower vs leaf
Vis1.lf.pap&lt;-<span class="st"> </span>Cpapilio580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis1.lf.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.lf&quot;</span>,<span class="dv">1</span>)
Vis2.lf.pap&lt;-Cpapilio600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis2.lf.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.lf&quot;</span>,<span class="dv">1</span>)
Vis3.lf.pap&lt;-Cpapilio620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis3.lf.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.lf&quot;</span>,<span class="dv">1</span>)
Vis4.lf.pap&lt;-Cpapilio640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis4.lf.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.lf&quot;</span>,<span class="dv">1</span>)
Vis5.lf.pap&lt;-Cpapilio660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis5.lf.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis5.lf&quot;</span>,<span class="dv">1</span>)


allvis.lf.pap&lt;-Vis1.lf.pap <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.lf.pap) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.lf.pap) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Vis4.lf.pap) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis5.lf.pap) 

###beetle vs leaf
Vis1.lb.pap&lt;-<span class="st"> </span>Cpapilio580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis1.lb.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.lb&quot;</span>,<span class="dv">1</span>)
Vis2.lb.pap&lt;-Cpapilio600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis2.lb.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.lb&quot;</span>,<span class="dv">1</span>)
Vis3.lb.pap&lt;-Cpapilio620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis3.lb.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.lb&quot;</span>,<span class="dv">1</span>)
Vis4.lb.pap&lt;-Cpapilio640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis4.lb.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.lb&quot;</span>,<span class="dv">1</span>)
Vis5.lb.pap&lt;-Cpapilio660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis5.lb.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis5.lb&quot;</span>,<span class="dv">1</span>)


allvis.lb.pap&lt;-Vis1.lb.pap <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.lb.pap) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.lb.pap) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Vis4.lb.pap) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis5.lb.pap) 

###beetle vs flower
Vis1.bf.pap&lt;-<span class="st"> </span>Cpapilio580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis1.bf.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.bf&quot;</span>,<span class="dv">1</span>)
Vis2.bf.pap&lt;-Cpapilio600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis2.bf.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.bf&quot;</span>,<span class="dv">1</span>)
Vis3.bf.pap&lt;-Cpapilio620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis3.bf.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.bf&quot;</span>,<span class="dv">1</span>)
Vis4.bf.pap&lt;-Cpapilio640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis4.bf.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.bf&quot;</span>,<span class="dv">1</span>)
Vis5.bf.pap&lt;-Cpapilio660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis5.bf.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis5.bf&quot;</span>,<span class="dv">1</span>)

allvis.bf.pap&lt;-Vis1.bf.pap <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.bf.pap) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.bf.pap) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Vis4.bf.pap) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis5.bf.pap) 




##for Heliconius sp
###flower vs leaf
Vis1.lf.heli&lt;-<span class="st"> </span>Cheliconius580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis1.lf.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.lf&quot;</span>,<span class="dv">1</span>)
Vis2.lf.heli&lt;-Cheliconius600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis2.lf.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.lf&quot;</span>,<span class="dv">1</span>)
Vis3.lf.heli&lt;-Cheliconius620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis3.lf.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.lf&quot;</span>,<span class="dv">1</span>)
Vis4.lf.heli&lt;-Cheliconius640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis4.lf.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.lf&quot;</span>,<span class="dv">1</span>)
Vis5.lf.heli&lt;-Cheliconius660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis5.lf.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis5.lf&quot;</span>,<span class="dv">1</span>)


allvis.lf.heli&lt;-Vis1.lf.heli <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.lf.heli) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.lf.heli) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Vis4.lf.heli) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis5.lf.heli) 

###beetle vs leaf
Vis1.lb.heli&lt;-<span class="st"> </span>Cheliconius580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis1.lb.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.lb&quot;</span>,<span class="dv">1</span>)
Vis2.lb.heli&lt;-Cheliconius600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis2.lb.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.lb&quot;</span>,<span class="dv">1</span>)
Vis3.lb.heli&lt;-Cheliconius620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis3.lb.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.lb&quot;</span>,<span class="dv">1</span>)
Vis4.lb.heli&lt;-Cheliconius640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis4.lb.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.lb&quot;</span>,<span class="dv">1</span>)
Vis5.lb.heli&lt;-Cheliconius660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis5.lb.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis5.lb&quot;</span>,<span class="dv">1</span>)


allvis.lb.heli&lt;-Vis1.lb.heli <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.lb.heli) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.lb.heli) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Vis4.lb.heli) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis5.lb.heli) 

###beetle vs flower
Vis1.bf.heli&lt;-<span class="st"> </span>Cheliconius580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis1.bf.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.bf&quot;</span>,<span class="dv">1</span>)
Vis2.bf.heli&lt;-Cheliconius600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis2.bf.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.bf&quot;</span>,<span class="dv">1</span>)
Vis3.bf.heli&lt;-Cheliconius620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis3.bf.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.bf&quot;</span>,<span class="dv">1</span>)
Vis4.bf.heli&lt;-Cheliconius640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis4.bf.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.bf&quot;</span>,<span class="dv">1</span>)
Vis5.bf.heli&lt;-Cheliconius660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis5.bf.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis5.bf&quot;</span>,<span class="dv">1</span>)

allvis.bf.heli&lt;-Vis1.bf.heli <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.bf.heli) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.bf.heli) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Vis4.bf.heli) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis5.bf.heli) </code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#import the flower color code </span>
color.code&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;data/color code list.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) 

<span class="co">#creat a list of species name used in the spec data and </span>
name.list&lt;-<span class="kw">unique</span>(dataset.transpose<span class="op">$</span>species) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">sort</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#order it alphebatically as well</span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">species =</span> <span class="st">&quot;.&quot;</span>)<span class="co">#make it a data frame and name the column &quot;species&quot;</span>

<span class="co">#creat flower name list</span>
flower.colour &lt;-<span class="st"> </span>name.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(species, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower names</span>
<span class="st">  </span><span class="kw">cbind</span>(color.code <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(type, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(name)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower color codes and order it alphebatically</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#remove the redundant column</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">uncount</span>(count) <span class="co">#repeat each row for 5 times for 5 visual systems</span>

<span class="co">#creat beetle name list</span>

beetle.colour&lt;-<span class="st"> </span>name.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(species, <span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower names</span>
<span class="st">  </span><span class="kw">cbind</span>(color.code <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(type, <span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(name)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower color codes and order it alphebatically</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#remove the redundant column</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">uncount</span>(count) <span class="co">#repeat each row for 5 times for 5 visual systems</span></code></pre></div>
<div id="agrilus-planipennis-3" class="section level2">
<h2><em>Agrilus planipennis</em></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#make flower vs leaf plot</span>
##add the mean
mean.lf.bup&lt;-allvis.lf.bup <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.lf.bup<span class="op">$</span>vissys,allvis.lf.bup<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.lf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

##plot the mean
<span class="kw">names</span>(mean.lf.bup)[<span class="kw">names</span>(mean.lf.bup) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span> 
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.lf.bup&lt;-mean.lf.bup[<span class="kw">order</span>(mean.lf.bup<span class="op">$</span>flowerID),] 
<span class="co">#make the data frame order by flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.lf.bup<span class="op">$</span>match.name&lt;-flower.colour<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.lf.bup<span class="op">$</span>colour&lt;-flower.colour<span class="op">$</span>colour

lf.bup&lt;-<span class="kw">ggplot</span>(mean.lf.bup, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.lf,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.lf.bup<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.lf.bup<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lf&quot;</span>, <span class="st">&quot;Vis2.lf&quot;</span>, <span class="st">&quot;Vis3.lf&quot;</span>,<span class="st">&quot;Vis4.lf&quot;</span>,<span class="st">&quot;Vis5.lf&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.lf.bup<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.lf.bup<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.lf.bup<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.lf.bup<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis5.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis5.lf.bup<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Leaf vs. Flower&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lf&quot;</span>, <span class="st">&quot;Vis2.lf&quot;</span>, <span class="st">&quot;Vis3.lf&quot;</span>,<span class="st">&quot;Vis4.lf&quot;</span>,<span class="st">&quot;Vis5.lf&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;d&quot;</span>)) <span class="co">#add stitistical info</span>


<span class="co">#make beetle vs leaf plot</span>
##add the mean
mean.lb.bup&lt;-allvis.lb.bup <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.lb.bup<span class="op">$</span>vissys,allvis.lb.bup<span class="op">$</span>patch2,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch2(beetles) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.lb=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

##plot the mean
<span class="kw">names</span>(mean.lb.bup)[<span class="kw">names</span>(mean.lb.bup) <span class="op">==</span><span class="st"> &quot;patch2&quot;</span>] &lt;-<span class="st"> &quot;beetleID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.lb.bup&lt;-mean.lb.bup[<span class="kw">order</span>(mean.lb.bup<span class="op">$</span>beetleID),]
<span class="co">#make the data frame order bt beetleID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.lb.bup<span class="op">$</span>match.name&lt;-beetle.colour<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.lb.bup<span class="op">$</span>colour&lt;-beetle.colour<span class="op">$</span>colour


lb.bup&lt;-<span class="kw">ggplot</span>(mean.lb.bup, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.lb,<span class="dt">group=</span>beetleID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.lb.bup<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.lb.bup<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lb&quot;</span>, <span class="st">&quot;Vis2.lb&quot;</span>, <span class="st">&quot;Vis3.lb&quot;</span>,<span class="st">&quot;Vis4.lb&quot;</span>,<span class="st">&quot;Vis5.lb&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.lb.bup<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.lb.bup<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.lb.bup<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.lb.bup<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis5.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis5.lb.bup<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Leaf vs. Beetle&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lb&quot;</span>, <span class="st">&quot;Vis2.lb&quot;</span>, <span class="st">&quot;Vis3.lb&quot;</span>,<span class="st">&quot;Vis4.lb&quot;</span>,<span class="st">&quot;Vis5.lb&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add stitistical info</span>


<span class="co">#make beetle vs flower plot</span>
##add the mean
mean.bf.bup&lt;-allvis.bf.bup <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bf.bup<span class="op">$</span>vissys,allvis.bf.bup<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#patch1(flowers</span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>


##plot the mean dS
<span class="kw">names</span>(mean.bf.bup)[<span class="kw">names</span>(mean.bf.bup) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.bf.bup&lt;-mean.bf.bup[<span class="kw">order</span>(mean.bf.bup<span class="op">$</span>flowerID),]
<span class="co">#make the data frame order bt flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.bf.bup<span class="op">$</span>match.name&lt;-flower.colour<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.bf.bup<span class="op">$</span>colour&lt;-flower.colour<span class="op">$</span>colour

bf.bup&lt;-<span class="kw">ggplot</span>(mean.bf.bup, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bf,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bf.bup<span class="op">$</span>colour, <span class="dt">size=</span><span class="dv">3</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bf.bup<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.bf&quot;</span>, <span class="st">&quot;Vis2.bf&quot;</span>, <span class="st">&quot;Vis3.bf&quot;</span>,<span class="st">&quot;Vis4.bf&quot;</span>,<span class="st">&quot;Vis5.bf&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.bf.bup<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.bf.bup<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.bf.bup<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.bf.bup<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis5.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis5.bf.bup<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Flower&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.bf&quot;</span>, <span class="st">&quot;Vis2.bf&quot;</span>, <span class="st">&quot;Vis3.bf&quot;</span>,<span class="st">&quot;Vis4.bf&quot;</span>,<span class="st">&quot;Vis5.bf&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add stitistical info</span>


figure.bup &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(lf.bup,lb.bup,bf.bup, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)
figure.bup</code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-38-1.png" width="672" /> </br> </br></p>
</div>
<div id="papilio-xuthus-3" class="section level2">
<h2><em>Papilio xuthus</em></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#make flower vs leaf plot</span>
##add the mean
mean.lf.pap&lt;-allvis.lf.pap <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.lf.pap<span class="op">$</span>vissys,allvis.lf.pap<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.lf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

##plot the mean
<span class="kw">names</span>(mean.lf.pap)[<span class="kw">names</span>(mean.lf.pap) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span> 
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.lf.pap&lt;-mean.lf.pap[<span class="kw">order</span>(mean.lf.pap<span class="op">$</span>flowerID),] 
<span class="co">#make the data frame order by flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.lf.pap<span class="op">$</span>match.name&lt;-flower.colour<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.lf.pap<span class="op">$</span>colour&lt;-flower.colour<span class="op">$</span>colour

lf.pap&lt;-<span class="kw">ggplot</span>(mean.lf.pap, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.lf,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.lf.pap<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.lf.pap<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lf&quot;</span>, <span class="st">&quot;Vis2.lf&quot;</span>, <span class="st">&quot;Vis3.lf&quot;</span>,<span class="st">&quot;Vis4.lf&quot;</span>,<span class="st">&quot;Vis5.lf&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.lf.pap<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.lf.pap<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.lf.pap<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.lf.pap<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis5.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis5.lf.pap<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Leaf vs. Flower&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lf&quot;</span>, <span class="st">&quot;Vis2.lf&quot;</span>, <span class="st">&quot;Vis3.lf&quot;</span>,<span class="st">&quot;Vis4.lf&quot;</span>,<span class="st">&quot;Vis5.lf&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;d&quot;</span>)) <span class="co">#add stitistical info</span>


<span class="co">#make beetle vs leaf plot</span>
##add the mean
mean.lb.pap&lt;-allvis.lb.pap <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.lb.pap<span class="op">$</span>vissys,allvis.lb.pap<span class="op">$</span>patch2,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch2(beetles) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.lb=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

##plot the mean
<span class="kw">names</span>(mean.lb.pap)[<span class="kw">names</span>(mean.lb.pap) <span class="op">==</span><span class="st"> &quot;patch2&quot;</span>] &lt;-<span class="st"> &quot;beetleID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.lb.pap&lt;-mean.lb.pap[<span class="kw">order</span>(mean.lb.pap<span class="op">$</span>beetleID),]
<span class="co">#make the data frame order bt beetleID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.lb.pap<span class="op">$</span>match.name&lt;-beetle.colour<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.lb.pap<span class="op">$</span>colour&lt;-beetle.colour<span class="op">$</span>colour


lb.pap&lt;-<span class="kw">ggplot</span>(mean.lb.pap, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.lb,<span class="dt">group=</span>beetleID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.lb.pap<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.lb.pap<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lb&quot;</span>, <span class="st">&quot;Vis2.lb&quot;</span>, <span class="st">&quot;Vis3.lb&quot;</span>,<span class="st">&quot;Vis4.lb&quot;</span>,<span class="st">&quot;Vis5.lb&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.lb.pap<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.lb.pap<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.lb.pap<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.lb.pap<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis5.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis5.lb.pap<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Leaf vs. Beetle&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lb&quot;</span>, <span class="st">&quot;Vis2.lb&quot;</span>, <span class="st">&quot;Vis3.lb&quot;</span>,<span class="st">&quot;Vis4.lb&quot;</span>,<span class="st">&quot;Vis5.lb&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add stitistical info</span>


<span class="co">#make beetle vs flower plot</span>
##add the mean
mean.bf.pap&lt;-allvis.bf.pap <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bf.pap<span class="op">$</span>vissys,allvis.bf.pap<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#patch1(flowers</span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>


##plot the mean dS
<span class="kw">names</span>(mean.bf.pap)[<span class="kw">names</span>(mean.bf.pap) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.bf.pap&lt;-mean.bf.pap[<span class="kw">order</span>(mean.bf.pap<span class="op">$</span>flowerID),]
<span class="co">#make the data frame order bt flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.bf.pap<span class="op">$</span>match.name&lt;-flower.colour<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.bf.pap<span class="op">$</span>colour&lt;-flower.colour<span class="op">$</span>colour

bf.pap&lt;-<span class="kw">ggplot</span>(mean.bf.pap, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bf,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bf.pap<span class="op">$</span>colour, <span class="dt">size=</span><span class="dv">3</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bf.pap<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.bf&quot;</span>, <span class="st">&quot;Vis2.bf&quot;</span>, <span class="st">&quot;Vis3.bf&quot;</span>,<span class="st">&quot;Vis4.bf&quot;</span>,<span class="st">&quot;Vis5.bf&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.bf.pap<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.bf.pap<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.bf.pap<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.bf.pap<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis5.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis5.bf.pap<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Flower&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.bf&quot;</span>, <span class="st">&quot;Vis2.bf&quot;</span>, <span class="st">&quot;Vis3.bf&quot;</span>,<span class="st">&quot;Vis4.bf&quot;</span>,<span class="st">&quot;Vis5.bf&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add stitistical info</span>


figure.pap &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(lf.pap,lb.pap,bf.pap, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)
figure.pap</code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-39-1.png" width="672" /> </br> </br></p>
</div>
<div id="heliconius-sp-3" class="section level2">
<h2><em>Heliconius</em> sp</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#make flower vs leaf plot</span>
##add the mean
mean.lf.heli&lt;-allvis.lf.heli <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.lf.heli<span class="op">$</span>vissys,allvis.lf.heli<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.lf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

##plot the mean
<span class="kw">names</span>(mean.lf.heli)[<span class="kw">names</span>(mean.lf.heli) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span> 
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.lf.heli&lt;-mean.lf.heli[<span class="kw">order</span>(mean.lf.heli<span class="op">$</span>flowerID),] 
<span class="co">#make the data frame order by flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.lf.heli<span class="op">$</span>match.name&lt;-flower.colour<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.lf.heli<span class="op">$</span>colour&lt;-flower.colour<span class="op">$</span>colour

lf.heli&lt;-<span class="kw">ggplot</span>(mean.lf.heli, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.lf,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.lf.heli<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.lf.heli<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lf&quot;</span>, <span class="st">&quot;Vis2.lf&quot;</span>, <span class="st">&quot;Vis3.lf&quot;</span>,<span class="st">&quot;Vis4.lf&quot;</span>,<span class="st">&quot;Vis5.lf&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.lf.heli<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.lf.heli<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.lf.heli<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.lf.heli<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis5.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis5.lf.heli<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Leaf vs. Flower&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lf&quot;</span>, <span class="st">&quot;Vis2.lf&quot;</span>, <span class="st">&quot;Vis3.lf&quot;</span>,<span class="st">&quot;Vis4.lf&quot;</span>,<span class="st">&quot;Vis5.lf&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add stitistical info</span>


<span class="co">#make beetle vs leaf plot</span>
##add the mean
mean.lb.heli&lt;-allvis.lb.heli <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.lb.heli<span class="op">$</span>vissys,allvis.lb.heli<span class="op">$</span>patch2,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch2(beetles) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.lb=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

##plot the mean
<span class="kw">names</span>(mean.lb.heli)[<span class="kw">names</span>(mean.lb.heli) <span class="op">==</span><span class="st"> &quot;patch2&quot;</span>] &lt;-<span class="st"> &quot;beetleID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.lb.heli&lt;-mean.lb.heli[<span class="kw">order</span>(mean.lb.heli<span class="op">$</span>beetleID),]
<span class="co">#make the data frame order bt beetleID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.lb.heli<span class="op">$</span>match.name&lt;-beetle.colour<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.lb.heli<span class="op">$</span>colour&lt;-beetle.colour<span class="op">$</span>colour


lb.heli&lt;-<span class="kw">ggplot</span>(mean.lb.heli, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.lb,<span class="dt">group=</span>beetleID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.lb.heli<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.lb.heli<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lb&quot;</span>, <span class="st">&quot;Vis2.lb&quot;</span>, <span class="st">&quot;Vis3.lb&quot;</span>,<span class="st">&quot;Vis4.lb&quot;</span>,<span class="st">&quot;Vis5.lb&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.lb.heli<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.lb.heli<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.lb.heli<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.lb.heli<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis5.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis5.lb.heli<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Leaf vs. Beetle&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lb&quot;</span>, <span class="st">&quot;Vis2.lb&quot;</span>, <span class="st">&quot;Vis3.lb&quot;</span>,<span class="st">&quot;Vis4.lb&quot;</span>,<span class="st">&quot;Vis5.lb&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add stitistical info</span>


<span class="co">#make beetle vs flower plot</span>
##add the mean
mean.bf.heli&lt;-allvis.bf.heli <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bf.heli<span class="op">$</span>vissys,allvis.bf.heli<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#patch1(flowers</span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>


##plot the mean dS
<span class="kw">names</span>(mean.bf.heli)[<span class="kw">names</span>(mean.bf.heli) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.bf.heli&lt;-mean.bf.heli[<span class="kw">order</span>(mean.bf.heli<span class="op">$</span>flowerID),]
<span class="co">#make the data frame order bt flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

##combine the colour code list to the mean.bf for ploting
mean.bf.heli<span class="op">$</span>match.name&lt;-flower.colour<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.bf.heli<span class="op">$</span>colour&lt;-flower.colour<span class="op">$</span>colour

bf.heli&lt;-<span class="kw">ggplot</span>(mean.bf.heli, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bf,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bf.heli<span class="op">$</span>colour, <span class="dt">size=</span><span class="dv">3</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bf.heli<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.bf&quot;</span>, <span class="st">&quot;Vis2.bf&quot;</span>, <span class="st">&quot;Vis3.bf&quot;</span>,<span class="st">&quot;Vis4.bf&quot;</span>,<span class="st">&quot;Vis5.bf&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.bf.heli<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.bf.heli<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.bf.heli<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.bf.heli<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis5.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis5.bf.heli<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Flower&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.bf&quot;</span>, <span class="st">&quot;Vis2.bf&quot;</span>, <span class="st">&quot;Vis3.bf&quot;</span>,<span class="st">&quot;Vis4.bf&quot;</span>,<span class="st">&quot;Vis5.bf&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add stitistical info</span>


figure.heli &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(lf.heli,lb.heli,bf.heli, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)
figure.heli</code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-40-1.png" width="672" /> </br> </br></p>
</div>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>The results were qualitatively the same for different photoreceptor ratios among the three comparison groups – contrast increased for LWS photoreceptors with peak sensitivity of 580 to 640 nm (20 nm increments), but there was little or no contrast improvement for LWS peak sensitivities at 660 and 680 nm.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
