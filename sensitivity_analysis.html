<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Sensitivity analysis</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Overview</a>
</li>
<li>
  <a href="main_models.html">Main models</a>
</li>
<li>
  <a href="even_spacing.html">Even spacing</a>
</li>
<li>
  <a href="opsin_shifed_models.html">Opsin-shifted visual systems</a>
</li>
<li>
  <a href="sensitivity_analysis.html">Sensitivity analysis</a>
</li>
<li>
  <a href="behavioural_assay.html">Behavioural assay</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Sensitivity analysis</h1>
<h3 class="subtitle">Supplementary Information</h3>

</div>


<div id="the-aim" class="section level1">
<h1>The aim</h1>
<ul>
<li><p>To test whether the modelling results were sensitive to the photoreceptor ratios used, we repeated these analyses using published ratios that represent the known variation in insects. Specifically, we compared the changes in contrast when shifting the LWS peak from 580 nm to 660 nm between tetrachomat visual systems with different photoreceptor ratios.</p></li>
<li><p>We applied the same modelling method described in the <a href="main_models.html">Main models</a> but using ratios of different insects, including the jewel beetle, <em>Agrilus planipennis</em> (same as the ratio used in the main text; 1.14: 1: 1.26: 1.38; UVS: SWS: MWS: LWS), and two butterflies, <em>Papilio Xuthus</em> (1: 1: 4.08: 2.92) and <em>Heliconius</em> sp. type III (1.00: 1.44: 2.22: 11.11).</p></li>
<li><p>The model parameters and the statistical methods remain the same as described in main text of the paper.</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(pavo)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(stringr)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">library</span>(tidyr) <span class="co">#for gather() function</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">library</span>(lme4)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw">library</span>(car)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">library</span>(multcomp)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="kw">library</span>(boot) <span class="co">#for mean() function</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="kw">library</span>(pander) <span class="co">#for creating tidy tables</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="kw">library</span>(ggpubr) <span class="co">#for ggarrange() function</span></span></code></pre></div>
<div class="figure">
<img src="sensitivity_analysis_files/figure-html/unnamed-chunk-4-1.png" alt="Figure caption: VS 580 to VS 660 were used for the sensitivity analysis" width="672" />
<p class="caption">
Figure caption: VS 580 to VS 660 were used for the sensitivity analysis
</p>
</div>
<p></br> </br></p>
</div>
<div id="data-description" class="section level1">
<h1>Data description</h1>
<p>We used the same spectral data and daylight illumination described in the <a href="main_models.html">Main models</a> section.</p>
<p></br> </br></p>
</div>
<div id="run-the-visual-models" class="section level1">
<h1>Run the visual models</h1>
<ul>
<li><p>We created 3 different visual systems using different receptor ratios from 3 insect species (UVS, SWS, MWS, LWS):</p></li>
<li><p><em>Agrilus planipennis</em>: 1.14, 1, 1.26, 1.38</p></li>
<li><p><em>Papilio xuthus</em>: 1, 1, 4.08, 2.92</p></li>
<li><p><em>Heliconius</em> sp. type III : 1, 1.44, 2.22, 11.11</p></li>
</ul>
<p></br></p>
<ul>
<li><p>We ran the visual models with the same parameter settings and steps as in the <a href="main_models.html">Main models</a>.</p></li>
<li><p>We first calculated the quantum catches, then calculated the contrasts.</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">#Quantum catch calculation</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">#Quantum catch - D65 - Visual model 2</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#shared between 3 species</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>buprest580=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb2-5"><a href="#cb2-5"></a>buprest600=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a>buprest620=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">7</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a>buprest640=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">8</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb2-8"><a href="#cb2-8"></a>buprest660=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">9</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a></span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">##Second: Contrast calculation</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">#Contrast calculation- D65 - Visual model 2</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">#for Agrilus planipennis</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>Cbuprest580 =<span class="st"> </span><span class="kw">coldist</span>(buprest580, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb2-17"><a href="#cb2-17"></a>Cbuprest600 =<span class="st"> </span><span class="kw">coldist</span>(buprest600, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb2-18"><a href="#cb2-18"></a>Cbuprest620 =<span class="st"> </span><span class="kw">coldist</span>(buprest620, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb2-19"><a href="#cb2-19"></a>Cbuprest640 =<span class="st"> </span><span class="kw">coldist</span>(buprest640, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb2-20"><a href="#cb2-20"></a>Cbuprest660 =<span class="st"> </span><span class="kw">coldist</span>(buprest660, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb2-21"><a href="#cb2-21"></a></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="co">#for Papilio xuthus</span></span>
<span id="cb2-23"><a href="#cb2-23"></a>Cpapilio580 =<span class="st"> </span><span class="kw">coldist</span>(buprest580, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">4.08</span>, <span class="fl">2.92</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb2-24"><a href="#cb2-24"></a>Cpapilio600 =<span class="st"> </span><span class="kw">coldist</span>(buprest600, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">4.08</span>, <span class="fl">2.92</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb2-25"><a href="#cb2-25"></a>Cpapilio620 =<span class="st"> </span><span class="kw">coldist</span>(buprest620, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">4.08</span>, <span class="fl">2.92</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb2-26"><a href="#cb2-26"></a>Cpapilio640 =<span class="st"> </span><span class="kw">coldist</span>(buprest640, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">4.08</span>, <span class="fl">2.92</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb2-27"><a href="#cb2-27"></a>Cpapilio660 =<span class="st"> </span><span class="kw">coldist</span>(buprest660, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">4.08</span>, <span class="fl">2.92</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb2-28"><a href="#cb2-28"></a></span>
<span id="cb2-29"><a href="#cb2-29"></a><span class="co">#for Heliconius sp</span></span>
<span id="cb2-30"><a href="#cb2-30"></a>Cheliconius580 =<span class="st"> </span><span class="kw">coldist</span>(buprest580, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.44</span>, <span class="fl">2.22</span>, <span class="fl">11.11</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb2-31"><a href="#cb2-31"></a>Cheliconius600 =<span class="st"> </span><span class="kw">coldist</span>(buprest600, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.44</span>, <span class="fl">2.22</span>, <span class="fl">11.11</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb2-32"><a href="#cb2-32"></a>Cheliconius620 =<span class="st"> </span><span class="kw">coldist</span>(buprest620, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.44</span>, <span class="fl">2.22</span>, <span class="fl">11.11</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb2-33"><a href="#cb2-33"></a>Cheliconius640 =<span class="st"> </span><span class="kw">coldist</span>(buprest640, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.44</span>, <span class="fl">2.22</span>, <span class="fl">11.11</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span>
<span id="cb2-34"><a href="#cb2-34"></a>Cheliconius660 =<span class="st"> </span><span class="kw">coldist</span>(buprest660, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.44</span>, <span class="fl">2.22</span>, <span class="fl">11.11</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</span></code></pre></div>
<p></br></p>
</div>
<div id="compare-contrast" class="section level1 tabset tabset-fade tabset-pills">
<h1>Compare contrast</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">#create different comparison groups for furthur GLMM analysis</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#Organize data before GLMM</span></span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#for Agrilus planipennis</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">##flower vs leaf</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>Cbuprest580.flower.vs.leaf=</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="st">  </span>Cbuprest580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb3-8"><a href="#cb3-8"></a>Cbuprest600.flower.vs.leaf=</span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="st">  </span>Cbuprest600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb3-10"><a href="#cb3-10"></a>Cbuprest620.flower.vs.leaf=</span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="st">  </span>Cbuprest620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb3-12"><a href="#cb3-12"></a>Cbuprest640.flower.vs.leaf=</span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="st">  </span>Cbuprest640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb3-14"><a href="#cb3-14"></a>Cbuprest660.flower.vs.leaf=</span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="st">  </span>Cbuprest660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb3-16"><a href="#cb3-16"></a></span>
<span id="cb3-17"><a href="#cb3-17"></a>Cbuprest.flower.vs.leaf=</span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="st">  </span>Cbuprest580.flower.vs.leaf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.flower.vs.leaf) <span class="op">%&gt;%</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.flower.vs.leaf)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.flower.vs.leaf) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest660.flower.vs.leaf) </span>
<span id="cb3-20"><a href="#cb3-20"></a></span>
<span id="cb3-21"><a href="#cb3-21"></a>bup580.flower.vs.leaf&lt;-Cbuprest580.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-22"><a href="#cb3-22"></a>bup600.flower.vs.leaf&lt;-Cbuprest600.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-23"><a href="#cb3-23"></a>bup620.flower.vs.leaf&lt;-Cbuprest620.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-24"><a href="#cb3-24"></a>bup640.flower.vs.leaf&lt;-Cbuprest640.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-25"><a href="#cb3-25"></a>bup660.flower.vs.leaf&lt;-Cbuprest660.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-26"><a href="#cb3-26"></a></span>
<span id="cb3-27"><a href="#cb3-27"></a>com.bupcontrast.flower.vs.leaf&lt;-<span class="kw">cbind</span>(Cbuprest.flower.vs.leaf[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.flower.vs.leaf,bup600.flower.vs.leaf,bup620.flower.vs.leaf,bup640.flower.vs.leaf,bup660.flower.vs.leaf)</span>
<span id="cb3-28"><a href="#cb3-28"></a>compare.flower.vs.leaf.bup &lt;-<span class="st"> </span>com.bupcontrast.flower.vs.leaf <span class="op">%&gt;%</span></span>
<span id="cb3-29"><a href="#cb3-29"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.flower.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)</span>
<span id="cb3-30"><a href="#cb3-30"></a></span>
<span id="cb3-31"><a href="#cb3-31"></a><span class="co">##beetle vs leaf</span></span>
<span id="cb3-32"><a href="#cb3-32"></a>Cbuprest580.beetle.vs.leaf=</span>
<span id="cb3-33"><a href="#cb3-33"></a><span class="st">  </span>Cbuprest580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-34"><a href="#cb3-34"></a>Cbuprest600.beetle.vs.leaf=</span>
<span id="cb3-35"><a href="#cb3-35"></a><span class="st">  </span>Cbuprest600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-36"><a href="#cb3-36"></a>Cbuprest620.beetle.vs.leaf=</span>
<span id="cb3-37"><a href="#cb3-37"></a><span class="st">  </span>Cbuprest620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-38"><a href="#cb3-38"></a>Cbuprest640.beetle.vs.leaf=</span>
<span id="cb3-39"><a href="#cb3-39"></a><span class="st">  </span>Cbuprest640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-40"><a href="#cb3-40"></a>Cbuprest660.beetle.vs.leaf=</span>
<span id="cb3-41"><a href="#cb3-41"></a><span class="st">  </span>Cbuprest660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-42"><a href="#cb3-42"></a></span>
<span id="cb3-43"><a href="#cb3-43"></a>Cbuprest.beetle.vs.leaf=</span>
<span id="cb3-44"><a href="#cb3-44"></a><span class="st">  </span>Cbuprest580.beetle.vs.leaf  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.beetle.vs.leaf)<span class="op">%&gt;%</span></span>
<span id="cb3-45"><a href="#cb3-45"></a><span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.beetle.vs.leaf)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.beetle.vs.leaf) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest660.beetle.vs.leaf) </span>
<span id="cb3-46"><a href="#cb3-46"></a></span>
<span id="cb3-47"><a href="#cb3-47"></a>bup580.beetle.vs.leaf&lt;-Cbuprest580.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-48"><a href="#cb3-48"></a>bup600.beetle.vs.leaf&lt;-Cbuprest600.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-49"><a href="#cb3-49"></a>bup620.beetle.vs.leaf&lt;-Cbuprest620.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-50"><a href="#cb3-50"></a>bup640.beetle.vs.leaf&lt;-Cbuprest640.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-51"><a href="#cb3-51"></a>bup660.beetle.vs.leaf&lt;-Cbuprest660.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-52"><a href="#cb3-52"></a></span>
<span id="cb3-53"><a href="#cb3-53"></a>com.bupcontrast.beetle.vs.leaf&lt;-<span class="kw">cbind</span>(Cbuprest.beetle.vs.leaf[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.beetle.vs.leaf,bup600.beetle.vs.leaf,bup620.beetle.vs.leaf,bup640.beetle.vs.leaf,bup660.beetle.vs.leaf)</span>
<span id="cb3-54"><a href="#cb3-54"></a>compare.beetle.vs.leaf.bup &lt;-<span class="st"> </span>com.bupcontrast.beetle.vs.leaf <span class="op">%&gt;%</span></span>
<span id="cb3-55"><a href="#cb3-55"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)</span>
<span id="cb3-56"><a href="#cb3-56"></a></span>
<span id="cb3-57"><a href="#cb3-57"></a><span class="co">##beetle vs flower</span></span>
<span id="cb3-58"><a href="#cb3-58"></a>Cbuprest580.beetle.vs.flower=</span>
<span id="cb3-59"><a href="#cb3-59"></a><span class="st">  </span>Cbuprest580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-60"><a href="#cb3-60"></a>Cbuprest600.beetle.vs.flower=</span>
<span id="cb3-61"><a href="#cb3-61"></a><span class="st">  </span>Cbuprest600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-62"><a href="#cb3-62"></a>Cbuprest620.beetle.vs.flower=</span>
<span id="cb3-63"><a href="#cb3-63"></a><span class="st">  </span>Cbuprest620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-64"><a href="#cb3-64"></a>Cbuprest640.beetle.vs.flower=</span>
<span id="cb3-65"><a href="#cb3-65"></a><span class="st">  </span>Cbuprest640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-66"><a href="#cb3-66"></a>Cbuprest660.beetle.vs.flower=</span>
<span id="cb3-67"><a href="#cb3-67"></a><span class="st">  </span>Cbuprest660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-68"><a href="#cb3-68"></a></span>
<span id="cb3-69"><a href="#cb3-69"></a>Cbuprest.beetle.vs.flower=</span>
<span id="cb3-70"><a href="#cb3-70"></a><span class="st">  </span>Cbuprest580.beetle.vs.flower <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.beetle.vs.flower) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-71"><a href="#cb3-71"></a><span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.beetle.vs.flower)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.beetle.vs.flower) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-72"><a href="#cb3-72"></a><span class="st">  </span><span class="kw">rbind</span>(Cbuprest660.beetle.vs.flower)</span>
<span id="cb3-73"><a href="#cb3-73"></a></span>
<span id="cb3-74"><a href="#cb3-74"></a>bup580.beetle.vs.flower&lt;-Cbuprest580.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb3-75"><a href="#cb3-75"></a>bup600.beetle.vs.flower&lt;-Cbuprest600.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb3-76"><a href="#cb3-76"></a>bup620.beetle.vs.flower&lt;-Cbuprest620.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb3-77"><a href="#cb3-77"></a>bup640.beetle.vs.flower&lt;-Cbuprest640.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb3-78"><a href="#cb3-78"></a>bup660.beetle.vs.flower&lt;-Cbuprest660.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb3-79"><a href="#cb3-79"></a></span>
<span id="cb3-80"><a href="#cb3-80"></a>com.bupcontrast.beetle.vs.flower&lt;-<span class="kw">cbind</span>(Cbuprest.beetle.vs.flower[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.beetle.vs.flower,bup600.beetle.vs.flower,bup620.beetle.vs.flower,bup640.beetle.vs.flower,bup660.beetle.vs.flower)</span>
<span id="cb3-81"><a href="#cb3-81"></a>compare.beetle.vs.flower.bup &lt;-<span class="st"> </span>com.bupcontrast.beetle.vs.flower <span class="op">%&gt;%</span></span>
<span id="cb3-82"><a href="#cb3-82"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.flower&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)</span>
<span id="cb3-83"><a href="#cb3-83"></a></span>
<span id="cb3-84"><a href="#cb3-84"></a></span>
<span id="cb3-85"><a href="#cb3-85"></a></span>
<span id="cb3-86"><a href="#cb3-86"></a></span>
<span id="cb3-87"><a href="#cb3-87"></a><span class="co">#for Papilio xuthus</span></span>
<span id="cb3-88"><a href="#cb3-88"></a><span class="co">##flower vs leaf</span></span>
<span id="cb3-89"><a href="#cb3-89"></a>Cpapilio580.flower.vs.leaf=</span>
<span id="cb3-90"><a href="#cb3-90"></a><span class="st">  </span>Cpapilio580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb3-91"><a href="#cb3-91"></a>Cpapilio600.flower.vs.leaf=</span>
<span id="cb3-92"><a href="#cb3-92"></a><span class="st">  </span>Cpapilio600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb3-93"><a href="#cb3-93"></a>Cpapilio620.flower.vs.leaf=</span>
<span id="cb3-94"><a href="#cb3-94"></a><span class="st">  </span>Cpapilio620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb3-95"><a href="#cb3-95"></a>Cpapilio640.flower.vs.leaf=</span>
<span id="cb3-96"><a href="#cb3-96"></a><span class="st">  </span>Cpapilio640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb3-97"><a href="#cb3-97"></a>Cpapilio660.flower.vs.leaf=</span>
<span id="cb3-98"><a href="#cb3-98"></a><span class="st">  </span>Cpapilio660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb3-99"><a href="#cb3-99"></a></span>
<span id="cb3-100"><a href="#cb3-100"></a>Cpapilio.flower.vs.leaf=</span>
<span id="cb3-101"><a href="#cb3-101"></a><span class="st">  </span>Cpapilio580.flower.vs.leaf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cpapilio600.flower.vs.leaf) <span class="op">%&gt;%</span></span>
<span id="cb3-102"><a href="#cb3-102"></a><span class="st">  </span><span class="kw">rbind</span>(Cpapilio620.flower.vs.leaf)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cpapilio640.flower.vs.leaf) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cpapilio660.flower.vs.leaf) </span>
<span id="cb3-103"><a href="#cb3-103"></a></span>
<span id="cb3-104"><a href="#cb3-104"></a>pap580.flower.vs.leaf&lt;-Cpapilio580.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-105"><a href="#cb3-105"></a>pap600.flower.vs.leaf&lt;-Cpapilio600.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-106"><a href="#cb3-106"></a>pap620.flower.vs.leaf&lt;-Cpapilio620.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-107"><a href="#cb3-107"></a>pap640.flower.vs.leaf&lt;-Cpapilio640.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-108"><a href="#cb3-108"></a>pap660.flower.vs.leaf&lt;-Cpapilio660.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-109"><a href="#cb3-109"></a></span>
<span id="cb3-110"><a href="#cb3-110"></a>com.papcontrast.flower.vs.leaf&lt;-<span class="kw">cbind</span>(Cpapilio.flower.vs.leaf[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],pap580.flower.vs.leaf,pap600.flower.vs.leaf,pap620.flower.vs.leaf,pap640.flower.vs.leaf,pap660.flower.vs.leaf)</span>
<span id="cb3-111"><a href="#cb3-111"></a>compare.flower.vs.leaf.pap &lt;-<span class="st"> </span>com.papcontrast.flower.vs.leaf <span class="op">%&gt;%</span></span>
<span id="cb3-112"><a href="#cb3-112"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.flower.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)</span>
<span id="cb3-113"><a href="#cb3-113"></a></span>
<span id="cb3-114"><a href="#cb3-114"></a><span class="co">##beetle vs leaf</span></span>
<span id="cb3-115"><a href="#cb3-115"></a>Cpapilio580.beetle.vs.leaf=</span>
<span id="cb3-116"><a href="#cb3-116"></a><span class="st">  </span>Cpapilio580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-117"><a href="#cb3-117"></a>Cpapilio600.beetle.vs.leaf=</span>
<span id="cb3-118"><a href="#cb3-118"></a><span class="st">  </span>Cpapilio600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-119"><a href="#cb3-119"></a>Cpapilio620.beetle.vs.leaf=</span>
<span id="cb3-120"><a href="#cb3-120"></a><span class="st">  </span>Cpapilio620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-121"><a href="#cb3-121"></a>Cpapilio640.beetle.vs.leaf=</span>
<span id="cb3-122"><a href="#cb3-122"></a><span class="st">  </span>Cpapilio640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-123"><a href="#cb3-123"></a>Cpapilio660.beetle.vs.leaf=</span>
<span id="cb3-124"><a href="#cb3-124"></a><span class="st">  </span>Cpapilio660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-125"><a href="#cb3-125"></a></span>
<span id="cb3-126"><a href="#cb3-126"></a>Cpapilio.beetle.vs.leaf=</span>
<span id="cb3-127"><a href="#cb3-127"></a><span class="st">  </span>Cpapilio580.beetle.vs.leaf  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cpapilio600.beetle.vs.leaf)<span class="op">%&gt;%</span></span>
<span id="cb3-128"><a href="#cb3-128"></a><span class="st">  </span><span class="kw">rbind</span>(Cpapilio620.beetle.vs.leaf)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cpapilio640.beetle.vs.leaf) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cpapilio660.beetle.vs.leaf) </span>
<span id="cb3-129"><a href="#cb3-129"></a></span>
<span id="cb3-130"><a href="#cb3-130"></a>pap580.beetle.vs.leaf&lt;-Cpapilio580.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-131"><a href="#cb3-131"></a>pap600.beetle.vs.leaf&lt;-Cpapilio600.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-132"><a href="#cb3-132"></a>pap620.beetle.vs.leaf&lt;-Cpapilio620.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-133"><a href="#cb3-133"></a>pap640.beetle.vs.leaf&lt;-Cpapilio640.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-134"><a href="#cb3-134"></a>pap660.beetle.vs.leaf&lt;-Cpapilio660.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-135"><a href="#cb3-135"></a></span>
<span id="cb3-136"><a href="#cb3-136"></a>com.papcontrast.beetle.vs.leaf&lt;-<span class="kw">cbind</span>(Cpapilio.beetle.vs.leaf[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],pap580.beetle.vs.leaf,pap600.beetle.vs.leaf,pap620.beetle.vs.leaf,pap640.beetle.vs.leaf,pap660.beetle.vs.leaf)</span>
<span id="cb3-137"><a href="#cb3-137"></a>compare.beetle.vs.leaf.pap &lt;-<span class="st"> </span>com.papcontrast.beetle.vs.leaf <span class="op">%&gt;%</span></span>
<span id="cb3-138"><a href="#cb3-138"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)</span>
<span id="cb3-139"><a href="#cb3-139"></a></span>
<span id="cb3-140"><a href="#cb3-140"></a><span class="co">##beetle vs flower</span></span>
<span id="cb3-141"><a href="#cb3-141"></a>Cpapilio580.beetle.vs.flower=</span>
<span id="cb3-142"><a href="#cb3-142"></a><span class="st">  </span>Cpapilio580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-143"><a href="#cb3-143"></a>Cpapilio600.beetle.vs.flower=</span>
<span id="cb3-144"><a href="#cb3-144"></a><span class="st">  </span>Cpapilio600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-145"><a href="#cb3-145"></a>Cpapilio620.beetle.vs.flower=</span>
<span id="cb3-146"><a href="#cb3-146"></a><span class="st">  </span>Cpapilio620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-147"><a href="#cb3-147"></a>Cpapilio640.beetle.vs.flower=</span>
<span id="cb3-148"><a href="#cb3-148"></a><span class="st">  </span>Cpapilio640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-149"><a href="#cb3-149"></a>Cpapilio660.beetle.vs.flower=</span>
<span id="cb3-150"><a href="#cb3-150"></a><span class="st">  </span>Cpapilio660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-151"><a href="#cb3-151"></a></span>
<span id="cb3-152"><a href="#cb3-152"></a>Cpapilio.beetle.vs.flower=</span>
<span id="cb3-153"><a href="#cb3-153"></a><span class="st">  </span>Cpapilio580.beetle.vs.flower <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cpapilio600.beetle.vs.flower) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-154"><a href="#cb3-154"></a><span class="st">  </span><span class="kw">rbind</span>(Cpapilio620.beetle.vs.flower)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cpapilio640.beetle.vs.flower) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-155"><a href="#cb3-155"></a><span class="st">  </span><span class="kw">rbind</span>(Cpapilio660.beetle.vs.flower)</span>
<span id="cb3-156"><a href="#cb3-156"></a></span>
<span id="cb3-157"><a href="#cb3-157"></a>pap580.beetle.vs.flower&lt;-Cpapilio580.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb3-158"><a href="#cb3-158"></a>pap600.beetle.vs.flower&lt;-Cpapilio600.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb3-159"><a href="#cb3-159"></a>pap620.beetle.vs.flower&lt;-Cpapilio620.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb3-160"><a href="#cb3-160"></a>pap640.beetle.vs.flower&lt;-Cpapilio640.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb3-161"><a href="#cb3-161"></a>pap660.beetle.vs.flower&lt;-Cpapilio660.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb3-162"><a href="#cb3-162"></a></span>
<span id="cb3-163"><a href="#cb3-163"></a>com.papcontrast.beetle.vs.flower&lt;-<span class="kw">cbind</span>(Cpapilio.beetle.vs.flower[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],pap580.beetle.vs.flower,pap600.beetle.vs.flower,pap620.beetle.vs.flower,pap640.beetle.vs.flower,pap660.beetle.vs.flower)</span>
<span id="cb3-164"><a href="#cb3-164"></a>compare.beetle.vs.flower.pap &lt;-<span class="st"> </span>com.papcontrast.beetle.vs.flower <span class="op">%&gt;%</span></span>
<span id="cb3-165"><a href="#cb3-165"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.flower&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)</span>
<span id="cb3-166"><a href="#cb3-166"></a></span>
<span id="cb3-167"><a href="#cb3-167"></a></span>
<span id="cb3-168"><a href="#cb3-168"></a></span>
<span id="cb3-169"><a href="#cb3-169"></a><span class="co">#for Heliconius sp</span></span>
<span id="cb3-170"><a href="#cb3-170"></a><span class="co">##flower vs leaf</span></span>
<span id="cb3-171"><a href="#cb3-171"></a>Cheliconius580.flower.vs.leaf=</span>
<span id="cb3-172"><a href="#cb3-172"></a><span class="st">  </span>Cheliconius580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb3-173"><a href="#cb3-173"></a>Cheliconius600.flower.vs.leaf=</span>
<span id="cb3-174"><a href="#cb3-174"></a><span class="st">  </span>Cheliconius600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb3-175"><a href="#cb3-175"></a>Cheliconius620.flower.vs.leaf=</span>
<span id="cb3-176"><a href="#cb3-176"></a><span class="st">  </span>Cheliconius620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb3-177"><a href="#cb3-177"></a>Cheliconius640.flower.vs.leaf=</span>
<span id="cb3-178"><a href="#cb3-178"></a><span class="st">  </span>Cheliconius640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb3-179"><a href="#cb3-179"></a>Cheliconius660.flower.vs.leaf=</span>
<span id="cb3-180"><a href="#cb3-180"></a><span class="st">  </span>Cheliconius660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb3-181"><a href="#cb3-181"></a></span>
<span id="cb3-182"><a href="#cb3-182"></a>Cheliconius.flower.vs.leaf=</span>
<span id="cb3-183"><a href="#cb3-183"></a><span class="st">  </span>Cheliconius580.flower.vs.leaf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cheliconius600.flower.vs.leaf) <span class="op">%&gt;%</span></span>
<span id="cb3-184"><a href="#cb3-184"></a><span class="st">  </span><span class="kw">rbind</span>(Cheliconius620.flower.vs.leaf)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cheliconius640.flower.vs.leaf) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cheliconius660.flower.vs.leaf) </span>
<span id="cb3-185"><a href="#cb3-185"></a></span>
<span id="cb3-186"><a href="#cb3-186"></a>heli580.flower.vs.leaf&lt;-Cheliconius580.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-187"><a href="#cb3-187"></a>heli600.flower.vs.leaf&lt;-Cheliconius600.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-188"><a href="#cb3-188"></a>heli620.flower.vs.leaf&lt;-Cheliconius620.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-189"><a href="#cb3-189"></a>heli640.flower.vs.leaf&lt;-Cheliconius640.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-190"><a href="#cb3-190"></a>heli660.flower.vs.leaf&lt;-Cheliconius660.flower.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-191"><a href="#cb3-191"></a></span>
<span id="cb3-192"><a href="#cb3-192"></a>com.helicontrast.flower.vs.leaf&lt;-<span class="kw">cbind</span>(Cheliconius.flower.vs.leaf[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],heli580.flower.vs.leaf,heli600.flower.vs.leaf,heli620.flower.vs.leaf,heli640.flower.vs.leaf,heli660.flower.vs.leaf)</span>
<span id="cb3-193"><a href="#cb3-193"></a>compare.flower.vs.leaf.heli &lt;-<span class="st"> </span>com.helicontrast.flower.vs.leaf <span class="op">%&gt;%</span></span>
<span id="cb3-194"><a href="#cb3-194"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.flower.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)</span>
<span id="cb3-195"><a href="#cb3-195"></a></span>
<span id="cb3-196"><a href="#cb3-196"></a><span class="co">##beetle vs leaf</span></span>
<span id="cb3-197"><a href="#cb3-197"></a>Cheliconius580.beetle.vs.leaf=</span>
<span id="cb3-198"><a href="#cb3-198"></a><span class="st">  </span>Cheliconius580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-199"><a href="#cb3-199"></a>Cheliconius600.beetle.vs.leaf=</span>
<span id="cb3-200"><a href="#cb3-200"></a><span class="st">  </span>Cheliconius600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-201"><a href="#cb3-201"></a>Cheliconius620.beetle.vs.leaf=</span>
<span id="cb3-202"><a href="#cb3-202"></a><span class="st">  </span>Cheliconius620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-203"><a href="#cb3-203"></a>Cheliconius640.beetle.vs.leaf=</span>
<span id="cb3-204"><a href="#cb3-204"></a><span class="st">  </span>Cheliconius640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-205"><a href="#cb3-205"></a>Cheliconius660.beetle.vs.leaf=</span>
<span id="cb3-206"><a href="#cb3-206"></a><span class="st">  </span>Cheliconius660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-207"><a href="#cb3-207"></a></span>
<span id="cb3-208"><a href="#cb3-208"></a>Cheliconius.beetle.vs.leaf=</span>
<span id="cb3-209"><a href="#cb3-209"></a><span class="st">  </span>Cheliconius580.beetle.vs.leaf  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cheliconius600.beetle.vs.leaf)<span class="op">%&gt;%</span></span>
<span id="cb3-210"><a href="#cb3-210"></a><span class="st">  </span><span class="kw">rbind</span>(Cheliconius620.beetle.vs.leaf)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cheliconius640.beetle.vs.leaf) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cheliconius660.beetle.vs.leaf) </span>
<span id="cb3-211"><a href="#cb3-211"></a></span>
<span id="cb3-212"><a href="#cb3-212"></a>heli580.beetle.vs.leaf&lt;-Cheliconius580.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-213"><a href="#cb3-213"></a>heli600.beetle.vs.leaf&lt;-Cheliconius600.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-214"><a href="#cb3-214"></a>heli620.beetle.vs.leaf&lt;-Cheliconius620.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-215"><a href="#cb3-215"></a>heli640.beetle.vs.leaf&lt;-Cheliconius640.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-216"><a href="#cb3-216"></a>heli660.beetle.vs.leaf&lt;-Cheliconius660.beetle.vs.leaf[,<span class="dv">3</span>]</span>
<span id="cb3-217"><a href="#cb3-217"></a></span>
<span id="cb3-218"><a href="#cb3-218"></a>com.helicontrast.beetle.vs.leaf&lt;-<span class="kw">cbind</span>(Cheliconius.beetle.vs.leaf[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],heli580.beetle.vs.leaf,heli600.beetle.vs.leaf,heli620.beetle.vs.leaf,heli640.beetle.vs.leaf,heli660.beetle.vs.leaf)</span>
<span id="cb3-219"><a href="#cb3-219"></a>compare.beetle.vs.leaf.heli &lt;-<span class="st"> </span>com.helicontrast.beetle.vs.leaf <span class="op">%&gt;%</span></span>
<span id="cb3-220"><a href="#cb3-220"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.leaf&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)</span>
<span id="cb3-221"><a href="#cb3-221"></a></span>
<span id="cb3-222"><a href="#cb3-222"></a><span class="co">##beetle vs flower</span></span>
<span id="cb3-223"><a href="#cb3-223"></a>Cheliconius580.beetle.vs.flower=</span>
<span id="cb3-224"><a href="#cb3-224"></a><span class="st">  </span>Cheliconius580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-225"><a href="#cb3-225"></a>Cheliconius600.beetle.vs.flower=</span>
<span id="cb3-226"><a href="#cb3-226"></a><span class="st">  </span>Cheliconius600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-227"><a href="#cb3-227"></a>Cheliconius620.beetle.vs.flower=</span>
<span id="cb3-228"><a href="#cb3-228"></a><span class="st">  </span>Cheliconius620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-229"><a href="#cb3-229"></a>Cheliconius640.beetle.vs.flower=</span>
<span id="cb3-230"><a href="#cb3-230"></a><span class="st">  </span>Cheliconius640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-231"><a href="#cb3-231"></a>Cheliconius660.beetle.vs.flower=</span>
<span id="cb3-232"><a href="#cb3-232"></a><span class="st">  </span>Cheliconius660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb3-233"><a href="#cb3-233"></a></span>
<span id="cb3-234"><a href="#cb3-234"></a>Cheliconius.beetle.vs.flower=</span>
<span id="cb3-235"><a href="#cb3-235"></a><span class="st">  </span>Cheliconius580.beetle.vs.flower <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cheliconius600.beetle.vs.flower) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-236"><a href="#cb3-236"></a><span class="st">  </span><span class="kw">rbind</span>(Cheliconius620.beetle.vs.flower)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cheliconius640.beetle.vs.flower) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-237"><a href="#cb3-237"></a><span class="st">  </span><span class="kw">rbind</span>(Cheliconius660.beetle.vs.flower)</span>
<span id="cb3-238"><a href="#cb3-238"></a></span>
<span id="cb3-239"><a href="#cb3-239"></a>heli580.beetle.vs.flower&lt;-Cheliconius580.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb3-240"><a href="#cb3-240"></a>heli600.beetle.vs.flower&lt;-Cheliconius600.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb3-241"><a href="#cb3-241"></a>heli620.beetle.vs.flower&lt;-Cheliconius620.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb3-242"><a href="#cb3-242"></a>heli640.beetle.vs.flower&lt;-Cheliconius640.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb3-243"><a href="#cb3-243"></a>heli660.beetle.vs.flower&lt;-Cheliconius660.beetle.vs.flower[,<span class="dv">3</span>]</span>
<span id="cb3-244"><a href="#cb3-244"></a></span>
<span id="cb3-245"><a href="#cb3-245"></a>com.helicontrast.beetle.vs.flower&lt;-<span class="kw">cbind</span>(Cheliconius.beetle.vs.flower[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],heli580.beetle.vs.flower,heli600.beetle.vs.flower,heli620.beetle.vs.flower,heli640.beetle.vs.flower,heli660.beetle.vs.flower)</span>
<span id="cb3-246"><a href="#cb3-246"></a>compare.beetle.vs.flower.heli &lt;-<span class="st"> </span>com.helicontrast.beetle.vs.flower<span class="op">%&gt;%</span></span>
<span id="cb3-247"><a href="#cb3-247"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.beetle.vs.flower&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>)</span></code></pre></div>
<p></br> </br></p>
<p>Click the tabs to see the results for each comparison group ( <strong>Flower vs. Leaf</strong> / <strong>Beetle vs. Leaf</strong> / <strong>Beetle vs. Flower</strong>) in 3 different speceis (<em>Agrilus planipennis</em> / <em>Papilio xuthus</em> / <em>Heliconius</em> sp).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">#for Agrilus planipennis</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">##Flower vs Leaf</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>m.flower.vs.leaf.bup &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.flower.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.flower.vs.leaf.bup,<span class="dt">REML=</span>F)</span>
<span id="cb4-4"><a href="#cb4-4"></a>sum.flower.vs.leaf.bup &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.flower.vs.leaf.bup, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.flower.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">##Beetle vs Leaf</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>m.beetle.vs.leaf.bup &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.leaf.bup,<span class="dt">REML=</span>F)</span>
<span id="cb4-7"><a href="#cb4-7"></a>sum.beetle.vs.leaf.bup &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.leaf.bup, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">##Beetle vs Flower</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>m.beetle.vs.flower.bup &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.flower <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.flower.bup,<span class="dt">REML=</span>F)</span>
<span id="cb4-10"><a href="#cb4-10"></a>sum.beetle.vs.flower.bup &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.flower.bup, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.flower =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb4-11"><a href="#cb4-11"></a></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">###reshape data for heatmap</span></span>
<span id="cb4-13"><a href="#cb4-13"></a>p1.bup&lt;-sum.flower.vs.leaf.bup[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb4-14"><a href="#cb4-14"></a>p2.bup&lt;-sum.beetle.vs.leaf.bup[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb4-15"><a href="#cb4-15"></a>p3.bup&lt;-sum.beetle.vs.flower.bup[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb4-16"><a href="#cb4-16"></a></span>
<span id="cb4-17"><a href="#cb4-17"></a>VislistA.bup&lt;-<span class="kw">c</span>(<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 660&quot;</span>)</span>
<span id="cb4-18"><a href="#cb4-18"></a>VislistB.bup&lt;-<span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>)</span>
<span id="cb4-19"><a href="#cb4-19"></a></span>
<span id="cb4-20"><a href="#cb4-20"></a>heat.bup&lt;-<span class="kw">data.frame</span>(<span class="kw">names</span>(p1.bup),<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p1.bup,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-21"><a href="#cb4-21"></a><span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p2.bup,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-22"><a href="#cb4-22"></a><span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p3.bup,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb4-23"><a href="#cb4-23"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">orignial.list =</span> <span class="dv">1</span>, <span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-24"><a href="#cb4-24"></a><span class="st">  </span><span class="kw">cbind</span>(VislistA.bup) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-25"><a href="#cb4-25"></a><span class="st">  </span><span class="kw">cbind</span>(VislistB.bup) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-26"><a href="#cb4-26"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>orignial.list)</span>
<span id="cb4-27"><a href="#cb4-27"></a></span>
<span id="cb4-28"><a href="#cb4-28"></a><span class="co">##add asterisks for significant pairs</span></span>
<span id="cb4-29"><a href="#cb4-29"></a>heat.bup<span class="op">$</span>sig.flower.vs.leaf[heat.bup<span class="op">$</span>flower.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb4-30"><a href="#cb4-30"></a>heat.bup<span class="op">$</span>sig.flower.vs.leaf[heat.bup<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb4-31"><a href="#cb4-31"></a>heat.bup<span class="op">$</span>sig.flower.vs.leaf[heat.bup<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb4-32"><a href="#cb4-32"></a>heat.bup<span class="op">$</span>sig.flower.vs.leaf[heat.bup<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb4-33"><a href="#cb4-33"></a>heat.bup<span class="op">$</span>sig.beetle.vs.leaf[heat.bup<span class="op">$</span>beetle.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb4-34"><a href="#cb4-34"></a>heat.bup<span class="op">$</span>sig.beetle.vs.leaf[heat.bup<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb4-35"><a href="#cb4-35"></a>heat.bup<span class="op">$</span>sig.beetle.vs.leaf[heat.bup<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb4-36"><a href="#cb4-36"></a>heat.bup<span class="op">$</span>sig.beetle.vs.leaf[heat.bup<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb4-37"><a href="#cb4-37"></a>heat.bup<span class="op">$</span>sig.beetle.vs.flower[heat.bup<span class="op">$</span>beetle.vs.flower <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb4-38"><a href="#cb4-38"></a>heat.bup<span class="op">$</span>sig.beetle.vs.flower[heat.bup<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb4-39"><a href="#cb4-39"></a>heat.bup<span class="op">$</span>sig.beetle.vs.flower[heat.bup<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb4-40"><a href="#cb4-40"></a>heat.bup<span class="op">$</span>sig.beetle.vs.flower[heat.bup<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb4-41"><a href="#cb4-41"></a></span>
<span id="cb4-42"><a href="#cb4-42"></a></span>
<span id="cb4-43"><a href="#cb4-43"></a></span>
<span id="cb4-44"><a href="#cb4-44"></a><span class="co">#for Papilio xuthus</span></span>
<span id="cb4-45"><a href="#cb4-45"></a><span class="co">##Flower vs Leaf</span></span>
<span id="cb4-46"><a href="#cb4-46"></a>m.flower.vs.leaf.pap &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.flower.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.flower.vs.leaf.pap,<span class="dt">REML=</span>F)</span>
<span id="cb4-47"><a href="#cb4-47"></a>sum.flower.vs.leaf.pap &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.flower.vs.leaf.pap, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.flower.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb4-48"><a href="#cb4-48"></a><span class="co">##Beetle vs Leaf</span></span>
<span id="cb4-49"><a href="#cb4-49"></a>m.beetle.vs.leaf.pap &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.leaf.pap,<span class="dt">REML=</span>F)</span>
<span id="cb4-50"><a href="#cb4-50"></a>sum.beetle.vs.leaf.pap &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.leaf.pap, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb4-51"><a href="#cb4-51"></a><span class="co">##Beetle vs Flower</span></span>
<span id="cb4-52"><a href="#cb4-52"></a>m.beetle.vs.flower.pap &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.flower <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.flower.pap,<span class="dt">REML=</span>F)</span>
<span id="cb4-53"><a href="#cb4-53"></a>sum.beetle.vs.flower.pap &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.flower.pap, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.flower =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb4-54"><a href="#cb4-54"></a></span>
<span id="cb4-55"><a href="#cb4-55"></a><span class="co">###reshape data for heatmap</span></span>
<span id="cb4-56"><a href="#cb4-56"></a>p1.pap&lt;-sum.flower.vs.leaf.pap[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb4-57"><a href="#cb4-57"></a>p2.pap&lt;-sum.beetle.vs.leaf.pap[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb4-58"><a href="#cb4-58"></a>p3.pap&lt;-sum.beetle.vs.flower.pap[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb4-59"><a href="#cb4-59"></a></span>
<span id="cb4-60"><a href="#cb4-60"></a>VislistA.pap&lt;-<span class="kw">c</span>(<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 660&quot;</span>)</span>
<span id="cb4-61"><a href="#cb4-61"></a>VislistB.pap&lt;-<span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>)</span>
<span id="cb4-62"><a href="#cb4-62"></a></span>
<span id="cb4-63"><a href="#cb4-63"></a>heat.pap&lt;-<span class="kw">data.frame</span>(<span class="kw">names</span>(p1.pap),<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p1.pap,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-64"><a href="#cb4-64"></a><span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p2.pap,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-65"><a href="#cb4-65"></a><span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p3.pap,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb4-66"><a href="#cb4-66"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">orignial.list =</span> <span class="dv">1</span>, <span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-67"><a href="#cb4-67"></a><span class="st">  </span><span class="kw">cbind</span>(VislistA.pap) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-68"><a href="#cb4-68"></a><span class="st">  </span><span class="kw">cbind</span>(VislistB.pap) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-69"><a href="#cb4-69"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>orignial.list)</span>
<span id="cb4-70"><a href="#cb4-70"></a></span>
<span id="cb4-71"><a href="#cb4-71"></a><span class="co">##add asterisks for significant pairs</span></span>
<span id="cb4-72"><a href="#cb4-72"></a>heat.pap<span class="op">$</span>sig.flower.vs.leaf[heat.pap<span class="op">$</span>flower.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb4-73"><a href="#cb4-73"></a>heat.pap<span class="op">$</span>sig.flower.vs.leaf[heat.pap<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb4-74"><a href="#cb4-74"></a>heat.pap<span class="op">$</span>sig.flower.vs.leaf[heat.pap<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb4-75"><a href="#cb4-75"></a>heat.pap<span class="op">$</span>sig.flower.vs.leaf[heat.pap<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb4-76"><a href="#cb4-76"></a>heat.pap<span class="op">$</span>sig.beetle.vs.leaf[heat.pap<span class="op">$</span>beetle.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb4-77"><a href="#cb4-77"></a>heat.pap<span class="op">$</span>sig.beetle.vs.leaf[heat.pap<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb4-78"><a href="#cb4-78"></a>heat.pap<span class="op">$</span>sig.beetle.vs.leaf[heat.pap<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb4-79"><a href="#cb4-79"></a>heat.pap<span class="op">$</span>sig.beetle.vs.leaf[heat.pap<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb4-80"><a href="#cb4-80"></a>heat.pap<span class="op">$</span>sig.beetle.vs.flower[heat.pap<span class="op">$</span>beetle.vs.flower <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb4-81"><a href="#cb4-81"></a>heat.pap<span class="op">$</span>sig.beetle.vs.flower[heat.pap<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb4-82"><a href="#cb4-82"></a>heat.pap<span class="op">$</span>sig.beetle.vs.flower[heat.pap<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb4-83"><a href="#cb4-83"></a>heat.pap<span class="op">$</span>sig.beetle.vs.flower[heat.pap<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb4-84"><a href="#cb4-84"></a></span>
<span id="cb4-85"><a href="#cb4-85"></a></span>
<span id="cb4-86"><a href="#cb4-86"></a></span>
<span id="cb4-87"><a href="#cb4-87"></a><span class="co">#for Heliconius sp</span></span>
<span id="cb4-88"><a href="#cb4-88"></a><span class="co">##Flower vs Leaf</span></span>
<span id="cb4-89"><a href="#cb4-89"></a>m.flower.vs.leaf.heli &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.flower.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.flower.vs.leaf.heli,<span class="dt">REML=</span>F)</span>
<span id="cb4-90"><a href="#cb4-90"></a>sum.flower.vs.leaf.heli &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.flower.vs.leaf.heli, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.flower.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb4-91"><a href="#cb4-91"></a><span class="co">##Beetle vs Leaf</span></span>
<span id="cb4-92"><a href="#cb4-92"></a>m.beetle.vs.leaf.heli &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.leaf <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.leaf.heli,<span class="dt">REML=</span>F)</span>
<span id="cb4-93"><a href="#cb4-93"></a>sum.beetle.vs.leaf.heli &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.leaf.heli, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.leaf =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb4-94"><a href="#cb4-94"></a><span class="co">##Beetle vs Flower</span></span>
<span id="cb4-95"><a href="#cb4-95"></a>m.beetle.vs.flower.heli &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.beetle.vs.flower <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.beetle.vs.flower.heli,<span class="dt">REML=</span>F)</span>
<span id="cb4-96"><a href="#cb4-96"></a>sum.beetle.vs.flower.heli &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.beetle.vs.flower.heli, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.beetle.vs.flower =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb4-97"><a href="#cb4-97"></a></span>
<span id="cb4-98"><a href="#cb4-98"></a><span class="co">###reshape data for heatmap</span></span>
<span id="cb4-99"><a href="#cb4-99"></a>p1.heli&lt;-sum.flower.vs.leaf.heli[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb4-100"><a href="#cb4-100"></a>p2.heli&lt;-sum.beetle.vs.leaf.heli[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb4-101"><a href="#cb4-101"></a>p3.heli&lt;-sum.beetle.vs.flower.heli[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]</span>
<span id="cb4-102"><a href="#cb4-102"></a></span>
<span id="cb4-103"><a href="#cb4-103"></a>VislistA.heli&lt;-<span class="kw">c</span>(<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>,<span class="st">&quot;VS 660&quot;</span>)</span>
<span id="cb4-104"><a href="#cb4-104"></a>VislistB.heli&lt;-<span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 580&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>)</span>
<span id="cb4-105"><a href="#cb4-105"></a></span>
<span id="cb4-106"><a href="#cb4-106"></a>heat.heli&lt;-<span class="kw">data.frame</span>(<span class="kw">names</span>(p1.heli),<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p1.heli,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-107"><a href="#cb4-107"></a><span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p2.heli,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-108"><a href="#cb4-108"></a><span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p3.heli,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb4-109"><a href="#cb4-109"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">orignial.list =</span> <span class="dv">1</span>, <span class="dt">flower.vs.leaf =</span> <span class="dv">2</span>, <span class="dt">beetle.vs.leaf =</span> <span class="dv">3</span>, <span class="dt">beetle.vs.flower =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-110"><a href="#cb4-110"></a><span class="st">  </span><span class="kw">cbind</span>(VislistA.heli) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-111"><a href="#cb4-111"></a><span class="st">  </span><span class="kw">cbind</span>(VislistB.heli) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-112"><a href="#cb4-112"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>orignial.list)</span>
<span id="cb4-113"><a href="#cb4-113"></a></span>
<span id="cb4-114"><a href="#cb4-114"></a><span class="co">##add asterisks for significant pairs</span></span>
<span id="cb4-115"><a href="#cb4-115"></a>heat.heli<span class="op">$</span>sig.flower.vs.leaf[heat.heli<span class="op">$</span>flower.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb4-116"><a href="#cb4-116"></a>heat.heli<span class="op">$</span>sig.flower.vs.leaf[heat.heli<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb4-117"><a href="#cb4-117"></a>heat.heli<span class="op">$</span>sig.flower.vs.leaf[heat.heli<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb4-118"><a href="#cb4-118"></a>heat.heli<span class="op">$</span>sig.flower.vs.leaf[heat.heli<span class="op">$</span>flower.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb4-119"><a href="#cb4-119"></a>heat.heli<span class="op">$</span>sig.beetle.vs.leaf[heat.heli<span class="op">$</span>beetle.vs.leaf <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb4-120"><a href="#cb4-120"></a>heat.heli<span class="op">$</span>sig.beetle.vs.leaf[heat.heli<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb4-121"><a href="#cb4-121"></a>heat.heli<span class="op">$</span>sig.beetle.vs.leaf[heat.heli<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb4-122"><a href="#cb4-122"></a>heat.heli<span class="op">$</span>sig.beetle.vs.leaf[heat.heli<span class="op">$</span>beetle.vs.leaf <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span>
<span id="cb4-123"><a href="#cb4-123"></a>heat.heli<span class="op">$</span>sig.beetle.vs.flower[heat.heli<span class="op">$</span>beetle.vs.flower <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb4-124"><a href="#cb4-124"></a>heat.heli<span class="op">$</span>sig.beetle.vs.flower[heat.heli<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;*&quot;</span></span>
<span id="cb4-125"><a href="#cb4-125"></a>heat.heli<span class="op">$</span>sig.beetle.vs.flower[heat.heli<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>] &lt;-<span class="st"> &quot;**&quot;</span></span>
<span id="cb4-126"><a href="#cb4-126"></a>heat.heli<span class="op">$</span>sig.beetle.vs.flower[heat.heli<span class="op">$</span>beetle.vs.flower <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0001</span>] &lt;-<span class="st"> &quot;***&quot;</span></span></code></pre></div>
<div id="flower-vs-leaf" class="section level2 tabset tabset-fade tabset-pills">
<h2><strong>Flower vs Leaf</strong></h2>
<div id="agrilus-planipennis" class="section level3 tabset tabset-fade tabset-pills">
<h3><em>Agrilus planipennis</em></h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">Anova</span>(m.flower.vs.leaf.bup) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:76%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.flower.vs.leaf</strong></td>
<td align="center">11416</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values" class="section level4">
<h4>Pair-wise p-values</h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat.bup, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA.bup, <span class="dt">y=</span>VislistB.bup, <span class="dt">fill=</span>flower.vs.leaf)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA.bup, VislistB.bup, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(flower.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.flower.vs.leaf)))<span class="op">+</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb6-7"><a href="#cb6-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb6-8"><a href="#cb6-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb6-9"><a href="#cb6-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb6-10"><a href="#cb6-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p></br> </br></p>
</div>
<div id="original-model-output" class="section level4">
<h4>Original model output</h4>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>sum.flower.vs.leaf.bup</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.flower.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.flower.vs.leaf.bup, REML = F)
## 
## Linear Hypotheses:
##                                                    Estimate Std. Error z value
## bup600.flower.vs.leaf - bup580.flower.vs.leaf == 0  0.50517    0.02555  19.771
## bup620.flower.vs.leaf - bup580.flower.vs.leaf == 0  1.41081    0.02555  55.216
## bup640.flower.vs.leaf - bup580.flower.vs.leaf == 0  2.16478    0.02555  84.724
## bup660.flower.vs.leaf - bup580.flower.vs.leaf == 0  2.11431    0.02555  82.749
## bup620.flower.vs.leaf - bup600.flower.vs.leaf == 0  0.90565    0.02555  35.445
## bup640.flower.vs.leaf - bup600.flower.vs.leaf == 0  1.65962    0.02555  64.953
## bup660.flower.vs.leaf - bup600.flower.vs.leaf == 0  1.60915    0.02555  62.978
## bup640.flower.vs.leaf - bup620.flower.vs.leaf == 0  0.75397    0.02555  29.508
## bup660.flower.vs.leaf - bup620.flower.vs.leaf == 0  0.70350    0.02555  27.533
## bup660.flower.vs.leaf - bup640.flower.vs.leaf == 0 -0.05047    0.02555  -1.975
##                                                    Pr(&gt;|z|)    
## bup600.flower.vs.leaf - bup580.flower.vs.leaf == 0   &lt;2e-16 ***
## bup620.flower.vs.leaf - bup580.flower.vs.leaf == 0   &lt;2e-16 ***
## bup640.flower.vs.leaf - bup580.flower.vs.leaf == 0   &lt;2e-16 ***
## bup660.flower.vs.leaf - bup580.flower.vs.leaf == 0   &lt;2e-16 ***
## bup620.flower.vs.leaf - bup600.flower.vs.leaf == 0   &lt;2e-16 ***
## bup640.flower.vs.leaf - bup600.flower.vs.leaf == 0   &lt;2e-16 ***
## bup660.flower.vs.leaf - bup600.flower.vs.leaf == 0   &lt;2e-16 ***
## bup640.flower.vs.leaf - bup620.flower.vs.leaf == 0   &lt;2e-16 ***
## bup660.flower.vs.leaf - bup620.flower.vs.leaf == 0   &lt;2e-16 ***
## bup660.flower.vs.leaf - bup640.flower.vs.leaf == 0    0.482    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
<div id="papilio-xuthus" class="section level3 tabset tabset-fade tabset-pills">
<h3><em>Papilio xuthus</em></h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">Anova</span>(m.flower.vs.leaf.pap) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:76%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.flower.vs.leaf</strong></td>
<td align="center">27309</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-1" class="section level4">
<h4>Pair-wise p-values</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat.pap, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA.pap, <span class="dt">y=</span>VislistB.pap, <span class="dt">fill=</span>flower.vs.leaf)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA.pap, VislistB.pap, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(flower.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.flower.vs.leaf)))<span class="op">+</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb10-7"><a href="#cb10-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb10-8"><a href="#cb10-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb10-9"><a href="#cb10-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb10-10"><a href="#cb10-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p></br> </br></p>
</div>
<div id="original-model-output-1" class="section level4">
<h4>Original model output</h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>sum.flower.vs.leaf.pap</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.flower.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.flower.vs.leaf.pap, REML = F)
## 
## Linear Hypotheses:
##                                                    Estimate Std. Error z value
## pap600.flower.vs.leaf - pap580.flower.vs.leaf == 0  0.68948    0.02006   34.37
## pap620.flower.vs.leaf - pap580.flower.vs.leaf == 0  1.77492    0.02006   88.48
## pap640.flower.vs.leaf - pap580.flower.vs.leaf == 0  2.63397    0.02006  131.31
## pap660.flower.vs.leaf - pap580.flower.vs.leaf == 0  2.61129    0.02006  130.17
## pap620.flower.vs.leaf - pap600.flower.vs.leaf == 0  1.08544    0.02006   54.11
## pap640.flower.vs.leaf - pap600.flower.vs.leaf == 0  1.94449    0.02006   96.93
## pap660.flower.vs.leaf - pap600.flower.vs.leaf == 0  1.92181    0.02006   95.80
## pap640.flower.vs.leaf - pap620.flower.vs.leaf == 0  0.85905    0.02006   42.82
## pap660.flower.vs.leaf - pap620.flower.vs.leaf == 0  0.83637    0.02006   41.69
## pap660.flower.vs.leaf - pap640.flower.vs.leaf == 0 -0.02268    0.02006   -1.13
##                                                    Pr(&gt;|z|)    
## pap600.flower.vs.leaf - pap580.flower.vs.leaf == 0   &lt;2e-16 ***
## pap620.flower.vs.leaf - pap580.flower.vs.leaf == 0   &lt;2e-16 ***
## pap640.flower.vs.leaf - pap580.flower.vs.leaf == 0   &lt;2e-16 ***
## pap660.flower.vs.leaf - pap580.flower.vs.leaf == 0   &lt;2e-16 ***
## pap620.flower.vs.leaf - pap600.flower.vs.leaf == 0   &lt;2e-16 ***
## pap640.flower.vs.leaf - pap600.flower.vs.leaf == 0   &lt;2e-16 ***
## pap660.flower.vs.leaf - pap600.flower.vs.leaf == 0   &lt;2e-16 ***
## pap640.flower.vs.leaf - pap620.flower.vs.leaf == 0   &lt;2e-16 ***
## pap660.flower.vs.leaf - pap620.flower.vs.leaf == 0   &lt;2e-16 ***
## pap660.flower.vs.leaf - pap640.flower.vs.leaf == 0        1    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
<div id="heliconius-sp" class="section level3 tabset tabset-fade tabset-pills">
<h3><em>Heliconius</em> sp</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">Anova</span>(m.flower.vs.leaf.heli) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:76%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.flower.vs.leaf</strong></td>
<td align="center">32813</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-2" class="section level4">
<h4>Pair-wise p-values</h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat.heli, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA.heli, <span class="dt">y=</span>VislistB.heli, <span class="dt">fill=</span>flower.vs.leaf)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA.heli, VislistB.heli, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(flower.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.flower.vs.leaf)))<span class="op">+</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb14-7"><a href="#cb14-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb14-8"><a href="#cb14-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb14-9"><a href="#cb14-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb14-10"><a href="#cb14-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p></br> </br></p>
</div>
<div id="original-model-output-2" class="section level4">
<h4>Original model output</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>sum.flower.vs.leaf.heli</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.flower.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.flower.vs.leaf.heli, REML = F)
## 
## Linear Hypotheses:
##                                                      Estimate Std. Error
## heli600.flower.vs.leaf - heli580.flower.vs.leaf == 0  0.42090    0.01189
## heli620.flower.vs.leaf - heli580.flower.vs.leaf == 0  1.13320    0.01189
## heli640.flower.vs.leaf - heli580.flower.vs.leaf == 0  1.71168    0.01189
## heli660.flower.vs.leaf - heli580.flower.vs.leaf == 0  1.67741    0.01189
## heli620.flower.vs.leaf - heli600.flower.vs.leaf == 0  0.71230    0.01189
## heli640.flower.vs.leaf - heli600.flower.vs.leaf == 0  1.29079    0.01189
## heli660.flower.vs.leaf - heli600.flower.vs.leaf == 0  1.25652    0.01189
## heli640.flower.vs.leaf - heli620.flower.vs.leaf == 0  0.57849    0.01189
## heli660.flower.vs.leaf - heli620.flower.vs.leaf == 0  0.54421    0.01189
## heli660.flower.vs.leaf - heli640.flower.vs.leaf == 0 -0.03427    0.01189
##                                                      z value Pr(&gt;|z|)    
## heli600.flower.vs.leaf - heli580.flower.vs.leaf == 0  35.411   &lt;2e-16 ***
## heli620.flower.vs.leaf - heli580.flower.vs.leaf == 0  95.339   &lt;2e-16 ***
## heli640.flower.vs.leaf - heli580.flower.vs.leaf == 0 144.009   &lt;2e-16 ***
## heli660.flower.vs.leaf - heli580.flower.vs.leaf == 0 141.125   &lt;2e-16 ***
## heli620.flower.vs.leaf - heli600.flower.vs.leaf == 0  59.928   &lt;2e-16 ***
## heli640.flower.vs.leaf - heli600.flower.vs.leaf == 0 108.598   &lt;2e-16 ***
## heli660.flower.vs.leaf - heli600.flower.vs.leaf == 0 105.714   &lt;2e-16 ***
## heli640.flower.vs.leaf - heli620.flower.vs.leaf == 0  48.670   &lt;2e-16 ***
## heli660.flower.vs.leaf - heli620.flower.vs.leaf == 0  45.786   &lt;2e-16 ***
## heli660.flower.vs.leaf - heli640.flower.vs.leaf == 0  -2.883   0.0393 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
</div>
<div id="beetle-vs-leaf" class="section level2 tabset tabset-fade tabset-pills">
<h2><strong>Beetle vs Leaf</strong></h2>
<div id="agrilus-planipennis-1" class="section level3 tabset tabset-fade tabset-pills">
<h3><em>Agrilus planipennis</em></h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">Anova</span>(m.beetle.vs.leaf.bup) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:76%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.leaf</strong></td>
<td align="center">10679</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-3" class="section level4">
<h4>Pair-wise p-values</h4>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat.bup, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA.bup, <span class="dt">y=</span>VislistB.bup, <span class="dt">fill=</span>beetle.vs.leaf)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA.bup, VislistB.bup, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.leaf))) <span class="op">+</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb18-7"><a href="#cb18-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb18-8"><a href="#cb18-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb18-9"><a href="#cb18-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb18-10"><a href="#cb18-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p></br> </br></p>
</div>
<div id="original-model-output-3" class="section level4">
<h4>Original model output</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>sum.beetle.vs.leaf.bup</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.beetle.vs.leaf.bup, REML = F)
## 
## Linear Hypotheses:
##                                                    Estimate Std. Error z value
## bup600.beetle.vs.leaf - bup580.beetle.vs.leaf == 0  0.68827    0.02643  26.044
## bup620.beetle.vs.leaf - bup580.beetle.vs.leaf == 0  1.46939    0.02643  55.602
## bup640.beetle.vs.leaf - bup580.beetle.vs.leaf == 0  2.06989    0.02643  78.324
## bup660.beetle.vs.leaf - bup580.beetle.vs.leaf == 0  2.32172    0.02643  87.854
## bup620.beetle.vs.leaf - bup600.beetle.vs.leaf == 0  0.78112    0.02643  29.558
## bup640.beetle.vs.leaf - bup600.beetle.vs.leaf == 0  1.38162    0.02643  52.280
## bup660.beetle.vs.leaf - bup600.beetle.vs.leaf == 0  1.63345    0.02643  61.810
## bup640.beetle.vs.leaf - bup620.beetle.vs.leaf == 0  0.60050    0.02643  22.723
## bup660.beetle.vs.leaf - bup620.beetle.vs.leaf == 0  0.85233    0.02643  32.252
## bup660.beetle.vs.leaf - bup640.beetle.vs.leaf == 0  0.25184    0.02643   9.529
##                                                    Pr(&gt;|z|)    
## bup600.beetle.vs.leaf - bup580.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup620.beetle.vs.leaf - bup580.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup640.beetle.vs.leaf - bup580.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup660.beetle.vs.leaf - bup580.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup620.beetle.vs.leaf - bup600.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup640.beetle.vs.leaf - bup600.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup660.beetle.vs.leaf - bup600.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup640.beetle.vs.leaf - bup620.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup660.beetle.vs.leaf - bup620.beetle.vs.leaf == 0   &lt;2e-16 ***
## bup660.beetle.vs.leaf - bup640.beetle.vs.leaf == 0   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
<div id="papilio-xuthus-1" class="section level3 tabset tabset-fade tabset-pills">
<h3><em>Papilio xuthus</em></h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">Anova</span>(m.beetle.vs.leaf.pap) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:76%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.leaf</strong></td>
<td align="center">20388</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-4" class="section level4">
<h4>Pair-wise p-values</h4>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat.pap, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA.pap, <span class="dt">y=</span>VislistB.pap, <span class="dt">fill=</span>beetle.vs.leaf)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA.pap, VislistB.pap, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.leaf))) <span class="op">+</span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb22-7"><a href="#cb22-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb22-8"><a href="#cb22-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb22-9"><a href="#cb22-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb22-10"><a href="#cb22-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb22-11"><a href="#cb22-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p></br> </br></p>
</div>
<div id="original-model-output-4" class="section level4">
<h4>Original model output</h4>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>sum.beetle.vs.leaf.pap</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.beetle.vs.leaf.pap, REML = F)
## 
## Linear Hypotheses:
##                                                    Estimate Std. Error z value
## pap600.beetle.vs.leaf - pap580.beetle.vs.leaf == 0  0.85513    0.02241   38.16
## pap620.beetle.vs.leaf - pap580.beetle.vs.leaf == 0  1.76841    0.02241   78.91
## pap640.beetle.vs.leaf - pap580.beetle.vs.leaf == 0  2.44445    0.02241  109.07
## pap660.beetle.vs.leaf - pap580.beetle.vs.leaf == 0  2.72785    0.02241  121.72
## pap620.beetle.vs.leaf - pap600.beetle.vs.leaf == 0  0.91328    0.02241   40.75
## pap640.beetle.vs.leaf - pap600.beetle.vs.leaf == 0  1.58933    0.02241   70.92
## pap660.beetle.vs.leaf - pap600.beetle.vs.leaf == 0  1.87273    0.02241   83.56
## pap640.beetle.vs.leaf - pap620.beetle.vs.leaf == 0  0.67604    0.02241   30.17
## pap660.beetle.vs.leaf - pap620.beetle.vs.leaf == 0  0.95944    0.02241   42.81
## pap660.beetle.vs.leaf - pap640.beetle.vs.leaf == 0  0.28340    0.02241   12.64
##                                                    Pr(&gt;|z|)    
## pap600.beetle.vs.leaf - pap580.beetle.vs.leaf == 0   &lt;2e-16 ***
## pap620.beetle.vs.leaf - pap580.beetle.vs.leaf == 0   &lt;2e-16 ***
## pap640.beetle.vs.leaf - pap580.beetle.vs.leaf == 0   &lt;2e-16 ***
## pap660.beetle.vs.leaf - pap580.beetle.vs.leaf == 0   &lt;2e-16 ***
## pap620.beetle.vs.leaf - pap600.beetle.vs.leaf == 0   &lt;2e-16 ***
## pap640.beetle.vs.leaf - pap600.beetle.vs.leaf == 0   &lt;2e-16 ***
## pap660.beetle.vs.leaf - pap600.beetle.vs.leaf == 0   &lt;2e-16 ***
## pap640.beetle.vs.leaf - pap620.beetle.vs.leaf == 0   &lt;2e-16 ***
## pap660.beetle.vs.leaf - pap620.beetle.vs.leaf == 0   &lt;2e-16 ***
## pap660.beetle.vs.leaf - pap640.beetle.vs.leaf == 0   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
<div id="heliconius-sp-1" class="section level3 tabset tabset-fade tabset-pills">
<h3><em>Heliconius</em> sp</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">Anova</span>(m.beetle.vs.leaf.heli) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:76%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.leaf</strong></td>
<td align="center">18227</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-5" class="section level4">
<h4>Pair-wise p-values</h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat.heli, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA.heli, <span class="dt">y=</span>VislistB.heli, <span class="dt">fill=</span>beetle.vs.leaf)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA.heli, VislistB.heli, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.leaf, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.leaf))) <span class="op">+</span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb26-7"><a href="#cb26-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb26-8"><a href="#cb26-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb26-9"><a href="#cb26-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb26-10"><a href="#cb26-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p></br> </br></p>
</div>
<div id="original-model-output-5" class="section level4">
<h4>Original model output</h4>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>sum.beetle.vs.leaf.heli</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.leaf + (1 | patch2) + (1 | 
##     patch1), data = compare.beetle.vs.leaf.heli, REML = F)
## 
## Linear Hypotheses:
##                                                      Estimate Std. Error
## heli600.beetle.vs.leaf - heli580.beetle.vs.leaf == 0  0.55507    0.01541
## heli620.beetle.vs.leaf - heli580.beetle.vs.leaf == 0  1.14395    0.01541
## heli640.beetle.vs.leaf - heli580.beetle.vs.leaf == 0  1.58503    0.01541
## heli660.beetle.vs.leaf - heli580.beetle.vs.leaf == 0  1.77791    0.01541
## heli620.beetle.vs.leaf - heli600.beetle.vs.leaf == 0  0.58888    0.01541
## heli640.beetle.vs.leaf - heli600.beetle.vs.leaf == 0  1.02995    0.01541
## heli660.beetle.vs.leaf - heli600.beetle.vs.leaf == 0  1.22284    0.01541
## heli640.beetle.vs.leaf - heli620.beetle.vs.leaf == 0  0.44108    0.01541
## heli660.beetle.vs.leaf - heli620.beetle.vs.leaf == 0  0.63396    0.01541
## heli660.beetle.vs.leaf - heli640.beetle.vs.leaf == 0  0.19289    0.01541
##                                                      z value Pr(&gt;|z|)    
## heli600.beetle.vs.leaf - heli580.beetle.vs.leaf == 0   36.01   &lt;2e-16 ***
## heli620.beetle.vs.leaf - heli580.beetle.vs.leaf == 0   74.22   &lt;2e-16 ***
## heli640.beetle.vs.leaf - heli580.beetle.vs.leaf == 0  102.83   &lt;2e-16 ***
## heli660.beetle.vs.leaf - heli580.beetle.vs.leaf == 0  115.34   &lt;2e-16 ***
## heli620.beetle.vs.leaf - heli600.beetle.vs.leaf == 0   38.20   &lt;2e-16 ***
## heli640.beetle.vs.leaf - heli600.beetle.vs.leaf == 0   66.82   &lt;2e-16 ***
## heli660.beetle.vs.leaf - heli600.beetle.vs.leaf == 0   79.33   &lt;2e-16 ***
## heli640.beetle.vs.leaf - heli620.beetle.vs.leaf == 0   28.61   &lt;2e-16 ***
## heli660.beetle.vs.leaf - heli620.beetle.vs.leaf == 0   41.13   &lt;2e-16 ***
## heli660.beetle.vs.leaf - heli640.beetle.vs.leaf == 0   12.51   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
</div>
<div id="beetle-vs-flower" class="section level2 tabset tabset-fade tabset-pills">
<h2><strong>Beetle vs Flower</strong></h2>
<div id="agrilus-planipennis-2" class="section level3 tabset tabset-fade tabset-pills">
<h3><em>Agrilus planipennis</em></h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">Anova</span>(m.beetle.vs.flower.bup) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:79%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="43%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.flower</strong></td>
<td align="center">3063</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-6" class="section level4">
<h4>Pair-wise p-values</h4>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat.bup, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA.bup, <span class="dt">y=</span>VislistB.bup, <span class="dt">fill=</span>beetle.vs.flower)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA.bup, VislistB.bup, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.flower, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.flower)))<span class="op">+</span></span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour </span></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb30-7"><a href="#cb30-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb30-8"><a href="#cb30-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb30-9"><a href="#cb30-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb30-10"><a href="#cb30-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb30-11"><a href="#cb30-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-27-1.png" width="672" /> </br> </br></p>
</div>
<div id="original-model-output-6" class="section level4">
<h4>Original model output</h4>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>sum.beetle.vs.flower.bup</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.flower + (1 | patch2) + 
##     (1 | patch1), data = compare.beetle.vs.flower.bup, REML = F)
## 
## Linear Hypotheses:
##                                                        Estimate Std. Error
## bup600.beetle.vs.flower - bup580.beetle.vs.flower == 0  0.45586    0.03766
## bup620.beetle.vs.flower - bup580.beetle.vs.flower == 0  1.01303    0.03766
## bup640.beetle.vs.flower - bup580.beetle.vs.flower == 0  1.47154    0.03766
## bup660.beetle.vs.flower - bup580.beetle.vs.flower == 0  1.81545    0.03766
## bup620.beetle.vs.flower - bup600.beetle.vs.flower == 0  0.55717    0.03766
## bup640.beetle.vs.flower - bup600.beetle.vs.flower == 0  1.01568    0.03766
## bup660.beetle.vs.flower - bup600.beetle.vs.flower == 0  1.35958    0.03766
## bup640.beetle.vs.flower - bup620.beetle.vs.flower == 0  0.45851    0.03766
## bup660.beetle.vs.flower - bup620.beetle.vs.flower == 0  0.80241    0.03766
## bup660.beetle.vs.flower - bup640.beetle.vs.flower == 0  0.34391    0.03766
##                                                        z value Pr(&gt;|z|)    
## bup600.beetle.vs.flower - bup580.beetle.vs.flower == 0  12.106   &lt;2e-16 ***
## bup620.beetle.vs.flower - bup580.beetle.vs.flower == 0  26.902   &lt;2e-16 ***
## bup640.beetle.vs.flower - bup580.beetle.vs.flower == 0  39.077   &lt;2e-16 ***
## bup660.beetle.vs.flower - bup580.beetle.vs.flower == 0  48.210   &lt;2e-16 ***
## bup620.beetle.vs.flower - bup600.beetle.vs.flower == 0  14.796   &lt;2e-16 ***
## bup640.beetle.vs.flower - bup600.beetle.vs.flower == 0  26.972   &lt;2e-16 ***
## bup660.beetle.vs.flower - bup600.beetle.vs.flower == 0  36.104   &lt;2e-16 ***
## bup640.beetle.vs.flower - bup620.beetle.vs.flower == 0  12.176   &lt;2e-16 ***
## bup660.beetle.vs.flower - bup620.beetle.vs.flower == 0  21.308   &lt;2e-16 ***
## bup660.beetle.vs.flower - bup640.beetle.vs.flower == 0   9.133   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
<div id="papilio-xuthus-2" class="section level3 tabset tabset-fade tabset-pills">
<h3><em>Papilio xuthus</em></h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">Anova</span>(m.beetle.vs.flower.pap) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:79%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="43%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.flower</strong></td>
<td align="center">6368</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-7" class="section level4">
<h4>Pair-wise p-values</h4>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat.pap, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA.pap, <span class="dt">y=</span>VislistB.pap, <span class="dt">fill=</span>beetle.vs.flower)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA.pap, VislistB.pap, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.flower, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.flower)))<span class="op">+</span></span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour </span></span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb34-7"><a href="#cb34-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb34-8"><a href="#cb34-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb34-9"><a href="#cb34-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb34-10"><a href="#cb34-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb34-11"><a href="#cb34-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p></br> </br></p>
</div>
<div id="original-model-output-7" class="section level4">
<h4>Original model output</h4>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>sum.beetle.vs.flower.pap</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.flower + (1 | patch2) + 
##     (1 | patch1), data = compare.beetle.vs.flower.pap, REML = F)
## 
## Linear Hypotheses:
##                                                        Estimate Std. Error
## pap600.beetle.vs.flower - pap580.beetle.vs.flower == 0  0.66476    0.03471
## pap620.beetle.vs.flower - pap580.beetle.vs.flower == 0  1.40418    0.03471
## pap640.beetle.vs.flower - pap580.beetle.vs.flower == 0  1.98604    0.03471
## pap660.beetle.vs.flower - pap580.beetle.vs.flower == 0  2.42328    0.03471
## pap620.beetle.vs.flower - pap600.beetle.vs.flower == 0  0.73942    0.03471
## pap640.beetle.vs.flower - pap600.beetle.vs.flower == 0  1.32128    0.03471
## pap660.beetle.vs.flower - pap600.beetle.vs.flower == 0  1.75851    0.03471
## pap640.beetle.vs.flower - pap620.beetle.vs.flower == 0  0.58186    0.03471
## pap660.beetle.vs.flower - pap620.beetle.vs.flower == 0  1.01910    0.03471
## pap660.beetle.vs.flower - pap640.beetle.vs.flower == 0  0.43723    0.03471
##                                                        z value Pr(&gt;|z|)    
## pap600.beetle.vs.flower - pap580.beetle.vs.flower == 0   19.15   &lt;2e-16 ***
## pap620.beetle.vs.flower - pap580.beetle.vs.flower == 0   40.45   &lt;2e-16 ***
## pap640.beetle.vs.flower - pap580.beetle.vs.flower == 0   57.21   &lt;2e-16 ***
## pap660.beetle.vs.flower - pap580.beetle.vs.flower == 0   69.81   &lt;2e-16 ***
## pap620.beetle.vs.flower - pap600.beetle.vs.flower == 0   21.30   &lt;2e-16 ***
## pap640.beetle.vs.flower - pap600.beetle.vs.flower == 0   38.06   &lt;2e-16 ***
## pap660.beetle.vs.flower - pap600.beetle.vs.flower == 0   50.66   &lt;2e-16 ***
## pap640.beetle.vs.flower - pap620.beetle.vs.flower == 0   16.76   &lt;2e-16 ***
## pap660.beetle.vs.flower - pap620.beetle.vs.flower == 0   29.36   &lt;2e-16 ***
## pap660.beetle.vs.flower - pap640.beetle.vs.flower == 0   12.60   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
<div id="heliconius-sp-2" class="section level3 tabset tabset-fade tabset-pills">
<h3><em>Heliconius</em> sp</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">Anova</span>(m.beetle.vs.flower.heli) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</span></code></pre></div>
<table style="width:79%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="43%" />
<col width="11%" />
<col width="6%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.beetle.vs.flower</strong></td>
<td align="center">6137</td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p></br> </br></p>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-8" class="section level4">
<h4>Pair-wise p-values</h4>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> heat.heli, <span class="kw">aes</span>(<span class="dt">x=</span>VislistA.heli, <span class="dt">y=</span>VislistB.heli, <span class="dt">fill=</span>beetle.vs.flower)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA.heli, VislistB.heli, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">format</span>(<span class="kw">round</span>(beetle.vs.flower, <span class="dv">2</span>), <span class="dt">nsmall =</span> <span class="dv">2</span>), sig.beetle.vs.flower)))<span class="op">+</span></span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour </span></span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb38-6"><a href="#cb38-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb38-7"><a href="#cb38-7"></a>        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</span>
<span id="cb38-8"><a href="#cb38-8"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb38-9"><a href="#cb38-9"></a>                     <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb38-10"><a href="#cb38-10"></a>                     <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>() )<span class="op">+</span></span>
<span id="cb38-11"><a href="#cb38-11"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;p vaalue&quot;</span>)</span></code></pre></div>
<p><img src="sensitivity_analysis_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p></br> </br></p>
</div>
<div id="original-model-output-8" class="section level4">
<h4>Original model output</h4>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>sum.beetle.vs.flower.heli</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.beetle.vs.flower + (1 | patch2) + 
##     (1 | patch1), data = compare.beetle.vs.flower.heli, REML = F)
## 
## Linear Hypotheses:
##                                                          Estimate Std. Error
## heli600.beetle.vs.flower - heli580.beetle.vs.flower == 0  0.39954    0.02165
## heli620.beetle.vs.flower - heli580.beetle.vs.flower == 0  0.85116    0.02165
## heli640.beetle.vs.flower - heli580.beetle.vs.flower == 0  1.21207    0.02165
## heli660.beetle.vs.flower - heli580.beetle.vs.flower == 0  1.48278    0.02165
## heli620.beetle.vs.flower - heli600.beetle.vs.flower == 0  0.45162    0.02165
## heli640.beetle.vs.flower - heli600.beetle.vs.flower == 0  0.81253    0.02165
## heli660.beetle.vs.flower - heli600.beetle.vs.flower == 0  1.08324    0.02165
## heli640.beetle.vs.flower - heli620.beetle.vs.flower == 0  0.36091    0.02165
## heli660.beetle.vs.flower - heli620.beetle.vs.flower == 0  0.63161    0.02165
## heli660.beetle.vs.flower - heli640.beetle.vs.flower == 0  0.27070    0.02165
##                                                          z value Pr(&gt;|z|)    
## heli600.beetle.vs.flower - heli580.beetle.vs.flower == 0   18.45   &lt;2e-16 ***
## heli620.beetle.vs.flower - heli580.beetle.vs.flower == 0   39.31   &lt;2e-16 ***
## heli640.beetle.vs.flower - heli580.beetle.vs.flower == 0   55.98   &lt;2e-16 ***
## heli660.beetle.vs.flower - heli580.beetle.vs.flower == 0   68.49   &lt;2e-16 ***
## heli620.beetle.vs.flower - heli600.beetle.vs.flower == 0   20.86   &lt;2e-16 ***
## heli640.beetle.vs.flower - heli600.beetle.vs.flower == 0   37.53   &lt;2e-16 ***
## heli660.beetle.vs.flower - heli600.beetle.vs.flower == 0   50.03   &lt;2e-16 ***
## heli640.beetle.vs.flower - heli620.beetle.vs.flower == 0   16.67   &lt;2e-16 ***
## heli660.beetle.vs.flower - heli620.beetle.vs.flower == 0   29.17   &lt;2e-16 ***
## heli660.beetle.vs.flower - heli640.beetle.vs.flower == 0   12.50   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
<p></br> </br></p>
</div>
</div>
</div>
</div>
<div id="plot-the-contrasts" class="section level1 tabset tabset-fade tabset-pills">
<h1>Plot the contrasts</h1>
<ul>
<li>Colours approximate human perception of either flower (left and right) or beetle (centre) colouration.</li>
<li>Lines of the same colors connect the same sample</li>
</ul>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co">#combine all contrast value in each comparison group</span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="co">##for Agrilus planipennis</span></span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="co">###flower vs leaf</span></span>
<span id="cb41-4"><a href="#cb41-4"></a>VS1.fl.bup&lt;-<span class="st"> </span>Cbuprest580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-5"><a href="#cb41-5"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-6"><a href="#cb41-6"></a>VS1.fl.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-7"><a href="#cb41-7"></a>VS2.fl.bup&lt;-Cbuprest600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-8"><a href="#cb41-8"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-9"><a href="#cb41-9"></a>VS2.fl.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-10"><a href="#cb41-10"></a>VS3.fl.bup&lt;-Cbuprest620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-11"><a href="#cb41-11"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-12"><a href="#cb41-12"></a>VS3.fl.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-13"><a href="#cb41-13"></a>VS4.fl.bup&lt;-Cbuprest640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-14"><a href="#cb41-14"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-15"><a href="#cb41-15"></a>VS4.fl.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-16"><a href="#cb41-16"></a>VS5.fl.bup&lt;-Cbuprest660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-17"><a href="#cb41-17"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-18"><a href="#cb41-18"></a>VS5.fl.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-19"><a href="#cb41-19"></a></span>
<span id="cb41-20"><a href="#cb41-20"></a>allvis.fl.bup&lt;-VS1.fl.bup <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.fl.bup) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.fl.bup) <span class="op">%&gt;%</span></span>
<span id="cb41-21"><a href="#cb41-21"></a><span class="st">  </span><span class="kw">rbind</span>(VS4.fl.bup) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS5.fl.bup) </span>
<span id="cb41-22"><a href="#cb41-22"></a></span>
<span id="cb41-23"><a href="#cb41-23"></a><span class="co">###beetle vs leaf</span></span>
<span id="cb41-24"><a href="#cb41-24"></a>VS1.bl.bup&lt;-<span class="st"> </span>Cbuprest580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-25"><a href="#cb41-25"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-26"><a href="#cb41-26"></a>VS1.bl.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-27"><a href="#cb41-27"></a>VS2.bl.bup&lt;-Cbuprest600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-28"><a href="#cb41-28"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-29"><a href="#cb41-29"></a>VS2.bl.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-30"><a href="#cb41-30"></a>VS3.bl.bup&lt;-Cbuprest620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-31"><a href="#cb41-31"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-32"><a href="#cb41-32"></a>VS3.bl.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-33"><a href="#cb41-33"></a>VS4.bl.bup&lt;-Cbuprest640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-34"><a href="#cb41-34"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-35"><a href="#cb41-35"></a>VS4.bl.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-36"><a href="#cb41-36"></a>VS5.bl.bup&lt;-Cbuprest660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-37"><a href="#cb41-37"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-38"><a href="#cb41-38"></a>VS5.bl.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-39"><a href="#cb41-39"></a></span>
<span id="cb41-40"><a href="#cb41-40"></a>allvis.bl.bup&lt;-VS1.bl.bup <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bl.bup) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bl.bup) <span class="op">%&gt;%</span></span>
<span id="cb41-41"><a href="#cb41-41"></a><span class="st">  </span><span class="kw">rbind</span>(VS4.bl.bup) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS5.bl.bup)</span>
<span id="cb41-42"><a href="#cb41-42"></a></span>
<span id="cb41-43"><a href="#cb41-43"></a><span class="co">###beetle vs flower</span></span>
<span id="cb41-44"><a href="#cb41-44"></a>VS1.bf.bup&lt;-<span class="st"> </span>Cbuprest580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-45"><a href="#cb41-45"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb41-46"><a href="#cb41-46"></a>VS1.bf.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-47"><a href="#cb41-47"></a>VS2.bf.bup&lt;-Cbuprest600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-48"><a href="#cb41-48"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb41-49"><a href="#cb41-49"></a>VS2.bf.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-50"><a href="#cb41-50"></a>VS3.bf.bup&lt;-Cbuprest620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-51"><a href="#cb41-51"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb41-52"><a href="#cb41-52"></a>VS3.bf.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-53"><a href="#cb41-53"></a>VS4.bf.bup&lt;-Cbuprest640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-54"><a href="#cb41-54"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb41-55"><a href="#cb41-55"></a>VS4.bf.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-56"><a href="#cb41-56"></a>VS5.bf.bup&lt;-Cbuprest660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-57"><a href="#cb41-57"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb41-58"><a href="#cb41-58"></a>VS5.bf.bup<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-59"><a href="#cb41-59"></a></span>
<span id="cb41-60"><a href="#cb41-60"></a>allvis.bf.bup&lt;-VS1.bf.bup <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bf.bup) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bf.bup) <span class="op">%&gt;%</span></span>
<span id="cb41-61"><a href="#cb41-61"></a><span class="st">  </span><span class="kw">rbind</span>(VS4.bf.bup) <span class="op">%&gt;%</span><span class="kw">rbind</span>(VS5.bf.bup) </span>
<span id="cb41-62"><a href="#cb41-62"></a></span>
<span id="cb41-63"><a href="#cb41-63"></a></span>
<span id="cb41-64"><a href="#cb41-64"></a></span>
<span id="cb41-65"><a href="#cb41-65"></a><span class="co">##for Papilio xuthus</span></span>
<span id="cb41-66"><a href="#cb41-66"></a><span class="co">###flower vs leaf</span></span>
<span id="cb41-67"><a href="#cb41-67"></a>VS1.fl.pap&lt;-<span class="st"> </span>Cpapilio580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-68"><a href="#cb41-68"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-69"><a href="#cb41-69"></a>VS1.fl.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-70"><a href="#cb41-70"></a>VS2.fl.pap&lt;-Cpapilio600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-71"><a href="#cb41-71"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-72"><a href="#cb41-72"></a>VS2.fl.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-73"><a href="#cb41-73"></a>VS3.fl.pap&lt;-Cpapilio620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-74"><a href="#cb41-74"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-75"><a href="#cb41-75"></a>VS3.fl.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-76"><a href="#cb41-76"></a>VS4.fl.pap&lt;-Cpapilio640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-77"><a href="#cb41-77"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-78"><a href="#cb41-78"></a>VS4.fl.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-79"><a href="#cb41-79"></a>VS5.fl.pap&lt;-Cpapilio660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-80"><a href="#cb41-80"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-81"><a href="#cb41-81"></a>VS5.fl.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-82"><a href="#cb41-82"></a></span>
<span id="cb41-83"><a href="#cb41-83"></a></span>
<span id="cb41-84"><a href="#cb41-84"></a>allvis.fl.pap&lt;-VS1.fl.pap <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.fl.pap) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.fl.pap) <span class="op">%&gt;%</span></span>
<span id="cb41-85"><a href="#cb41-85"></a><span class="st">  </span><span class="kw">rbind</span>(VS4.fl.pap) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS5.fl.pap) </span>
<span id="cb41-86"><a href="#cb41-86"></a></span>
<span id="cb41-87"><a href="#cb41-87"></a><span class="co">###beetle vs leaf</span></span>
<span id="cb41-88"><a href="#cb41-88"></a>VS1.bl.pap&lt;-<span class="st"> </span>Cpapilio580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-89"><a href="#cb41-89"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-90"><a href="#cb41-90"></a>VS1.bl.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-91"><a href="#cb41-91"></a>VS2.bl.pap&lt;-Cpapilio600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-92"><a href="#cb41-92"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-93"><a href="#cb41-93"></a>VS2.bl.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-94"><a href="#cb41-94"></a>VS3.bl.pap&lt;-Cpapilio620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-95"><a href="#cb41-95"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-96"><a href="#cb41-96"></a>VS3.bl.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-97"><a href="#cb41-97"></a>VS4.bl.pap&lt;-Cpapilio640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-98"><a href="#cb41-98"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-99"><a href="#cb41-99"></a>VS4.bl.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-100"><a href="#cb41-100"></a>VS5.bl.pap&lt;-Cpapilio660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-101"><a href="#cb41-101"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-102"><a href="#cb41-102"></a>VS5.bl.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-103"><a href="#cb41-103"></a></span>
<span id="cb41-104"><a href="#cb41-104"></a></span>
<span id="cb41-105"><a href="#cb41-105"></a>allvis.bl.pap&lt;-VS1.bl.pap <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bl.pap) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bl.pap) <span class="op">%&gt;%</span></span>
<span id="cb41-106"><a href="#cb41-106"></a><span class="st">  </span><span class="kw">rbind</span>(VS4.bl.pap) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS5.bl.pap) </span>
<span id="cb41-107"><a href="#cb41-107"></a></span>
<span id="cb41-108"><a href="#cb41-108"></a><span class="co">###beetle vs flower</span></span>
<span id="cb41-109"><a href="#cb41-109"></a>VS1.bf.pap&lt;-<span class="st"> </span>Cpapilio580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-110"><a href="#cb41-110"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb41-111"><a href="#cb41-111"></a>VS1.bf.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-112"><a href="#cb41-112"></a>VS2.bf.pap&lt;-Cpapilio600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-113"><a href="#cb41-113"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb41-114"><a href="#cb41-114"></a>VS2.bf.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-115"><a href="#cb41-115"></a>VS3.bf.pap&lt;-Cpapilio620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-116"><a href="#cb41-116"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb41-117"><a href="#cb41-117"></a>VS3.bf.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-118"><a href="#cb41-118"></a>VS4.bf.pap&lt;-Cpapilio640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-119"><a href="#cb41-119"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb41-120"><a href="#cb41-120"></a>VS4.bf.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-121"><a href="#cb41-121"></a>VS5.bf.pap&lt;-Cpapilio660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-122"><a href="#cb41-122"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb41-123"><a href="#cb41-123"></a>VS5.bf.pap<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-124"><a href="#cb41-124"></a></span>
<span id="cb41-125"><a href="#cb41-125"></a>allvis.bf.pap&lt;-VS1.bf.pap <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bf.pap) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bf.pap) <span class="op">%&gt;%</span></span>
<span id="cb41-126"><a href="#cb41-126"></a><span class="st">  </span><span class="kw">rbind</span>(VS4.bf.pap) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS5.bf.pap) </span>
<span id="cb41-127"><a href="#cb41-127"></a></span>
<span id="cb41-128"><a href="#cb41-128"></a></span>
<span id="cb41-129"><a href="#cb41-129"></a></span>
<span id="cb41-130"><a href="#cb41-130"></a></span>
<span id="cb41-131"><a href="#cb41-131"></a><span class="co">##for Heliconius sp</span></span>
<span id="cb41-132"><a href="#cb41-132"></a><span class="co">###flower vs leaf</span></span>
<span id="cb41-133"><a href="#cb41-133"></a>VS1.fl.heli&lt;-<span class="st"> </span>Cheliconius580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-134"><a href="#cb41-134"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-135"><a href="#cb41-135"></a>VS1.fl.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-136"><a href="#cb41-136"></a>VS2.fl.heli&lt;-Cheliconius600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-137"><a href="#cb41-137"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-138"><a href="#cb41-138"></a>VS2.fl.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-139"><a href="#cb41-139"></a>VS3.fl.heli&lt;-Cheliconius620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-140"><a href="#cb41-140"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-141"><a href="#cb41-141"></a>VS3.fl.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-142"><a href="#cb41-142"></a>VS4.fl.heli&lt;-Cheliconius640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-143"><a href="#cb41-143"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-144"><a href="#cb41-144"></a>VS4.fl.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-145"><a href="#cb41-145"></a>VS5.fl.heli&lt;-Cheliconius660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-146"><a href="#cb41-146"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-147"><a href="#cb41-147"></a>VS5.fl.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.fl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-148"><a href="#cb41-148"></a></span>
<span id="cb41-149"><a href="#cb41-149"></a></span>
<span id="cb41-150"><a href="#cb41-150"></a>allvis.fl.heli&lt;-VS1.fl.heli <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.fl.heli) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.fl.heli) <span class="op">%&gt;%</span></span>
<span id="cb41-151"><a href="#cb41-151"></a><span class="st">  </span><span class="kw">rbind</span>(VS4.fl.heli) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS5.fl.heli) </span>
<span id="cb41-152"><a href="#cb41-152"></a></span>
<span id="cb41-153"><a href="#cb41-153"></a><span class="co">###beetle vs leaf</span></span>
<span id="cb41-154"><a href="#cb41-154"></a>VS1.bl.heli&lt;-<span class="st"> </span>Cheliconius580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-155"><a href="#cb41-155"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-156"><a href="#cb41-156"></a>VS1.bl.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-157"><a href="#cb41-157"></a>VS2.bl.heli&lt;-Cheliconius600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-158"><a href="#cb41-158"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-159"><a href="#cb41-159"></a>VS2.bl.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-160"><a href="#cb41-160"></a>VS3.bl.heli&lt;-Cheliconius620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-161"><a href="#cb41-161"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-162"><a href="#cb41-162"></a>VS3.bl.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-163"><a href="#cb41-163"></a>VS4.bl.heli&lt;-Cheliconius640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-164"><a href="#cb41-164"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-165"><a href="#cb41-165"></a>VS4.bl.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-166"><a href="#cb41-166"></a>VS5.bl.heli&lt;-Cheliconius660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-167"><a href="#cb41-167"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))</span>
<span id="cb41-168"><a href="#cb41-168"></a>VS5.bl.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.bl&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-169"><a href="#cb41-169"></a></span>
<span id="cb41-170"><a href="#cb41-170"></a></span>
<span id="cb41-171"><a href="#cb41-171"></a>allvis.bl.heli&lt;-VS1.bl.heli <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bl.heli) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bl.heli) <span class="op">%&gt;%</span></span>
<span id="cb41-172"><a href="#cb41-172"></a><span class="st">  </span><span class="kw">rbind</span>(VS4.bl.heli) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS5.bl.heli) </span>
<span id="cb41-173"><a href="#cb41-173"></a></span>
<span id="cb41-174"><a href="#cb41-174"></a><span class="co">###beetle vs flower</span></span>
<span id="cb41-175"><a href="#cb41-175"></a>VS1.bf.heli&lt;-<span class="st"> </span>Cheliconius580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-176"><a href="#cb41-176"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb41-177"><a href="#cb41-177"></a>VS1.bf.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS1.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-178"><a href="#cb41-178"></a>VS2.bf.heli&lt;-Cheliconius600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-179"><a href="#cb41-179"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb41-180"><a href="#cb41-180"></a>VS2.bf.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS2.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-181"><a href="#cb41-181"></a>VS3.bf.heli&lt;-Cheliconius620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-182"><a href="#cb41-182"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb41-183"><a href="#cb41-183"></a>VS3.bf.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS3.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-184"><a href="#cb41-184"></a>VS4.bf.heli&lt;-Cheliconius640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-185"><a href="#cb41-185"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb41-186"><a href="#cb41-186"></a>VS4.bf.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS4.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-187"><a href="#cb41-187"></a>VS5.bf.heli&lt;-Cheliconius660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-188"><a href="#cb41-188"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))</span>
<span id="cb41-189"><a href="#cb41-189"></a>VS5.bf.heli<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;VS5.bf&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb41-190"><a href="#cb41-190"></a></span>
<span id="cb41-191"><a href="#cb41-191"></a>allvis.bf.heli&lt;-VS1.bf.heli <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS2.bf.heli) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS3.bf.heli) <span class="op">%&gt;%</span></span>
<span id="cb41-192"><a href="#cb41-192"></a><span class="st">  </span><span class="kw">rbind</span>(VS4.bf.heli) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(VS5.bf.heli) </span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co">#import the flower color code </span></span>
<span id="cb42-2"><a href="#cb42-2"></a>color.code&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;data/color code list.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) </span>
<span id="cb42-3"><a href="#cb42-3"></a></span>
<span id="cb42-4"><a href="#cb42-4"></a><span class="co">#creat a list of species name used in the spec data and </span></span>
<span id="cb42-5"><a href="#cb42-5"></a>name.list&lt;-<span class="kw">unique</span>(dataset.transpose<span class="op">$</span>species) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-6"><a href="#cb42-6"></a><span class="st">  </span><span class="kw">sort</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#order it alphebatically as well</span></span>
<span id="cb42-7"><a href="#cb42-7"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">species =</span> <span class="st">&quot;.&quot;</span>)<span class="co">#make it a data frame and name the column &quot;species&quot;</span></span>
<span id="cb42-8"><a href="#cb42-8"></a></span>
<span id="cb42-9"><a href="#cb42-9"></a><span class="co">#creat flower name list</span></span>
<span id="cb42-10"><a href="#cb42-10"></a>flower.colour &lt;-<span class="st"> </span>name.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(species, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower names</span></span>
<span id="cb42-11"><a href="#cb42-11"></a><span class="st">  </span><span class="kw">cbind</span>(color.code <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(type, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(name)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower color codes and order it alphebatically</span></span>
<span id="cb42-12"><a href="#cb42-12"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#remove the redundant column</span></span>
<span id="cb42-13"><a href="#cb42-13"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">uncount</span>(count) <span class="co">#repeat each row for 5 times for 5 visual systems</span></span>
<span id="cb42-14"><a href="#cb42-14"></a></span>
<span id="cb42-15"><a href="#cb42-15"></a><span class="co">#creat beetle name list</span></span>
<span id="cb42-16"><a href="#cb42-16"></a></span>
<span id="cb42-17"><a href="#cb42-17"></a>beetle.colour&lt;-<span class="st"> </span>name.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(species, <span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower names</span></span>
<span id="cb42-18"><a href="#cb42-18"></a><span class="st">  </span><span class="kw">cbind</span>(color.code <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(type, <span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(name)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower color codes and order it alphebatically</span></span>
<span id="cb42-19"><a href="#cb42-19"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#remove the redundant column</span></span>
<span id="cb42-20"><a href="#cb42-20"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">uncount</span>(count) <span class="co">#repeat each row for 5 times for 5 visual systems</span></span></code></pre></div>
<div id="agrilus-planipennis-3" class="section level2">
<h2><em>Agrilus planipennis</em></h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co">#make flower vs leaf plot</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="co">##add the mean</span></span>
<span id="cb43-3"><a href="#cb43-3"></a>mean.fl.bup&lt;-allvis.fl.bup <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.fl.bup<span class="op">$</span>vissys,allvis.fl.bup<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span></span>
<span id="cb43-5"><a href="#cb43-5"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.fl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-6"><a href="#cb43-6"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb43-7"><a href="#cb43-7"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-8"><a href="#cb43-8"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb43-9"><a href="#cb43-9"></a></span>
<span id="cb43-10"><a href="#cb43-10"></a><span class="co">##plot the mean</span></span>
<span id="cb43-11"><a href="#cb43-11"></a><span class="kw">names</span>(mean.fl.bup)[<span class="kw">names</span>(mean.fl.bup) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span> </span>
<span id="cb43-12"><a href="#cb43-12"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb43-13"><a href="#cb43-13"></a>mean.fl.bup&lt;-mean.fl.bup[<span class="kw">order</span>(mean.fl.bup<span class="op">$</span>flowerID),] </span>
<span id="cb43-14"><a href="#cb43-14"></a><span class="co">#make the data frame order by flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb43-15"><a href="#cb43-15"></a></span>
<span id="cb43-16"><a href="#cb43-16"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb43-17"><a href="#cb43-17"></a>mean.fl.bup<span class="op">$</span>match.name&lt;-flower.colour<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb43-18"><a href="#cb43-18"></a>mean.fl.bup<span class="op">$</span>colour&lt;-flower.colour<span class="op">$</span>colour</span>
<span id="cb43-19"><a href="#cb43-19"></a></span>
<span id="cb43-20"><a href="#cb43-20"></a>fl.bup&lt;-<span class="kw">ggplot</span>(mean.fl.bup, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.fl,<span class="dt">group=</span>flowerID))<span class="op">+</span></span>
<span id="cb43-21"><a href="#cb43-21"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.fl.bup<span class="op">$</span>colour,<span class="dt">size=</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-22"><a href="#cb43-22"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.fl.bup<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb43-23"><a href="#cb43-23"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb43-24"><a href="#cb43-24"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb43-25"><a href="#cb43-25"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">21</span>)<span class="op">+</span></span>
<span id="cb43-26"><a href="#cb43-26"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb43-27"><a href="#cb43-27"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span></span>
<span id="cb43-28"><a href="#cb43-28"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb43-29"><a href="#cb43-29"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),</span>
<span id="cb43-30"><a href="#cb43-30"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb43-31"><a href="#cb43-31"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb43-32"><a href="#cb43-32"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb43-33"><a href="#cb43-33"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb43-34"><a href="#cb43-34"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb43-35"><a href="#cb43-35"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb43-36"><a href="#cb43-36"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb43-37"><a href="#cb43-37"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb43-38"><a href="#cb43-38"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>,<span class="st">&quot;VS5.fl&quot;</span>),</span>
<span id="cb43-39"><a href="#cb43-39"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span></span>
<span id="cb43-40"><a href="#cb43-40"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co">##add a JND=1 line</span></span>
<span id="cb43-41"><a href="#cb43-41"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.fl.bup<span class="op">$</span>dS)), </span>
<span id="cb43-42"><a href="#cb43-42"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb43-43"><a href="#cb43-43"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.fl.bup<span class="op">$</span>dS)), </span>
<span id="cb43-44"><a href="#cb43-44"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb43-45"><a href="#cb43-45"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.fl.bup<span class="op">$</span>dS)), </span>
<span id="cb43-46"><a href="#cb43-46"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb43-47"><a href="#cb43-47"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.fl.bup<span class="op">$</span>dS)), </span>
<span id="cb43-48"><a href="#cb43-48"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb43-49"><a href="#cb43-49"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.fl.bup<span class="op">$</span>dS)), </span>
<span id="cb43-50"><a href="#cb43-50"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb43-51"><a href="#cb43-51"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb43-52"><a href="#cb43-52"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Flower vs. Leaf&quot;</span>)<span class="op">+</span></span>
<span id="cb43-53"><a href="#cb43-53"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>,<span class="st">&quot;VS5.fl&quot;</span>), <span class="dt">y =</span> <span class="dv">21</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;d&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb43-54"><a href="#cb43-54"></a></span>
<span id="cb43-55"><a href="#cb43-55"></a></span>
<span id="cb43-56"><a href="#cb43-56"></a><span class="co">#make beetle vs leaf plot</span></span>
<span id="cb43-57"><a href="#cb43-57"></a><span class="co">##add the mean</span></span>
<span id="cb43-58"><a href="#cb43-58"></a>mean.bl.bup&lt;-allvis.bl.bup <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bl.bup<span class="op">$</span>vissys,allvis.bl.bup<span class="op">$</span>patch2,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-59"><a href="#cb43-59"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch2(beetles) and vissys</span></span>
<span id="cb43-60"><a href="#cb43-60"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-61"><a href="#cb43-61"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb43-62"><a href="#cb43-62"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-63"><a href="#cb43-63"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb43-64"><a href="#cb43-64"></a></span>
<span id="cb43-65"><a href="#cb43-65"></a><span class="co">##plot the mean</span></span>
<span id="cb43-66"><a href="#cb43-66"></a><span class="kw">names</span>(mean.bl.bup)[<span class="kw">names</span>(mean.bl.bup) <span class="op">==</span><span class="st"> &quot;patch2&quot;</span>] &lt;-<span class="st"> &quot;beetleID&quot;</span></span>
<span id="cb43-67"><a href="#cb43-67"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb43-68"><a href="#cb43-68"></a>mean.bl.bup&lt;-mean.bl.bup[<span class="kw">order</span>(mean.bl.bup<span class="op">$</span>beetleID),]</span>
<span id="cb43-69"><a href="#cb43-69"></a><span class="co">#make the data frame order bt beetleID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb43-70"><a href="#cb43-70"></a></span>
<span id="cb43-71"><a href="#cb43-71"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb43-72"><a href="#cb43-72"></a>mean.bl.bup<span class="op">$</span>match.name&lt;-beetle.colour<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb43-73"><a href="#cb43-73"></a>mean.bl.bup<span class="op">$</span>colour&lt;-beetle.colour<span class="op">$</span>colour</span>
<span id="cb43-74"><a href="#cb43-74"></a></span>
<span id="cb43-75"><a href="#cb43-75"></a></span>
<span id="cb43-76"><a href="#cb43-76"></a>bl.bup&lt;-<span class="kw">ggplot</span>(mean.bl.bup, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bl,<span class="dt">group=</span>beetleID))<span class="op">+</span></span>
<span id="cb43-77"><a href="#cb43-77"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bl.bup<span class="op">$</span>colour,<span class="dt">size=</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-78"><a href="#cb43-78"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bl.bup<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb43-79"><a href="#cb43-79"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb43-80"><a href="#cb43-80"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb43-81"><a href="#cb43-81"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">21</span>)<span class="op">+</span></span>
<span id="cb43-82"><a href="#cb43-82"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb43-83"><a href="#cb43-83"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb43-84"><a href="#cb43-84"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),</span>
<span id="cb43-85"><a href="#cb43-85"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb43-86"><a href="#cb43-86"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb43-87"><a href="#cb43-87"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb43-88"><a href="#cb43-88"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb43-89"><a href="#cb43-89"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb43-90"><a href="#cb43-90"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb43-91"><a href="#cb43-91"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb43-92"><a href="#cb43-92"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb43-93"><a href="#cb43-93"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>,<span class="st">&quot;VS5.bl&quot;</span>),</span>
<span id="cb43-94"><a href="#cb43-94"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span></span>
<span id="cb43-95"><a href="#cb43-95"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co">##add a JND=1 line</span></span>
<span id="cb43-96"><a href="#cb43-96"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bl.bup<span class="op">$</span>dS)), </span>
<span id="cb43-97"><a href="#cb43-97"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb43-98"><a href="#cb43-98"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bl.bup<span class="op">$</span>dS)), </span>
<span id="cb43-99"><a href="#cb43-99"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb43-100"><a href="#cb43-100"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bl.bup<span class="op">$</span>dS)), </span>
<span id="cb43-101"><a href="#cb43-101"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb43-102"><a href="#cb43-102"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bl.bup<span class="op">$</span>dS)), </span>
<span id="cb43-103"><a href="#cb43-103"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb43-104"><a href="#cb43-104"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.bl.bup<span class="op">$</span>dS)), </span>
<span id="cb43-105"><a href="#cb43-105"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb43-106"><a href="#cb43-106"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb43-107"><a href="#cb43-107"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Leaf&quot;</span>)<span class="op">+</span></span>
<span id="cb43-108"><a href="#cb43-108"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>,<span class="st">&quot;VS5.bl&quot;</span>), <span class="dt">y =</span> <span class="dv">21</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb43-109"><a href="#cb43-109"></a></span>
<span id="cb43-110"><a href="#cb43-110"></a></span>
<span id="cb43-111"><a href="#cb43-111"></a><span class="co">#make beetle vs flower plot</span></span>
<span id="cb43-112"><a href="#cb43-112"></a><span class="co">##add the mean</span></span>
<span id="cb43-113"><a href="#cb43-113"></a>mean.bf.bup&lt;-allvis.bf.bup <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bf.bup<span class="op">$</span>vissys,allvis.bf.bup<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-114"><a href="#cb43-114"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span></span>
<span id="cb43-115"><a href="#cb43-115"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#patch1(flowers</span></span>
<span id="cb43-116"><a href="#cb43-116"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb43-117"><a href="#cb43-117"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-118"><a href="#cb43-118"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb43-119"><a href="#cb43-119"></a></span>
<span id="cb43-120"><a href="#cb43-120"></a></span>
<span id="cb43-121"><a href="#cb43-121"></a><span class="co">##plot the mean dS</span></span>
<span id="cb43-122"><a href="#cb43-122"></a><span class="kw">names</span>(mean.bf.bup)[<span class="kw">names</span>(mean.bf.bup) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span></span>
<span id="cb43-123"><a href="#cb43-123"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb43-124"><a href="#cb43-124"></a>mean.bf.bup&lt;-mean.bf.bup[<span class="kw">order</span>(mean.bf.bup<span class="op">$</span>flowerID),]</span>
<span id="cb43-125"><a href="#cb43-125"></a><span class="co">#make the data frame order bt flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb43-126"><a href="#cb43-126"></a></span>
<span id="cb43-127"><a href="#cb43-127"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb43-128"><a href="#cb43-128"></a>mean.bf.bup<span class="op">$</span>match.name&lt;-flower.colour<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb43-129"><a href="#cb43-129"></a>mean.bf.bup<span class="op">$</span>colour&lt;-flower.colour<span class="op">$</span>colour</span>
<span id="cb43-130"><a href="#cb43-130"></a></span>
<span id="cb43-131"><a href="#cb43-131"></a>bf.bup&lt;-<span class="kw">ggplot</span>(mean.bf.bup, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bf,<span class="dt">group=</span>flowerID))<span class="op">+</span></span>
<span id="cb43-132"><a href="#cb43-132"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bf.bup<span class="op">$</span>colour, <span class="dt">size=</span> <span class="dv">1</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-133"><a href="#cb43-133"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bf.bup<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb43-134"><a href="#cb43-134"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb43-135"><a href="#cb43-135"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb43-136"><a href="#cb43-136"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">21</span>)<span class="op">+</span></span>
<span id="cb43-137"><a href="#cb43-137"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb43-138"><a href="#cb43-138"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span></span>
<span id="cb43-139"><a href="#cb43-139"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb43-140"><a href="#cb43-140"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),</span>
<span id="cb43-141"><a href="#cb43-141"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb43-142"><a href="#cb43-142"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb43-143"><a href="#cb43-143"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb43-144"><a href="#cb43-144"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb43-145"><a href="#cb43-145"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb43-146"><a href="#cb43-146"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb43-147"><a href="#cb43-147"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb43-148"><a href="#cb43-148"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb43-149"><a href="#cb43-149"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>,<span class="st">&quot;VS5.bf&quot;</span>),</span>
<span id="cb43-150"><a href="#cb43-150"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span></span>
<span id="cb43-151"><a href="#cb43-151"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co">##add a JND=1 line</span></span>
<span id="cb43-152"><a href="#cb43-152"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bf.bup<span class="op">$</span>dS)), </span>
<span id="cb43-153"><a href="#cb43-153"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb43-154"><a href="#cb43-154"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bf.bup<span class="op">$</span>dS)), </span>
<span id="cb43-155"><a href="#cb43-155"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb43-156"><a href="#cb43-156"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bf.bup<span class="op">$</span>dS)), </span>
<span id="cb43-157"><a href="#cb43-157"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb43-158"><a href="#cb43-158"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bf.bup<span class="op">$</span>dS)), </span>
<span id="cb43-159"><a href="#cb43-159"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb43-160"><a href="#cb43-160"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.bup, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.bf.bup<span class="op">$</span>dS)), </span>
<span id="cb43-161"><a href="#cb43-161"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb43-162"><a href="#cb43-162"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb43-163"><a href="#cb43-163"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Flower&quot;</span>)<span class="op">+</span></span>
<span id="cb43-164"><a href="#cb43-164"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>,<span class="st">&quot;VS5.bf&quot;</span>), <span class="dt">y =</span> <span class="dv">21</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb43-165"><a href="#cb43-165"></a></span>
<span id="cb43-166"><a href="#cb43-166"></a></span>
<span id="cb43-167"><a href="#cb43-167"></a>figure.bup &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(fl.bup,bl.bup,bf.bup, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb43-168"><a href="#cb43-168"></a>figure.bup</span></code></pre></div>
<div class="figure">
<img src="sensitivity_analysis_files/figure-html/unnamed-chunk-37-1.png" alt="Figure caption: Comparison of chromatic contrast between visual systems with the LWS photoreceptor peaking at different wavelengths in the jewel beetle, _Agrilus planipenni_. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Two contrasts &gt; 12 JND are from flowers that have high UV - blue chroma compared to beetles and leaves." width="672" />
<p class="caption">
Figure caption: Comparison of chromatic contrast between visual systems with the LWS photoreceptor peaking at different wavelengths in the jewel beetle, <em>Agrilus planipenni</em>. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Two contrasts &gt; 12 JND are from flowers that have high UV - blue chroma compared to beetles and leaves.
</p>
</div>
<p></br> </br></p>
</div>
<div id="papilio-xuthus-3" class="section level2">
<h2><em>Papilio xuthus</em></h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co">#make flower vs leaf plot</span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="co">##add the mean</span></span>
<span id="cb44-3"><a href="#cb44-3"></a>mean.fl.pap&lt;-allvis.fl.pap <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.fl.pap<span class="op">$</span>vissys,allvis.fl.pap<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span></span>
<span id="cb44-5"><a href="#cb44-5"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.fl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-6"><a href="#cb44-6"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-8"><a href="#cb44-8"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb44-9"><a href="#cb44-9"></a></span>
<span id="cb44-10"><a href="#cb44-10"></a><span class="co">##plot the mean</span></span>
<span id="cb44-11"><a href="#cb44-11"></a><span class="kw">names</span>(mean.fl.pap)[<span class="kw">names</span>(mean.fl.pap) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span> </span>
<span id="cb44-12"><a href="#cb44-12"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb44-13"><a href="#cb44-13"></a>mean.fl.pap&lt;-mean.fl.pap[<span class="kw">order</span>(mean.fl.pap<span class="op">$</span>flowerID),] </span>
<span id="cb44-14"><a href="#cb44-14"></a><span class="co">#make the data frame order by flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb44-15"><a href="#cb44-15"></a></span>
<span id="cb44-16"><a href="#cb44-16"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb44-17"><a href="#cb44-17"></a>mean.fl.pap<span class="op">$</span>match.name&lt;-flower.colour<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb44-18"><a href="#cb44-18"></a>mean.fl.pap<span class="op">$</span>colour&lt;-flower.colour<span class="op">$</span>colour</span>
<span id="cb44-19"><a href="#cb44-19"></a></span>
<span id="cb44-20"><a href="#cb44-20"></a>fl.pap&lt;-<span class="kw">ggplot</span>(mean.fl.pap, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.fl,<span class="dt">group=</span>flowerID))<span class="op">+</span></span>
<span id="cb44-21"><a href="#cb44-21"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.fl.pap<span class="op">$</span>colour,<span class="dt">size=</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-22"><a href="#cb44-22"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.fl.pap<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb44-23"><a href="#cb44-23"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb44-24"><a href="#cb44-24"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb44-25"><a href="#cb44-25"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">21</span>)<span class="op">+</span></span>
<span id="cb44-26"><a href="#cb44-26"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb44-27"><a href="#cb44-27"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span></span>
<span id="cb44-28"><a href="#cb44-28"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb44-29"><a href="#cb44-29"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),</span>
<span id="cb44-30"><a href="#cb44-30"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb44-31"><a href="#cb44-31"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb44-32"><a href="#cb44-32"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb44-33"><a href="#cb44-33"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb44-34"><a href="#cb44-34"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb44-35"><a href="#cb44-35"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb44-36"><a href="#cb44-36"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb44-37"><a href="#cb44-37"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb44-38"><a href="#cb44-38"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>,<span class="st">&quot;VS5.fl&quot;</span>),</span>
<span id="cb44-39"><a href="#cb44-39"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span></span>
<span id="cb44-40"><a href="#cb44-40"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co">##add a JND=1 line</span></span>
<span id="cb44-41"><a href="#cb44-41"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.fl.pap<span class="op">$</span>dS)), </span>
<span id="cb44-42"><a href="#cb44-42"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb44-43"><a href="#cb44-43"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.fl.pap<span class="op">$</span>dS)), </span>
<span id="cb44-44"><a href="#cb44-44"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb44-45"><a href="#cb44-45"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.fl.pap<span class="op">$</span>dS)), </span>
<span id="cb44-46"><a href="#cb44-46"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb44-47"><a href="#cb44-47"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.fl.pap<span class="op">$</span>dS)), </span>
<span id="cb44-48"><a href="#cb44-48"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb44-49"><a href="#cb44-49"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.fl.pap<span class="op">$</span>dS)), </span>
<span id="cb44-50"><a href="#cb44-50"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb44-51"><a href="#cb44-51"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb44-52"><a href="#cb44-52"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Flower vs. Leaf&quot;</span>)<span class="op">+</span></span>
<span id="cb44-53"><a href="#cb44-53"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>,<span class="st">&quot;VS5.fl&quot;</span>), <span class="dt">y =</span> <span class="dv">21</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;d&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb44-54"><a href="#cb44-54"></a></span>
<span id="cb44-55"><a href="#cb44-55"></a></span>
<span id="cb44-56"><a href="#cb44-56"></a><span class="co">#make beetle vs leaf plot</span></span>
<span id="cb44-57"><a href="#cb44-57"></a><span class="co">##add the mean</span></span>
<span id="cb44-58"><a href="#cb44-58"></a>mean.bl.pap&lt;-allvis.bl.pap <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bl.pap<span class="op">$</span>vissys,allvis.bl.pap<span class="op">$</span>patch2,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-59"><a href="#cb44-59"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch2(beetles) and vissys</span></span>
<span id="cb44-60"><a href="#cb44-60"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-61"><a href="#cb44-61"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb44-62"><a href="#cb44-62"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-63"><a href="#cb44-63"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb44-64"><a href="#cb44-64"></a></span>
<span id="cb44-65"><a href="#cb44-65"></a><span class="co">##plot the mean</span></span>
<span id="cb44-66"><a href="#cb44-66"></a><span class="kw">names</span>(mean.bl.pap)[<span class="kw">names</span>(mean.bl.pap) <span class="op">==</span><span class="st"> &quot;patch2&quot;</span>] &lt;-<span class="st"> &quot;beetleID&quot;</span></span>
<span id="cb44-67"><a href="#cb44-67"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb44-68"><a href="#cb44-68"></a>mean.bl.pap&lt;-mean.bl.pap[<span class="kw">order</span>(mean.bl.pap<span class="op">$</span>beetleID),]</span>
<span id="cb44-69"><a href="#cb44-69"></a><span class="co">#make the data frame order bt beetleID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb44-70"><a href="#cb44-70"></a></span>
<span id="cb44-71"><a href="#cb44-71"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb44-72"><a href="#cb44-72"></a>mean.bl.pap<span class="op">$</span>match.name&lt;-beetle.colour<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb44-73"><a href="#cb44-73"></a>mean.bl.pap<span class="op">$</span>colour&lt;-beetle.colour<span class="op">$</span>colour</span>
<span id="cb44-74"><a href="#cb44-74"></a></span>
<span id="cb44-75"><a href="#cb44-75"></a></span>
<span id="cb44-76"><a href="#cb44-76"></a>bl.pap&lt;-<span class="kw">ggplot</span>(mean.bl.pap, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bl,<span class="dt">group=</span>beetleID))<span class="op">+</span></span>
<span id="cb44-77"><a href="#cb44-77"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bl.pap<span class="op">$</span>colour,<span class="dt">size=</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-78"><a href="#cb44-78"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bl.pap<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb44-79"><a href="#cb44-79"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb44-80"><a href="#cb44-80"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb44-81"><a href="#cb44-81"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">21</span>)<span class="op">+</span></span>
<span id="cb44-82"><a href="#cb44-82"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb44-83"><a href="#cb44-83"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb44-84"><a href="#cb44-84"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),</span>
<span id="cb44-85"><a href="#cb44-85"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb44-86"><a href="#cb44-86"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb44-87"><a href="#cb44-87"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb44-88"><a href="#cb44-88"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb44-89"><a href="#cb44-89"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb44-90"><a href="#cb44-90"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb44-91"><a href="#cb44-91"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb44-92"><a href="#cb44-92"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb44-93"><a href="#cb44-93"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>,<span class="st">&quot;VS5.bl&quot;</span>),</span>
<span id="cb44-94"><a href="#cb44-94"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span></span>
<span id="cb44-95"><a href="#cb44-95"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co">##add a JND=1 line</span></span>
<span id="cb44-96"><a href="#cb44-96"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bl.pap<span class="op">$</span>dS)), </span>
<span id="cb44-97"><a href="#cb44-97"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb44-98"><a href="#cb44-98"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bl.pap<span class="op">$</span>dS)), </span>
<span id="cb44-99"><a href="#cb44-99"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb44-100"><a href="#cb44-100"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bl.pap<span class="op">$</span>dS)), </span>
<span id="cb44-101"><a href="#cb44-101"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb44-102"><a href="#cb44-102"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bl.pap<span class="op">$</span>dS)), </span>
<span id="cb44-103"><a href="#cb44-103"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb44-104"><a href="#cb44-104"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.bl.pap<span class="op">$</span>dS)), </span>
<span id="cb44-105"><a href="#cb44-105"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb44-106"><a href="#cb44-106"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb44-107"><a href="#cb44-107"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Leaf&quot;</span>)<span class="op">+</span></span>
<span id="cb44-108"><a href="#cb44-108"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>,<span class="st">&quot;VS5.bl&quot;</span>), <span class="dt">y =</span> <span class="dv">21</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb44-109"><a href="#cb44-109"></a></span>
<span id="cb44-110"><a href="#cb44-110"></a></span>
<span id="cb44-111"><a href="#cb44-111"></a><span class="co">#make beetle vs flower plot</span></span>
<span id="cb44-112"><a href="#cb44-112"></a><span class="co">##add the mean</span></span>
<span id="cb44-113"><a href="#cb44-113"></a>mean.bf.pap&lt;-allvis.bf.pap <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bf.pap<span class="op">$</span>vissys,allvis.bf.pap<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-114"><a href="#cb44-114"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span></span>
<span id="cb44-115"><a href="#cb44-115"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#patch1(flowers</span></span>
<span id="cb44-116"><a href="#cb44-116"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb44-117"><a href="#cb44-117"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-118"><a href="#cb44-118"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb44-119"><a href="#cb44-119"></a></span>
<span id="cb44-120"><a href="#cb44-120"></a></span>
<span id="cb44-121"><a href="#cb44-121"></a><span class="co">##plot the mean dS</span></span>
<span id="cb44-122"><a href="#cb44-122"></a><span class="kw">names</span>(mean.bf.pap)[<span class="kw">names</span>(mean.bf.pap) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span></span>
<span id="cb44-123"><a href="#cb44-123"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb44-124"><a href="#cb44-124"></a>mean.bf.pap&lt;-mean.bf.pap[<span class="kw">order</span>(mean.bf.pap<span class="op">$</span>flowerID),]</span>
<span id="cb44-125"><a href="#cb44-125"></a><span class="co">#make the data frame order bt flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb44-126"><a href="#cb44-126"></a></span>
<span id="cb44-127"><a href="#cb44-127"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb44-128"><a href="#cb44-128"></a>mean.bf.pap<span class="op">$</span>match.name&lt;-flower.colour<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb44-129"><a href="#cb44-129"></a>mean.bf.pap<span class="op">$</span>colour&lt;-flower.colour<span class="op">$</span>colour</span>
<span id="cb44-130"><a href="#cb44-130"></a></span>
<span id="cb44-131"><a href="#cb44-131"></a>bf.pap&lt;-<span class="kw">ggplot</span>(mean.bf.pap, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bf,<span class="dt">group=</span>flowerID))<span class="op">+</span></span>
<span id="cb44-132"><a href="#cb44-132"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bf.pap<span class="op">$</span>colour, <span class="dt">size=</span> <span class="dv">1</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-133"><a href="#cb44-133"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bf.pap<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb44-134"><a href="#cb44-134"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb44-135"><a href="#cb44-135"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb44-136"><a href="#cb44-136"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">21</span>)<span class="op">+</span></span>
<span id="cb44-137"><a href="#cb44-137"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb44-138"><a href="#cb44-138"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span></span>
<span id="cb44-139"><a href="#cb44-139"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb44-140"><a href="#cb44-140"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),</span>
<span id="cb44-141"><a href="#cb44-141"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb44-142"><a href="#cb44-142"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb44-143"><a href="#cb44-143"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb44-144"><a href="#cb44-144"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb44-145"><a href="#cb44-145"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb44-146"><a href="#cb44-146"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb44-147"><a href="#cb44-147"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb44-148"><a href="#cb44-148"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb44-149"><a href="#cb44-149"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>,<span class="st">&quot;VS5.bf&quot;</span>),</span>
<span id="cb44-150"><a href="#cb44-150"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span></span>
<span id="cb44-151"><a href="#cb44-151"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co">##add a JND=1 line</span></span>
<span id="cb44-152"><a href="#cb44-152"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bf.pap<span class="op">$</span>dS)), </span>
<span id="cb44-153"><a href="#cb44-153"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb44-154"><a href="#cb44-154"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bf.pap<span class="op">$</span>dS)), </span>
<span id="cb44-155"><a href="#cb44-155"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb44-156"><a href="#cb44-156"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bf.pap<span class="op">$</span>dS)), </span>
<span id="cb44-157"><a href="#cb44-157"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb44-158"><a href="#cb44-158"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bf.pap<span class="op">$</span>dS)), </span>
<span id="cb44-159"><a href="#cb44-159"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb44-160"><a href="#cb44-160"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.pap, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.bf.pap<span class="op">$</span>dS)), </span>
<span id="cb44-161"><a href="#cb44-161"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb44-162"><a href="#cb44-162"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb44-163"><a href="#cb44-163"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Flower&quot;</span>)<span class="op">+</span></span>
<span id="cb44-164"><a href="#cb44-164"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>,<span class="st">&quot;VS5.bf&quot;</span>), <span class="dt">y =</span> <span class="dv">21</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb44-165"><a href="#cb44-165"></a></span>
<span id="cb44-166"><a href="#cb44-166"></a></span>
<span id="cb44-167"><a href="#cb44-167"></a>figure.pap &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(fl.pap,bl.pap,bf.pap, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb44-168"><a href="#cb44-168"></a>figure.pap</span></code></pre></div>
<div class="figure">
<img src="sensitivity_analysis_files/figure-html/unnamed-chunk-38-1.png" alt="Figure caption: Comparison of chromatic contrast between visual systems with the LWS photoreceptor peaking at different wavelengths in the butterfly, _Papilio xuthus_. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1." width="672" />
<p class="caption">
Figure caption: Comparison of chromatic contrast between visual systems with the LWS photoreceptor peaking at different wavelengths in the butterfly, <em>Papilio xuthus</em>. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1.
</p>
</div>
<p></br> </br></p>
</div>
<div id="heliconius-sp-3" class="section level2">
<h2><em>Heliconius</em> sp</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co">#make flower vs leaf plot</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="co">##add the mean</span></span>
<span id="cb45-3"><a href="#cb45-3"></a>mean.fl.heli&lt;-allvis.fl.heli <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.fl.heli<span class="op">$</span>vissys,allvis.fl.heli<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-4"><a href="#cb45-4"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span></span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.fl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-6"><a href="#cb45-6"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb45-7"><a href="#cb45-7"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-8"><a href="#cb45-8"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb45-9"><a href="#cb45-9"></a></span>
<span id="cb45-10"><a href="#cb45-10"></a><span class="co">##plot the mean</span></span>
<span id="cb45-11"><a href="#cb45-11"></a><span class="kw">names</span>(mean.fl.heli)[<span class="kw">names</span>(mean.fl.heli) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span> </span>
<span id="cb45-12"><a href="#cb45-12"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb45-13"><a href="#cb45-13"></a>mean.fl.heli&lt;-mean.fl.heli[<span class="kw">order</span>(mean.fl.heli<span class="op">$</span>flowerID),] </span>
<span id="cb45-14"><a href="#cb45-14"></a><span class="co">#make the data frame order by flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb45-15"><a href="#cb45-15"></a></span>
<span id="cb45-16"><a href="#cb45-16"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb45-17"><a href="#cb45-17"></a>mean.fl.heli<span class="op">$</span>match.name&lt;-flower.colour<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb45-18"><a href="#cb45-18"></a>mean.fl.heli<span class="op">$</span>colour&lt;-flower.colour<span class="op">$</span>colour</span>
<span id="cb45-19"><a href="#cb45-19"></a></span>
<span id="cb45-20"><a href="#cb45-20"></a>fl.heli&lt;-<span class="kw">ggplot</span>(mean.fl.heli, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.fl,<span class="dt">group=</span>flowerID))<span class="op">+</span></span>
<span id="cb45-21"><a href="#cb45-21"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.fl.heli<span class="op">$</span>colour,<span class="dt">size=</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-22"><a href="#cb45-22"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.fl.heli<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb45-23"><a href="#cb45-23"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb45-24"><a href="#cb45-24"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb45-25"><a href="#cb45-25"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span></span>
<span id="cb45-26"><a href="#cb45-26"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb45-27"><a href="#cb45-27"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span></span>
<span id="cb45-28"><a href="#cb45-28"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb45-29"><a href="#cb45-29"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),</span>
<span id="cb45-30"><a href="#cb45-30"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb45-31"><a href="#cb45-31"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb45-32"><a href="#cb45-32"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb45-33"><a href="#cb45-33"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb45-34"><a href="#cb45-34"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb45-35"><a href="#cb45-35"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb45-36"><a href="#cb45-36"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb45-37"><a href="#cb45-37"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb45-38"><a href="#cb45-38"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>,<span class="st">&quot;VS5.fl&quot;</span>),</span>
<span id="cb45-39"><a href="#cb45-39"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span></span>
<span id="cb45-40"><a href="#cb45-40"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co">##add a JND=1 line</span></span>
<span id="cb45-41"><a href="#cb45-41"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.fl.heli<span class="op">$</span>dS)), </span>
<span id="cb45-42"><a href="#cb45-42"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb45-43"><a href="#cb45-43"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.fl.heli<span class="op">$</span>dS)), </span>
<span id="cb45-44"><a href="#cb45-44"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb45-45"><a href="#cb45-45"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.fl.heli<span class="op">$</span>dS)), </span>
<span id="cb45-46"><a href="#cb45-46"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb45-47"><a href="#cb45-47"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.fl.heli<span class="op">$</span>dS)), </span>
<span id="cb45-48"><a href="#cb45-48"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb45-49"><a href="#cb45-49"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.fl.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.fl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.fl.heli<span class="op">$</span>dS)), </span>
<span id="cb45-50"><a href="#cb45-50"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb45-51"><a href="#cb45-51"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb45-52"><a href="#cb45-52"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Flower vs. Leaf&quot;</span>)<span class="op">+</span></span>
<span id="cb45-53"><a href="#cb45-53"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.fl&quot;</span>, <span class="st">&quot;VS2.fl&quot;</span>, <span class="st">&quot;VS3.fl&quot;</span>,<span class="st">&quot;VS4.fl&quot;</span>,<span class="st">&quot;VS5.fl&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb45-54"><a href="#cb45-54"></a></span>
<span id="cb45-55"><a href="#cb45-55"></a></span>
<span id="cb45-56"><a href="#cb45-56"></a><span class="co">#make beetle vs leaf plot</span></span>
<span id="cb45-57"><a href="#cb45-57"></a><span class="co">##add the mean</span></span>
<span id="cb45-58"><a href="#cb45-58"></a>mean.bl.heli&lt;-allvis.bl.heli <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bl.heli<span class="op">$</span>vissys,allvis.bl.heli<span class="op">$</span>patch2,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-59"><a href="#cb45-59"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch2(beetles) and vissys</span></span>
<span id="cb45-60"><a href="#cb45-60"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bl=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-61"><a href="#cb45-61"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb45-62"><a href="#cb45-62"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-63"><a href="#cb45-63"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb45-64"><a href="#cb45-64"></a></span>
<span id="cb45-65"><a href="#cb45-65"></a><span class="co">##plot the mean</span></span>
<span id="cb45-66"><a href="#cb45-66"></a><span class="kw">names</span>(mean.bl.heli)[<span class="kw">names</span>(mean.bl.heli) <span class="op">==</span><span class="st"> &quot;patch2&quot;</span>] &lt;-<span class="st"> &quot;beetleID&quot;</span></span>
<span id="cb45-67"><a href="#cb45-67"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb45-68"><a href="#cb45-68"></a>mean.bl.heli&lt;-mean.bl.heli[<span class="kw">order</span>(mean.bl.heli<span class="op">$</span>beetleID),]</span>
<span id="cb45-69"><a href="#cb45-69"></a><span class="co">#make the data frame order bt beetleID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb45-70"><a href="#cb45-70"></a></span>
<span id="cb45-71"><a href="#cb45-71"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb45-72"><a href="#cb45-72"></a>mean.bl.heli<span class="op">$</span>match.name&lt;-beetle.colour<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb45-73"><a href="#cb45-73"></a>mean.bl.heli<span class="op">$</span>colour&lt;-beetle.colour<span class="op">$</span>colour</span>
<span id="cb45-74"><a href="#cb45-74"></a></span>
<span id="cb45-75"><a href="#cb45-75"></a></span>
<span id="cb45-76"><a href="#cb45-76"></a>bl.heli&lt;-<span class="kw">ggplot</span>(mean.bl.heli, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bl,<span class="dt">group=</span>beetleID))<span class="op">+</span></span>
<span id="cb45-77"><a href="#cb45-77"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bl.heli<span class="op">$</span>colour,<span class="dt">size=</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-78"><a href="#cb45-78"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bl.heli<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb45-79"><a href="#cb45-79"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb45-80"><a href="#cb45-80"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb45-81"><a href="#cb45-81"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span></span>
<span id="cb45-82"><a href="#cb45-82"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb45-83"><a href="#cb45-83"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb45-84"><a href="#cb45-84"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),</span>
<span id="cb45-85"><a href="#cb45-85"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb45-86"><a href="#cb45-86"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb45-87"><a href="#cb45-87"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb45-88"><a href="#cb45-88"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb45-89"><a href="#cb45-89"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb45-90"><a href="#cb45-90"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb45-91"><a href="#cb45-91"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb45-92"><a href="#cb45-92"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb45-93"><a href="#cb45-93"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>,<span class="st">&quot;VS5.bl&quot;</span>),</span>
<span id="cb45-94"><a href="#cb45-94"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span></span>
<span id="cb45-95"><a href="#cb45-95"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co">##add a JND=1 line</span></span>
<span id="cb45-96"><a href="#cb45-96"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bl.heli<span class="op">$</span>dS)), </span>
<span id="cb45-97"><a href="#cb45-97"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb45-98"><a href="#cb45-98"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bl.heli<span class="op">$</span>dS)), </span>
<span id="cb45-99"><a href="#cb45-99"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb45-100"><a href="#cb45-100"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bl.heli<span class="op">$</span>dS)), </span>
<span id="cb45-101"><a href="#cb45-101"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb45-102"><a href="#cb45-102"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bl.heli<span class="op">$</span>dS)), </span>
<span id="cb45-103"><a href="#cb45-103"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb45-104"><a href="#cb45-104"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bl.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.bl&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.bl.heli<span class="op">$</span>dS)), </span>
<span id="cb45-105"><a href="#cb45-105"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb45-106"><a href="#cb45-106"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb45-107"><a href="#cb45-107"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Leaf&quot;</span>)<span class="op">+</span></span>
<span id="cb45-108"><a href="#cb45-108"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bl&quot;</span>, <span class="st">&quot;VS2.bl&quot;</span>, <span class="st">&quot;VS3.bl&quot;</span>,<span class="st">&quot;VS4.bl&quot;</span>,<span class="st">&quot;VS5.bl&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb45-109"><a href="#cb45-109"></a></span>
<span id="cb45-110"><a href="#cb45-110"></a></span>
<span id="cb45-111"><a href="#cb45-111"></a><span class="co">#make beetle vs flower plot</span></span>
<span id="cb45-112"><a href="#cb45-112"></a><span class="co">##add the mean</span></span>
<span id="cb45-113"><a href="#cb45-113"></a>mean.bf.heli&lt;-allvis.bf.heli <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bf.heli<span class="op">$</span>vissys,allvis.bf.heli<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-114"><a href="#cb45-114"></a><span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span></span>
<span id="cb45-115"><a href="#cb45-115"></a><span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#patch1(flowers</span></span>
<span id="cb45-116"><a href="#cb45-116"></a><span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span></span>
<span id="cb45-117"><a href="#cb45-117"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-118"><a href="#cb45-118"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span></span>
<span id="cb45-119"><a href="#cb45-119"></a></span>
<span id="cb45-120"><a href="#cb45-120"></a></span>
<span id="cb45-121"><a href="#cb45-121"></a><span class="co">##plot the mean dS</span></span>
<span id="cb45-122"><a href="#cb45-122"></a><span class="kw">names</span>(mean.bf.heli)[<span class="kw">names</span>(mean.bf.heli) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span></span>
<span id="cb45-123"><a href="#cb45-123"></a><span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span></span>
<span id="cb45-124"><a href="#cb45-124"></a>mean.bf.heli&lt;-mean.bf.heli[<span class="kw">order</span>(mean.bf.heli<span class="op">$</span>flowerID),]</span>
<span id="cb45-125"><a href="#cb45-125"></a><span class="co">#make the data frame order bt flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span></span>
<span id="cb45-126"><a href="#cb45-126"></a></span>
<span id="cb45-127"><a href="#cb45-127"></a><span class="co">##combine the colour code list to the mean.bf for ploting</span></span>
<span id="cb45-128"><a href="#cb45-128"></a>mean.bf.heli<span class="op">$</span>match.name&lt;-flower.colour<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span></span>
<span id="cb45-129"><a href="#cb45-129"></a>mean.bf.heli<span class="op">$</span>colour&lt;-flower.colour<span class="op">$</span>colour</span>
<span id="cb45-130"><a href="#cb45-130"></a></span>
<span id="cb45-131"><a href="#cb45-131"></a>bf.heli&lt;-<span class="kw">ggplot</span>(mean.bf.heli, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bf,<span class="dt">group=</span>flowerID))<span class="op">+</span></span>
<span id="cb45-132"><a href="#cb45-132"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bf.heli<span class="op">$</span>colour, <span class="dt">size=</span> <span class="dv">1</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-133"><a href="#cb45-133"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bf.heli<span class="op">$</span>colour, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb45-134"><a href="#cb45-134"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span></span>
<span id="cb45-135"><a href="#cb45-135"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span></span>
<span id="cb45-136"><a href="#cb45-136"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span></span>
<span id="cb45-137"><a href="#cb45-137"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb45-138"><a href="#cb45-138"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span></span>
<span id="cb45-139"><a href="#cb45-139"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  </span>
<span id="cb45-140"><a href="#cb45-140"></a>        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),</span>
<span id="cb45-141"><a href="#cb45-141"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb45-142"><a href="#cb45-142"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb45-143"><a href="#cb45-143"></a>        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb45-144"><a href="#cb45-144"></a>        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),</span>
<span id="cb45-145"><a href="#cb45-145"></a>        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),</span>
<span id="cb45-146"><a href="#cb45-146"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb45-147"><a href="#cb45-147"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb45-148"><a href="#cb45-148"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span></span>
<span id="cb45-149"><a href="#cb45-149"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>,<span class="st">&quot;VS5.bf&quot;</span>),</span>
<span id="cb45-150"><a href="#cb45-150"></a>                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;VS 580&quot;</span>, <span class="st">&quot;VS 600&quot;</span>,<span class="st">&quot;VS 620&quot;</span>,<span class="st">&quot;VS 640&quot;</span>,<span class="st">&quot;VS 660&quot;</span>))<span class="op">+</span></span>
<span id="cb45-151"><a href="#cb45-151"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co">##add a JND=1 line</span></span>
<span id="cb45-152"><a href="#cb45-152"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS1.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS1.bf.heli<span class="op">$</span>dS)), </span>
<span id="cb45-153"><a href="#cb45-153"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb45-154"><a href="#cb45-154"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS2.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS2.bf.heli<span class="op">$</span>dS)), </span>
<span id="cb45-155"><a href="#cb45-155"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb45-156"><a href="#cb45-156"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS3.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS3.bf.heli<span class="op">$</span>dS)), </span>
<span id="cb45-157"><a href="#cb45-157"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb45-158"><a href="#cb45-158"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS4.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS4.bf.heli<span class="op">$</span>dS)), </span>
<span id="cb45-159"><a href="#cb45-159"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb45-160"><a href="#cb45-160"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf.heli, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;VS5.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">mean</span>(VS5.bf.heli<span class="op">$</span>dS)), </span>
<span id="cb45-161"><a href="#cb45-161"></a>             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the mean point</span></span>
<span id="cb45-162"><a href="#cb45-162"></a><span class="st">  </span><span class="co">#change the x labels</span></span>
<span id="cb45-163"><a href="#cb45-163"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Flower&quot;</span>)<span class="op">+</span></span>
<span id="cb45-164"><a href="#cb45-164"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;VS1.bf&quot;</span>, <span class="st">&quot;VS2.bf&quot;</span>, <span class="st">&quot;VS3.bf&quot;</span>,<span class="st">&quot;VS4.bf&quot;</span>,<span class="st">&quot;VS5.bf&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)) <span class="co">#add statistical info</span></span>
<span id="cb45-165"><a href="#cb45-165"></a></span>
<span id="cb45-166"><a href="#cb45-166"></a></span>
<span id="cb45-167"><a href="#cb45-167"></a>figure.heli &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(fl.heli,bl.heli,bf.heli, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb45-168"><a href="#cb45-168"></a>figure.heli</span></code></pre></div>
<div class="figure">
<img src="sensitivity_analysis_files/figure-html/unnamed-chunk-39-1.png" alt="Figure caption: Comparison of chromatic contrast between visual systems with the LWS photoreceptor peaking at different wavelengths in the butterfly, _Heliconius_ sp. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1." width="672" />
<p class="caption">
Figure caption: Comparison of chromatic contrast between visual systems with the LWS photoreceptor peaking at different wavelengths in the butterfly, <em>Heliconius</em> sp. Black dots show the means of the representative contrasts in visual systems. Each coloured dot represents the average contrast of each flower pattern to all leaves (left panel), each beetle colour to all leaves (middle panel) or each flower colour to all beetle colours (right panel). Colours of the dots correspond to the human-visible colour of the flower (left and right panels) or beetle (middle panel) with the lines of the same colour connecting the results between different visual systems. This is for graphical representation only; statistical tests are based on all pairwise combinations of spectra and not averages. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1.
</p>
</div>
<p></br> </br></p>
</div>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>The results were qualitatively the same for different photoreceptor ratios among three comparison groups – contrast increased for LWS photoreceptors with peak sensitivity from 580 to at least 640 nm. This indicates that our results were not biased by photoreceptor ratios in our hypothetical visual systems.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
