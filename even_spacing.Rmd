---
title: "The effect of evenly spaced photoreceptors on chromatic contrast"
output:
  pdf_document: default
  html_document:
    theme: flatly
    toc: true
    toc_depth: 2
subtitle: Supplementary Information
Date: January 08 2021
---
# The aim

* Here, we tested the effect of even spacing of sensitivities on colour discrimination in a tetrachromatic visual system. Specifically, we ran visual models with __an evenly spaced visual system__ and __an unevenly spaced visual system__, then compared spectral contrast in all three comparison groups (‘leaf vs. flower’, ‘leaf vs. beetle’, ‘beetle vs. flower’). 

* These two visual systems have the same upper and lower sensitivities with varying distribution of the two middle sensitivities. The evenly spaced visual system has peak sensitivities at 355 nm, 455 nm, 530 nm, and 660 nm, while VS 660 from the [Main models](main_models.html) section is used to represent the unevenly spaced visual system, with peak sensitivities at 355 nm, 445 nm, 530 nm, and 660 nm. 

* The model parameters and the statistical methods remain the same as described in the main text.

```{r, warning=FALSE,echo=FALSE,message=FALSE, results='hide'}
library(pavo)
library(dplyr)
library(stringr)
library(tidyr) #for gather() function
library(ggplot2)
library(lme4)
library(car)
library(multcomp)
library(boot) #for mean() function
library(pander) #for creating tidy tables
library(ggpubr) #for ggarrange() function
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning=FALSE, message=FALSE) # Suppress warnings in the HTML output
knitr::opts_chunk$set(cache=TRUE, warning = F) # set up cacheing to save time when re-building the html document
```

```{r import data,echo=FALSE,message=FALSE, warning=FALSE}
#import sensitivity curves
even.space <- read.csv("data/peak sensitivity_even space.csv",header=TRUE) %>%
  as.rspec()
# sensmodel(c(380,480,580,660),range = c(300, 800),
#                    lambdacut = NULL,beta=TRUE,
#                    oiltype = NULL, om = NULL) %>% as.rspec()
specsensbuprest.model2 <- read.csv("data/peak sensitivity_filter shift_aim2.csv",header=TRUE) %>%
  as.rspec()
#import irradiance
irradiance.d65 <- read.csv("data/d65.csv",header=TRUE) %>% 
  as.rspec(lim=c(300,800)) %>%  #set import range
  procspec(opt = c("min", "max")) #standardize the illumination spectrum
irradiance.twilight <- read.csv("data/civil twilight.csv",header=TRUE) %>% 
  as.rspec(lim=c(300,800)) %>% 
  procspec(opt = c("min", "max")) %>% 
  rename( twilight = Irradiance) %>% 
  irrad2flux() #convert the irradiance (μ Watt.cm^{-2}) to photon flux (μ mol.s^{-1}.m^{-2}) to derive correct quantum catch.


#import backgound - average leaf
aveleaf <- read.csv("data/aveleaf.csv",header=TRUE) %>% as.rspec()

#import and combind beetle, flower, leaf together
raw.dataset<-read.csv("data/refelectance spectra.csv",header=TRUE) %>% as.rspec()
dataset<- aggspec(raw.dataset, by = 3, FUN = mean) %>%  #average three measurements to a representative one
  procspec(opt = "smooth", span = 0.1, fixneg = "zero") #smooth the spectra and lift <0 to 0
```

```{r, fig.cap="Reflectance spectra of the targets",echo=FALSE,message=FALSE, warning=FALSE,fig.show='hide'}
#import spectral reflectance
#assign categoryies to each spectrum
category.list <- c("flower","leaf","beetle")
category <- rep(category.list , c(47*501,46*501,37*501))
wavelength<-rep(dataset[,1])

#transform the data for ploting purpose
dataset.transpose<-gather(dataset[,2:131], key = "species", value = "reflectance", na.rm = FALSE,
                          convert = FALSE, factor_key = FALSE)
dataset.plot.indivisually<-cbind(dataset.transpose, wavelength,category)

#split data by categories for future use
flower.spec<-dataset.plot.indivisually[1:23547,]
leaf.spec<-dataset.plot.indivisually[23548:46593,]
beetle.spec<-dataset.plot.indivisually[46594:65130,]

#merge the spectra before plot here
dataset.plot.indivisually$category2<-factor(dataset.plot.indivisually$category, levels=c("leaf","flower","beetle"))

#plot the spectra of the targets used in this model
ggplot(dataset.plot.indivisually,aes(x=wavelength,y=reflectance, colour=category2, group=species))+
  geom_point(size=.05)+
  geom_line(size=.05)+
  theme(legend.position = "none")+
  scale_color_manual( values = c( "forestgreen", "palevioletred1","cornflowerblue"))+
  facet_grid(category2 ~ .)+
  xlab("Wavelength (nm)")+ylab("Reflectance (%)")+
  theme_classic()+
  guides(colour=FALSE) # remove the legend
```

```{r, fig.cap="Figure caption: ensitivity curves of the evenly spaced visual system (solid lines) and the unevenly spaced visual system (VS 660; dotted lines).",echo=FALSE,message=FALSE, warning=FALSE}
#plot the visual systems
system.list <- c("even space","uneven space")
system.type <- rep(system.list , c(1*501,1*501))
visevencurve<-even.space %>%  rename( UVS = 2, SWS = 3, MWS = 4, LWS = 5)
VS660curve<-specsensbuprest.model2[,c(1,2,3,4,9)] %>%  rename( UVS = 2, SWS = 3, MWS = 4, LWS = 5)
combine.curves <- visevencurve %>%  rbind(VS660curve) %>% cbind(system.type) %>%
  gather( peak, value, -wl, -system.type) 

ggplot(combine.curves,aes(x=wl, y=value, linetype=system.type, color=peak))+
  geom_line()+
  guides(color=guide_legend(title="peak sensitivity", reverse=TRUE),
         linetype=guide_legend(title="system type"))+
  scale_color_manual(
    values = c("red4","olivedrab4", "dodgerblue3", "darkorchid4"),
    labels = c("LWS", "MWS", "SWS", "UVS"))+
  xlab("Wavelength (nm)")+ 
  ylab("Relative spectral sensitivity")+
  theme_classic()
```


</br>
</br>

# Data description

* We used the same spectral data collected from beetles and plants as described in the [Main models](main_models.html) section.

</br>
</br>

# Run the visual models
* We ran the visual models with the same parameter settings and steps as in the main models.
```{r,echo=FALSE,message=FALSE, warning=FALSE}

#Quantum catch - D65
buprest.even.space.d65=vismodel(dataset[1:501,], visual = even.space, bkg=aveleaf$aveleaf, illum = irradiance.d65[1:501,2], qcatch = 'fi', relative=FALSE, vonkries=TRUE)

#Quantum catch - twilight
buprest.even.space.twilight=vismodel(dataset[1:501,], visual = even.space, bkg=aveleaf$aveleaf, illum = irradiance.twilight[1:501,2], qcatch = 'fi', relative=FALSE, vonkries=TRUE)


#VS660
buprest660=vismodel(dataset[1:501,], visual = specsensbuprest.model2[, c(1,2,3,4,9)], bkg=aveleaf$aveleaf, illum = irradiance.d65[1:501,2], qcatch = 'fi', relative=FALSE, vonkries=TRUE)
buprest660_twilight=vismodel(dataset[1:501,], visual = specsensbuprest.model2[, c(1,2,3,4,9)], bkg=aveleaf$aveleaf, illum = irradiance.twilight[1:501,2], qcatch = 'fi', relative=FALSE, vonkries=TRUE)


#Contrast calculation- D65 
Cbuprest.even.space.d65 = coldist(buprest.even.space.d65, noise="neural", achro=FALSE, n = c(1.14,1,1.26,1.38), weber = 0.1, weber.ref = 4)

#Contrast calculation- twilight
Cbuprest.even.space.twilight = coldist(buprest.even.space.twilight, noise="quantum", achro=FALSE, n = c(1.14,1,1.26,1.38), weber = 0.1, weber.ref = 4)

#VS660
Cbuprest660 = coldist(buprest660, noise="neural", achro=FALSE, n = c(1.14,1,1.26,1.38), weber = 0.1, weber.ref = 4)
Cbuprest660_twilight = coldist(buprest660_twilight, noise="quantum", achro=FALSE, n = c(1.14,1,1.26,1.38), weber = 0.1, weber.ref = 4)

#combine all contrast value in each comparison group

#Daylight
##flower vs leaf
VS.fl_d65.even.space<- Cbuprest.even.space.d65%>% filter(str_detect(patch1,"flower")) %>% 
  filter(str_detect(patch2,"leaves"))
VS.fl_d65.even.space$vissys<-strrep("VS1.lf",1)

##beetle vs leaf
VS.bl_d65.even.space<- Cbuprest.even.space.d65%>% filter(str_detect(patch2,"beetle")) %>% 
  filter(str_detect(patch1,"leaves"))
VS.bl_d65.even.space$vissys<-strrep("VS1.lb",1)

##Beetle vs. Flower
VS.bf_d65.even.space<- Cbuprest.even.space.d65%>% filter(str_detect(patch1,"flower")) %>% 
  filter(str_detect(patch2,"beetle"))
VS.bf_d65.even.space$vissys<-strrep("VS1.bf",1)

##Twiligth - model 2
##flower vs leaf
VS.fl_twilight.even.space<- Cbuprest.even.space.twilight %>% filter(str_detect(patch1,"flower")) %>% 
  filter(str_detect(patch2,"leaves"))
VS.fl_twilight.even.space$vissys<-strrep("VS1.lf",1)

##beetle vs leaf
VS.bl_twilight.even.space<- Cbuprest.even.space.twilight %>% filter(str_detect(patch2,"beetle")) %>% 
  filter(str_detect(patch1,"leaves"))
VS.bl_twilight.even.space$vissys<-strrep("VS1.lb",1)

##Beetle vs. Flower
VS.bf_twilight.even.space<- Cbuprest.even.space.twilight %>% filter(str_detect(patch1,"flower")) %>% 
  filter(str_detect(patch2,"beetle"))
VS.bf_twilight.even.space$vissys<-strrep("VS1.bf",1)

#VS660
Vis5.lf_d65.model2<-Cbuprest660%>% filter(str_detect(patch1,"flower")) %>% 
  filter(str_detect(patch2,"leaves"))
Vis5.lf_d65.model2$vissys<-strrep("Vis5.lf",1)
Vis5.lb_d65.model2<-Cbuprest660%>% filter(str_detect(patch2,"beetle")) %>% 
  filter(str_detect(patch1,"leaves"))
Vis5.lb_d65.model2$vissys<-strrep("Vis5.lb",1)
Vis5.bf_d65.model2<-Cbuprest660%>% filter(str_detect(patch1,"flower")) %>% 
  filter(str_detect(patch2,"beetle"))
Vis5.bf_d65.model2$vissys<-strrep("Vis5.bf",1)
Vis5.lf_twilight.model2<-Cbuprest660_twilight %>% filter(str_detect(patch1,"flower")) %>% 
  filter(str_detect(patch2,"leaves"))
Vis5.lf_twilight.model2$vissys<-strrep("Vis5.lf",1)
Vis5.lb_twilight.model2<-Cbuprest660_twilight %>% filter(str_detect(patch2,"beetle")) %>% 
  filter(str_detect(patch1,"leaves"))
Vis5.lb_twilight.model2$vissys<-strrep("Vis5.lb",1)
Vis5.bf_twilight.model2<-Cbuprest660_twilight %>% filter(str_detect(patch1,"flower")) %>% 
  filter(str_detect(patch2,"beetle"))
Vis5.bf_twilight.model2$vissys<-strrep("Vis5.bf",1)

```
</br>
</br>

## Contrast tables{.tabset .tabset-fade .tabset-pills}
```{r,echo=FALSE,message=FALSE, warning=FALSE}
system.list.even.space<- rbind.data.frame("even space", "VS 660") %>% rename(system = 1) # make a list of system names
```

### Daylight
```{r,echo=FALSE,message=FALSE, warning=FALSE}
#Daylight
##list contrast from each comparison group
lf.contrast_d65.even.space <-rbind.data.frame(mean(VS.fl_d65.even.space$dS),mean(Vis5.lf_d65.model2$dS))
lb.contrast_d65.even.space <-rbind.data.frame(mean(VS.bl_d65.even.space$dS),mean(Vis5.lb_d65.model2$dS))
bf.contrast_d65.even.space <-rbind.data.frame(mean(VS.bf_d65.even.space$dS),mean(Vis5.bf_d65.model2$dS))


#combind comparison groups together in a table
contrast.list_d65.even.space <- system.list.even.space %>% cbind(lf.contrast_d65.even.space) %>% cbind(lb.contrast_d65.even.space) %>% cbind(bf.contrast_d65.even.space) %>% dplyr:: rename(flower.vs.leaf = 2, beetle.vs.leaf = 3, beetle.vs.flower = 4) %>% pander() 
contrast.list_d65.even.space

#to generate max and min medians from each comparison group
##for even space sivual system
# list( max(VS.fl_d65.even.space$dS), min(VS.fl_d65.even.space$dS))
# list( max(VS.bl_d65.even.space$dS), min(VS.bl_d65.even.space$dS))
# list( max(VS.bf_d65.even.space$dS), min(VS.bf_d65.even.space$dS))
# 
# ##for VS660 sivual system
# list( max(Vis5.lf_d65.model2$dS), min(Vis5.lf_d65.model2$dS))
# list( max(Vis5.lb_d65.model2$dS), min(Vis5.lb_d65.model2$dS))
# list( max(Vis5.bf_d65.model2$dS), min(Vis5.bf_d65.model2$dS))
```

</br>
</br>

### Twilight
```{r,echo=FALSE,message=FALSE, warning=FALSE}
#Twilight
##list contrast from each comparison group
lf.contrast_twilight.even.space <- rbind.data.frame(mean(VS.fl_twilight.even.space$dS),mean(Vis5.lf_twilight.model2$dS))
lb.contrast_twilight.even.space <- rbind.data.frame(mean(VS.bl_twilight.even.space$dS),mean(Vis5.lb_twilight.model2$dS))
bf.contrast_twilight.even.space <- rbind.data.frame(mean(VS.bf_twilight.even.space$dS),mean(Vis5.bf_twilight.model2$dS))

#combind comparison groups together in a table
contrast.list_twilight.even.space <- system.list.even.space %>% cbind(lf.contrast_twilight.even.space) %>% cbind(lb.contrast_twilight.even.space) %>% cbind(bf.contrast_twilight.even.space) %>% dplyr:: rename(flower.vs.leaf = 2, beetle.vs.leaf = 3, beetle.vs.flower = 4) %>% pander() 
contrast.list_twilight.even.space
```

</br>
</br>

# Compare contrasts {.tabset .tabset-fade .tabset-pills}
* To compare contrasts between visual systems, We conducted Wald chi-square tests on generalised linear mixed models (GLMM) followed by posthoc tests.

* In the models, we assigned
    + Independent variable: __contrast__
    + Dependent variable: 
        + Fixed factor: __visual system__
        + Random factor: __sample ID__ of both targets in the comparison

```{r,echo=FALSE,message=FALSE, warning=FALSE} 
#creat different comparison groups for furthur GLMM analysis
#Organize data before GLMM

#D65
##flower vs leaf
Cbuprest.even.space.flower.vs.leaf=
  Cbuprest.even.space.d65 %>%filter(str_detect(patch1, "flower")) %>% filter(str_detect(patch2, "leaves"))
Cbuprest660.flower.vs.leaf=
  Cbuprest660 %>%filter(str_detect(patch1, "flower")) %>% filter(str_detect(patch2, "leaves"))

Cbuprest.flower.vs.leaf.even.space.VS660=
  Cbuprest.even.space.flower.vs.leaf %>% rbind(Cbuprest660.flower.vs.leaf) 

bup.even.space.flower.vs.leaf<-Cbuprest.even.space.flower.vs.leaf[,3]
bup660.flower.vs.leaf<-Cbuprest660.flower.vs.leaf[,3]

com.bupcontrast.flower.vs.leaf.even.space<-cbind(Cbuprest.flower.vs.leaf.even.space.VS660[,1:2],bup.even.space.flower.vs.leaf,bup660.flower.vs.leaf)
compare.flower.vs.leaf.even.space <- com.bupcontrast.flower.vs.leaf.even.space %>%
  gather(key = "peak_wl.flower.vs.leaf", value = "dS", 3:4)

##beetle vs leaf
Cbuprest.even.space.beetle.vs.leaf=
  Cbuprest.even.space.d65 %>%filter(str_detect(patch1, "leaves")) %>% filter(str_detect(patch2, "beetle"))
Cbuprest660.beetle.vs.leaf=
  Cbuprest660 %>%filter(str_detect(patch1, "leaves")) %>% filter(str_detect(patch2, "beetle"))

Cbuprest.beetle.vs.leaf.even.space.VS660=
  Cbuprest.even.space.beetle.vs.leaf %>% rbind(Cbuprest660.beetle.vs.leaf)

bup.even.space.beetle.vs.leaf<-Cbuprest.even.space.beetle.vs.leaf[,3]
bup660.beetle.vs.leaf<-Cbuprest660.beetle.vs.leaf[,3]

com.bupcontrast.beetle.vs.leaf.even.space<-cbind(Cbuprest.beetle.vs.leaf.even.space.VS660[,1:2],bup.even.space.beetle.vs.leaf,bup660.beetle.vs.leaf)
compare.beetle.vs.leaf.even.space <- com.bupcontrast.beetle.vs.leaf.even.space %>%
  gather(key = "peak_wl.beetle.vs.leaf", value = "dS", 3:4)

##Beetle vs. Flower
Cbuprest.even.space.beetle.vs.flower=
  Cbuprest.even.space.d65 %>%filter(str_detect(patch1, "flower")) %>% filter(str_detect(patch2, "beetle"))
Cbuprest660.beetle.vs.flower=
  Cbuprest660 %>%filter(str_detect(patch1, "flower")) %>% filter(str_detect(patch2, "beetle"))

Cbuprest.beetle.vs.flower.even.space.VS660=
  Cbuprest.even.space.beetle.vs.flower %>%  rbind(Cbuprest660.beetle.vs.flower)

bup.even.space.beetle.vs.flower<-Cbuprest.even.space.beetle.vs.flower[,3]
bup660.beetle.vs.flower<-Cbuprest660.beetle.vs.flower[,3]

com.bupcontrast.beetle.vs.flower.even.space<-cbind(Cbuprest.beetle.vs.flower.even.space.VS660[,1:2],bup.even.space.beetle.vs.flower,bup660.beetle.vs.flower)
compare.beetle.vs.flower.even.space <- com.bupcontrast.beetle.vs.flower.even.space %>%
  gather(key = "peak_wl.beetle.vs.flower", value = "dS", 3:4)


#Twilight
##flower vs leaf
Cbuprest.even.space.flower.vs.leaf_twilight=
  Cbuprest.even.space.twilight %>%filter(str_detect(patch1, "flower")) %>% filter(str_detect(patch2, "leaves"))
Cbuprest660.flower.vs.leaf_twilight=
  Cbuprest660_twilight %>%filter(str_detect(patch1, "flower")) %>% filter(str_detect(patch2, "leaves"))

Cbuprest.flower.vs.leaf.even.space.VS660.twilight=
  Cbuprest.even.space.flower.vs.leaf_twilight %>% rbind(Cbuprest660.flower.vs.leaf_twilight) 

bup.even.space.flower.vs.leaf_twilight<-Cbuprest.even.space.flower.vs.leaf_twilight[,3]
bup660.flower.vs.leaf_twilight<-Cbuprest660.flower.vs.leaf_twilight[,3]

com.bupcontrast.flower.vs.leaf.even.space_twilight<-cbind(Cbuprest.flower.vs.leaf.even.space.VS660.twilight[,1:2],bup.even.space.flower.vs.leaf_twilight,bup660.flower.vs.leaf_twilight)
compare.flower.vs.leaf.even.space_twilight <- com.bupcontrast.flower.vs.leaf.even.space_twilight %>%
  gather(key = "peak_wl.flower.vs.leaf", value = "dS", 3:4)

##beetle vs leaf
Cbuprest.even.space.beetle.vs.leaf_twilight=
  Cbuprest.even.space.twilight %>%filter(str_detect(patch1, "leaves")) %>% filter(str_detect(patch2, "beetle"))
Cbuprest660.beetle.vs.leaf_twilight=
  Cbuprest660_twilight %>%filter(str_detect(patch1, "leaves")) %>% filter(str_detect(patch2, "beetle"))

Cbuprest.beetle.vs.leafr.even.space.VS660.twilight=
  Cbuprest.even.space.beetle.vs.leaf_twilight  %>%  rbind(Cbuprest660.beetle.vs.leaf_twilight)

bup.even.space.beetle.vs.leaf_twilight<-Cbuprest.even.space.beetle.vs.leaf_twilight[,3]
bup660.beetle.vs.leaf_twilight<-Cbuprest660.beetle.vs.leaf_twilight[,3]

com.bupcontrast.beetle.vs.leaf.even.space_twilight<-cbind(Cbuprest.beetle.vs.leafr.even.space.VS660.twilight[,1:2],bup.even.space.beetle.vs.leaf_twilight,bup660.beetle.vs.leaf_twilight)
compare.beetle.vs.leaf.even.space_twilight <- com.bupcontrast.beetle.vs.leaf.even.space_twilight %>%
  gather(key = "peak_wl.beetle.vs.leaf", value = "dS", 3:4)

##Beetle vs. Flower
Cbuprest.even.space.beetle.vs.flower_twilight=
  Cbuprest.even.space.twilight %>% filter(str_detect(patch1, "flower")) %>% filter(str_detect(patch2, "beetle"))
Cbuprest660.beetle.vs.flower_twilight=
  Cbuprest660_twilight %>%filter(str_detect(patch1, "flower")) %>% filter(str_detect(patch2, "beetle"))

Cbuprest.beetle.vs.flower.even.space.VS660.twilight=
  Cbuprest.even.space.beetle.vs.flower_twilight %>% rbind(Cbuprest660.beetle.vs.flower_twilight)

bup.even.space.beetle.vs.flower_twilight<-Cbuprest.even.space.beetle.vs.flower_twilight[,3]
bup660.beetle.vs.flower_twilight<-Cbuprest660.beetle.vs.flower_twilight[,3]

com.bupcontrast.beetle.vs.flower.even.space_twilight<-cbind(Cbuprest.beetle.vs.flower.even.space.VS660.twilight[,1:2],bup.even.space.beetle.vs.flower_twilight,bup660.beetle.vs.flower_twilight)
compare.beetle.vs.flower.even.space_twilight <- com.bupcontrast.beetle.vs.flower.even.space_twilight %>%
  gather(key = "peak_wl.beetle.vs.flower", value = "dS", 3:4)

```

</br>

```{r,echo=FALSE,message=FALSE, warning=FALSE}
#GLMM - D65 - visual model 1
##Flower vs. Leaf
m.flower.vs.leaf_d65.even.space <- lmer(dS~peak_wl.flower.vs.leaf + (1|patch2) + (1|patch1), data = compare.flower.vs.leaf.even.space,REML=F)
sum.flower.vs.leaf_d65.even.space<-summary(glht(m.flower.vs.leaf_d65.even.space, linfct = mcp(peak_wl.flower.vs.leaf = "Tukey")), test = adjusted("bonferroni"))
#REML=F, in order to fit the model using the likelihood ratio test. Otherwise, the lmer default will fit the model using the REML (REstricted Maximum Likelihood) criterion.

##Beetle vs. Leaf
m.beetle.vs.leaf_d65.even.space <- lmer(dS~peak_wl.beetle.vs.leaf + (1|patch2) + (1|patch1), data = compare.beetle.vs.leaf.even.space,REML=F)
sum.beetle.vs.leaf_d65.even.space <- summary(glht(m.beetle.vs.leaf_d65.even.space, linfct = mcp(peak_wl.beetle.vs.leaf = "Tukey")), test = adjusted("bonferroni"))

##Beetle vs. Flower
m.beetle.vs.flower_d65.even.space<- lmer(dS~peak_wl.beetle.vs.flower + (1|patch2) + (1|patch1), data = compare.beetle.vs.flower.even.space,REML=F)
sum.beetle.vs.flower_d65.even.space <-summary(glht(m.beetle.vs.flower_d65.even.space, linfct = mcp(peak_wl.beetle.vs.flower = "Tukey")), test = adjusted("bonferroni"))


#GLMM - Twilight - visual model 2
##Flower vs. Leaf
m.flower.vs.leaf_twilight.even.space <- lmer(dS~peak_wl.flower.vs.leaf + (1|patch2) + (1|patch1), data = compare.flower.vs.leaf.even.space_twilight ,REML=F)
sum.flower.vs.leaf_twilight.even.space  <- summary(glht(m.flower.vs.leaf_twilight.even.space , linfct = mcp(peak_wl.flower.vs.leaf = "Tukey")), test = adjusted("bonferroni"))
##Beetle vs. Leaf
m.beetle.vs.leaf_twilight.even.space <- lmer(dS~peak_wl.beetle.vs.leaf + (1|patch2) + (1|patch1), data = compare.beetle.vs.leaf.even.space_twilight ,REML=F)
sum.beetle.vs.leaf_twilight.even.space  <- summary(glht(m.beetle.vs.leaf_twilight.even.space , linfct = mcp(peak_wl.beetle.vs.leaf = "Tukey")), test = adjusted("bonferroni"))
##Beetle vs. Flower
m.beetle.vs.flower_twilight.even.space  <- lmer(dS~peak_wl.beetle.vs.flower + (1|patch2) + (1|patch1), data = compare.beetle.vs.flower.even.space_twilight ,REML=F)
sum.beetle.vs.flower_twilight.even.space  <-summary(glht(m.beetle.vs.flower_twilight.even.space , linfct = mcp(peak_wl.beetle.vs.flower = "Tukey")), test = adjusted("bonferroni"))
```

## __Flower vs. Leaf__ {.tabset .tabset-fade .tabset-pills}
### Daylight

```{r,echo=FALSE,message=FALSE, warning=FALSE}
Anova(m.flower.vs.leaf_d65.even.space) %>% pander()
```

</br>
</br>


### Twilight
```{r,echo=FALSE,message=FALSE, warning=FALSE}
Anova(m.flower.vs.leaf_twilight.even.space) %>% pander()
```

</br>
</br>


## __Beetle vs. Leaf__ {.tabset .tabset-fade .tabset-pills}
### Daylight
```{r,echo=FALSE,message=FALSE, warning=FALSE}
Anova(m.beetle.vs.leaf_d65.even.space) %>% pander()
```

</br>
</br>


### Twilight
```{r,echo=FALSE,message=FALSE, warning=FALSE}
Anova(m.beetle.vs.leaf_twilight.even.space) %>% pander()
```

</br>
</br>


## __Beetle vs. Flower__ {.tabset .tabset-fade .tabset-pills}
### Daylight
```{r,echo=FALSE,message=FALSE, warning=FALSE}
Anova(m.beetle.vs.flower_d65.even.space) %>% pander()
```

</br>
</br>

### Twilight
```{r,echo=FALSE,message=FALSE, warning=FALSE}
Anova(m.beetle.vs.flower_twilight.even.space) %>% pander()
```

</br>
</br>


# Summary
For all three comparison groups, VS 660 (unevenly spaced visual system) has significantly higher contrast than the evenly spaced visual system. This indicates that our results were not biased by uneven spacing of spectral sensitivities in our hypothetical visual systems.