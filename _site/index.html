<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content=" Lu-Yi Wang1, Devi Stuart-Fox1, Geoff Walker1, Nicholas Roberts2 and Amanda Franklin1   1School of Biosciences, The University of Melbourne, Australia   2School of Biological Sciences, University of Bristol, UK" />


<title>Visual sensitivity in the far-red enhances contrast against vegetation</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Visual sensitivity in the far-red enhances contrast against vegetation</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Visual sensitivity in the far-red enhances contrast against vegetation</h1>
<h3 class="subtitle">Supplementary Information</h3>
<h4 class="author"><br>Lu-Yi Wang<sup>1</sup>, Devi Stuart-Fox<sup>1</sup>, Geoff Walker<sup>1</sup>, Nicholas Roberts<sup>2</sup> and Amanda Franklin<sup>1</sup> <br></br> <sup>1</sup>School of Biosciences, The University of Melbourne, Australia <br></br> <sup>2</sup>School of Biological Sciences, University of Bristol, UK <br></br></h4>

</div>


<div id="aims" class="section level1">
<h1>Aims</h1>
<ul>
<li><p>We investigated the potential benefit of long wavelength sensitivity by modelling the visual contrast in representative insect vision.</p></li>
<li><p>Specifically, we varied the presence of a long wavelength sensitive photoreceptor and its wavelength of maximum sensitivity.</p></li>
<li><p>To make our study ecological relevant to far-red sensitivity, we focused on jewel beetles.</p></li>
<li><p>Additionally, we tested the effect of red-shifted light environment on contrast by running the same models under twilight illumination.</p></li>
</ul>
</div>
<div id="load-r-libraries" class="section level1">
<h1>Load R libraries</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pavo)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(stringr)
<span class="kw">library</span>(tidyr) <span class="co">#for gather() function</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(lme4)
<span class="kw">library</span>(car)
<span class="kw">library</span>(multcomp)
<span class="kw">library</span>(boot) <span class="co">#for mean() function</span>
<span class="kw">library</span>(pander) <span class="co">#for creating tidy tables</span>
<span class="kw">library</span>(ggpubr) <span class="co">#for ggarrange() function</span></code></pre></div>
</div>
<div id="data-description" class="section level1">
<h1>Data description</h1>
<div id="import-and-process-the-data" class="section level2">
<h2>Import and process the data</h2>
<ul>
<li>All the wavelength used in the models ranged from 300-800 nm.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#import sensitivity curves</span>
specsensbuprest.model1 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/peak sensitivity 3.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.rspec</span>()
specsensbuprest.model2 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/peak sensitivity 4.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.rspec</span>()
<span class="co">#import irradiance</span>
irradiance.d65 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/d65.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as.rspec</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">300</span>,<span class="dv">800</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#set import range</span>
<span class="st">  </span><span class="kw">procspec</span>(<span class="dt">opt =</span> <span class="kw">c</span>(<span class="st">&quot;min&quot;</span>, <span class="st">&quot;max&quot;</span>)) <span class="co">#standardize the illumination spectrum</span>
irradiance.twilight &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/civil twilight.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as.rspec</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">300</span>,<span class="dv">800</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">procspec</span>(<span class="dt">opt =</span> <span class="kw">c</span>(<span class="st">&quot;min&quot;</span>, <span class="st">&quot;max&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>( <span class="dt">twilight =</span> Irradiance) 

<span class="co">#import backgound - average leaf</span>
aveleaf &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/aveleaf.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.rspec</span>()

<span class="co">#import and combind beetle, flower, leaf together</span>
raw.dataset&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;data/pooled_spec_2019.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.rspec</span>()
dataset&lt;-<span class="st"> </span><span class="kw">aggspec</span>(raw.dataset, <span class="dt">by =</span> <span class="dv">3</span>, <span class="dt">FUN =</span> mean) <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#average three measurements to a representative one</span>
<span class="st">  </span><span class="kw">procspec</span>(<span class="dt">opt =</span> <span class="st">&quot;smooth&quot;</span>, <span class="dt">span =</span> <span class="fl">0.1</span>, <span class="dt">fixneg =</span> <span class="st">&quot;zero&quot;</span>) <span class="co">#smooth the spectra and lift &lt;0 to 0</span></code></pre></div>
</div>
<div id="spectra-of-the-targets" class="section level2">
<h2>Spectra of the targets</h2>
<ul>
<li>Jewel beetles and their host plants (leaves and flowers): collected using integrating sphere
<ul>
<li>Leaves:
<ul>
<li>sample source: mainly from Melton Gardens and Maranoa Gardens (4 from Melbourne roadsides).</li>
<li>colour: green</li>
<li>totla number: 46 (all are from the host plant genus of Australian jewel beetles)</li>
</ul></li>
<li>Flowers:
<ul>
<li>sample source: mainly from Melton Gardens and Maranoa Gardens (4 from Melbourne roadsides).</li>
<li>colour: white (10), pink (11), red (10), yellow (9), orange (3), and purple (4)</li>
<li>total number: 47 (from 46 species, exactly the same species for leaves reflectance)</li>
</ul></li>
<li>Beetles:
<ul>
<li>sample source: Australian jewel beetles from, ANIC (29) and our own collection</li>
<li>colour: red, pink, yellow/orange, green, blue, velvet, black</li>
<li>totla number: 37</li>
</ul></li>
</ul></li>
<li>We averaged of 3 measurements to generate a representative spectrum for each colour</li>
<li>The spectral data were smoothed with the span = 0.1, and those &lt; 0 were lifted to 0</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#assign categoryies to each spectrum</span>
category.list &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;flower&quot;</span>,<span class="st">&quot;leaf&quot;</span>,<span class="st">&quot;beetle&quot;</span>)
category &lt;-<span class="st"> </span><span class="kw">rep</span>(category.list , <span class="kw">c</span>(<span class="dv">47</span><span class="op">*</span><span class="dv">501</span>,<span class="dv">46</span><span class="op">*</span><span class="dv">501</span>,<span class="dv">37</span><span class="op">*</span><span class="dv">501</span>))
wavelength&lt;-<span class="kw">rep</span>(dataset[,<span class="dv">1</span>])

<span class="co">#transform the data for ploting purpose</span>
dataset.transpose&lt;-<span class="kw">gather</span>(dataset[,<span class="dv">2</span><span class="op">:</span><span class="dv">131</span>], <span class="dt">key =</span> <span class="st">&quot;species&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;reflectance&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">FALSE</span>,
       <span class="dt">convert =</span> <span class="ot">FALSE</span>, <span class="dt">factor_key =</span> <span class="ot">FALSE</span>)
dataset.plot.indivisually&lt;-<span class="kw">cbind</span>(dataset.transpose, wavelength,category)

<span class="co">#split data by categories for future use</span>
flower.spec&lt;-dataset.plot.indivisually[<span class="dv">1</span><span class="op">:</span><span class="dv">23547</span>,]
leaf.spec&lt;-dataset.plot.indivisually[<span class="dv">23548</span><span class="op">:</span><span class="dv">46593</span>,]
beetle.spec&lt;-dataset.plot.indivisually[<span class="dv">46594</span><span class="op">:</span><span class="dv">65130</span>,]

<span class="co">#merge the spectra before plot here</span>
dataset.plot.indivisually<span class="op">$</span>category2&lt;-<span class="kw">factor</span>(dataset.plot.indivisually<span class="op">$</span>category, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;leaf&quot;</span>,<span class="st">&quot;flower&quot;</span>,<span class="st">&quot;beetle&quot;</span>))

<span class="co">#plot the spectra of the targets used in this model</span>
<span class="kw">ggplot</span>(dataset.plot.indivisually,<span class="kw">aes</span>(<span class="dt">x=</span>wavelength,<span class="dt">y=</span>reflectance, <span class="dt">colour=</span>category2, <span class="dt">group=</span>species))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span>.<span class="dv">05</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span>.<span class="dv">05</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_manual</span>( <span class="dt">values =</span> <span class="kw">c</span>( <span class="st">&quot;forestgreen&quot;</span>, <span class="st">&quot;palevioletred1&quot;</span>,<span class="st">&quot;cornflowerblue&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(category2 <span class="op">~</span><span class="st"> </span>.)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Wavelength (nm)&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Reflectance (%)&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="dt">name=</span><span class="st">&quot;sample type&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>()</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="visual-sensitivities-and-visual-systems" class="section level2">
<h2>Visual sensitivities and visual systems</h2>
<ul>
<li>We created 9 sensitivity curves peaking at 380, 460, 520, 580, 600, 620, 640, 660, 680 nm and classified them into 4 photoreceptor types based on their peaks:
<ul>
<li>Ultraviolet sensitive (UVS): 380 nm</li>
<li>Short-wavelength sensitive (SWS): 460 nm</li>
<li>Medium-wavelength sensitive (MWS): 520 nm</li>
<li>Long-wavelength sensitive (LWS): 580, 600, 620, 640, 660, 680 nm</li>
</ul></li>
<li>Based on these sensitivities, we created several different visual systems for 2 visual models:</li>
</ul>
<hr />
<ul>
<li>In the first model ( <strong>Visual model 1</strong> ), we tested effect of having an LWS photoreceptor. We compared the contrast between 3 trichromatic visual system with varied photoreceptor combination. We also tested an extra receptor the extent to which enhanced the contrast by comparing with a tetrachromatic visual system.
<ul>
<li>Visual systems in <strong>visual model 1</strong>:
<ol style="list-style-type: decimal">
<li>Visual system USM: 380 nm, 460 nm, 520 nm (UVS,SWS,MWS)</li>
<li>Visual system UML: 380 nm, 520 nm, 580 nm (UVS,MWS,LWS)</li>
<li>Visual system USL: 380 nm, 460 nm, 580 nm (UVS,SWS,LWS)</li>
<li>Visual system USML: 380 nm, 460 nm, 520 nm, 580 nm (UVS,SWS,MWS,LWS)</li>
</ol></li>
</ul></li>
</ul>
<hr />
<ul>
<li>In the second model ( <strong>Visual model 2</strong> ), we tested how the contrast changed as peak sensitivity increased by systematically increasing the peak sensitivity of the LWS photoreceptor from 580-680 nm.
<ul>
<li>Visual systems in <strong>visual model 2</strong>:
<ol style="list-style-type: decimal">
<li>Visual system 580: 380 nm, 460 nm, 520 nm, 580 nm</li>
<li>Visual system 600: 380 nm, 460 nm, 520 nm, 600 nm</li>
<li>Visual system 620: 380 nm, 460 nm, 520 nm, 620 nm</li>
<li>Visual system 640: 380 nm, 460 nm, 520 nm, 640 nm</li>
<li>Visual system 660: 380 nm, 460 nm, 520 nm, 660 nm</li>
<li>Visual system 680: 380 nm, 460 nm, 520 nm, 680 nm</li>
</ol></li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wl&lt;-specsensbuprest.model2[,<span class="dv">1</span>]
peaks&lt;-<span class="kw">gather</span>(specsensbuprest.model2[,<span class="dv">2</span><span class="op">:</span><span class="dv">10</span>], peak, value) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(wl)

peak.order &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;UVS.380.&quot;</span>, <span class="st">&quot;UVS.460.&quot;</span>, <span class="st">&quot;LWS.520.&quot;</span>, <span class="st">&quot;LWS.580.&quot;</span>, <span class="st">&quot;LWS.600.&quot;</span>, <span class="st">&quot;LWS.620.&quot;</span>, <span class="st">&quot;LWS.640.&quot;</span>, <span class="st">&quot;LWS.660.&quot;</span>, <span class="st">&quot;LWS.680.&quot;</span>) <span class="co">#to order the peaks in the legend</span>
<span class="kw">ggplot</span>(peaks,<span class="kw">aes</span>(<span class="dt">x=</span>wl, <span class="dt">y=</span>value, <span class="dt">col=</span>peak))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">color=</span><span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="st">&quot;peak sensitivity&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_manual</span>(
    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;olivedrab4&quot;</span>, <span class="st">&quot;orange1&quot;</span>, <span class="st">&quot;orange3&quot;</span>,<span class="st">&quot;darkorange3&quot;</span>, <span class="st">&quot;orangered1&quot;</span>, <span class="st">&quot;red2&quot;</span>,<span class="st">&quot;red4&quot;</span>, <span class="st">&quot;darkorchid4&quot;</span>, <span class="st">&quot;dodgerblue3&quot;</span>),
    <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;320 nm&quot;</span>, <span class="st">&quot;460 nm&quot;</span>,<span class="st">&quot;520 nm&quot;</span>, <span class="st">&quot;580 nm&quot;</span>, <span class="st">&quot;600 nm&quot;</span>, <span class="st">&quot;620 nm&quot;</span>, <span class="st">&quot;640 nm&quot;</span>, <span class="st">&quot;660 nm&quot;</span>, <span class="st">&quot;680 nm&quot;</span> ),
    <span class="dt">breaks=</span>peak.order)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Wavelength (nm)&quot;</span>)<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Relative spectral sensitivity&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>()</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="illuminations" class="section level2">
<h2>Illuminations</h2>
<ul>
<li>Two light environments: daylight and twilight (to represent red-shifted illumination).
<ul>
<li>daylight: <strong>D65</strong> from Commission internationale de l’eclairage CIE</li>
<li>twilight: measured at the Pinnacles Lookout in Alpine National Park, VIC, Australia at 18:15 on September 14th 2019.</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">illum &lt;-<span class="st"> </span><span class="kw">merge</span>(irradiance.d65, irradiance.twilight) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(light, illuminace, <span class="op">-</span>wl) 

<span class="kw">ggplot</span>(illum, <span class="kw">aes</span>(<span class="dt">x=</span>wl, <span class="dt">y=</span>illuminace, <span class="dt">color=</span>light))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Wavelength (nm)&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Irradiance&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>()</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
</div>
<div id="run-the-visual-models" class="section level1">
<h1>Run the visual models</h1>
<div id="first-quantum-catch-calculation" class="section level2">
<h2>First: Quantum catch calculation</h2>
<ul>
<li>We calculated quantum catch of each visual system based on Fechner’s law (the signal of the receptor channel is proportional to the logarithm of the quantum catch).</li>
<li>The average leaf was used for the background.</li>
<li>von Kries chromatic adaptation was applied to correct the colour.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Quantum catch - D65 - Visual model 1</span>
visUVSWMW..=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model1[, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
visUV..MWLW=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model1[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
visUVSW..LW=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model1[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
visUVSWMWLW=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model1[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)

<span class="co">#Quantum catch - D65 - Visual model 2</span>
buprest580=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest600=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest620=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">7</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest640=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">8</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest660=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">9</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest680=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">10</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.d65[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)

<span class="co">#Quantum catch - twilight - Visual model 1</span>
visUVSWMW.._twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model1[, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
visUV..MWLW_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model1[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
visUVSW..LW_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model1[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
visUVSWMWLW_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model1[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)

<span class="co">#Quantum catch - twilight - Visual model 2</span>
buprest580_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest600_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest620_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">7</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest640_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">8</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest660_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">9</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)
buprest680_twilight=<span class="kw">vismodel</span>(dataset[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,], <span class="dt">visual =</span> specsensbuprest.model2[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">10</span>)], <span class="dt">bkg=</span>aveleaf<span class="op">$</span>aveleaf, <span class="dt">illum =</span> irradiance.twilight[<span class="dv">1</span><span class="op">:</span><span class="dv">501</span>,<span class="dv">2</span>], <span class="dt">qcatch =</span> <span class="st">&#39;fi&#39;</span>, <span class="dt">relative=</span><span class="ot">FALSE</span>, <span class="dt">vonkries=</span><span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="second-contrast-calculation" class="section level2">
<h2>Second: Contrast calculation</h2>
<ul>
<li>We used a neural noise-limited model where the noise is proportional to the Weber fraction and is independent of the intensity of the signal received.</li>
<li>Photoreceptor density is based on the opisn gene epxression of Emerald ash borer, <em>Agrilus planipennis</em>: 1.14, 1, 1.26, 1.38</li>
<li>The Weber fraction was asinged to be 0.1</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Contrast calculation- D65 - Visual model 1</span>
CvisUVSWMW.. =<span class="st"> </span><span class="kw">coldist</span>(visUVSWMW.., <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">3</span>)  ##change &quot;weber.ref&quot; to 3
CvisUV..MWLW =<span class="st"> </span><span class="kw">coldist</span>(visUV..MWLW, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">3</span>)
CvisUVSW..LW =<span class="st"> </span><span class="kw">coldist</span>(visUVSW..LW, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">3</span>)
CvisUVSWMWLW =<span class="st"> </span><span class="kw">coldist</span>(visUVSWMWLW, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)

<span class="co">#Contrast calculation- D65 - Visual model 2</span>
Cbuprest580 =<span class="st"> </span><span class="kw">coldist</span>(buprest580, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest600 =<span class="st"> </span><span class="kw">coldist</span>(buprest600, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest620 =<span class="st"> </span><span class="kw">coldist</span>(buprest620, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest640 =<span class="st"> </span><span class="kw">coldist</span>(buprest640, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest660 =<span class="st"> </span><span class="kw">coldist</span>(buprest660, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest680 =<span class="st"> </span><span class="kw">coldist</span>(buprest680, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)

<span class="co">#Contrast calculation- twilight - Visual model 1</span>
CvisUVSWMW.._twilight =<span class="st"> </span><span class="kw">coldist</span>(visUVSWMW.._twilight, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">3</span>)  ##change &quot;weber.ref&quot; to 3
CvisUV..MWLW_twilight =<span class="st"> </span><span class="kw">coldist</span>(visUV..MWLW_twilight, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">3</span>)
CvisUVSW..LW_twilight =<span class="st"> </span><span class="kw">coldist</span>(visUVSW..LW_twilight, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">3</span>)
CvisUVSWMWLW_twilight =<span class="st"> </span><span class="kw">coldist</span>(visUVSWMWLW_twilight, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)

<span class="co">#Contrast calculation- twilight - Visual model 2</span>
Cbuprest580_twilight =<span class="st"> </span><span class="kw">coldist</span>(buprest580_twilight, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest600_twilight =<span class="st"> </span><span class="kw">coldist</span>(buprest600_twilight, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest620_twilight =<span class="st"> </span><span class="kw">coldist</span>(buprest620_twilight, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest640_twilight =<span class="st"> </span><span class="kw">coldist</span>(buprest640_twilight, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest660_twilight =<span class="st"> </span><span class="kw">coldist</span>(buprest660_twilight, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)
Cbuprest680_twilight =<span class="st"> </span><span class="kw">coldist</span>(buprest680_twilight, <span class="dt">noise=</span><span class="st">&quot;neural&quot;</span>, <span class="dt">achro=</span><span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.14</span>,<span class="dv">1</span>,<span class="fl">1.26</span>,<span class="fl">1.38</span>), <span class="dt">weber =</span> <span class="fl">0.1</span>, <span class="dt">weber.ref =</span> <span class="dv">4</span>)</code></pre></div>
</div>
</div>
<div id="compare-contrasts" class="section level1">
<h1>Compare contrasts</h1>
<ul>
<li>Using GLMM to test if contasts were different among visual systems</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#creat different comparison groups for furthur GLMM analysis</span>
<span class="co">#Organize data before GLMM</span>

<span class="co">#D65 - visual model 1</span>
##flower vs leaf
CvisUVSWMW...leaf.vs.flower=
<span class="st">  </span>CvisUVSWMW.. <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
CvisUV..MWLW.leaf.vs.flower=
<span class="st">  </span>CvisUV..MWLW <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
CvisUVSW..LW.leaf.vs.flower=
<span class="st">  </span>CvisUVSW..LW <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
CvisUVSWMWLW.leaf.vs.flower=
<span class="st">  </span>CvisUVSWMWLW <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))

C.leaf.vs.flower.model1=
<span class="st">  </span>CvisUVSWMW...leaf.vs.flower <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvisUV..MWLW.leaf.vs.flower) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(CvisUVSW..LW.leaf.vs.flower)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvisUVSWMWLW.leaf.vs.flower)

contrast.UVSWMW...leaf.vs.flower&lt;-CvisUVSWMW...leaf.vs.flower[,<span class="dv">3</span>]
contrast.UV..MWLW.leaf.vs.flower&lt;-CvisUV..MWLW.leaf.vs.flower[,<span class="dv">3</span>]
contrast.UVSW..LW.leaf.vs.flower&lt;-CvisUVSW..LW.leaf.vs.flower[,<span class="dv">3</span>]
contrast.UVSWMWLW.leaf.vs.flower&lt;-CvisUVSWMWLW.leaf.vs.flower[,<span class="dv">3</span>]

com.contrast.leaf.vs.flower.model1&lt;-<span class="kw">cbind</span>(CvisUVSWMW...leaf.vs.flower[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],contrast.UVSWMW...leaf.vs.flower,contrast.UV..MWLW.leaf.vs.flower,contrast.UVSW..LW.leaf.vs.flower,contrast.UVSWMWLW.leaf.vs.flower)
compare.leaf.vs.flower.model1 &lt;-<span class="st"> </span>com.contrast.leaf.vs.flower.model1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.leaf.vs.flower&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)

##beetle vs leaf
CvisUVSWMW...leaf.vs.beetle=
<span class="st">  </span>CvisUVSWMW.. <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvisUV..MWLW.leaf.vs.beetle=
<span class="st">  </span>CvisUV..MWLW <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvisUVSW..LW.leaf.vs.beetle=
<span class="st">  </span>CvisUVSW..LW <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvisUVSWMWLW.leaf.vs.beetle=
<span class="st">  </span>CvisUVSWMWLW <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

C.leaf.vs.beetle.model1=
<span class="st">  </span>CvisUVSWMW...leaf.vs.beetle <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvisUV..MWLW.leaf.vs.beetle) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(CvisUVSW..LW.leaf.vs.beetle)<span class="op">%&gt;%</span><span class="st">  </span><span class="kw">rbind</span>(CvisUVSWMWLW.leaf.vs.beetle)

contrast.UVSWMW...leaf.vs.beetle&lt;-CvisUVSWMW...leaf.vs.beetle[,<span class="dv">3</span>]
contrast.UV..MWLW.leaf.vs.beetle&lt;-CvisUV..MWLW.leaf.vs.beetle[,<span class="dv">3</span>]
contrast.UVSW..LW.leaf.vs.beetle&lt;-CvisUVSW..LW.leaf.vs.beetle[,<span class="dv">3</span>]
contrast.UVSWMWLW.leaf.vs.beetle&lt;-CvisUVSWMWLW.leaf.vs.beetle[,<span class="dv">3</span>]

com.contrast.leaf.vs.beetle.model1&lt;-<span class="kw">cbind</span>(CvisUVSWMW...leaf.vs.beetle[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],contrast.UVSWMW...leaf.vs.beetle,contrast.UV..MWLW.leaf.vs.beetle,contrast.UVSW..LW.leaf.vs.beetle,contrast.UVSWMWLW.leaf.vs.beetle)
compare.leaf.vs.beetle.model1 &lt;-<span class="st"> </span>com.contrast.leaf.vs.beetle.model1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.leaf.vs.beetle&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)

##beetle vs flower
CvisUVSWMW...flower.vs.beetle=
<span class="st">  </span>CvisUVSWMW.. <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvisUV..MWLW.flower.vs.beetle=
<span class="st">  </span>CvisUV..MWLW <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvisUVSW..LW.flower.vs.beetle=
<span class="st">  </span>CvisUVSW..LW <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvisUVSWMWLW.flower.vs.beetle=
<span class="st">  </span>CvisUVSWMWLW <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

C.flower.vs.beetle.model1=
<span class="st">  </span>CvisUVSWMW...flower.vs.beetle <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvisUV..MWLW.flower.vs.beetle) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(CvisUVSW..LW.flower.vs.beetle) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">rbind</span>(CvisUVSWMWLW.flower.vs.beetle)

contrast.UVSWMW...flower.vs.beetle&lt;-CvisUVSWMW...flower.vs.beetle[,<span class="dv">3</span>]
contrast.UV..MWLW.flower.vs.beetle&lt;-CvisUV..MWLW.flower.vs.beetle[,<span class="dv">3</span>]
contrast.UVSW..LW.flower.vs.beetle&lt;-CvisUVSW..LW.flower.vs.beetle[,<span class="dv">3</span>]
contrast.UVSWMWLW.flower.vs.beetle&lt;-CvisUVSWMWLW.flower.vs.beetle[,<span class="dv">3</span>]

com.contrast.flower.vs.beetle.model1&lt;-<span class="kw">cbind</span>(CvisUVSWMW...flower.vs.beetle[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],contrast.UVSWMW...flower.vs.beetle,contrast.UV..MWLW.flower.vs.beetle,contrast.UVSW..LW.flower.vs.beetle,contrast.UVSWMWLW.flower.vs.beetle)
compare.flower.vs.beetle.model1 &lt;-<span class="st"> </span>com.contrast.flower.vs.beetle.model1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.flower.vs.beetle&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)



<span class="co">#D65 - visual model 2</span>
##flower vs leaf
Cbuprest580.leaf.vs.flower=
<span class="st">  </span>Cbuprest580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest600.leaf.vs.flower=
<span class="st">  </span>Cbuprest600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest620.leaf.vs.flower=
<span class="st">  </span>Cbuprest620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest640.leaf.vs.flower=
<span class="st">  </span>Cbuprest640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest660.leaf.vs.flower=
<span class="st">  </span>Cbuprest660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest680.leaf.vs.flower=
<span class="st">  </span>Cbuprest680 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))

Cbuprest.leaf.vs.flower.model2=
<span class="st">  </span>Cbuprest580.leaf.vs.flower <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.leaf.vs.flower) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.leaf.vs.flower)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.leaf.vs.flower) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest660.leaf.vs.flower) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest680.leaf.vs.flower)

bup580.leaf.vs.flower&lt;-Cbuprest580.leaf.vs.flower[,<span class="dv">3</span>]
bup600.leaf.vs.flower&lt;-Cbuprest600.leaf.vs.flower[,<span class="dv">3</span>]
bup620.leaf.vs.flower&lt;-Cbuprest620.leaf.vs.flower[,<span class="dv">3</span>]
bup640.leaf.vs.flower&lt;-Cbuprest640.leaf.vs.flower[,<span class="dv">3</span>]
bup660.leaf.vs.flower&lt;-Cbuprest660.leaf.vs.flower[,<span class="dv">3</span>]
bup680.leaf.vs.flower&lt;-Cbuprest680.leaf.vs.flower[,<span class="dv">3</span>]

com.bupcontrast.leaf.vs.flower.model2&lt;-<span class="kw">cbind</span>(Cbuprest.leaf.vs.flower.model2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.leaf.vs.flower,bup600.leaf.vs.flower,bup620.leaf.vs.flower,bup640.leaf.vs.flower,bup660.leaf.vs.flower,bup680.leaf.vs.flower)
compare.leaf.vs.flower.model2 &lt;-<span class="st"> </span>com.bupcontrast.leaf.vs.flower.model2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.leaf.vs.flower&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">8</span>)

##beetle vs leaf
Cbuprest580.leaf.vs.beetle=
<span class="st">  </span>Cbuprest580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest600.leaf.vs.beetle=
<span class="st">  </span>Cbuprest600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest620.leaf.vs.beetle=
<span class="st">  </span>Cbuprest620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest640.leaf.vs.beetle=
<span class="st">  </span>Cbuprest640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest660.leaf.vs.beetle=
<span class="st">  </span>Cbuprest660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest680.leaf.vs.beetle=
<span class="st">  </span>Cbuprest680 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

Cbuprest.leaf.vs.beetle.model2=
<span class="st">  </span>Cbuprest580.leaf.vs.beetle  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.leaf.vs.beetle)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.leaf.vs.beetle)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.leaf.vs.beetle) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest660.leaf.vs.beetle) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest680.leaf.vs.beetle)

bup580.leaf.vs.beetle&lt;-Cbuprest580.leaf.vs.beetle[,<span class="dv">3</span>]
bup600.leaf.vs.beetle&lt;-Cbuprest600.leaf.vs.beetle[,<span class="dv">3</span>]
bup620.leaf.vs.beetle&lt;-Cbuprest620.leaf.vs.beetle[,<span class="dv">3</span>]
bup640.leaf.vs.beetle&lt;-Cbuprest640.leaf.vs.beetle[,<span class="dv">3</span>]
bup660.leaf.vs.beetle&lt;-Cbuprest660.leaf.vs.beetle[,<span class="dv">3</span>]
bup680.leaf.vs.beetle&lt;-Cbuprest680.leaf.vs.beetle[,<span class="dv">3</span>]

com.bupcontrast.leaf.vs.beetle.model2&lt;-<span class="kw">cbind</span>(Cbuprest.leaf.vs.beetle.model2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.leaf.vs.beetle,bup600.leaf.vs.beetle,bup620.leaf.vs.beetle,bup640.leaf.vs.beetle,bup660.leaf.vs.beetle,bup680.leaf.vs.beetle)
compare.leaf.vs.beetle.model2 &lt;-<span class="st"> </span>com.bupcontrast.leaf.vs.beetle.model2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.leaf.vs.beetle&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">8</span>)

##beetle vs flower
Cbuprest580.flower.vs.beetle=
<span class="st">  </span>Cbuprest580 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest600.flower.vs.beetle=
<span class="st">  </span>Cbuprest600 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest620.flower.vs.beetle=
<span class="st">  </span>Cbuprest620 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest640.flower.vs.beetle=
<span class="st">  </span>Cbuprest640 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest660.flower.vs.beetle=
<span class="st">  </span>Cbuprest660 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest680.flower.vs.beetle=
<span class="st">  </span>Cbuprest680 <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

Cbuprest.flower.vs.beetle.model2=
<span class="st"> </span>Cbuprest580.flower.vs.beetle <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.flower.vs.beetle) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.flower.vs.beetle)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.flower.vs.beetle) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest660.flower.vs.beetle)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest680.flower.vs.beetle)

bup580.flower.vs.beetle&lt;-Cbuprest580.flower.vs.beetle[,<span class="dv">3</span>]
bup600.flower.vs.beetle&lt;-Cbuprest600.flower.vs.beetle[,<span class="dv">3</span>]
bup620.flower.vs.beetle&lt;-Cbuprest620.flower.vs.beetle[,<span class="dv">3</span>]
bup640.flower.vs.beetle&lt;-Cbuprest640.flower.vs.beetle[,<span class="dv">3</span>]
bup660.flower.vs.beetle&lt;-Cbuprest660.flower.vs.beetle[,<span class="dv">3</span>]
bup680.flower.vs.beetle&lt;-Cbuprest680.flower.vs.beetle[,<span class="dv">3</span>]

com.bupcontrast.flower.vs.beetle.model2&lt;-<span class="kw">cbind</span>(Cbuprest.flower.vs.beetle.model2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.flower.vs.beetle,bup600.flower.vs.beetle,bup620.flower.vs.beetle,bup640.flower.vs.beetle,bup660.flower.vs.beetle,bup680.flower.vs.beetle)
compare.flower.vs.beetle.model2 &lt;-<span class="st"> </span>com.bupcontrast.flower.vs.beetle.model2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.flower.vs.beetle&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">8</span>)


<span class="co">#Twilight - visual model 1</span>
##flower vs leaf
CvisUVSWMW...leaf.vs.flower_twilight=
<span class="st">  </span>CvisUVSWMW.._twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
CvisUV..MWLW.leaf.vs.flower_twilight=
<span class="st">  </span>CvisUV..MWLW_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
CvisUVSW..LW.leaf.vs.flower_twilight=
<span class="st">  </span>CvisUVSW..LW_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
CvisUVSWMWLW.leaf.vs.flower_twilight=
<span class="st">  </span>CvisUVSWMWLW_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))

C.leaf.vs.flower_twilight.model1=
<span class="st">  </span>CvisUVSWMW...leaf.vs.flower_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvisUV..MWLW.leaf.vs.flower_twilight) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(CvisUVSW..LW.leaf.vs.flower_twilight)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvisUVSWMWLW.leaf.vs.flower_twilight)

contrast.UVSWMW...leaf.vs.flower_twilight&lt;-CvisUVSWMW...leaf.vs.flower_twilight[,<span class="dv">3</span>]
contrast.UV..MWLW.leaf.vs.flower_twilight&lt;-CvisUV..MWLW.leaf.vs.flower_twilight[,<span class="dv">3</span>]
contrast.UVSW..LW.leaf.vs.flower_twilight&lt;-CvisUVSW..LW.leaf.vs.flower_twilight[,<span class="dv">3</span>]
contrast.UVSWMWLW.leaf.vs.flower_twilight&lt;-CvisUVSWMWLW.leaf.vs.flower_twilight[,<span class="dv">3</span>]

com.contrast.leaf.vs.flower_twilight.model1&lt;-<span class="kw">cbind</span>(CvisUVSWMW...leaf.vs.flower_twilight[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],contrast.UVSWMW...leaf.vs.flower_twilight,contrast.UV..MWLW.leaf.vs.flower_twilight,contrast.UVSW..LW.leaf.vs.flower_twilight,contrast.UVSWMWLW.leaf.vs.flower_twilight)
compare.leaf.vs.flower_twilight.model1 &lt;-<span class="st"> </span>com.contrast.leaf.vs.flower_twilight.model1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.leaf.vs.flower&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)

##beetle vs leaf
CvisUVSWMW...leaf.vs.beetle_twilight=
<span class="st">  </span>CvisUVSWMW.._twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvisUV..MWLW.leaf.vs.beetle_twilight=
<span class="st">  </span>CvisUV..MWLW_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvisUVSW..LW.leaf.vs.beetle_twilight=
<span class="st">  </span>CvisUVSW..LW_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvisUVSWMWLW.leaf.vs.beetle_twilight=
<span class="st">  </span>CvisUVSWMWLW_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

C.leaf.vs.beetle_twilight.model1=
<span class="st">  </span>CvisUVSWMW...leaf.vs.beetle_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvisUV..MWLW.leaf.vs.beetle_twilight) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(CvisUVSW..LW.leaf.vs.beetle_twilight)<span class="op">%&gt;%</span><span class="st">  </span><span class="kw">rbind</span>(CvisUVSWMWLW.leaf.vs.beetle_twilight)

contrast.UVSWMW...leaf.vs.beetle_twilight&lt;-CvisUVSWMW...leaf.vs.beetle_twilight[,<span class="dv">3</span>]
contrast.UV..MWLW.leaf.vs.beetle_twilight&lt;-CvisUV..MWLW.leaf.vs.beetle_twilight[,<span class="dv">3</span>]
contrast.UVSW..LW.leaf.vs.beetle_twilight&lt;-CvisUVSW..LW.leaf.vs.beetle_twilight[,<span class="dv">3</span>]
contrast.UVSWMWLW.leaf.vs.beetle_twilight&lt;-CvisUVSWMWLW.leaf.vs.beetle_twilight[,<span class="dv">3</span>]

com.contrast.leaf.vs.beetle_twilight.model1&lt;-<span class="kw">cbind</span>(CvisUVSWMW...leaf.vs.beetle_twilight[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],contrast.UVSWMW...leaf.vs.beetle_twilight,contrast.UV..MWLW.leaf.vs.beetle_twilight,contrast.UVSW..LW.leaf.vs.beetle_twilight,contrast.UVSWMWLW.leaf.vs.beetle_twilight)
compare.leaf.vs.beetle_twilight.model1 &lt;-<span class="st"> </span>com.contrast.leaf.vs.beetle_twilight.model1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.leaf.vs.beetle&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)

##beetle vs flower
CvisUVSWMW...flower.vs.beetle_twilight=
<span class="st">  </span>CvisUVSWMW.._twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvisUV..MWLW.flower.vs.beetle_twilight=
<span class="st">  </span>CvisUV..MWLW_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvisUVSW..LW.flower.vs.beetle_twilight=
<span class="st">  </span>CvisUVSW..LW_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
CvisUVSWMWLW.flower.vs.beetle_twilight=
<span class="st">  </span>CvisUVSWMWLW_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

C.flower.vs.beetle_twilight.model1=
<span class="st">  </span>CvisUVSWMW...flower.vs.beetle_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(CvisUV..MWLW.flower.vs.beetle_twilight) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(CvisUVSW..LW.flower.vs.beetle_twilight) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">rbind</span>(CvisUVSWMWLW.flower.vs.beetle_twilight)

contrast.UVSWMW...flower.vs.beetle_twilight&lt;-CvisUVSWMW...flower.vs.beetle_twilight[,<span class="dv">3</span>]
contrast.UV..MWLW.flower.vs.beetle_twilight&lt;-CvisUV..MWLW.flower.vs.beetle_twilight[,<span class="dv">3</span>]
contrast.UVSW..LW.flower.vs.beetle_twilight&lt;-CvisUVSW..LW.flower.vs.beetle_twilight[,<span class="dv">3</span>]
contrast.UVSWMWLW.flower.vs.beetle_twilight&lt;-CvisUVSWMWLW.flower.vs.beetle_twilight[,<span class="dv">3</span>]

com.contrast.flower.vs.beetle_twilight.model1&lt;-<span class="kw">cbind</span>(CvisUVSWMW...flower.vs.beetle_twilight[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],contrast.UVSWMW...flower.vs.beetle_twilight,contrast.UV..MWLW.flower.vs.beetle_twilight,contrast.UVSW..LW.flower.vs.beetle_twilight,contrast.UVSWMWLW.flower.vs.beetle_twilight)
compare.flower.vs.beetle_twilight.model1 &lt;-<span class="st"> </span>com.contrast.flower.vs.beetle_twilight.model1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.flower.vs.beetle&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)



<span class="co">#Twilight - visual model 2</span>
##flower vs leaf
Cbuprest580.leaf.vs.flower_twilight=
<span class="st">  </span>Cbuprest580_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest600.leaf.vs.flower_twilight=
<span class="st">  </span>Cbuprest600_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest620.leaf.vs.flower_twilight=
<span class="st">  </span>Cbuprest620_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest640.leaf.vs.flower_twilight=
<span class="st">  </span>Cbuprest640_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest660.leaf.vs.flower_twilight=
<span class="st">  </span>Cbuprest660_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))
Cbuprest680.leaf.vs.flower_twilight=
<span class="st">  </span>Cbuprest680_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;leaves&quot;</span>))

Cbuprest.leaf.vs.flower_twilight.model2=
<span class="st">  </span>Cbuprest580.leaf.vs.flower_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.leaf.vs.flower_twilight) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.leaf.vs.flower_twilight)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.leaf.vs.flower_twilight) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest660.leaf.vs.flower_twilight) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest680.leaf.vs.flower_twilight)

bup580.leaf.vs.flower_twilight&lt;-Cbuprest580.leaf.vs.flower_twilight[,<span class="dv">3</span>]
bup600.leaf.vs.flower_twilight&lt;-Cbuprest600.leaf.vs.flower_twilight[,<span class="dv">3</span>]
bup620.leaf.vs.flower_twilight&lt;-Cbuprest620.leaf.vs.flower_twilight[,<span class="dv">3</span>]
bup640.leaf.vs.flower_twilight&lt;-Cbuprest640.leaf.vs.flower_twilight[,<span class="dv">3</span>]
bup660.leaf.vs.flower_twilight&lt;-Cbuprest660.leaf.vs.flower_twilight[,<span class="dv">3</span>]
bup680.leaf.vs.flower_twilight&lt;-Cbuprest680.leaf.vs.flower_twilight[,<span class="dv">3</span>]

com.bupcontrast.leaf.vs.flower_twilight.model2&lt;-<span class="kw">cbind</span>(Cbuprest.leaf.vs.flower_twilight.model2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.leaf.vs.flower_twilight,bup600.leaf.vs.flower_twilight,bup620.leaf.vs.flower_twilight,bup640.leaf.vs.flower_twilight,bup660.leaf.vs.flower_twilight,bup680.leaf.vs.flower_twilight)
compare.leaf.vs.flower_twilight.model2 &lt;-<span class="st"> </span>com.bupcontrast.leaf.vs.flower_twilight.model2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.leaf.vs.flower&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">8</span>)

##beetle vs leaf
Cbuprest580.leaf.vs.beetle_twilight=
<span class="st">  </span>Cbuprest580_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest600.leaf.vs.beetle_twilight=
<span class="st">  </span>Cbuprest600_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest620.leaf.vs.beetle_twilight=
<span class="st">  </span>Cbuprest620_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest640.leaf.vs.beetle_twilight=
<span class="st">  </span>Cbuprest640_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest660.leaf.vs.beetle_twilight=
<span class="st">  </span>Cbuprest660_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest680.leaf.vs.beetle_twilight=
<span class="st">  </span>Cbuprest680_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;leaves&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

Cbuprest.leaf.vs.beetle_twilight.model2=
<span class="st">  </span>Cbuprest580.leaf.vs.beetle_twilight  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest600.leaf.vs.beetle_twilight)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.leaf.vs.beetle_twilight)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.leaf.vs.beetle_twilight) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest660.leaf.vs.beetle_twilight) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest680.leaf.vs.beetle_twilight)

bup580.leaf.vs.beetle_twilight&lt;-Cbuprest580.leaf.vs.beetle_twilight[,<span class="dv">3</span>]
bup600.leaf.vs.beetle_twilight&lt;-Cbuprest600.leaf.vs.beetle_twilight[,<span class="dv">3</span>]
bup620.leaf.vs.beetle_twilight&lt;-Cbuprest620.leaf.vs.beetle_twilight[,<span class="dv">3</span>]
bup640.leaf.vs.beetle_twilight&lt;-Cbuprest640.leaf.vs.beetle_twilight[,<span class="dv">3</span>]
bup660.leaf.vs.beetle_twilight&lt;-Cbuprest660.leaf.vs.beetle_twilight[,<span class="dv">3</span>]
bup680.leaf.vs.beetle_twilight&lt;-Cbuprest680.leaf.vs.beetle_twilight[,<span class="dv">3</span>]

com.bupcontrast.leaf.vs.beetle_twilight.model2&lt;-<span class="kw">cbind</span>(Cbuprest.leaf.vs.beetle_twilight.model2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.leaf.vs.beetle_twilight,bup600.leaf.vs.beetle_twilight,bup620.leaf.vs.beetle_twilight,bup640.leaf.vs.beetle_twilight,bup660.leaf.vs.beetle_twilight,bup680.leaf.vs.beetle_twilight)
compare.leaf.vs.beetle_twilight.model2 &lt;-<span class="st"> </span>com.bupcontrast.leaf.vs.beetle_twilight.model2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.leaf.vs.beetle&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">8</span>)

##beetle vs flower
Cbuprest580.flower.vs.beetle_twilight=
<span class="st">  </span>Cbuprest580_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest600.flower.vs.beetle_twilight=
<span class="st">  </span>Cbuprest600_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest620.flower.vs.beetle_twilight=
<span class="st">  </span>Cbuprest620_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest640.flower.vs.beetle_twilight=
<span class="st">  </span>Cbuprest640_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest660.flower.vs.beetle_twilight=
<span class="st">  </span>Cbuprest660_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))
Cbuprest680.flower.vs.beetle_twilight=
<span class="st">  </span>Cbuprest680_twilight <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2, <span class="st">&quot;beetle&quot;</span>))

Cbuprest.flower.vs.beetle_twilight.model2=
<span class="st"> </span>Cbuprest580.flower.vs.beetle_twilight <span class="op">%&gt;%</span><span class="kw">rbind</span>(Cbuprest600.flower.vs.beetle_twilight) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest620.flower.vs.beetle_twilight) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest640.flower.vs.beetle_twilight) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(Cbuprest660.flower.vs.beetle_twilight) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Cbuprest680.flower.vs.beetle_twilight)

bup580.flower.vs.beetle_twilight&lt;-Cbuprest580.flower.vs.beetle_twilight[,<span class="dv">3</span>]
bup600.flower.vs.beetle_twilight&lt;-Cbuprest600.flower.vs.beetle_twilight[,<span class="dv">3</span>]
bup620.flower.vs.beetle_twilight&lt;-Cbuprest620.flower.vs.beetle_twilight[,<span class="dv">3</span>]
bup640.flower.vs.beetle_twilight&lt;-Cbuprest640.flower.vs.beetle_twilight[,<span class="dv">3</span>]
bup660.flower.vs.beetle_twilight&lt;-Cbuprest660.flower.vs.beetle_twilight[,<span class="dv">3</span>]
bup680.flower.vs.beetle_twilight&lt;-Cbuprest680.flower.vs.beetle_twilight[,<span class="dv">3</span>]

com.bupcontrast.flower.vs.beetle_twilight.model2&lt;-<span class="kw">cbind</span>(Cbuprest.flower.vs.beetle_twilight.model2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],bup580.flower.vs.beetle_twilight,bup600.flower.vs.beetle_twilight,bup620.flower.vs.beetle_twilight,bup640.flower.vs.beetle_twilight,bup660.flower.vs.beetle_twilight,bup680.flower.vs.beetle_twilight)
compare.flower.vs.beetle_twilight.model2 &lt;-<span class="st"> </span>com.bupcontrast.flower.vs.beetle_twilight.model2 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;peak_wl.flower.vs.beetle&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;dS&quot;</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">8</span>)</code></pre></div>
<div id="check-assumptions" class="section level2 tabset tabset-fade tabset-pills">
<h2>Check assumptions</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#checking assumptions</span>
##D65 - visual model 1
res.leaf.vs.flower_d65.model1&lt;-<span class="kw">lm</span>(compare.leaf.vs.flower.model1<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.leaf.vs.flower.model1<span class="op">$</span>peak_wl.leaf.vs.flower)
res.leaf.vs.beetle_d65.model1&lt;-<span class="kw">lm</span>(compare.leaf.vs.beetle.model1<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.leaf.vs.beetle.model1<span class="op">$</span>peak_wl.leaf.vs.beetle)
res.flower.vs.beetle_d65.model1&lt;-<span class="kw">lm</span>(compare.flower.vs.beetle.model1<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.flower.vs.beetle.model1<span class="op">$</span>peak_wl.flower.vs.beetle)

##D65 - visual model 2
res.leaf.vs.flower_d65.model2&lt;-<span class="kw">lm</span>(compare.leaf.vs.flower.model2<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.leaf.vs.flower.model2<span class="op">$</span>peak_wl.leaf.vs.flower)
res.leaf.vs.beetle_d65.model2&lt;-<span class="kw">lm</span>(compare.leaf.vs.beetle.model2<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.leaf.vs.beetle.model2<span class="op">$</span>peak_wl.leaf.vs.beetle)
res.flower.vs.beetle_d65.model2&lt;-<span class="kw">lm</span>(compare.flower.vs.beetle.model2<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.flower.vs.beetle.model2<span class="op">$</span>peak_wl.flower.vs.beetle)

##Twilight - visual model 1
res.leaf.vs.flower_twilight.model1&lt;-<span class="kw">lm</span>(compare.leaf.vs.flower.model1<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.leaf.vs.flower.model1<span class="op">$</span>peak_wl.leaf.vs.flower)
res.leaf.vs.beetle_twilight.model1&lt;-<span class="kw">lm</span>(compare.leaf.vs.beetle.model1<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.leaf.vs.beetle.model1<span class="op">$</span>peak_wl.leaf.vs.beetle)
res.flower.vs.beetle_twilight.model1&lt;-<span class="kw">lm</span>(compare.flower.vs.beetle.model1<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.flower.vs.beetle.model1<span class="op">$</span>peak_wl.flower.vs.beetle)

##Twilight - visual model 2
res.leaf.vs.flower_twilight.model2&lt;-<span class="kw">lm</span>(compare.leaf.vs.flower.model2<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.leaf.vs.flower.model2<span class="op">$</span>peak_wl.leaf.vs.flower)
res.leaf.vs.beetle_twilight.model2&lt;-<span class="kw">lm</span>(compare.leaf.vs.beetle.model2<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.leaf.vs.beetle.model2<span class="op">$</span>peak_wl.leaf.vs.beetle)
res.flower.vs.beetle_twilight.model2&lt;-<span class="kw">lm</span>(compare.flower.vs.beetle.model2<span class="op">$</span>dS <span class="op">~</span><span class="st"> </span>compare.flower.vs.beetle.model2<span class="op">$</span>peak_wl.flower.vs.beetle)</code></pre></div>
<div id="normality" class="section level3 tabset tabset-fade tabset-pills">
<h3>Normality</h3>
<div id="visual-model-1" class="section level4 tabset tabset-fade tabset-pills">
<h4>Visual model 1</h4>
<div id="d65" class="section level5">
<h5>D65</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
<span class="kw">qqnorm</span>(res.leaf.vs.flower_d65.model1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Leaf vs Flower&quot;</span>)
<span class="kw">qqnorm</span>(res.leaf.vs.beetle_d65.model1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Leaf vs Beetle&quot;</span>)
<span class="kw">qqnorm</span>(res.flower.vs.beetle_d65.model1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs Flower&quot;</span>)</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="twilight" class="section level5">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
<span class="kw">qqnorm</span>(res.leaf.vs.flower_twilight.model1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Leaf vs Flower&quot;</span>)
<span class="kw">qqnorm</span>(res.leaf.vs.beetle_twilight.model1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Leaf vs Beetle&quot;</span>)
<span class="kw">qqnorm</span>(res.flower.vs.beetle_twilight.model1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs Flower&quot;</span>)</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
<div id="visual-model-2" class="section level4 tabset tabset-fade tabset-pills">
<h4>Visual model 2</h4>
<div id="d65-1" class="section level5">
<h5>D65</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
<span class="kw">qqnorm</span>(res.leaf.vs.flower_d65.model2<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Leaf vs Flower&quot;</span>)
<span class="kw">qqnorm</span>(res.leaf.vs.beetle_d65.model2<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Leaf vs Beetle&quot;</span>)
<span class="kw">qqnorm</span>(res.flower.vs.beetle_d65.model2<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs Flower&quot;</span>)</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="twilight-1" class="section level5">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
<span class="kw">qqnorm</span>(res.leaf.vs.flower_twilight.model2<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Leaf vs Flower&quot;</span>)
<span class="kw">qqnorm</span>(res.leaf.vs.beetle_twilight.model2<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Leaf vs Beetle&quot;</span>)
<span class="kw">qqnorm</span>(res.flower.vs.beetle_twilight.model2<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Beetle vs Flower&quot;</span>)</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="homoscedasticity" class="section level3 tabset tabset-fade tabset-pills">
<h3>Homoscedasticity</h3>
<div id="visual-model-1-1" class="section level4 tabset tabset-fade tabset-pills">
<h4>Visual model 1</h4>
<div id="d65-2" class="section level5">
<h5>D65</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
<span class="kw">boxplot</span>(compare.leaf.vs.flower.model1<span class="op">$</span>dS<span class="op">~</span>compare.leaf.vs.flower.model1<span class="op">$</span>peak_wl.leaf.vs.flower, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Leaf vs Flower&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Vis UML&quot;</span>, <span class="st">&quot;Vis USL&quot;</span>, <span class="st">&quot;Vis USM&quot;</span>, <span class="st">&quot;Vis USML&quot;</span>))
<span class="kw">boxplot</span>(compare.leaf.vs.beetle.model1<span class="op">$</span>dS<span class="op">~</span>compare.leaf.vs.beetle.model1<span class="op">$</span>peak_wl.leaf.vs.beetle, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Leaf vs Beetle&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Vis UML&quot;</span>, <span class="st">&quot;Vis USL&quot;</span>, <span class="st">&quot;Vis USM&quot;</span>, <span class="st">&quot;Vis USML&quot;</span>))
<span class="kw">boxplot</span>(compare.flower.vs.beetle.model1<span class="op">$</span>dS<span class="op">~</span>compare.flower.vs.beetle.model1<span class="op">$</span>peak_wl.flower.vs.beetle, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Beetle vs Flower&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Vis UML&quot;</span>, <span class="st">&quot;Vis USL&quot;</span>, <span class="st">&quot;Vis USM&quot;</span>, <span class="st">&quot;Vis USML&quot;</span>))</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="twilight-2" class="section level5">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
<span class="kw">boxplot</span>(compare.leaf.vs.flower_twilight.model1<span class="op">$</span>dS<span class="op">~</span>compare.leaf.vs.flower_twilight.model1<span class="op">$</span>peak_wl.leaf.vs.flower, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Leaf vs Flower&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Vis UML&quot;</span>, <span class="st">&quot;Vis USL&quot;</span>, <span class="st">&quot;Vis USM&quot;</span>, <span class="st">&quot;Vis USML&quot;</span>))
<span class="kw">boxplot</span>(compare.leaf.vs.beetle_twilight.model1<span class="op">$</span>dS<span class="op">~</span>compare.leaf.vs.beetle_twilight.model1<span class="op">$</span>peak_wl.leaf.vs.beetle, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Leaf vs Beetle&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Vis UML&quot;</span>, <span class="st">&quot;Vis USL&quot;</span>, <span class="st">&quot;Vis USM&quot;</span>, <span class="st">&quot;Vis USML&quot;</span>))
<span class="kw">boxplot</span>(compare.flower.vs.beetle_twilight.model1<span class="op">$</span>dS<span class="op">~</span>compare.flower.vs.beetle_twilight.model1<span class="op">$</span>peak_wl.flower.vs.beetle, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Beetle vs Flower&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Vis UML&quot;</span>, <span class="st">&quot;Vis USL&quot;</span>, <span class="st">&quot;Vis USM&quot;</span>, <span class="st">&quot;Vis USML&quot;</span>))</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="visual-model-2-1" class="section level4 tabset tabset-fade tabset-pills">
<h4>Visual model 2</h4>
<div id="d65-3" class="section level5">
<h5>D65</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
<span class="kw">boxplot</span>(compare.leaf.vs.flower.model2<span class="op">$</span>dS<span class="op">~</span>compare.leaf.vs.flower.model2<span class="op">$</span>peak_wl.leaf.vs.flower, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Leaf vs Flower&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>, <span class="st">&quot;Vis 620&quot;</span>, <span class="st">&quot;Vis 640&quot;</span>, <span class="st">&quot;Vis 660&quot;</span>, <span class="st">&quot;Vis 680&quot;</span>))
<span class="kw">boxplot</span>(compare.leaf.vs.beetle.model2<span class="op">$</span>dS<span class="op">~</span>compare.leaf.vs.beetle.model2<span class="op">$</span>peak_wl.leaf.vs.beetle, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Leaf vs Beetle&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>, <span class="st">&quot;Vis 620&quot;</span>, <span class="st">&quot;Vis 640&quot;</span>, <span class="st">&quot;Vis 660&quot;</span>, <span class="st">&quot;Vis 680&quot;</span>))
<span class="kw">boxplot</span>(compare.flower.vs.beetle.model2<span class="op">$</span>dS<span class="op">~</span>compare.flower.vs.beetle.model2<span class="op">$</span>peak_wl.flower.vs.beetle, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Beetle vs Flower&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>, <span class="st">&quot;Vis 620&quot;</span>, <span class="st">&quot;Vis 640&quot;</span>, <span class="st">&quot;Vis 660&quot;</span>, <span class="st">&quot;Vis 680&quot;</span>))</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="twilight-3" class="section level5">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span> (<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
<span class="kw">boxplot</span>(compare.leaf.vs.flower_twilight.model2<span class="op">$</span>dS<span class="op">~</span>compare.leaf.vs.flower_twilight.model2<span class="op">$</span>peak_wl.leaf.vs.flower, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Leaf vs Flower&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>, <span class="st">&quot;Vis 620&quot;</span>, <span class="st">&quot;Vis 640&quot;</span>, <span class="st">&quot;Vis 660&quot;</span>, <span class="st">&quot;Vis 680&quot;</span>))
<span class="kw">boxplot</span>(compare.leaf.vs.beetle_twilight.model2<span class="op">$</span>dS<span class="op">~</span>compare.leaf.vs.beetle_twilight.model2<span class="op">$</span>peak_wl.leaf.vs.beetle, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Leaf vs Beetle&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>, <span class="st">&quot;Vis 620&quot;</span>, <span class="st">&quot;Vis 640&quot;</span>, <span class="st">&quot;Vis 660&quot;</span>, <span class="st">&quot;Vis 680&quot;</span>))
<span class="kw">boxplot</span>(compare.flower.vs.beetle_twilight.model2<span class="op">$</span>dS<span class="op">~</span>compare.flower.vs.beetle_twilight.model2<span class="op">$</span>peak_wl.flower.vs.beetle, <span class="dt">las=</span><span class="dv">2</span>,
        <span class="dt">main =</span> <span class="st">&quot;Beetle vs Flower&quot;</span>,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>, <span class="st">&quot;Vis 620&quot;</span>, <span class="st">&quot;Vis 640&quot;</span>, <span class="st">&quot;Vis 660&quot;</span>, <span class="st">&quot;Vis 680&quot;</span>))</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
</div>
</div>
</div>
<div id="glmm-results" class="section level2">
<h2>GLMM results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#GLMM - D65 - visual model 1</span>
##Leaf vs Flower
m.leaf.vs.flower_d65.model1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.leaf.vs.flower <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.leaf.vs.flower.model1,<span class="dt">REML=</span>F)
sum.leaf.vs.flower_d65.model1&lt;-<span class="kw">summary</span>(<span class="kw">glht</span>(m.leaf.vs.flower_d65.model1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.leaf.vs.flower =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
<span class="co">#REML=F, in order to fit the model using the likelihood ratio test. Otherwise, the lmer default will fit the model using the REML (REstricted Maximum Likelihood) criterion.</span>

##Leaf vs Beetle
m.leaf.vs.beetle_d65.model1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.leaf.vs.beetle <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.leaf.vs.beetle.model1,<span class="dt">REML=</span>F)
sum.leaf.vs.beetle_d65.model1 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.leaf.vs.beetle_d65.model1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.leaf.vs.beetle =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))

##Beetle vs Flower
m.flower.vs.beetle_d65.model1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.flower.vs.beetle <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.flower.vs.beetle.model1,<span class="dt">REML=</span>F)
sum.flower.vs.beetle_d65.model1 &lt;-<span class="kw">summary</span>(<span class="kw">glht</span>(m.flower.vs.beetle_d65.model1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.flower.vs.beetle =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))

###reshape data for heatmap
p1_d65.model1&lt;-sum.leaf.vs.flower_d65.model1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p2_d65.model1&lt;-sum.leaf.vs.beetle_d65.model1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p3_d65.model1&lt;-sum.flower.vs.beetle_d65.model1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]

VislistA_d65.model1&lt;-<span class="kw">c</span>(<span class="st">&quot;Vis USL&quot;</span>, <span class="st">&quot;Vis USM&quot;</span>,<span class="st">&quot;Vis USML&quot;</span>,<span class="st">&quot;Vis USM&quot;</span>,<span class="st">&quot;Vis USML&quot;</span>,<span class="st">&quot;Vis USML&quot;</span>)
VislistB_d65.model1&lt;-<span class="kw">c</span>(<span class="st">&quot;Vis UML&quot;</span>, <span class="st">&quot;Vis UML&quot;</span>,<span class="st">&quot;Vis UML&quot;</span>,<span class="st">&quot;Vis USL&quot;</span>,<span class="st">&quot;Vis USL&quot;</span>,<span class="st">&quot;Vis USW&quot;</span>)

heat1_d65.model1&lt;-<span class="kw">data.frame</span>(<span class="kw">names</span>(p1_d65.model1),<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p1_d65.model1,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p2_d65.model1,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p3_d65.model1,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">orignial.list =</span> <span class="dv">1</span>, <span class="dt">leaf.vs.flower =</span> <span class="dv">2</span>, <span class="dt">leaf.vs.beetle =</span> <span class="dv">3</span>, <span class="dt">flower.vs.beetle =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistA_d65.model1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistB_d65.model1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>orignial.list)


<span class="co">#GLMM - D65 - visual model 2</span>
##Leaf vs Flower
m.leaf.vs.flower_d65.model2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.leaf.vs.flower <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.leaf.vs.flower.model2,<span class="dt">REML=</span>F)
sum.leaf.vs.flower_d65.model2 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.leaf.vs.flower_d65.model2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.leaf.vs.flower =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
##Leaf vs Beetle
m.leaf.vs.beetle_d65.model2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.leaf.vs.beetle <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.leaf.vs.beetle.model2,<span class="dt">REML=</span>F)
sum.leaf.vs.beetle_d65.model2 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.leaf.vs.beetle_d65.model2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.leaf.vs.beetle =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
##Beetle vs Flower
m.flower.vs.beetle_d65.model2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.flower.vs.beetle <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.flower.vs.beetle.model2,<span class="dt">REML=</span>F)
sum.flower.vs.beetle_d65.model2 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.flower.vs.beetle_d65.model2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.flower.vs.beetle =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))

###reshape data for heatmap
p1_d65.model2&lt;-sum.leaf.vs.flower_d65.model2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p2_d65.model2&lt;-sum.leaf.vs.beetle_d65.model2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p3_d65.model2&lt;-sum.flower.vs.beetle_d65.model2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]

VislistA_d65.model2&lt;-<span class="kw">c</span>(<span class="st">&quot;Vis 600&quot;</span>, <span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 680&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 680&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 680&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 680&quot;</span>,<span class="st">&quot;Vis 680&quot;</span>)
VislistB_d65.model2&lt;-<span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>)

heat1_d65.model2&lt;-<span class="kw">data.frame</span>(<span class="kw">names</span>(p1_d65.model2),<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p1_d65.model2,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p2_d65.model2,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p3_d65.model2,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">orignial.list =</span> <span class="dv">1</span>, <span class="dt">leaf.vs.flower =</span> <span class="dv">2</span>, <span class="dt">leaf.vs.beetle =</span> <span class="dv">3</span>, <span class="dt">flower.vs.beetle =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistA_d65.model2) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistB_d65.model2) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>orignial.list)

<span class="co">#GLMM - Twilight - visual model 1</span>
##Leaf vs Flower
m.leaf.vs.flower_twilight.model1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.leaf.vs.flower <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.leaf.vs.flower_twilight.model1,<span class="dt">REML=</span>F)
sum.leaf.vs.flower_twilight.model1 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.leaf.vs.flower_twilight.model1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.leaf.vs.flower =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
##Leaf vs Beetle
m.leaf.vs.beetle_twilight.model1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.leaf.vs.beetle <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.leaf.vs.beetle_twilight.model1,<span class="dt">REML=</span>F)
sum.leaf.vs.beetle_twilight.model1&lt;-<span class="kw">summary</span>(<span class="kw">glht</span>(m.leaf.vs.beetle_twilight.model1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.leaf.vs.beetle =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
##Beetle vs Flower
m.flower.vs.beetle_twilight.model1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.flower.vs.beetle <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.flower.vs.beetle_twilight.model1,<span class="dt">REML=</span>F)
sum.flower.vs.beetle_twilight.model1&lt;-<span class="kw">summary</span>(<span class="kw">glht</span>(m.flower.vs.beetle_twilight.model1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.flower.vs.beetle =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
###reshape data for heatmap
p1_twilight.model1&lt;-sum.leaf.vs.flower_twilight.model1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p2_twilight.model1&lt;-sum.leaf.vs.beetle_twilight.model1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p3_twilight.model1&lt;-sum.flower.vs.beetle_twilight.model1[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]

VislistA_twilight.model1&lt;-<span class="kw">c</span>(<span class="st">&quot;Vis USL&quot;</span>, <span class="st">&quot;Vis USM&quot;</span>,<span class="st">&quot;Vis USML&quot;</span>,<span class="st">&quot;Vis USM&quot;</span>,<span class="st">&quot;Vis USML&quot;</span>,<span class="st">&quot;Vis USML&quot;</span>)
VislistB_twilight.model1&lt;-<span class="kw">c</span>(<span class="st">&quot;Vis UML&quot;</span>, <span class="st">&quot;Vis UML&quot;</span>,<span class="st">&quot;Vis UML&quot;</span>,<span class="st">&quot;Vis USL&quot;</span>,<span class="st">&quot;Vis USL&quot;</span>,<span class="st">&quot;Vis USW&quot;</span>)

heat1_twilight.model1&lt;-<span class="kw">data.frame</span>(<span class="kw">names</span>(p1_twilight.model1),<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p1_twilight.model1,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p2_twilight.model1,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p3_twilight.model1,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">orignial.list =</span> <span class="dv">1</span>, <span class="dt">leaf.vs.flower =</span> <span class="dv">2</span>, <span class="dt">leaf.vs.beetle =</span> <span class="dv">3</span>, <span class="dt">flower.vs.beetle =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistA_twilight.model1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistB_twilight.model1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>orignial.list)


<span class="co">#GLMM - Twilight - visual model 2</span>
##Leaf vs Flower
m.leaf.vs.flower_twilight.model2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.leaf.vs.flower <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.leaf.vs.flower_twilight.model2,<span class="dt">REML=</span>F)
sum.leaf.vs.flower_twilight.model2 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.leaf.vs.flower_twilight.model2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.leaf.vs.flower =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
##Leaf vs Beetle
m.leaf.vs.beetle_twilight.model2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.leaf.vs.beetle <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.leaf.vs.beetle_twilight.model2,<span class="dt">REML=</span>F)
sum.leaf.vs.beetle_twilight.model2 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(m.leaf.vs.beetle_twilight.model2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.leaf.vs.beetle =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
##Beetle vs Flower
m.flower.vs.beetle_twilight.model2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(dS<span class="op">~</span>peak_wl.flower.vs.beetle <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch2) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>patch1), <span class="dt">data =</span> compare.flower.vs.beetle_twilight.model2,<span class="dt">REML=</span>F)
sum.flower.vs.beetle_twilight.model2 &lt;-<span class="kw">summary</span>(<span class="kw">glht</span>(m.flower.vs.beetle_twilight.model2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">peak_wl.flower.vs.beetle =</span> <span class="st">&quot;Tukey&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="st">&quot;bonferroni&quot;</span>))
###reshape data for heatmap
p1_twilight.model2&lt;-sum.leaf.vs.flower_twilight.model2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p2_twilight.model2&lt;-sum.leaf.vs.beetle_twilight.model2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]
p3_twilight.model2&lt;-sum.flower.vs.beetle_twilight.model2[[<span class="st">&quot;test&quot;</span>]][[<span class="st">&quot;pvalues&quot;</span>]]

VislistA_twilight.model2&lt;-<span class="kw">c</span>(<span class="st">&quot;Vis 600&quot;</span>, <span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 680&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 680&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 680&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 680&quot;</span>,<span class="st">&quot;Vis 680&quot;</span>)
VislistB_twilight.model2&lt;-<span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 580&quot;</span>,<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>)

heat1_twilight.model2&lt;-<span class="kw">data.frame</span>(<span class="kw">names</span>(p1_twilight.model2),<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p1_twilight.model2,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p2_twilight.model2,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(p3_twilight.model2,<span class="st">&quot;([0-9]+).*$&quot;</span>))) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">orignial.list =</span> <span class="dv">1</span>, <span class="dt">leaf.vs.flower =</span> <span class="dv">2</span>, <span class="dt">leaf.vs.beetle =</span> <span class="dv">3</span>, <span class="dt">flower.vs.beetle =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistA_twilight.model2) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cbind</span>(VislistB_twilight.model2) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>orignial.list)</code></pre></div>
<div id="result-of-visual-model-1-comparing-visual-systems-with-different-photoreceptor-combination" class="section level3 tabset tabset-fade tabset-pills">
<h3>Result of visual model 1: comparing visual systems with different photoreceptor combination</h3>
<p>Click the tabs to see the results in each comparison groups ( <strong>Leaf vs. Flower</strong> / <strong>Leaf vs. Beetle</strong> / <strong>Beetle vs. Flower</strong>) and under different light conditions ( <strong>Daylight</strong> / <strong>Twilight</strong>)</p>
<div id="leaf-vs-flower" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Leaf vs Flower</strong></h4>
<div id="daylight" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.leaf.vs.flower_d65.model1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.leaf.vs.flower</strong></td>
<td align="center">397.5</td>
<td align="center">3</td>
<td align="center">7.567e-86</td>
</tr>
</tbody>
</table>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat1_d65.model1[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>)], <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_d65.model1, <span class="dt">y=</span>VislistB_d65.model1, <span class="dt">fill=</span>leaf.vs.flower)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_d65.model1, VislistB_d65.model1, <span class="dt">label =</span> <span class="kw">round</span>(leaf.vs.flower, <span class="dv">2</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="original-model-output" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.leaf.vs.flower_d65.model1</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.leaf.vs.flower + (1 | patch2) + (1 | 
##     patch1), data = compare.leaf.vs.flower.model1, REML = F)
## 
## Linear Hypotheses:
##                                                                          Estimate
## contrast.UVSW..LW.leaf.vs.flower - contrast.UV..MWLW.leaf.vs.flower == 0  0.35939
## contrast.UVSWMW...leaf.vs.flower - contrast.UV..MWLW.leaf.vs.flower == 0  0.41078
## contrast.UVSWMWLW.leaf.vs.flower - contrast.UV..MWLW.leaf.vs.flower == 0  1.00853
## contrast.UVSWMW...leaf.vs.flower - contrast.UVSW..LW.leaf.vs.flower == 0  0.05139
## contrast.UVSWMWLW.leaf.vs.flower - contrast.UVSW..LW.leaf.vs.flower == 0  0.64914
## contrast.UVSWMWLW.leaf.vs.flower - contrast.UVSWMW...leaf.vs.flower == 0  0.59775
##                                                                          Std. Error
## contrast.UVSW..LW.leaf.vs.flower - contrast.UV..MWLW.leaf.vs.flower == 0    0.05135
## contrast.UVSWMW...leaf.vs.flower - contrast.UV..MWLW.leaf.vs.flower == 0    0.05135
## contrast.UVSWMWLW.leaf.vs.flower - contrast.UV..MWLW.leaf.vs.flower == 0    0.05135
## contrast.UVSWMW...leaf.vs.flower - contrast.UVSW..LW.leaf.vs.flower == 0    0.05135
## contrast.UVSWMWLW.leaf.vs.flower - contrast.UVSW..LW.leaf.vs.flower == 0    0.05135
## contrast.UVSWMWLW.leaf.vs.flower - contrast.UVSWMW...leaf.vs.flower == 0    0.05135
##                                                                          z value
## contrast.UVSW..LW.leaf.vs.flower - contrast.UV..MWLW.leaf.vs.flower == 0   6.999
## contrast.UVSWMW...leaf.vs.flower - contrast.UV..MWLW.leaf.vs.flower == 0   8.000
## contrast.UVSWMWLW.leaf.vs.flower - contrast.UV..MWLW.leaf.vs.flower == 0  19.641
## contrast.UVSWMW...leaf.vs.flower - contrast.UVSW..LW.leaf.vs.flower == 0   1.001
## contrast.UVSWMWLW.leaf.vs.flower - contrast.UVSW..LW.leaf.vs.flower == 0  12.642
## contrast.UVSWMWLW.leaf.vs.flower - contrast.UVSWMW...leaf.vs.flower == 0  11.641
##                                                                          Pr(&gt;|z|)
## contrast.UVSW..LW.leaf.vs.flower - contrast.UV..MWLW.leaf.vs.flower == 0 1.55e-11
## contrast.UVSWMW...leaf.vs.flower - contrast.UV..MWLW.leaf.vs.flower == 0 7.99e-15
## contrast.UVSWMWLW.leaf.vs.flower - contrast.UV..MWLW.leaf.vs.flower == 0  &lt; 2e-16
## contrast.UVSWMW...leaf.vs.flower - contrast.UVSW..LW.leaf.vs.flower == 0        1
## contrast.UVSWMWLW.leaf.vs.flower - contrast.UVSW..LW.leaf.vs.flower == 0  &lt; 2e-16
## contrast.UVSWMWLW.leaf.vs.flower - contrast.UVSWMW...leaf.vs.flower == 0  &lt; 2e-16
##                                                                             
## contrast.UVSW..LW.leaf.vs.flower - contrast.UV..MWLW.leaf.vs.flower == 0 ***
## contrast.UVSWMW...leaf.vs.flower - contrast.UV..MWLW.leaf.vs.flower == 0 ***
## contrast.UVSWMWLW.leaf.vs.flower - contrast.UV..MWLW.leaf.vs.flower == 0 ***
## contrast.UVSWMW...leaf.vs.flower - contrast.UVSW..LW.leaf.vs.flower == 0    
## contrast.UVSWMWLW.leaf.vs.flower - contrast.UVSW..LW.leaf.vs.flower == 0 ***
## contrast.UVSWMWLW.leaf.vs.flower - contrast.UVSWMW...leaf.vs.flower == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-4" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.leaf.vs.flower_twilight.model1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.leaf.vs.flower</strong></td>
<td align="center">366.8</td>
<td align="center">3</td>
<td align="center">3.429e-79</td>
</tr>
</tbody>
</table>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-1" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat1_twilight.model1[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>)], <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.model1, <span class="dt">y=</span>VislistB_twilight.model1, <span class="dt">fill=</span>leaf.vs.flower)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.model1, VislistB_twilight.model1, <span class="dt">label =</span> <span class="kw">round</span>(leaf.vs.flower, <span class="dv">2</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
<div id="original-model-output-1" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.leaf.vs.flower_twilight.model1</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.leaf.vs.flower + (1 | patch2) + (1 | 
##     patch1), data = compare.leaf.vs.flower_twilight.model1, REML = F)
## 
## Linear Hypotheses:
##                                                                                            Estimate
## contrast.UVSW..LW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0  0.28995
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0  0.30736
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0  0.88756
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0  0.01741
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0  0.59762
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSWMW...leaf.vs.flower_twilight == 0  0.58021
##                                                                                            Std. Error
## contrast.UVSW..LW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0    0.04757
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0    0.04757
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0    0.04757
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0    0.04757
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0    0.04757
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSWMW...leaf.vs.flower_twilight == 0    0.04757
##                                                                                            z value
## contrast.UVSW..LW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0   6.095
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0   6.461
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0  18.656
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0   0.366
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0  12.562
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSWMW...leaf.vs.flower_twilight == 0  12.196
##                                                                                            Pr(&gt;|z|)
## contrast.UVSW..LW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0 6.58e-09
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0 6.26e-10
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0  &lt; 2e-16
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0        1
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0  &lt; 2e-16
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSWMW...leaf.vs.flower_twilight == 0  &lt; 2e-16
##                                                                                               
## contrast.UVSW..LW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0 ***
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0 ***
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0 ***
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0    
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0 ***
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSWMW...leaf.vs.flower_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
</div>
<div id="leaf-vs-beetle" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Leaf vs Beetle</strong></h4>
<div id="daylight-1" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.leaf.vs.beetle_d65.model1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.leaf.vs.beetle</strong></td>
<td align="center">428.9</td>
<td align="center">3</td>
<td align="center">1.186e-92</td>
</tr>
</tbody>
</table>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-2" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat1_d65.model1[,<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>)], <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_d65.model1, <span class="dt">y=</span>VislistB_d65.model1, <span class="dt">fill=</span>leaf.vs.beetle)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_d65.model1, VislistB_d65.model1, <span class="dt">label =</span> <span class="kw">round</span>(leaf.vs.beetle, <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
<div id="original-model-output-2" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.leaf.vs.beetle_d65.model1</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.leaf.vs.beetle + (1 | patch2) + (1 | 
##     patch1), data = compare.leaf.vs.beetle.model1, REML = F)
## 
## Linear Hypotheses:
##                                                                          Estimate
## contrast.UVSW..LW.leaf.vs.beetle - contrast.UV..MWLW.leaf.vs.beetle == 0 -0.10903
## contrast.UVSWMW...leaf.vs.beetle - contrast.UV..MWLW.leaf.vs.beetle == 0 -0.57455
## contrast.UVSWMWLW.leaf.vs.beetle - contrast.UV..MWLW.leaf.vs.beetle == 0  0.45280
## contrast.UVSWMW...leaf.vs.beetle - contrast.UVSW..LW.leaf.vs.beetle == 0 -0.46552
## contrast.UVSWMWLW.leaf.vs.beetle - contrast.UVSW..LW.leaf.vs.beetle == 0  0.56183
## contrast.UVSWMWLW.leaf.vs.beetle - contrast.UVSWMW...leaf.vs.beetle == 0  1.02735
##                                                                          Std. Error
## contrast.UVSW..LW.leaf.vs.beetle - contrast.UV..MWLW.leaf.vs.beetle == 0    0.04988
## contrast.UVSWMW...leaf.vs.beetle - contrast.UV..MWLW.leaf.vs.beetle == 0    0.04988
## contrast.UVSWMWLW.leaf.vs.beetle - contrast.UV..MWLW.leaf.vs.beetle == 0    0.04988
## contrast.UVSWMW...leaf.vs.beetle - contrast.UVSW..LW.leaf.vs.beetle == 0    0.04988
## contrast.UVSWMWLW.leaf.vs.beetle - contrast.UVSW..LW.leaf.vs.beetle == 0    0.04988
## contrast.UVSWMWLW.leaf.vs.beetle - contrast.UVSWMW...leaf.vs.beetle == 0    0.04988
##                                                                          z value
## contrast.UVSW..LW.leaf.vs.beetle - contrast.UV..MWLW.leaf.vs.beetle == 0  -2.186
## contrast.UVSWMW...leaf.vs.beetle - contrast.UV..MWLW.leaf.vs.beetle == 0 -11.518
## contrast.UVSWMWLW.leaf.vs.beetle - contrast.UV..MWLW.leaf.vs.beetle == 0   9.077
## contrast.UVSWMW...leaf.vs.beetle - contrast.UVSW..LW.leaf.vs.beetle == 0  -9.332
## contrast.UVSWMWLW.leaf.vs.beetle - contrast.UVSW..LW.leaf.vs.beetle == 0  11.263
## contrast.UVSWMWLW.leaf.vs.beetle - contrast.UVSWMW...leaf.vs.beetle == 0  20.595
##                                                                          Pr(&gt;|z|)
## contrast.UVSW..LW.leaf.vs.beetle - contrast.UV..MWLW.leaf.vs.beetle == 0    0.173
## contrast.UVSWMW...leaf.vs.beetle - contrast.UV..MWLW.leaf.vs.beetle == 0   &lt;2e-16
## contrast.UVSWMWLW.leaf.vs.beetle - contrast.UV..MWLW.leaf.vs.beetle == 0   &lt;2e-16
## contrast.UVSWMW...leaf.vs.beetle - contrast.UVSW..LW.leaf.vs.beetle == 0   &lt;2e-16
## contrast.UVSWMWLW.leaf.vs.beetle - contrast.UVSW..LW.leaf.vs.beetle == 0   &lt;2e-16
## contrast.UVSWMWLW.leaf.vs.beetle - contrast.UVSWMW...leaf.vs.beetle == 0   &lt;2e-16
##                                                                             
## contrast.UVSW..LW.leaf.vs.beetle - contrast.UV..MWLW.leaf.vs.beetle == 0    
## contrast.UVSWMW...leaf.vs.beetle - contrast.UV..MWLW.leaf.vs.beetle == 0 ***
## contrast.UVSWMWLW.leaf.vs.beetle - contrast.UV..MWLW.leaf.vs.beetle == 0 ***
## contrast.UVSWMW...leaf.vs.beetle - contrast.UVSW..LW.leaf.vs.beetle == 0 ***
## contrast.UVSWMWLW.leaf.vs.beetle - contrast.UVSW..LW.leaf.vs.beetle == 0 ***
## contrast.UVSWMWLW.leaf.vs.beetle - contrast.UVSWMW...leaf.vs.beetle == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-5" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.leaf.vs.beetle_twilight.model1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.leaf.vs.beetle</strong></td>
<td align="center">488.9</td>
<td align="center">3</td>
<td align="center">1.225e-105</td>
</tr>
</tbody>
</table>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-3" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat1_twilight.model1[,<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>)], <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.model1, <span class="dt">y=</span>VislistB_twilight.model1, <span class="dt">fill=</span>leaf.vs.beetle)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.model1, VislistB_twilight.model1, <span class="dt">label =</span> <span class="kw">round</span>(leaf.vs.beetle, <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="original-model-output-3" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.leaf.vs.beetle_twilight.model1</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.leaf.vs.beetle + (1 | patch2) + (1 | 
##     patch1), data = compare.leaf.vs.beetle_twilight.model1, REML = F)
## 
## Linear Hypotheses:
##                                                                                            Estimate
## contrast.UVSW..LW.leaf.vs.beetle_twilight - contrast.UV..MWLW.leaf.vs.beetle_twilight == 0 -0.14766
## contrast.UVSWMW...leaf.vs.beetle_twilight - contrast.UV..MWLW.leaf.vs.beetle_twilight == 0 -0.62399
## contrast.UVSWMWLW.leaf.vs.beetle_twilight - contrast.UV..MWLW.leaf.vs.beetle_twilight == 0  0.38815
## contrast.UVSWMW...leaf.vs.beetle_twilight - contrast.UVSW..LW.leaf.vs.beetle_twilight == 0 -0.47633
## contrast.UVSWMWLW.leaf.vs.beetle_twilight - contrast.UVSW..LW.leaf.vs.beetle_twilight == 0  0.53581
## contrast.UVSWMWLW.leaf.vs.beetle_twilight - contrast.UVSWMW...leaf.vs.beetle_twilight == 0  1.01214
##                                                                                            Std. Error
## contrast.UVSW..LW.leaf.vs.beetle_twilight - contrast.UV..MWLW.leaf.vs.beetle_twilight == 0    0.04635
## contrast.UVSWMW...leaf.vs.beetle_twilight - contrast.UV..MWLW.leaf.vs.beetle_twilight == 0    0.04635
## contrast.UVSWMWLW.leaf.vs.beetle_twilight - contrast.UV..MWLW.leaf.vs.beetle_twilight == 0    0.04635
## contrast.UVSWMW...leaf.vs.beetle_twilight - contrast.UVSW..LW.leaf.vs.beetle_twilight == 0    0.04635
## contrast.UVSWMWLW.leaf.vs.beetle_twilight - contrast.UVSW..LW.leaf.vs.beetle_twilight == 0    0.04635
## contrast.UVSWMWLW.leaf.vs.beetle_twilight - contrast.UVSWMW...leaf.vs.beetle_twilight == 0    0.04635
##                                                                                            z value
## contrast.UVSW..LW.leaf.vs.beetle_twilight - contrast.UV..MWLW.leaf.vs.beetle_twilight == 0  -3.186
## contrast.UVSWMW...leaf.vs.beetle_twilight - contrast.UV..MWLW.leaf.vs.beetle_twilight == 0 -13.463
## contrast.UVSWMWLW.leaf.vs.beetle_twilight - contrast.UV..MWLW.leaf.vs.beetle_twilight == 0   8.375
## contrast.UVSWMW...leaf.vs.beetle_twilight - contrast.UVSW..LW.leaf.vs.beetle_twilight == 0 -10.277
## contrast.UVSWMWLW.leaf.vs.beetle_twilight - contrast.UVSW..LW.leaf.vs.beetle_twilight == 0  11.561
## contrast.UVSWMWLW.leaf.vs.beetle_twilight - contrast.UVSWMW...leaf.vs.beetle_twilight == 0  21.839
##                                                                                            Pr(&gt;|z|)
## contrast.UVSW..LW.leaf.vs.beetle_twilight - contrast.UV..MWLW.leaf.vs.beetle_twilight == 0  0.00866
## contrast.UVSWMW...leaf.vs.beetle_twilight - contrast.UV..MWLW.leaf.vs.beetle_twilight == 0  &lt; 2e-16
## contrast.UVSWMWLW.leaf.vs.beetle_twilight - contrast.UV..MWLW.leaf.vs.beetle_twilight == 0  &lt; 2e-16
## contrast.UVSWMW...leaf.vs.beetle_twilight - contrast.UVSW..LW.leaf.vs.beetle_twilight == 0  &lt; 2e-16
## contrast.UVSWMWLW.leaf.vs.beetle_twilight - contrast.UVSW..LW.leaf.vs.beetle_twilight == 0  &lt; 2e-16
## contrast.UVSWMWLW.leaf.vs.beetle_twilight - contrast.UVSWMW...leaf.vs.beetle_twilight == 0  &lt; 2e-16
##                                                                                               
## contrast.UVSW..LW.leaf.vs.beetle_twilight - contrast.UV..MWLW.leaf.vs.beetle_twilight == 0 ** 
## contrast.UVSWMW...leaf.vs.beetle_twilight - contrast.UV..MWLW.leaf.vs.beetle_twilight == 0 ***
## contrast.UVSWMWLW.leaf.vs.beetle_twilight - contrast.UV..MWLW.leaf.vs.beetle_twilight == 0 ***
## contrast.UVSWMW...leaf.vs.beetle_twilight - contrast.UVSW..LW.leaf.vs.beetle_twilight == 0 ***
## contrast.UVSWMWLW.leaf.vs.beetle_twilight - contrast.UVSW..LW.leaf.vs.beetle_twilight == 0 ***
## contrast.UVSWMWLW.leaf.vs.beetle_twilight - contrast.UVSWMW...leaf.vs.beetle_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
</div>
<div id="beetle-vs-flower" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Beetle vs Flower</strong></h4>
<div id="daylight-2" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.flower.vs.beetle_twilight.model1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:78%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="43%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.flower.vs.beetle</strong></td>
<td align="center">257.8</td>
<td align="center">3</td>
<td align="center">1.331e-55</td>
</tr>
</tbody>
</table>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-4" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat1_twilight.model1[,<span class="dv">3</span><span class="op">:</span><span class="dv">5</span>,], <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.model1, <span class="dt">y=</span>VislistB_twilight.model1, <span class="dt">fill=</span>flower.vs.beetle)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.model1, VislistB_twilight.model1, <span class="dt">label =</span> <span class="kw">round</span>(flower.vs.beetle, <span class="dv">2</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour </span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
<div id="original-model-output-4" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.flower.vs.beetle_twilight.model1</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.flower.vs.beetle + (1 | patch2) + 
##     (1 | patch1), data = compare.flower.vs.beetle_twilight.model1, 
##     REML = F)
## 
## Linear Hypotheses:
##                                                                                                Estimate
## contrast.UVSW..LW.flower.vs.beetle_twilight - contrast.UV..MWLW.flower.vs.beetle_twilight == 0  0.35978
## contrast.UVSWMW...flower.vs.beetle_twilight - contrast.UV..MWLW.flower.vs.beetle_twilight == 0  0.24697
## contrast.UVSWMWLW.flower.vs.beetle_twilight - contrast.UV..MWLW.flower.vs.beetle_twilight == 0  1.03501
## contrast.UVSWMW...flower.vs.beetle_twilight - contrast.UVSW..LW.flower.vs.beetle_twilight == 0 -0.11280
## contrast.UVSWMWLW.flower.vs.beetle_twilight - contrast.UVSW..LW.flower.vs.beetle_twilight == 0  0.67523
## contrast.UVSWMWLW.flower.vs.beetle_twilight - contrast.UVSWMW...flower.vs.beetle_twilight == 0  0.78803
##                                                                                                Std. Error
## contrast.UVSW..LW.flower.vs.beetle_twilight - contrast.UV..MWLW.flower.vs.beetle_twilight == 0    0.06753
## contrast.UVSWMW...flower.vs.beetle_twilight - contrast.UV..MWLW.flower.vs.beetle_twilight == 0    0.06753
## contrast.UVSWMWLW.flower.vs.beetle_twilight - contrast.UV..MWLW.flower.vs.beetle_twilight == 0    0.06753
## contrast.UVSWMW...flower.vs.beetle_twilight - contrast.UVSW..LW.flower.vs.beetle_twilight == 0    0.06753
## contrast.UVSWMWLW.flower.vs.beetle_twilight - contrast.UVSW..LW.flower.vs.beetle_twilight == 0    0.06753
## contrast.UVSWMWLW.flower.vs.beetle_twilight - contrast.UVSWMW...flower.vs.beetle_twilight == 0    0.06753
##                                                                                                z value
## contrast.UVSW..LW.flower.vs.beetle_twilight - contrast.UV..MWLW.flower.vs.beetle_twilight == 0   5.328
## contrast.UVSWMW...flower.vs.beetle_twilight - contrast.UV..MWLW.flower.vs.beetle_twilight == 0   3.657
## contrast.UVSWMWLW.flower.vs.beetle_twilight - contrast.UV..MWLW.flower.vs.beetle_twilight == 0  15.327
## contrast.UVSWMW...flower.vs.beetle_twilight - contrast.UVSW..LW.flower.vs.beetle_twilight == 0  -1.670
## contrast.UVSWMWLW.flower.vs.beetle_twilight - contrast.UVSW..LW.flower.vs.beetle_twilight == 0   9.999
## contrast.UVSWMWLW.flower.vs.beetle_twilight - contrast.UVSWMW...flower.vs.beetle_twilight == 0  11.670
##                                                                                                Pr(&gt;|z|)
## contrast.UVSW..LW.flower.vs.beetle_twilight - contrast.UV..MWLW.flower.vs.beetle_twilight == 0 5.96e-07
## contrast.UVSWMW...flower.vs.beetle_twilight - contrast.UV..MWLW.flower.vs.beetle_twilight == 0  0.00153
## contrast.UVSWMWLW.flower.vs.beetle_twilight - contrast.UV..MWLW.flower.vs.beetle_twilight == 0  &lt; 2e-16
## contrast.UVSWMW...flower.vs.beetle_twilight - contrast.UVSW..LW.flower.vs.beetle_twilight == 0  0.56893
## contrast.UVSWMWLW.flower.vs.beetle_twilight - contrast.UVSW..LW.flower.vs.beetle_twilight == 0  &lt; 2e-16
## contrast.UVSWMWLW.flower.vs.beetle_twilight - contrast.UVSWMW...flower.vs.beetle_twilight == 0  &lt; 2e-16
##                                                                                                   
## contrast.UVSW..LW.flower.vs.beetle_twilight - contrast.UV..MWLW.flower.vs.beetle_twilight == 0 ***
## contrast.UVSWMW...flower.vs.beetle_twilight - contrast.UV..MWLW.flower.vs.beetle_twilight == 0 ** 
## contrast.UVSWMWLW.flower.vs.beetle_twilight - contrast.UV..MWLW.flower.vs.beetle_twilight == 0 ***
## contrast.UVSWMW...flower.vs.beetle_twilight - contrast.UVSW..LW.flower.vs.beetle_twilight == 0    
## contrast.UVSWMWLW.flower.vs.beetle_twilight - contrast.UVSW..LW.flower.vs.beetle_twilight == 0 ***
## contrast.UVSWMWLW.flower.vs.beetle_twilight - contrast.UVSWMW...flower.vs.beetle_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-6" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.flower.vs.beetle_twilight.model1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:78%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="43%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.flower.vs.beetle</strong></td>
<td align="center">257.8</td>
<td align="center">3</td>
<td align="center">1.331e-55</td>
</tr>
</tbody>
</table>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-5" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat1_twilight.model1[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>)], <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.model1, <span class="dt">y=</span>VislistB_twilight.model1, <span class="dt">fill=</span>leaf.vs.flower)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.model1, VislistB_twilight.model1, <span class="dt">label =</span> <span class="kw">round</span>(leaf.vs.flower, <span class="dv">2</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
<div id="original-model-output-5" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.leaf.vs.flower_twilight.model1</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.leaf.vs.flower + (1 | patch2) + (1 | 
##     patch1), data = compare.leaf.vs.flower_twilight.model1, REML = F)
## 
## Linear Hypotheses:
##                                                                                            Estimate
## contrast.UVSW..LW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0  0.28995
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0  0.30736
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0  0.88756
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0  0.01741
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0  0.59762
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSWMW...leaf.vs.flower_twilight == 0  0.58021
##                                                                                            Std. Error
## contrast.UVSW..LW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0    0.04757
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0    0.04757
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0    0.04757
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0    0.04757
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0    0.04757
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSWMW...leaf.vs.flower_twilight == 0    0.04757
##                                                                                            z value
## contrast.UVSW..LW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0   6.095
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0   6.461
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0  18.656
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0   0.366
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0  12.562
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSWMW...leaf.vs.flower_twilight == 0  12.196
##                                                                                            Pr(&gt;|z|)
## contrast.UVSW..LW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0 6.58e-09
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0 6.26e-10
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0  &lt; 2e-16
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0        1
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0  &lt; 2e-16
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSWMW...leaf.vs.flower_twilight == 0  &lt; 2e-16
##                                                                                               
## contrast.UVSW..LW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0 ***
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0 ***
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UV..MWLW.leaf.vs.flower_twilight == 0 ***
## contrast.UVSWMW...leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0    
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSW..LW.leaf.vs.flower_twilight == 0 ***
## contrast.UVSWMWLW.leaf.vs.flower_twilight - contrast.UVSWMW...leaf.vs.flower_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
</div>
</div>
<div id="result-of-visual-model-2-comparing-visual-systems-with-different-peak-of-lws-photoreceptor" class="section level3 tabset tabset-fade tabset-pills">
<h3>Result of visual model 2: comparing visual systems with different peak of LWS photoreceptor</h3>
<p>Click the tabs to see the results in each comparison groups ( <strong>Leaf vs. Flower</strong> / <strong>Leaf vs. Beetle</strong> / <strong>Beetle vs. Flower</strong>) and under different light conditions ( <strong>Daylight</strong> / <strong>Twilight</strong>)</p>
<div id="leaf-vs-flower-1" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Leaf vs Flower</strong></h4>
<div id="daylight-3" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.leaf.vs.flower_d65.model2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.leaf.vs.flower</strong></td>
<td align="center">1713</td>
<td align="center">5</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-6" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat1_d65.model2[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>)], <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_d65.model2, <span class="dt">y=</span>VislistB_d65.model2, <span class="dt">fill=</span>leaf.vs.flower)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_d65.model2, VislistB_d65.model2, <span class="dt">label =</span> <span class="kw">round</span>(leaf.vs.flower, <span class="dv">2</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
</div>
<div id="original-model-output-6" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.leaf.vs.flower_d65.model2</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.leaf.vs.flower + (1 | patch2) + (1 | 
##     patch1), data = compare.leaf.vs.flower.model2, REML = F)
## 
## Linear Hypotheses:
##                                                    Estimate Std. Error
## bup600.leaf.vs.flower - bup580.leaf.vs.flower == 0  0.24412    0.01775
## bup620.leaf.vs.flower - bup580.leaf.vs.flower == 0  0.52938    0.01775
## bup640.leaf.vs.flower - bup580.leaf.vs.flower == 0  0.62627    0.01775
## bup660.leaf.vs.flower - bup580.leaf.vs.flower == 0  0.44845    0.01775
## bup680.leaf.vs.flower - bup580.leaf.vs.flower == 0  0.21500    0.01775
## bup620.leaf.vs.flower - bup600.leaf.vs.flower == 0  0.28526    0.01775
## bup640.leaf.vs.flower - bup600.leaf.vs.flower == 0  0.38215    0.01775
## bup660.leaf.vs.flower - bup600.leaf.vs.flower == 0  0.20433    0.01775
## bup680.leaf.vs.flower - bup600.leaf.vs.flower == 0 -0.02912    0.01775
## bup640.leaf.vs.flower - bup620.leaf.vs.flower == 0  0.09689    0.01775
## bup660.leaf.vs.flower - bup620.leaf.vs.flower == 0 -0.08093    0.01775
## bup680.leaf.vs.flower - bup620.leaf.vs.flower == 0 -0.31438    0.01775
## bup660.leaf.vs.flower - bup640.leaf.vs.flower == 0 -0.17782    0.01775
## bup680.leaf.vs.flower - bup640.leaf.vs.flower == 0 -0.41127    0.01775
## bup680.leaf.vs.flower - bup660.leaf.vs.flower == 0 -0.23345    0.01775
##                                                    z value Pr(&gt;|z|)    
## bup600.leaf.vs.flower - bup580.leaf.vs.flower == 0  13.751  &lt; 2e-16 ***
## bup620.leaf.vs.flower - bup580.leaf.vs.flower == 0  29.819  &lt; 2e-16 ***
## bup640.leaf.vs.flower - bup580.leaf.vs.flower == 0  35.276  &lt; 2e-16 ***
## bup660.leaf.vs.flower - bup580.leaf.vs.flower == 0  25.260  &lt; 2e-16 ***
## bup680.leaf.vs.flower - bup580.leaf.vs.flower == 0  12.110  &lt; 2e-16 ***
## bup620.leaf.vs.flower - bup600.leaf.vs.flower == 0  16.068  &lt; 2e-16 ***
## bup640.leaf.vs.flower - bup600.leaf.vs.flower == 0  21.526  &lt; 2e-16 ***
## bup660.leaf.vs.flower - bup600.leaf.vs.flower == 0  11.509  &lt; 2e-16 ***
## bup680.leaf.vs.flower - bup600.leaf.vs.flower == 0  -1.640        1    
## bup640.leaf.vs.flower - bup620.leaf.vs.flower == 0   5.457 7.25e-07 ***
## bup660.leaf.vs.flower - bup620.leaf.vs.flower == 0  -4.559 7.72e-05 ***
## bup680.leaf.vs.flower - bup620.leaf.vs.flower == 0 -17.708  &lt; 2e-16 ***
## bup660.leaf.vs.flower - bup640.leaf.vs.flower == 0 -10.016  &lt; 2e-16 ***
## bup680.leaf.vs.flower - bup640.leaf.vs.flower == 0 -23.166  &lt; 2e-16 ***
## bup680.leaf.vs.flower - bup660.leaf.vs.flower == 0 -13.150  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-7" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.leaf.vs.flower_twilight.model2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.leaf.vs.flower</strong></td>
<td align="center">2513</td>
<td align="center">5</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-7" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat1_twilight.model2[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>)], <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.model2, <span class="dt">y=</span>VislistB_twilight.model2, <span class="dt">fill=</span>leaf.vs.flower)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.model2, VislistB_twilight.model2, <span class="dt">label =</span> <span class="kw">round</span>(leaf.vs.flower, <span class="dv">2</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
<div id="original-model-output-7" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.leaf.vs.flower_twilight.model2</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.leaf.vs.flower + (1 | patch2) + (1 | 
##     patch1), data = compare.leaf.vs.flower_twilight.model2, REML = F)
## 
## Linear Hypotheses:
##                                                                      Estimate
## bup600.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  0.33799
## bup620.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  0.67777
## bup640.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  0.70976
## bup660.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  0.48063
## bup680.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  0.30326
## bup620.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0  0.33978
## bup640.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0  0.37177
## bup660.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0  0.14264
## bup680.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0 -0.03473
## bup640.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0  0.03199
## bup660.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0 -0.19714
## bup680.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0 -0.37451
## bup660.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0 -0.22913
## bup680.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0 -0.40651
## bup680.leaf.vs.flower_twilight - bup660.leaf.vs.flower_twilight == 0 -0.17737
##                                                                      Std. Error
## bup600.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0    0.01671
## bup620.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0    0.01671
## bup640.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0    0.01671
## bup660.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0    0.01671
## bup680.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0    0.01671
## bup620.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0    0.01671
## bup640.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0    0.01671
## bup660.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0    0.01671
## bup680.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0    0.01671
## bup640.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0    0.01671
## bup660.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0    0.01671
## bup680.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0    0.01671
## bup660.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0    0.01671
## bup680.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0    0.01671
## bup680.leaf.vs.flower_twilight - bup660.leaf.vs.flower_twilight == 0    0.01671
##                                                                      z value
## bup600.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  20.227
## bup620.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  40.561
## bup640.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  42.476
## bup660.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  28.763
## bup680.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  18.148
## bup620.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0  20.334
## bup640.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0  22.249
## bup660.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0   8.536
## bup680.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0  -2.079
## bup640.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0   1.915
## bup660.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0 -11.798
## bup680.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0 -22.413
## bup660.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0 -13.712
## bup680.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0 -24.327
## bup680.leaf.vs.flower_twilight - bup660.leaf.vs.flower_twilight == 0 -10.615
##                                                                      Pr(&gt;|z|)
## bup600.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup620.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup640.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup660.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup680.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup620.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup640.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup660.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup680.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0    0.565
## bup640.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0    0.833
## bup660.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup680.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup660.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup680.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup680.leaf.vs.flower_twilight - bup660.leaf.vs.flower_twilight == 0   &lt;2e-16
##                                                                         
## bup600.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0 ***
## bup620.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0 ***
## bup640.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0 ***
## bup660.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0 ***
## bup680.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0 ***
## bup620.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0 ***
## bup640.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0 ***
## bup660.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0 ***
## bup680.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0    
## bup640.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0    
## bup660.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0 ***
## bup680.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0 ***
## bup660.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0 ***
## bup680.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0 ***
## bup680.leaf.vs.flower_twilight - bup660.leaf.vs.flower_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
</div>
<div id="leaf-vs-beetle-1" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Leaf vs Beetle</strong></h4>
<div id="daylight-4" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.leaf.vs.beetle_d65.model2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.leaf.vs.beetle</strong></td>
<td align="center">6680</td>
<td align="center">5</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-8" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat1_d65.model2[,<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>)], <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_d65.model2, <span class="dt">y=</span>VislistB_d65.model2, <span class="dt">fill=</span>leaf.vs.beetle)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_d65.model2, VislistB_d65.model2, <span class="dt">label =</span> <span class="kw">round</span>(leaf.vs.beetle, <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
<div id="original-model-output-8" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.leaf.vs.beetle_d65.model2</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.leaf.vs.beetle + (1 | patch2) + (1 | 
##     patch1), data = compare.leaf.vs.beetle.model2, REML = F)
## 
## Linear Hypotheses:
##                                                    Estimate Std. Error
## bup600.leaf.vs.beetle - bup580.leaf.vs.beetle == 0  0.39775    0.02123
## bup620.leaf.vs.beetle - bup580.leaf.vs.beetle == 0  0.78833    0.02123
## bup640.leaf.vs.beetle - bup580.leaf.vs.beetle == 0  1.07273    0.02123
## bup660.leaf.vs.beetle - bup580.leaf.vs.beetle == 0  1.25623    0.02123
## bup680.leaf.vs.beetle - bup580.leaf.vs.beetle == 0  1.45229    0.02123
## bup620.leaf.vs.beetle - bup600.leaf.vs.beetle == 0  0.39057    0.02123
## bup640.leaf.vs.beetle - bup600.leaf.vs.beetle == 0  0.67498    0.02123
## bup660.leaf.vs.beetle - bup600.leaf.vs.beetle == 0  0.85848    0.02123
## bup680.leaf.vs.beetle - bup600.leaf.vs.beetle == 0  1.05454    0.02123
## bup640.leaf.vs.beetle - bup620.leaf.vs.beetle == 0  0.28440    0.02123
## bup660.leaf.vs.beetle - bup620.leaf.vs.beetle == 0  0.46790    0.02123
## bup680.leaf.vs.beetle - bup620.leaf.vs.beetle == 0  0.66397    0.02123
## bup660.leaf.vs.beetle - bup640.leaf.vs.beetle == 0  0.18350    0.02123
## bup680.leaf.vs.beetle - bup640.leaf.vs.beetle == 0  0.37956    0.02123
## bup680.leaf.vs.beetle - bup660.leaf.vs.beetle == 0  0.19606    0.02123
##                                                    z value Pr(&gt;|z|)    
## bup600.leaf.vs.beetle - bup580.leaf.vs.beetle == 0  18.737   &lt;2e-16 ***
## bup620.leaf.vs.beetle - bup580.leaf.vs.beetle == 0  37.135   &lt;2e-16 ***
## bup640.leaf.vs.beetle - bup580.leaf.vs.beetle == 0  50.532   &lt;2e-16 ***
## bup660.leaf.vs.beetle - bup580.leaf.vs.beetle == 0  59.176   &lt;2e-16 ***
## bup680.leaf.vs.beetle - bup580.leaf.vs.beetle == 0  68.412   &lt;2e-16 ***
## bup620.leaf.vs.beetle - bup600.leaf.vs.beetle == 0  18.398   &lt;2e-16 ***
## bup640.leaf.vs.beetle - bup600.leaf.vs.beetle == 0  31.796   &lt;2e-16 ***
## bup660.leaf.vs.beetle - bup600.leaf.vs.beetle == 0  40.440   &lt;2e-16 ***
## bup680.leaf.vs.beetle - bup600.leaf.vs.beetle == 0  49.675   &lt;2e-16 ***
## bup640.leaf.vs.beetle - bup620.leaf.vs.beetle == 0  13.397   &lt;2e-16 ***
## bup660.leaf.vs.beetle - bup620.leaf.vs.beetle == 0  22.041   &lt;2e-16 ***
## bup680.leaf.vs.beetle - bup620.leaf.vs.beetle == 0  31.277   &lt;2e-16 ***
## bup660.leaf.vs.beetle - bup640.leaf.vs.beetle == 0   8.644   &lt;2e-16 ***
## bup680.leaf.vs.beetle - bup640.leaf.vs.beetle == 0  17.880   &lt;2e-16 ***
## bup680.leaf.vs.beetle - bup660.leaf.vs.beetle == 0   9.236   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-8" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.leaf.vs.beetle_twilight.model2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:75%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.leaf.vs.beetle</strong></td>
<td align="center">9992</td>
<td align="center">5</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-9" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat1_twilight.model2[,<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>)], <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.model2, <span class="dt">y=</span>VislistB_twilight.model2, <span class="dt">fill=</span>leaf.vs.beetle)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.model2, VislistB_twilight.model2, <span class="dt">label =</span> <span class="kw">round</span>(leaf.vs.beetle, <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
</div>
<div id="original-model-output-9" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.leaf.vs.beetle_twilight.model2</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.leaf.vs.beetle + (1 | patch2) + (1 | 
##     patch1), data = compare.leaf.vs.beetle_twilight.model2, REML = F)
## 
## Linear Hypotheses:
##                                                                      Estimate
## bup600.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0  0.51006
## bup620.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0  1.00162
## bup640.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0  1.34108
## bup660.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0  1.57985
## bup680.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0  1.85649
## bup620.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0  0.49156
## bup640.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0  0.83103
## bup660.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0  1.06979
## bup680.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0  1.34643
## bup640.leaf.vs.beetle_twilight - bup620.leaf.vs.beetle_twilight == 0  0.33946
## bup660.leaf.vs.beetle_twilight - bup620.leaf.vs.beetle_twilight == 0  0.57823
## bup680.leaf.vs.beetle_twilight - bup620.leaf.vs.beetle_twilight == 0  0.85487
## bup660.leaf.vs.beetle_twilight - bup640.leaf.vs.beetle_twilight == 0  0.23876
## bup680.leaf.vs.beetle_twilight - bup640.leaf.vs.beetle_twilight == 0  0.51540
## bup680.leaf.vs.beetle_twilight - bup660.leaf.vs.beetle_twilight == 0  0.27664
##                                                                      Std. Error
## bup600.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0    0.02197
## bup620.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0    0.02197
## bup640.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0    0.02197
## bup660.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0    0.02197
## bup680.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0    0.02197
## bup620.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0    0.02197
## bup640.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0    0.02197
## bup660.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0    0.02197
## bup680.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0    0.02197
## bup640.leaf.vs.beetle_twilight - bup620.leaf.vs.beetle_twilight == 0    0.02197
## bup660.leaf.vs.beetle_twilight - bup620.leaf.vs.beetle_twilight == 0    0.02197
## bup680.leaf.vs.beetle_twilight - bup620.leaf.vs.beetle_twilight == 0    0.02197
## bup660.leaf.vs.beetle_twilight - bup640.leaf.vs.beetle_twilight == 0    0.02197
## bup680.leaf.vs.beetle_twilight - bup640.leaf.vs.beetle_twilight == 0    0.02197
## bup680.leaf.vs.beetle_twilight - bup660.leaf.vs.beetle_twilight == 0    0.02197
##                                                                      z value
## bup600.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0   23.21
## bup620.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0   45.58
## bup640.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0   61.03
## bup660.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0   71.90
## bup680.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0   84.49
## bup620.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0   22.37
## bup640.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0   37.82
## bup660.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0   48.69
## bup680.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0   61.27
## bup640.leaf.vs.beetle_twilight - bup620.leaf.vs.beetle_twilight == 0   15.45
## bup660.leaf.vs.beetle_twilight - bup620.leaf.vs.beetle_twilight == 0   26.32
## bup680.leaf.vs.beetle_twilight - bup620.leaf.vs.beetle_twilight == 0   38.90
## bup660.leaf.vs.beetle_twilight - bup640.leaf.vs.beetle_twilight == 0   10.87
## bup680.leaf.vs.beetle_twilight - bup640.leaf.vs.beetle_twilight == 0   23.46
## bup680.leaf.vs.beetle_twilight - bup660.leaf.vs.beetle_twilight == 0   12.59
##                                                                      Pr(&gt;|z|)
## bup600.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0   &lt;2e-16
## bup620.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0   &lt;2e-16
## bup640.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0   &lt;2e-16
## bup660.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0   &lt;2e-16
## bup680.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0   &lt;2e-16
## bup620.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0   &lt;2e-16
## bup640.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0   &lt;2e-16
## bup660.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0   &lt;2e-16
## bup680.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0   &lt;2e-16
## bup640.leaf.vs.beetle_twilight - bup620.leaf.vs.beetle_twilight == 0   &lt;2e-16
## bup660.leaf.vs.beetle_twilight - bup620.leaf.vs.beetle_twilight == 0   &lt;2e-16
## bup680.leaf.vs.beetle_twilight - bup620.leaf.vs.beetle_twilight == 0   &lt;2e-16
## bup660.leaf.vs.beetle_twilight - bup640.leaf.vs.beetle_twilight == 0   &lt;2e-16
## bup680.leaf.vs.beetle_twilight - bup640.leaf.vs.beetle_twilight == 0   &lt;2e-16
## bup680.leaf.vs.beetle_twilight - bup660.leaf.vs.beetle_twilight == 0   &lt;2e-16
##                                                                         
## bup600.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0 ***
## bup620.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0 ***
## bup640.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0 ***
## bup660.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0 ***
## bup680.leaf.vs.beetle_twilight - bup580.leaf.vs.beetle_twilight == 0 ***
## bup620.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0 ***
## bup640.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0 ***
## bup660.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0 ***
## bup680.leaf.vs.beetle_twilight - bup600.leaf.vs.beetle_twilight == 0 ***
## bup640.leaf.vs.beetle_twilight - bup620.leaf.vs.beetle_twilight == 0 ***
## bup660.leaf.vs.beetle_twilight - bup620.leaf.vs.beetle_twilight == 0 ***
## bup680.leaf.vs.beetle_twilight - bup620.leaf.vs.beetle_twilight == 0 ***
## bup660.leaf.vs.beetle_twilight - bup640.leaf.vs.beetle_twilight == 0 ***
## bup680.leaf.vs.beetle_twilight - bup640.leaf.vs.beetle_twilight == 0 ***
## bup680.leaf.vs.beetle_twilight - bup660.leaf.vs.beetle_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
</div>
<div id="beetle-vs-flower-1" class="section level4 tabset tabset-fade tabset-pills">
<h4><strong>Beetle vs Flower</strong></h4>
<div id="daylight-5" class="section level5 tabset tabset-fade tabset-pills">
<h5>Daylight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.flower.vs.beetle_twilight.model2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:78%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="43%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.flower.vs.beetle</strong></td>
<td align="center">4750</td>
<td align="center">5</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-10" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat1_twilight.model2[,<span class="dv">3</span><span class="op">:</span><span class="dv">5</span>,], <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.model2, <span class="dt">y=</span>VislistB_twilight.model2, <span class="dt">fill=</span>flower.vs.beetle)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.model2, VislistB_twilight.model2, <span class="dt">label =</span> <span class="kw">round</span>(flower.vs.beetle, <span class="dv">2</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour </span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
</div>
<div id="original-model-output-10" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.flower.vs.beetle_twilight.model2</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.flower.vs.beetle + (1 | patch2) + 
##     (1 | patch1), data = compare.flower.vs.beetle_twilight.model2, 
##     REML = F)
## 
## Linear Hypotheses:
##                                                                          Estimate
## bup600.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0  0.30286
## bup620.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0  0.69141
## bup640.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0  1.07424
## bup660.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0  1.38676
## bup680.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0  1.61180
## bup620.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0  0.38855
## bup640.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0  0.77138
## bup660.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0  1.08390
## bup680.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0  1.30894
## bup640.flower.vs.beetle_twilight - bup620.flower.vs.beetle_twilight == 0  0.38282
## bup660.flower.vs.beetle_twilight - bup620.flower.vs.beetle_twilight == 0  0.69535
## bup680.flower.vs.beetle_twilight - bup620.flower.vs.beetle_twilight == 0  0.92039
## bup660.flower.vs.beetle_twilight - bup640.flower.vs.beetle_twilight == 0  0.31252
## bup680.flower.vs.beetle_twilight - bup640.flower.vs.beetle_twilight == 0  0.53757
## bup680.flower.vs.beetle_twilight - bup660.flower.vs.beetle_twilight == 0  0.22505
##                                                                          Std. Error
## bup600.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0    0.02877
## bup620.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0    0.02877
## bup640.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0    0.02877
## bup660.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0    0.02877
## bup680.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0    0.02877
## bup620.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0    0.02877
## bup640.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0    0.02877
## bup660.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0    0.02877
## bup680.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0    0.02877
## bup640.flower.vs.beetle_twilight - bup620.flower.vs.beetle_twilight == 0    0.02877
## bup660.flower.vs.beetle_twilight - bup620.flower.vs.beetle_twilight == 0    0.02877
## bup680.flower.vs.beetle_twilight - bup620.flower.vs.beetle_twilight == 0    0.02877
## bup660.flower.vs.beetle_twilight - bup640.flower.vs.beetle_twilight == 0    0.02877
## bup680.flower.vs.beetle_twilight - bup640.flower.vs.beetle_twilight == 0    0.02877
## bup680.flower.vs.beetle_twilight - bup660.flower.vs.beetle_twilight == 0    0.02877
##                                                                          z value
## bup600.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0  10.528
## bup620.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0  24.034
## bup640.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0  37.342
## bup660.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0  48.206
## bup680.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0  56.029
## bup620.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0  13.507
## bup640.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0  26.814
## bup660.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0  37.678
## bup680.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0  45.501
## bup640.flower.vs.beetle_twilight - bup620.flower.vs.beetle_twilight == 0  13.308
## bup660.flower.vs.beetle_twilight - bup620.flower.vs.beetle_twilight == 0  24.171
## bup680.flower.vs.beetle_twilight - bup620.flower.vs.beetle_twilight == 0  31.994
## bup660.flower.vs.beetle_twilight - bup640.flower.vs.beetle_twilight == 0  10.864
## bup680.flower.vs.beetle_twilight - bup640.flower.vs.beetle_twilight == 0  18.687
## bup680.flower.vs.beetle_twilight - bup660.flower.vs.beetle_twilight == 0   7.823
##                                                                          Pr(&gt;|z|)
## bup600.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0  &lt; 2e-16
## bup620.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0  &lt; 2e-16
## bup640.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0  &lt; 2e-16
## bup660.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0  &lt; 2e-16
## bup680.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0  &lt; 2e-16
## bup620.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0  &lt; 2e-16
## bup640.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0  &lt; 2e-16
## bup660.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0  &lt; 2e-16
## bup680.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0  &lt; 2e-16
## bup640.flower.vs.beetle_twilight - bup620.flower.vs.beetle_twilight == 0  &lt; 2e-16
## bup660.flower.vs.beetle_twilight - bup620.flower.vs.beetle_twilight == 0  &lt; 2e-16
## bup680.flower.vs.beetle_twilight - bup620.flower.vs.beetle_twilight == 0  &lt; 2e-16
## bup660.flower.vs.beetle_twilight - bup640.flower.vs.beetle_twilight == 0  &lt; 2e-16
## bup680.flower.vs.beetle_twilight - bup640.flower.vs.beetle_twilight == 0  &lt; 2e-16
## bup680.flower.vs.beetle_twilight - bup660.flower.vs.beetle_twilight == 0 7.66e-14
##                                                                             
## bup600.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0 ***
## bup620.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0 ***
## bup640.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0 ***
## bup660.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0 ***
## bup680.flower.vs.beetle_twilight - bup580.flower.vs.beetle_twilight == 0 ***
## bup620.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0 ***
## bup640.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0 ***
## bup660.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0 ***
## bup680.flower.vs.beetle_twilight - bup600.flower.vs.beetle_twilight == 0 ***
## bup640.flower.vs.beetle_twilight - bup620.flower.vs.beetle_twilight == 0 ***
## bup660.flower.vs.beetle_twilight - bup620.flower.vs.beetle_twilight == 0 ***
## bup680.flower.vs.beetle_twilight - bup620.flower.vs.beetle_twilight == 0 ***
## bup660.flower.vs.beetle_twilight - bup640.flower.vs.beetle_twilight == 0 ***
## bup680.flower.vs.beetle_twilight - bup640.flower.vs.beetle_twilight == 0 ***
## bup680.flower.vs.beetle_twilight - bup660.flower.vs.beetle_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
<div id="twilight-9" class="section level5 tabset tabset-fade tabset-pills">
<h5>Twilight</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(m.flower.vs.beetle_twilight.model2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:78%;">
<caption>Analysis of Deviance Table (Type II Wald chisquare tests)</caption>
<colgroup>
<col width="43%" />
<col width="11%" />
<col width="6%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Chisq</th>
<th align="center">Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>peak_wl.flower.vs.beetle</strong></td>
<td align="center">4750</td>
<td align="center">5</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p>Click the tabs to see the <strong>p-value summary plot</strong> or the <strong>original model output</strong></p>
<div id="pair-wise-p-values-11" class="section level6">
<h6>Pair-wise p-values</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> heat1_twilight.model2[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>)], <span class="kw">aes</span>(<span class="dt">x=</span>VislistA_twilight.model2, <span class="dt">y=</span>VislistB_twilight.model2, <span class="dt">fill=</span>leaf.vs.flower)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(VislistA_twilight.model2, VislistB_twilight.model2, <span class="dt">label =</span> <span class="kw">round</span>(leaf.vs.flower, <span class="dv">2</span>)))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">high =</span> <span class="st">&quot;#132B43&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;#56B1F7&quot;</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="co">#delete if want to reverse the colour</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
</div>
<div id="original-model-output-11" class="section level6">
<h6>Original model output</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum.leaf.vs.flower_twilight.model2</code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lmer(formula = dS ~ peak_wl.leaf.vs.flower + (1 | patch2) + (1 | 
##     patch1), data = compare.leaf.vs.flower_twilight.model2, REML = F)
## 
## Linear Hypotheses:
##                                                                      Estimate
## bup600.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  0.33799
## bup620.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  0.67777
## bup640.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  0.70976
## bup660.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  0.48063
## bup680.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  0.30326
## bup620.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0  0.33978
## bup640.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0  0.37177
## bup660.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0  0.14264
## bup680.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0 -0.03473
## bup640.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0  0.03199
## bup660.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0 -0.19714
## bup680.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0 -0.37451
## bup660.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0 -0.22913
## bup680.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0 -0.40651
## bup680.leaf.vs.flower_twilight - bup660.leaf.vs.flower_twilight == 0 -0.17737
##                                                                      Std. Error
## bup600.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0    0.01671
## bup620.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0    0.01671
## bup640.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0    0.01671
## bup660.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0    0.01671
## bup680.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0    0.01671
## bup620.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0    0.01671
## bup640.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0    0.01671
## bup660.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0    0.01671
## bup680.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0    0.01671
## bup640.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0    0.01671
## bup660.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0    0.01671
## bup680.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0    0.01671
## bup660.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0    0.01671
## bup680.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0    0.01671
## bup680.leaf.vs.flower_twilight - bup660.leaf.vs.flower_twilight == 0    0.01671
##                                                                      z value
## bup600.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  20.227
## bup620.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  40.561
## bup640.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  42.476
## bup660.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  28.763
## bup680.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0  18.148
## bup620.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0  20.334
## bup640.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0  22.249
## bup660.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0   8.536
## bup680.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0  -2.079
## bup640.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0   1.915
## bup660.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0 -11.798
## bup680.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0 -22.413
## bup660.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0 -13.712
## bup680.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0 -24.327
## bup680.leaf.vs.flower_twilight - bup660.leaf.vs.flower_twilight == 0 -10.615
##                                                                      Pr(&gt;|z|)
## bup600.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup620.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup640.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup660.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup680.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup620.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup640.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup660.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup680.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0    0.565
## bup640.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0    0.833
## bup660.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup680.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup660.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup680.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0   &lt;2e-16
## bup680.leaf.vs.flower_twilight - bup660.leaf.vs.flower_twilight == 0   &lt;2e-16
##                                                                         
## bup600.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0 ***
## bup620.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0 ***
## bup640.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0 ***
## bup660.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0 ***
## bup680.leaf.vs.flower_twilight - bup580.leaf.vs.flower_twilight == 0 ***
## bup620.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0 ***
## bup640.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0 ***
## bup660.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0 ***
## bup680.leaf.vs.flower_twilight - bup600.leaf.vs.flower_twilight == 0    
## bup640.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0    
## bup660.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0 ***
## bup680.leaf.vs.flower_twilight - bup620.leaf.vs.flower_twilight == 0 ***
## bup660.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0 ***
## bup680.leaf.vs.flower_twilight - bup640.leaf.vs.flower_twilight == 0 ***
## bup680.leaf.vs.flower_twilight - bup660.leaf.vs.flower_twilight == 0 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- bonferroni method)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="plot-the-contasts" class="section level1 tabset tabset-fade tabset-pills">
<h1>Plot the contasts</h1>
<ul>
<li>Colours are in accordence with the actual sample colouration in visible range.</li>
<li>Lines of the same colors connect the same samples</li>
</ul>
<div id="visual-model-1-2" class="section level2 tabset tabset-fade tabset-pills">
<h2>Visual model 1</h2>
<div id="daylight-6" class="section level3">
<h3>Daylight</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#import the flower color code </span>
color.code&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;data/color code list.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>) 

<span class="co">#creat a list of species name used in the spec data and </span>
name.list&lt;-<span class="kw">unique</span>(dataset.transpose<span class="op">$</span>species) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">sort</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#order it alphebatically as well</span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">species =</span> <span class="st">&quot;.&quot;</span>)<span class="co">#make it a data frame and name the column &quot;species&quot;</span>

<span class="co">#creat flower name list for visual model 1</span>
flower.colour.model1 &lt;-<span class="st"> </span>name.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(species, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower names</span>
<span class="st">  </span><span class="kw">cbind</span>(color.code <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(type, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(name)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower color codes and order it alphebatically</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#remove the redundant column</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">uncount</span>(count) <span class="co">#repeat each row for 4 times for 4 visual systems</span>

<span class="co">#creat beetle name list for visual model 1</span>
beetle.colour.model1 &lt;-<span class="st"> </span>name.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(species, <span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower names</span>
<span class="st">  </span><span class="kw">cbind</span>(color.code <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(type, <span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(name)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower color codes and order it alphebatically</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#remove the redundant column</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">uncount</span>(count) <span class="co">#repeat each row for 4 times for 4 visual systems</span>



<span class="co">#make flower vs leaf plot</span>
Vis1.lf_d65.model1&lt;-<span class="st"> </span>CvisUVSWMW..<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis1.lf_d65.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.lf&quot;</span>,<span class="dv">1</span>)
Vis2.lf_d65.model1&lt;-CvisUV..MWLW<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis2.lf_d65.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.lf&quot;</span>,<span class="dv">1</span>)
Vis3.lf_d65.model1&lt;-CvisUVSW..LW<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis3.lf_d65.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.lf&quot;</span>,<span class="dv">1</span>)
Vis4.lf_d65.model1&lt;-CvisUVSWMWLW<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis4.lf_d65.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.lf&quot;</span>,<span class="dv">1</span>)
allvis.lf_d65.model1&lt;-Vis1.lf_d65.model1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.lf_d65.model1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.lf_d65.model1) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis4.lf_d65.model1)

<span class="co">#add the mean</span>
mean.lf_d65.model1&lt;-allvis.lf_d65.model1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.lf_d65.model1<span class="op">$</span>vissys,allvis.lf_d65.model1<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.lf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

<span class="co">#plot the mean</span>
<span class="kw">names</span>(mean.lf_d65.model1)[<span class="kw">names</span>(mean.lf_d65.model1) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span> 
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.lf_d65.model1&lt;-mean.lf_d65.model1[<span class="kw">order</span>(mean.lf_d65.model1<span class="op">$</span>flowerID),] 
<span class="co">#make the data frame order by flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

<span class="co">#combine the colour code list to the mean.bf for ploting</span>
mean.lf_d65.model1<span class="op">$</span>match.name&lt;-flower.colour.model1<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.lf_d65.model1<span class="op">$</span>colour&lt;-flower.colour.model1<span class="op">$</span>colour


lf_d65.model1&lt;-<span class="kw">ggplot</span>(mean.lf_d65.model1, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.lf,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.lf_d65.model1<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.lf_d65.model1<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle=</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lf&quot;</span>, <span class="st">&quot;Vis2.lf&quot;</span>, <span class="st">&quot;Vis3.lf&quot;</span>,<span class="st">&quot;Vis4.lf&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis USM&quot;</span>, <span class="st">&quot;Vis UML&quot;</span>, <span class="st">&quot;Vis USL&quot;</span>,<span class="st">&quot;Vis USML&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_d65.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.lf_d65.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_d65.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.lf_d65.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_d65.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.lf_d65.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_d65.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.lf_d65.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Leaf vs. Flower&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lf&quot;</span>, <span class="st">&quot;Vis2.lf&quot;</span>, <span class="st">&quot;Vis3.lf&quot;</span>,<span class="st">&quot;Vis4.lf&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;c&quot;</span>)) <span class="co">#add stitistical info</span>



<span class="co">#make beetle vs leaf plot</span>
Vis1.lb_d65.model1&lt;-<span class="st"> </span>CvisUVSWMW..<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis1.lb_d65.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.lb&quot;</span>,<span class="dv">1</span>)
Vis2.lb_d65.model1&lt;-CvisUV..MWLW<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis2.lb_d65.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.lb&quot;</span>,<span class="dv">1</span>)
Vis3.lb_d65.model1&lt;-CvisUVSW..LW<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis3.lb_d65.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.lb&quot;</span>,<span class="dv">1</span>)
Vis4.lb_d65.model1&lt;-CvisUVSWMWLW<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis4.lb_d65.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.lb&quot;</span>,<span class="dv">1</span>)
allvis.lb_d65.model1&lt;-Vis1.lb_d65.model1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.lb_d65.model1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.lb_d65.model1) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis4.lb_d65.model1)


<span class="co">#add the mean</span>
mean.lb_d65.model1&lt;-allvis.lb_d65.model1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.lb_d65.model1<span class="op">$</span>vissys,allvis.lb_d65.model1<span class="op">$</span>patch2,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch2(beetles) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.lb=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

<span class="co">#plot the mean</span>
<span class="kw">names</span>(mean.lb_d65.model1)[<span class="kw">names</span>(mean.lb_d65.model1) <span class="op">==</span><span class="st"> &quot;patch2&quot;</span>] &lt;-<span class="st"> &quot;beetleID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.lb_d65.model1&lt;-mean.lb_d65.model1[<span class="kw">order</span>(mean.lb_d65.model1<span class="op">$</span>beetleID),]
<span class="co">#make the data frame order bt beetleID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

<span class="co">#combine the colour code list to the mean.bf for ploting</span>
mean.lb_d65.model1<span class="op">$</span>match.name&lt;-beetle.colour.model1<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.lb_d65.model1<span class="op">$</span>colour&lt;-beetle.colour.model1<span class="op">$</span>colour


lb_d65.model1&lt;-<span class="kw">ggplot</span>(mean.lb_d65.model1, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.lb,<span class="dt">group=</span>beetleID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.lb_d65.model1<span class="op">$</span>colour, <span class="dt">size=</span><span class="dv">3</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.lb_d65.model1<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), 
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle=</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lb&quot;</span>, <span class="st">&quot;Vis2.lb&quot;</span>, <span class="st">&quot;Vis3.lb&quot;</span>,<span class="st">&quot;Vis4.lb&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis USM&quot;</span>, <span class="st">&quot;Vis UML&quot;</span>, <span class="st">&quot;Vis USL&quot;</span>,<span class="st">&quot;Vis USML&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_d65.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.lb_d65.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_d65.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.lb_d65.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_d65.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.lb_d65.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_d65.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.lb_d65.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Leaf vs. Beetle&quot;</span>)<span class="op">+</span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lb&quot;</span>, <span class="st">&quot;Vis2.lb&quot;</span>, <span class="st">&quot;Vis3.lb&quot;</span>,<span class="st">&quot;Vis4.lb&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>)) <span class="co">#add stitistical info</span>


<span class="co">#make beetle vs flower plot</span>
Vis1.bf_d65.model1&lt;-<span class="st"> </span>CvisUVSWMW..<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis1.bf_d65.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.bf&quot;</span>,<span class="dv">1</span>)
Vis2.bf_d65.model1&lt;-CvisUV..MWLW<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis2.bf_d65.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.bf&quot;</span>,<span class="dv">1</span>)
Vis3.bf_d65.model1&lt;-CvisUVSW..LW<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis3.bf_d65.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.bf&quot;</span>,<span class="dv">1</span>)
Vis4.bf_d65.model1&lt;-CvisUVSWMWLW<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis4.bf_d65.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.bf&quot;</span>,<span class="dv">1</span>)
allvis.bf_d65.model1&lt;-Vis1.bf_d65.model1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.bf_d65.model1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.bf_d65.model1)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Vis4.bf_d65.model1)


<span class="co">#add the mean</span>
mean.bf_d65.model1&lt;-allvis.bf_d65.model1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bf_d65.model1<span class="op">$</span>vissys,allvis.bf_d65.model1<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#patch1(flowers</span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

<span class="co">#plot the mean</span>
<span class="kw">names</span>(mean.bf_d65.model1)[<span class="kw">names</span>(mean.bf_d65.model1) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.bf_d65.model1&lt;-mean.bf_d65.model1[<span class="kw">order</span>(mean.bf_d65.model1<span class="op">$</span>flowerID),]
<span class="co">#make the data frame order bt flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

<span class="co">#combine the colour code list to the mean.bf for ploting</span>
mean.bf_d65.model1<span class="op">$</span>match.name&lt;-flower.colour.model1<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.bf_d65.model1<span class="op">$</span>colour&lt;-flower.colour.model1<span class="op">$</span>colour

bf_d65.model1&lt;-<span class="kw">ggplot</span>(mean.bf_d65.model1, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bf,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bf_d65.model1<span class="op">$</span>colour, <span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bf_d65.model1<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>),<span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle=</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.bf&quot;</span>, <span class="st">&quot;Vis2.bf&quot;</span>, <span class="st">&quot;Vis3.bf&quot;</span>,<span class="st">&quot;Vis4.bf&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis USM&quot;</span>, <span class="st">&quot;Vis UML&quot;</span>, <span class="st">&quot;Vis USL&quot;</span>,<span class="st">&quot;Vis USML&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.bf_d65.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.bf_d65.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.bf_d65.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.bf_d65.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Flower&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.bf&quot;</span>, <span class="st">&quot;Vis2.bf&quot;</span>, <span class="st">&quot;Vis3.bf&quot;</span>,<span class="st">&quot;Vis4.bf&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;c&quot;</span>)) <span class="co">#add stitistical info</span>

<span class="co">#plot the contrasts from the 3 comparison groups together</span>
figure_d65.model1 &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(lf_d65.model1,lb_d65.model1,bf_d65.model1, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)
figure_d65.model1</code></pre></div>
<div class="figure">
<img src="index_files/figure-html/unnamed-chunk-54-1.png" alt="Contrast comparison between visual systems with different photoreceptor combinations. A dot in each visual system shows a representative contrast of a flower pattern (beetle pattern in the middle panel), which is the average of its contrast to all leaves (all beetle patterns on the right panel). Colours of the dots reflcet the visible colour of the flower (beetle patterns in the middle panel) with the lines of the same colour connecting the results between different visual systems. Black dots show the median of the representative contrast in a visual system. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Two contrasts &gt; 10 JND are from flowers that have very low UV reflectance." width="672" />
<p class="caption">
Contrast comparison between visual systems with different photoreceptor combinations. A dot in each visual system shows a representative contrast of a flower pattern (beetle pattern in the middle panel), which is the average of its contrast to all leaves (all beetle patterns on the right panel). Colours of the dots reflcet the visible colour of the flower (beetle patterns in the middle panel) with the lines of the same colour connecting the results between different visual systems. Black dots show the median of the representative contrast in a visual system. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Two contrasts &gt; 10 JND are from flowers that have very low UV reflectance.
</p>
</div>
</div>
<div id="twilight-10" class="section level3">
<h3>Twilight</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#make flower vs leaf plot</span>
Vis1.lf_twilight.model1&lt;-<span class="st"> </span>CvisUVSWMW.._twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis1.lf_twilight.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.lf&quot;</span>,<span class="dv">1</span>)
Vis2.lf_twilight.model1&lt;-CvisUV..MWLW_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis2.lf_twilight.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.lf&quot;</span>,<span class="dv">1</span>)
Vis3.lf_twilight.model1&lt;-CvisUVSW..LW_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis3.lf_twilight.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.lf&quot;</span>,<span class="dv">1</span>)
Vis4.lf_twilight.model1&lt;-CvisUVSWMWLW_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis4.lf_twilight.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.lf&quot;</span>,<span class="dv">1</span>)
allvis.lf_twilight.model1&lt;-Vis1.lf_twilight.model1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.lf_twilight.model1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.lf_twilight.model1) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis4.lf_twilight.model1)

<span class="co">#add the mean</span>
mean.lf_twilight.model1&lt;-allvis.lf_twilight.model1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.lf_twilight.model1<span class="op">$</span>vissys,allvis.lf_twilight.model1<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.lf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

<span class="co">#plot the mean</span>
<span class="kw">names</span>(mean.lf_twilight.model1)[<span class="kw">names</span>(mean.lf_twilight.model1) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span> 
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.lf_twilight.model1&lt;-mean.lf_twilight.model1[<span class="kw">order</span>(mean.lf_twilight.model1<span class="op">$</span>flowerID),] 
<span class="co">#make the data frame order by flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

<span class="co">#combine the colour code list to the mean.bf for ploting</span>
mean.lf_twilight.model1<span class="op">$</span>match.name&lt;-flower.colour.model1<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.lf_twilight.model1<span class="op">$</span>colour&lt;-flower.colour.model1<span class="op">$</span>colour


lf_twilight.model1&lt;-<span class="kw">ggplot</span>(mean.lf_twilight.model1, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.lf,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.lf_twilight.model1<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.lf_twilight.model1<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle=</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lf&quot;</span>, <span class="st">&quot;Vis2.lf&quot;</span>, <span class="st">&quot;Vis3.lf&quot;</span>,<span class="st">&quot;Vis4.lf&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis USM&quot;</span>, <span class="st">&quot;Vis UML&quot;</span>, <span class="st">&quot;Vis USL&quot;</span>,<span class="st">&quot;Vis USML&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_twilight.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.lf_twilight.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_twilight.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.lf_twilight.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_twilight.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.lf_twilight.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_twilight.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.lf_twilight.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Leaf vs. Flower&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lf&quot;</span>, <span class="st">&quot;Vis2.lf&quot;</span>, <span class="st">&quot;Vis3.lf&quot;</span>,<span class="st">&quot;Vis4.lf&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;c&quot;</span>)) <span class="co">#add stitistical info</span>


<span class="co">#make beetle vs leaf plot</span>
Vis1.lb_twilight.model1&lt;-<span class="st"> </span>CvisUVSWMW.._twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis1.lb_twilight.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.lb&quot;</span>,<span class="dv">1</span>)
Vis2.lb_twilight.model1&lt;-CvisUV..MWLW_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis2.lb_twilight.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.lb&quot;</span>,<span class="dv">1</span>)
Vis3.lb_twilight.model1&lt;-CvisUVSW..LW_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis3.lb_twilight.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.lb&quot;</span>,<span class="dv">1</span>)
Vis4.lb_twilight.model1&lt;-CvisUVSWMWLW_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis4.lb_twilight.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.lb&quot;</span>,<span class="dv">1</span>)
allvis.lb_twilight.model1&lt;-Vis1.lb_twilight.model1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.lb_twilight.model1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.lb_twilight.model1) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis4.lb_twilight.model1)


<span class="co">#add the mean</span>
mean.lb_twilight.model1&lt;-allvis.lb_twilight.model1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.lb_twilight.model1<span class="op">$</span>vissys,allvis.lb_twilight.model1<span class="op">$</span>patch2,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch2(beetles) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.lb=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

<span class="co">#plot the mean</span>
<span class="kw">names</span>(mean.lb_twilight.model1)[<span class="kw">names</span>(mean.lb_twilight.model1) <span class="op">==</span><span class="st"> &quot;patch2&quot;</span>] &lt;-<span class="st"> &quot;beetleID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.lb_twilight.model1&lt;-mean.lb_twilight.model1[<span class="kw">order</span>(mean.lb_twilight.model1<span class="op">$</span>beetleID),]
<span class="co">#make the data frame order bt beetleID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

<span class="co">#combine the colour code list to the mean.bf for ploting</span>
mean.lb_twilight.model1<span class="op">$</span>match.name&lt;-beetle.colour.model1<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.lb_twilight.model1<span class="op">$</span>colour&lt;-beetle.colour.model1<span class="op">$</span>colour


lb_twilight.model1&lt;-<span class="kw">ggplot</span>(mean.lb_twilight.model1, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.lb,<span class="dt">group=</span>beetleID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.lb_twilight.model1<span class="op">$</span>colour, <span class="dt">size=</span><span class="dv">3</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.lb_twilight.model1<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), 
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle=</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lb&quot;</span>, <span class="st">&quot;Vis2.lb&quot;</span>, <span class="st">&quot;Vis3.lb&quot;</span>,<span class="st">&quot;Vis4.lb&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis USM&quot;</span>, <span class="st">&quot;Vis UML&quot;</span>, <span class="st">&quot;Vis USL&quot;</span>,<span class="st">&quot;Vis USML&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_twilight.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.lb_twilight.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_twilight.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.lb_twilight.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_twilight.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.lb_twilight.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_twilight.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.lb_twilight.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Leaf vs. Beetle&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lb&quot;</span>, <span class="st">&quot;Vis2.lb&quot;</span>, <span class="st">&quot;Vis3.lb&quot;</span>,<span class="st">&quot;Vis4.lb&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>)) <span class="co">#add stitistical info</span>





<span class="co">#make beetle vs flower plot</span>
Vis1.bf_twilight.model1&lt;-<span class="st"> </span>CvisUVSWMW.._twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis1.bf_twilight.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.bf&quot;</span>,<span class="dv">1</span>)
Vis2.bf_twilight.model1&lt;-CvisUV..MWLW_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis2.bf_twilight.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.bf&quot;</span>,<span class="dv">1</span>)
Vis3.bf_twilight.model1&lt;-CvisUVSW..LW_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis3.bf_twilight.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.bf&quot;</span>,<span class="dv">1</span>)
Vis4.bf_twilight.model1&lt;-CvisUVSWMWLW_twilight<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis4.bf_twilight.model1<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.bf&quot;</span>,<span class="dv">1</span>)
allvis.bf_twilight.model1&lt;-Vis1.bf_twilight.model1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.bf_twilight.model1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.bf_twilight.model1) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis4.bf_twilight.model1)


<span class="co">#add the mean</span>
mean.bf_twilight.model1&lt;-allvis.bf_twilight.model1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bf_twilight.model1<span class="op">$</span>vissys,allvis.bf_twilight.model1<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#patch1(flowers</span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

<span class="co">#plot the mean</span>
<span class="kw">names</span>(mean.bf_twilight.model1)[<span class="kw">names</span>(mean.bf_twilight.model1) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.bf_twilight.model1&lt;-mean.bf_twilight.model1[<span class="kw">order</span>(mean.bf_twilight.model1<span class="op">$</span>flowerID),]
<span class="co">#make the data frame order bt flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

<span class="co">#combine the colour code list to the mean.bf for ploting</span>
mean.bf_twilight.model1<span class="op">$</span>match.name&lt;-flower.colour.model1<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.bf_twilight.model1<span class="op">$</span>colour&lt;-flower.colour.model1<span class="op">$</span>colour

bf_twilight.model1&lt;-<span class="kw">ggplot</span>(mean.bf_twilight.model1, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bf,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bf_twilight.model1<span class="op">$</span>colour, <span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bf_twilight.model1<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>),<span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle=</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.bf&quot;</span>, <span class="st">&quot;Vis2.bf&quot;</span>, <span class="st">&quot;Vis3.bf&quot;</span>,<span class="st">&quot;Vis4.bf&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis USM&quot;</span>, <span class="st">&quot;Vis UML&quot;</span>, <span class="st">&quot;Vis USL&quot;</span>,<span class="st">&quot;Vis USML&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.bf_twilight.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.bf_twilight.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.bf_twilight.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.model1, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.bf_twilight.model1<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Flower&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.bf&quot;</span>, <span class="st">&quot;Vis2.bf&quot;</span>, <span class="st">&quot;Vis3.bf&quot;</span>,<span class="st">&quot;Vis4.bf&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;c&quot;</span>)) <span class="co">#add stitistical info</span>



<span class="co">#plot the contrasts from the 3 comparison groups together</span>
figure_twilight.model1 &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(lf_twilight.model1,lb_twilight.model1,bf_twilight.model1, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)
figure_twilight.model1</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
</div>
<div id="visual-model-2-2" class="section level2 tabset tabset-fade tabset-pills">
<h2>Visual model 2</h2>
<div id="daylight-7" class="section level3">
<h3>Daylight</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#creat flower name list for visual model 2</span>
flower.colour.model2 &lt;-<span class="st"> </span>name.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(species, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower names</span>
<span class="st">  </span><span class="kw">cbind</span>(color.code <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(type, <span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(name)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower color codes and order it alphebatically</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#remove the redundant column</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count =</span> <span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">uncount</span>(count) <span class="co">#repeat each row for 4 times for 6 visual systems</span>

<span class="co">#creat beetle name list for visual model 2</span>
beetle.colour.model2 &lt;-<span class="st"> </span>name.list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(species, <span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower names</span>
<span class="st">  </span><span class="kw">cbind</span>(color.code <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(type, <span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(name)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select flower color codes and order it alphebatically</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#remove the redundant column</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count =</span> <span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">uncount</span>(count) <span class="co">#repeat each row for 4 times for 6 visual systems</span>


<span class="co">#flower vs leaf</span>
Vis1.lf_d65.model2&lt;-<span class="st"> </span>Cbuprest580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis1.lf_d65.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.lf&quot;</span>,<span class="dv">1</span>)
Vis2.lf_d65.model2&lt;-Cbuprest600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis2.lf_d65.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.lf&quot;</span>,<span class="dv">1</span>)
Vis3.lf_d65.model2&lt;-Cbuprest620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis3.lf_d65.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.lf&quot;</span>,<span class="dv">1</span>)
Vis4.lf_d65.model2&lt;-Cbuprest640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis4.lf_d65.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.lf&quot;</span>,<span class="dv">1</span>)
Vis5.lf_d65.model2&lt;-Cbuprest660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis5.lf_d65.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis5.lf&quot;</span>,<span class="dv">1</span>)
Vis6.lf_d65.model2&lt;-Cbuprest680<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis6.lf_d65.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis6.lf&quot;</span>,<span class="dv">1</span>)

allvis.lf_d65.model2&lt;-Vis1.lf_d65.model2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.lf_d65.model2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.lf_d65.model2) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Vis4.lf_d65.model2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis5.lf_d65.model2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis6.lf_d65.model2)

<span class="co">#add the mean</span>
mean.lf_d65.model2&lt;-allvis.lf_d65.model2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.lf_d65.model2<span class="op">$</span>vissys,allvis.lf_d65.model2<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.lf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

<span class="co">#plot the mean</span>
<span class="kw">names</span>(mean.lf_d65.model2)[<span class="kw">names</span>(mean.lf_d65.model2) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span> 
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.lf_d65.model2&lt;-mean.lf_d65.model2[<span class="kw">order</span>(mean.lf_d65.model2<span class="op">$</span>flowerID),] 
<span class="co">#make the data frame order by flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

<span class="co">#combine the colour code list to the mean.bf for ploting</span>
mean.lf_d65.model2<span class="op">$</span>match.name&lt;-flower.colour.model2<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.lf_d65.model2<span class="op">$</span>colour&lt;-flower.colour.model2<span class="op">$</span>colour

lf_d65.model2&lt;-<span class="kw">ggplot</span>(mean.lf_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.lf,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.lf_d65.model2<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.lf_d65.model2<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lf&quot;</span>, <span class="st">&quot;Vis2.lf&quot;</span>, <span class="st">&quot;Vis3.lf&quot;</span>,<span class="st">&quot;Vis4.lf&quot;</span>,<span class="st">&quot;Vis5.lf&quot;</span>,<span class="st">&quot;Vis6.lf&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 680&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.lf_d65.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.lf_d65.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.lf_d65.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.lf_d65.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis5.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis5.lf_d65.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis6.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis6.lf_d65.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Leaf vs. Flower&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lf&quot;</span>, <span class="st">&quot;Vis2.lf&quot;</span>, <span class="st">&quot;Vis3.lf&quot;</span>,<span class="st">&quot;Vis4.lf&quot;</span>,<span class="st">&quot;Vis5.lf&quot;</span>,<span class="st">&quot;Vis6.lf&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>,<span class="st">&quot;b&quot;</span>)) <span class="co">#add stitistical info</span>


<span class="co">#beetle vs leaf</span>
Vis1.lb_d65.model2&lt;-<span class="st"> </span>Cbuprest580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis1.lb_d65.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.lb&quot;</span>,<span class="dv">1</span>)
Vis2.lb_d65.model2&lt;-Cbuprest600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis2.lb_d65.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.lb&quot;</span>,<span class="dv">1</span>)
Vis3.lb_d65.model2&lt;-Cbuprest620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis3.lb_d65.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.lb&quot;</span>,<span class="dv">1</span>)
Vis4.lb_d65.model2&lt;-Cbuprest640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis4.lb_d65.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.lb&quot;</span>,<span class="dv">1</span>)
Vis5.lb_d65.model2&lt;-Cbuprest660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis5.lb_d65.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis5.lb&quot;</span>,<span class="dv">1</span>)
Vis6.lb_d65.model2&lt;-Cbuprest680<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis6.lb_d65.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis6.lb&quot;</span>,<span class="dv">1</span>)

allvis.lb_d65.model2&lt;-Vis1.lb_d65.model2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.lb_d65.model2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.lb_d65.model2) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Vis4.lb_d65.model2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis5.lb_d65.model2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis6.lb_d65.model2)


<span class="co">#add the mean</span>
mean.lb_d65.model2&lt;-allvis.lb_d65.model2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.lb_d65.model2<span class="op">$</span>vissys,allvis.lb_d65.model2<span class="op">$</span>patch2,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch2(beetles) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.lb=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

<span class="co">#plot the mean</span>
<span class="kw">names</span>(mean.lb_d65.model2)[<span class="kw">names</span>(mean.lb_d65.model2) <span class="op">==</span><span class="st"> &quot;patch2&quot;</span>] &lt;-<span class="st"> &quot;beetleID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.lb_d65.model2&lt;-mean.lb_d65.model2[<span class="kw">order</span>(mean.lb_d65.model2<span class="op">$</span>beetleID),]
<span class="co">#make the data frame order bt beetleID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

<span class="co">#combine the colour code list to the mean.bf for ploting</span>
mean.lb_d65.model2<span class="op">$</span>match.name&lt;-beetle.colour.model2<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.lb_d65.model2<span class="op">$</span>colour&lt;-beetle.colour.model2<span class="op">$</span>colour


lb_d65.model2&lt;-<span class="kw">ggplot</span>(mean.lb_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.lb,<span class="dt">group=</span>beetleID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.lb_d65.model2<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.lb_d65.model2<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lb&quot;</span>, <span class="st">&quot;Vis2.lb&quot;</span>, <span class="st">&quot;Vis3.lb&quot;</span>,<span class="st">&quot;Vis4.lb&quot;</span>,<span class="st">&quot;Vis5.lb&quot;</span>,<span class="st">&quot;Vis6.lb&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 680&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.lb_d65.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.lb_d65.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.lb_d65.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.lb_d65.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis5.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis5.lb_d65.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis6.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis6.lb_d65.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Leaf vs. Beetle&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lb&quot;</span>, <span class="st">&quot;Vis2.lb&quot;</span>, <span class="st">&quot;Vis3.lb&quot;</span>,<span class="st">&quot;Vis4.lb&quot;</span>,<span class="st">&quot;Vis5.lb&quot;</span>,<span class="st">&quot;Vis6.lb&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>,<span class="st">&quot;f&quot;</span>)) <span class="co">#add stitistical info</span>


<span class="co">#beetle vs leaf</span>
Vis1.bf_d65.model2&lt;-<span class="st"> </span>Cbuprest580<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis1.bf_d65.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.bf&quot;</span>,<span class="dv">1</span>)
Vis2.bf_d65.model2&lt;-Cbuprest600<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis2.bf_d65.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.bf&quot;</span>,<span class="dv">1</span>)
Vis3.bf_d65.model2&lt;-Cbuprest620<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis3.bf_d65.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.bf&quot;</span>,<span class="dv">1</span>)
Vis4.bf_d65.model2&lt;-Cbuprest640<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis4.bf_d65.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.bf&quot;</span>,<span class="dv">1</span>)
Vis5.bf_d65.model2&lt;-Cbuprest660<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis5.bf_d65.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis5.bf&quot;</span>,<span class="dv">1</span>)
Vis6.bf_d65.model2&lt;-Cbuprest680<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis6.bf_d65.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis6.bf&quot;</span>,<span class="dv">1</span>)

allvis.bf_d65.model2&lt;-Vis1.bf_d65.model2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.bf_d65.model2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.bf_d65.model2) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Vis4.bf_d65.model2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis5.bf_d65.model2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis6.bf_d65.model2)



<span class="co">#add the mean</span>
mean.bf_d65.model2&lt;-allvis.bf_d65.model2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bf_d65.model2<span class="op">$</span>vissys,allvis.bf_d65.model2<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#patch1(flowers</span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>


<span class="co">#plot the mean dS</span>
<span class="kw">names</span>(mean.bf_d65.model2)[<span class="kw">names</span>(mean.bf_d65.model2) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.bf_d65.model2&lt;-mean.bf_d65.model2[<span class="kw">order</span>(mean.bf_d65.model2<span class="op">$</span>flowerID),]
<span class="co">#make the data frame order bt flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

<span class="co">#combine the colour code list to the mean.bf for ploting</span>
mean.bf_d65.model2<span class="op">$</span>match.name&lt;-flower.colour.model2<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.bf_d65.model2<span class="op">$</span>colour&lt;-flower.colour.model2<span class="op">$</span>colour

bf_d65.model2&lt;-<span class="kw">ggplot</span>(mean.bf_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bf,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bf_d65.model2<span class="op">$</span>colour, <span class="dt">size=</span><span class="dv">3</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bf_d65.model2<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.bf&quot;</span>, <span class="st">&quot;Vis2.bf&quot;</span>, <span class="st">&quot;Vis3.bf&quot;</span>,<span class="st">&quot;Vis4.bf&quot;</span>,<span class="st">&quot;Vis5.bf&quot;</span>,<span class="st">&quot;Vis6.bf&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 680&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.bf_d65.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.bf_d65.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.bf_d65.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.bf_d65.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis5.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis5.bf_d65.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_d65.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis6.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis6.bf_d65.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Flower&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.bf&quot;</span>, <span class="st">&quot;Vis2.bf&quot;</span>, <span class="st">&quot;Vis3.bf&quot;</span>,<span class="st">&quot;Vis4.bf&quot;</span>,<span class="st">&quot;Vis5.bf&quot;</span>,<span class="st">&quot;Vis6.bf&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>,<span class="st">&quot;f&quot;</span>)) <span class="co">#add stitistical info</span>


figure_d65.model2 &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(lf_d65.model2,lb_d65.model2,bf_d65.model2, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)
figure_d65.model2</code></pre></div>
<div class="figure">
<img src="index_files/figure-html/unnamed-chunk-56-1.png" alt="Contrast comparison between visual systems with the LWS photoreceptor peaking at different wavelengths. A dot in each visual system shows a representative contrast of a flower pattern (beetle pattern in the middle panel), which is the average of its contrast to all leaves (all beetle patterns on the right panel). Colours of the dots reflect the visible colour of the flower (beetle patterns in the middle panel) with the lines of the same colour connecting the results between different visual systems. Black dots show the median of the representative contrast in a visual system. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Two contrasts &gt; 10 JND are from flowers that have very low UV reflectance." width="672" />
<p class="caption">
Contrast comparison between visual systems with the LWS photoreceptor peaking at different wavelengths. A dot in each visual system shows a representative contrast of a flower pattern (beetle pattern in the middle panel), which is the average of its contrast to all leaves (all beetle patterns on the right panel). Colours of the dots reflect the visible colour of the flower (beetle patterns in the middle panel) with the lines of the same colour connecting the results between different visual systems. Black dots show the median of the representative contrast in a visual system. Letters on the top of each panel show the significant difference in contrast between visual systems. Dotted horizontal line indicates JND=1. Two contrasts &gt; 10 JND are from flowers that have very low UV reflectance.
</p>
</div>
</div>
<div id="twilight-11" class="section level3">
<h3>Twilight</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#flower vs leaf</span>
Vis1.lf_twilight.model2&lt;-<span class="st"> </span>Cbuprest580_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis1.lf_twilight.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.lf&quot;</span>,<span class="dv">1</span>)
Vis2.lf_twilight.model2&lt;-Cbuprest600_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis2.lf_twilight.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.lf&quot;</span>,<span class="dv">1</span>)
Vis3.lf_twilight.model2&lt;-Cbuprest620_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis3.lf_twilight.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.lf&quot;</span>,<span class="dv">1</span>)
Vis4.lf_twilight.model2&lt;-Cbuprest640_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis4.lf_twilight.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.lf&quot;</span>,<span class="dv">1</span>)
Vis5.lf_twilight.model2&lt;-Cbuprest660_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis5.lf_twilight.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis5.lf&quot;</span>,<span class="dv">1</span>)
Vis6.lf_twilight.model2&lt;-Cbuprest680_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;leaves&quot;</span>))
Vis6.lf_twilight.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis6.lf&quot;</span>,<span class="dv">1</span>)

allvis.lf_twilight.model2&lt;-Vis1.lf_twilight.model2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.lf_twilight.model2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.lf_twilight.model2) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Vis4.lf_twilight.model2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis5.lf_twilight.model2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis6.lf_twilight.model2)

<span class="co">#add the mean</span>
mean.lf_twilight.model2&lt;-allvis.lf_twilight.model2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.lf_twilight.model2<span class="op">$</span>vissys,allvis.lf_twilight.model2<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.lf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

<span class="co">#plot the mean</span>
<span class="kw">names</span>(mean.lf_twilight.model2)[<span class="kw">names</span>(mean.lf_twilight.model2) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span> 
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.lf_twilight.model2&lt;-mean.lf_twilight.model2[<span class="kw">order</span>(mean.lf_twilight.model2<span class="op">$</span>flowerID),] 
<span class="co">#make the data frame order by flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

<span class="co">#combine the colour code list to the mean.bf for ploting</span>
mean.lf_twilight.model2<span class="op">$</span>match.name&lt;-flower.colour.model2<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.lf_twilight.model2<span class="op">$</span>colour&lt;-flower.colour.model2<span class="op">$</span>colour

lf_twilight.model2&lt;-<span class="kw">ggplot</span>(mean.lf_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.lf,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.lf_twilight.model2<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.lf_twilight.model2<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lf&quot;</span>, <span class="st">&quot;Vis2.lf&quot;</span>, <span class="st">&quot;Vis3.lf&quot;</span>,<span class="st">&quot;Vis4.lf&quot;</span>,<span class="st">&quot;Vis5.lf&quot;</span>,<span class="st">&quot;Vis6.lf&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 680&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.lf_twilight.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.lf_twilight.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.lf_twilight.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.lf_twilight.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis5.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis5.lf_twilight.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lf_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis6.lf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis6.lf_twilight.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Leaf vs. Flower&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lf&quot;</span>, <span class="st">&quot;Vis2.lf&quot;</span>, <span class="st">&quot;Vis3.lf&quot;</span>,<span class="st">&quot;Vis4.lf&quot;</span>,<span class="st">&quot;Vis5.lf&quot;</span>,<span class="st">&quot;Vis6.lf&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;b&quot;</span>)) <span class="co">#add stitistical info</span>


<span class="co">#beetle vs leaf</span>
Vis1.lb_twilight.model2&lt;-<span class="st"> </span>Cbuprest580_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis1.lb_twilight.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.lb&quot;</span>,<span class="dv">1</span>)
Vis2.lb_twilight.model2&lt;-Cbuprest600_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis2.lb_twilight.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.lb&quot;</span>,<span class="dv">1</span>)
Vis3.lb_twilight.model2&lt;-Cbuprest620_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis3.lb_twilight.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.lb&quot;</span>,<span class="dv">1</span>)
Vis4.lb_twilight.model2&lt;-Cbuprest640_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis4.lb_twilight.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.lb&quot;</span>,<span class="dv">1</span>)
Vis5.lb_twilight.model2&lt;-Cbuprest660_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis5.lb_twilight.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis5.lb&quot;</span>,<span class="dv">1</span>)
Vis6.lb_twilight.model2&lt;-Cbuprest680_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;leaves&quot;</span>))
Vis6.lb_twilight.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis6.lb&quot;</span>,<span class="dv">1</span>)

allvis.lb_twilight.model2&lt;-Vis1.lb_twilight.model2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.lb_twilight.model2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.lb_twilight.model2) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Vis4.lb_twilight.model2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis5.lb_twilight.model2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis6.lb_twilight.model2)


<span class="co">#add the mean</span>
mean.lb_twilight.model2&lt;-allvis.lb_twilight.model2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.lb_twilight.model2<span class="op">$</span>vissys,allvis.lb_twilight.model2<span class="op">$</span>patch2,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch2(beetles) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.lb=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>

<span class="co">#plot the mean</span>
<span class="kw">names</span>(mean.lb_twilight.model2)[<span class="kw">names</span>(mean.lb_twilight.model2) <span class="op">==</span><span class="st"> &quot;patch2&quot;</span>] &lt;-<span class="st"> &quot;beetleID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.lb_twilight.model2&lt;-mean.lb_twilight.model2[<span class="kw">order</span>(mean.lb_twilight.model2<span class="op">$</span>beetleID),]
<span class="co">#make the data frame order bt beetleID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

<span class="co">#combine the colour code list to the mean.bf for ploting</span>
mean.lb_twilight.model2<span class="op">$</span>match.name&lt;-beetle.colour.model2<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.lb_twilight.model2<span class="op">$</span>colour&lt;-beetle.colour.model2<span class="op">$</span>colour


lb_twilight.model2&lt;-<span class="kw">ggplot</span>(mean.lb_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.lb,<span class="dt">group=</span>beetleID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.lb_twilight.model2<span class="op">$</span>colour,<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.lb_twilight.model2<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lb&quot;</span>, <span class="st">&quot;Vis2.lb&quot;</span>, <span class="st">&quot;Vis3.lb&quot;</span>,<span class="st">&quot;Vis4.lb&quot;</span>,<span class="st">&quot;Vis5.lb&quot;</span>,<span class="st">&quot;Vis6.lb&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 680&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.lb_twilight.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.lb_twilight.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.lb_twilight.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.lb_twilight.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis5.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis5.lb_twilight.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.lb_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis6.lb&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis6.lb_twilight.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Leaf vs. Beetle&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.lb&quot;</span>, <span class="st">&quot;Vis2.lb&quot;</span>, <span class="st">&quot;Vis3.lb&quot;</span>,<span class="st">&quot;Vis4.lb&quot;</span>,<span class="st">&quot;Vis5.lb&quot;</span>,<span class="st">&quot;Vis6.lb&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>,<span class="st">&quot;f&quot;</span>)) <span class="co">#add stitistical info</span>


<span class="co">#beetle vs leaf</span>
Vis1.bf_twilight.model2&lt;-<span class="st"> </span>Cbuprest580_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis1.bf_twilight.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis1.bf&quot;</span>,<span class="dv">1</span>)
Vis2.bf_twilight.model2&lt;-Cbuprest600_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis2.bf_twilight.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis2.bf&quot;</span>,<span class="dv">1</span>)
Vis3.bf_twilight.model2&lt;-Cbuprest620_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis3.bf_twilight.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis3.bf&quot;</span>,<span class="dv">1</span>)
Vis4.bf_twilight.model2&lt;-Cbuprest640_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis4.bf_twilight.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis4.bf&quot;</span>,<span class="dv">1</span>)
Vis5.bf_twilight.model2&lt;-Cbuprest660_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis5.bf_twilight.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis5.bf&quot;</span>,<span class="dv">1</span>)
Vis6.bf_twilight.model2&lt;-Cbuprest680_twilight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch1,<span class="st">&quot;flower&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(patch2,<span class="st">&quot;beetle&quot;</span>))
Vis6.bf_twilight.model2<span class="op">$</span>vissys&lt;-<span class="kw">strrep</span>(<span class="st">&quot;Vis6.bf&quot;</span>,<span class="dv">1</span>)

allvis.bf_twilight.model2&lt;-Vis1.bf_twilight.model2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis2.bf_twilight.model2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>(Vis3.bf_twilight.model2) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rbind</span>(Vis4.bf_twilight.model2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis5.bf_twilight.model2) <span class="op">%&gt;%</span><span class="kw">rbind</span>(Vis6.bf_twilight.model2)



<span class="co">#add the mean</span>
mean.bf_twilight.model2&lt;-allvis.bf_twilight.model2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">patch3 =</span> <span class="kw">paste</span>(allvis.bf_twilight.model2<span class="op">$</span>vissys,allvis.bf_twilight.model2<span class="op">$</span>patch1,<span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#create a new column &quot;patch3&quot; which combines the category info of patch1(flowers) and vissys</span>
<span class="st">  </span><span class="kw">group_by</span>(patch3,vissys,patch1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mean.dS.bf=</span><span class="kw">mean</span>(dS)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#patch1(flowers</span>
<span class="st">  </span><span class="co">#create a column &quot;mean.dS&quot; as the mean dS for one patch1 to all corresponding patch2</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>patch3) <span class="co">#remove the patch3 column because we don&#39;t need it anymore</span>


<span class="co">#plot the mean dS</span>
<span class="kw">names</span>(mean.bf_twilight.model2)[<span class="kw">names</span>(mean.bf_twilight.model2) <span class="op">==</span><span class="st"> &quot;patch1&quot;</span>] &lt;-<span class="st"> &quot;flowerID&quot;</span>
<span class="co">#rename the column &quot;patch1&quot; because somehow it doesn&#39;t work in the ggplot function</span>
mean.bf_twilight.model2&lt;-mean.bf_twilight.model2[<span class="kw">order</span>(mean.bf_twilight.model2<span class="op">$</span>flowerID),]
<span class="co">#make the data frame order bt flowerID then when apply the colour code in the following step &quot;viridis&quot;, the colour will be consistent in the same comparison accross different visual systems</span>

<span class="co">#combine the colour code list to the mean.bf for ploting</span>
mean.bf_twilight.model2<span class="op">$</span>match.name&lt;-flower.colour.model2<span class="op">$</span>species <span class="co"># this column is just for checking if match correctly</span>
mean.bf_twilight.model2<span class="op">$</span>colour&lt;-flower.colour.model2<span class="op">$</span>colour

bf_twilight.model2&lt;-<span class="kw">ggplot</span>(mean.bf_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span>vissys, <span class="dt">y=</span>mean.dS.bf,<span class="dt">group=</span>flowerID))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>mean.bf_twilight.model2<span class="op">$</span>colour, <span class="dt">size=</span><span class="dv">3</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span>mean.bf_twilight.model2<span class="op">$</span>colour, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Visual system&quot;</span>) <span class="op">+</span><span class="st">     </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Chromatic contrast (JND)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">15</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey80&quot;</span>,<span class="dt">size =</span> <span class="ot">NA</span>), <span class="co">#make the backfround empty: panel.background = element_blank()</span>
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),  
        <span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">angle =</span><span class="dv">90</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">12</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
        <span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">axis.line.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&#39;solid&#39;</span>),
        <span class="dt">legend.justification=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.45</span>),
        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.bf&quot;</span>, <span class="st">&quot;Vis2.bf&quot;</span>, <span class="st">&quot;Vis3.bf&quot;</span>,<span class="st">&quot;Vis4.bf&quot;</span>,<span class="st">&quot;Vis5.bf&quot;</span>,<span class="st">&quot;Vis6.bf&quot;</span>),
                   <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Vis 580&quot;</span>, <span class="st">&quot;Vis 600&quot;</span>,<span class="st">&quot;Vis 620&quot;</span>,<span class="st">&quot;Vis 640&quot;</span>,<span class="st">&quot;Vis 660&quot;</span>,<span class="st">&quot;Vis 680&quot;</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)<span class="op">+</span><span class="st"> </span>##add a JND=1 line
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis1.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis1.bf_twilight.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis2.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis2.bf_twilight.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis3.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis3.bf_twilight.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis4.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis4.bf_twilight.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis5.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis5.bf_twilight.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mean.bf_twilight.model2, <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">&quot;Vis6.bf&quot;</span>, <span class="dt">y=</span> <span class="kw">median</span>(Vis6.bf_twilight.model2<span class="op">$</span>dS)), 
             <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="st"> </span><span class="co">#add the median point</span>
<span class="st">  </span><span class="co">#change the x labels</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Beetle vs. Flower&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;Vis1.bf&quot;</span>, <span class="st">&quot;Vis2.bf&quot;</span>, <span class="st">&quot;Vis3.bf&quot;</span>,<span class="st">&quot;Vis4.bf&quot;</span>,<span class="st">&quot;Vis5.bf&quot;</span>,<span class="st">&quot;Vis6.bf&quot;</span>), <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">label =</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;b&quot;</span>)) <span class="co">#add stitistical info</span>


figure_twilight.model2 &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(lf_twilight.model2,lb_twilight.model2,bf_twilight.model2, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)
figure_twilight.model2</code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
